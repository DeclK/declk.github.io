<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>MMDetection3D &amp; OpenPCDet installation</title>
      <link href="/archives/93e5b117.html"/>
      <url>/archives/93e5b117.html</url>
      
        <content type="html"><![CDATA[<h1 id="MMDetection3D-amp-OpenPCDet"><a href="#MMDetection3D-amp-OpenPCDet" class="headerlink" title="MMDetection3D &amp; OpenPCDet"></a>MMDetection3D &amp; OpenPCDet</h1><h2 id="Install-mmdet3d"><a href="#Install-mmdet3d" class="headerlink" title="Install mmdet3d"></a>Install mmdet3d</h2><p>å¯ä»¥å‚è€ƒ <a href="https://mmdetection3d.readthedocs.io/en/latest/getting_started.html#">å®˜æ–¹ doc</a> è¿›è¡Œä¸‹è½½ã€‚å…¶ä¸­æä¾›äº†å¦‚ä½•ä½¿ç”¨ conda ä»é›¶ä¸‹è½½ï¼Œä½†æ˜¯ç¯å¢ƒä¸ä»…ä»…åŒ…å« conda ç¯å¢ƒï¼Œè¿˜æœ‰ GCC, CUDA ç­‰ç¼–è¯‘ç¯å¢ƒã€‚æ‰€ä»¥æ›´å¥½çš„é€‰æ‹©æ˜¯ä½¿ç”¨ docker è¿›è¡Œå®‰è£…ï¼Œè¿™æ ·èƒ½å¤Ÿä¸€æ­¥è§£å†³æ‰€æœ‰ç¯å¢ƒé—®é¢˜ï¼Œä¸“æ³¨äºä»£ç </p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># build an image with PyTorch 1.6, CUDA 10.1</span>docker build -t mmdetection3d docker/docker run --gpus all --shm-size<span class="token operator">=</span>8g -it -v <span class="token punctuation">{</span>DATA_DIR<span class="token punctuation">}</span>:/mmdetection3d/data mmdetection3d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºæ¯æ¬¡å¯åŠ¨ docker éƒ½è¦ä¼ å…¥å¾ˆå¤šå‚æ•°ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè®°å½•å¯åŠ¨å®¹å™¨çš„å‘½ä»¤ï¼Œä»¥åç›´æ¥å¤åˆ¶ç²˜è´´</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker run --gpus all --shm-size<span class="token operator">=</span>8g -it -v /home/chk/data:/shared -v /home/chk/.Xauthority:/root/.Xauthority -e <span class="token environment constant">DISPLAY</span> --net<span class="token operator">=</span>host --name<span class="token comment"># å…¶ä¸­ -e å’Œ --net æ˜¯ä¸ºäº†è®¾ç½®å›¾å½¢åŒ–æ“ä½œï¼Œåœ¨ä¹‹åè¯¦ç»†ä»‹ç»</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨å®‰è£…çš„è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸¤ä¸ªé—®é¢˜</p><ol><li><p>clone MMDetection3D æ—¶ç½‘ç»œå‡ºäº†é—®é¢˜ï¼Œclone å¤±è´¥äº†ã€‚å†æ¬¡å°è¯• <code>docker build</code> åæˆåŠŸ</p></li><li><p>å…¶ä¸­æœ‰ä¸ªå°æŠ¥é”™ <code>ERROR: nbconvert 5.6.0 has requirement traitlets&gt;=4.2, but you'll have traitlets 4.1.0 which is inco</code></p><p>ä½†æ˜¯æœ€ç»ˆæ˜¾ç¤ºæ˜¯æˆåŠŸå®‰è£…ï¼ŒæŸ¥äº†ä¸€ä¸‹è¿™ä¸ªåº“ï¼Œæ˜¯ç”¨äºå°† notebooks è½¬ä¸ºå…¶ä»–æ ¼å¼çš„ï¼Œå…ˆæš‚æ—¶å¿½ç•¥ã€‚å¦‚é‡åˆ°æŠ¥é”™åˆ™å°è¯•ä½¿ç”¨ pip å‡çº§ä»¥ç¬¦åˆæ¡ä»¶</p></li></ol><h3 id="Nvidia-Docker"><a href="#Nvidia-Docker" class="headerlink" title="Nvidia-Docker"></a>Nvidia-Docker</h3><p>ä¸ºäº†è®©å®¹å™¨èƒ½å¤Ÿä½¿ç”¨ GPUï¼Œéœ€è¦å®‰è£… Nvidia-dockerï¼Œè¿‡ç¨‹ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™ç¯‡ <a href="https://zhuanlan.zhihu.com/p/361934132">çŸ¥ä¹</a></p><h2 id="Verify"><a href="#Verify" class="headerlink" title="Verify"></a>Verify</h2><p>æ¥è¿è¡Œå®˜æ–¹ <a href="https://mmdetection3d.readthedocs.io/en/latest/demo.html">demo</a> éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</p><p>ä¸‹è½½å¥½ SECOND æ¨¡å‹ï¼Œç„¶åè¿è¡Œè„šæœ¬</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python demo/pcd_demo.py demo/data/kitti/kitti_000008.bin configs/second/hv_second_secfpn_6x8_80e_kitti-3d-car.py checkpoints/hv_second_secfpn_6x8_80e_kitti-3d-car_20200620_230238-393f000c.pth<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€åå¾—åˆ°æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:  File <span class="token string">"demo/pcd_demo.py"</span>, line <span class="token number">4</span>, <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>    from mmdet3d.apis <span class="token function">import</span> inference_detector, init_model, show_result_meshlab  File <span class="token string">"/mmdetection3d/mmdet3d/__init__.py"</span>, line <span class="token number">5</span>, <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>    <span class="token function">import</span> mmseg  File <span class="token string">"/opt/conda/lib/python3.7/site-packages/mmseg/__init__.py"</span>, line <span class="token number">59</span>, <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>    f<span class="token string">'MMCV=={mmcv.__version__} is used but incompatible. '</span> <span class="token punctuation">\</span>AssertionError: <span class="token assign-left variable">MMCV</span><span class="token operator">==</span><span class="token number">1.3</span>.8 is used but incompatible. Please <span class="token function">install</span> mmcv<span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">3</span>, <span class="token number">13</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0</span><span class="token punctuation">)</span>, <span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">4</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0</span><span class="token punctuation">)</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç°åœ¨å°è¯•å‡çº§ MMCV ä»¥è§£å†³ã€‚ä¿®æ”¹ dockerfile ä¸­çš„ mmcv ç‰ˆæœ¬ä¸º 1.3.13ï¼Œé‡æ–°ç”Ÿæˆé•œåƒå’Œå¯¹åº”å®¹å™¨ã€‚ç”±äºç›®å‰å®éªŒå®¤çš„ GPU æœ‰å…¶ä»–äººåœ¨è·‘é¡¹ç›®ï¼Œæ‰€ä»¥éªŒè¯çš„æ—¶å€™å‘ç”Ÿé”™è¯¯ <a href="https://github.com/open-mmlab/mmdetection3d/issues/21">github issue</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">RuntimeError: /mmdetection3d/mmdet3d/ops/spconv/src/indice_cuda.cu <span class="token number">124</span>cuda execution failed with error <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åº”è¯¥æ˜¯ç”±äºæ˜¾å­˜ä¸è¶³å¯¼è‡´çš„ï¼Œäºæ˜¯é€‰æ‹©äº†ä¸€ä¸ªè¾ƒå°çš„æ¨¡å‹ PointNet++ è¿›è¡Œäº†éªŒè¯ï¼Œæœ€ç»ˆ demo èƒ½å¤Ÿè¿è¡Œï¼Œæ•…ä»¥ä¸Šå‡çº§æ˜¯æœ‰æ•ˆçš„ã€‚åœ¨ MeshLab ä¸­è¿›è¡Œå¯è§†åŒ–æŸ¥çœ‹ PointNet++ åˆ†å‰²æ•ˆæœ</p><p><img src="/archives/93e5b117/image-20211028172827565.png" style="zoom:50%;"></p><p>ç­‰æœåŠ¡å™¨ç©ºé—²äº†ï¼Œæµ‹è¯•äº† SECONDï¼Œä¹Ÿå¯ä»¥è¿è¡Œ</p><p><img src="/archives/93e5b117/image-20211029132630612.png" style="zoom: 67%;"></p><h2 id="Work-with-VSCode"><a href="#Work-with-VSCode" class="headerlink" title="Work with VSCode"></a>Work with VSCode</h2><h3 id="VSCode-with-container"><a href="#VSCode-with-container" class="headerlink" title="VSCode with container"></a>VSCode with container</h3><p>æƒ³è¦ vscode ç¼–è¾‘ docker å®¹å™¨ä¸­çš„æ–‡ä»¶ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ–¹æ³• </p><ol><li><p>ä¸‹è½½ docker å’Œ remote-container æ’ä»¶</p></li><li><p>åœ¨ side bar ä¸­å¯ä»¥çœ‹åˆ° docker å·¥å…·æ ï¼Œå¯ä»¥è½»æ¾å¯åŠ¨å®¹å™¨</p><p><img src="/archives/93e5b117/image-20211028115235998.png"></p></li><li><p>å¯åŠ¨å®¹å™¨åï¼Œé€‰æ‹© <code>Attach Visual Studio Code</code> å°±å¯ä»¥æ‰“å¼€æ–°çš„çª—å£ï¼Œæ–°çª—å£çš„ç•Œé¢å°±åƒ vscode åœ¨å®¹å™¨ä¸­è¿è¡Œä¸€æ ·</p><p><img src="/archives/93e5b117/image-20211028115404905.png"></p></li></ol><p>å¦‚æœåœ¨ Linux ä¸Šé‡åˆ°è¿æ¥é—®é¢˜ <code>error "connect EACCES /var/run/docker.sock"</code> è¿™æ˜¯ç”±äº docker æƒé™é€ æˆï¼Œå¯ä»¥æŒ‰ç…§ <a href="https://github.com/microsoft/vscode-docker/wiki/Troubleshooting">å®˜æ–¹æç¤º</a>  å¯ä»¥å°è¯•è§£å†³ã€‚å¦‚æœè¿˜ä¸èƒ½è§£å†³ï¼Œç›´æ¥é€šè¿‡ä¿®æ”¹ <code>docker.sock</code> æ–‡ä»¶çš„æƒé™ä¸€æ­¥åˆ°ä½</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">666</span> /var/run/docker.sock<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="VSCode-å…å¯†ç™»å½•"><a href="#VSCode-å…å¯†ç™»å½•" class="headerlink" title="VSCode å…å¯†ç™»å½•"></a>VSCode å…å¯†ç™»å½•</h3><p>å®Œæˆä»¥ä¸‹æ­¥éª¤å³å¯ï¼š</p><ol><li><p>ç”Ÿæˆæœ¬åœ° ssh-keyï¼Œå’Œ git æ“ä½œæ˜¯ä¸€æ ·çš„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ssh-keygen -t rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å°† <code>id_rsa.pub</code> å¤åˆ¶åˆ°æœåŠ¡å™¨ä¸»æœº <code>~/.ssh</code> æ–‡ä»¶å¤¹ä¸‹ï¼Œå°† <code>id_rsa.pub</code> çš„å†…å®¹åŠ å…¥åˆ° <code>authorized_keys</code> ä¸­</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">cat</span> id_rsa.pub <span class="token operator">&gt;&gt;</span> authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>é‡å¯ ssh æœåŠ¡ <code>service sshd restart</code></p></li></ol><p>å…¶ä»–æ“ä½œå’Œä¸€èˆ¬ remote-ssh æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‰é»˜è®¤å¡«å†™é…ç½®æ–‡ä»¶å³å¯ï¼Œä¸éœ€è¦é…ç½® <code>IdentityFile</code> å…³é”®å­—</p><pre class="line-numbers language-config" data-language="config"><code class="language-config">Host Arbitrary_Nane  HostName Host_ip  User User_Name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="VSCode-X11-forward"><a href="#VSCode-X11-forward" class="headerlink" title="VSCode X11 forward"></a>VSCode X11 forward</h3><p>ä½¿ç”¨ X server è§£å†³æ— æ³•å¯è§†åŒ–å›¾å½¢ç•Œé¢çš„é—®é¢˜ã€‚ä¸€èˆ¬æ¥è®²ä½¿ç”¨ ssh è¿æ¥åˆ°æœåŠ¡å™¨åæ˜¯ä¸èƒ½ä½¿ç”¨å›¾å½¢åŒ–ç•Œé¢æœåŠ¡çš„ï¼Œä¾‹å¦‚ä½¿ç”¨  firefox æµè§ˆå™¨ã€‚ä¸€äº›è½¯ä»¶è‡ªå¸¦ X serverï¼Œä¾‹å¦‚ MobaXtermï¼Œå½“è¿æ¥ä¸ŠæœåŠ¡å™¨åï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>firefox</code>ï¼Œç„¶åå°±èƒ½å¼¹å‡ºæµè§ˆå™¨çª—å£ã€‚å¦‚æœç”µè„‘ä¸Šæ²¡æœ‰ X server åˆ™éœ€è¦è‡ªè¡Œå®‰è£…ï¼Œæˆ–è€…ç›´æ¥æŠŠ MobaXterm æŒ‚åœ¨æ—è¾¹å³å¯ã€‚æ›´å¤šç§‘æ™®å†…å®¹å‚è€ƒ <a href="https://www.jianshu.com/p/1a296191a122">åšå®¢</a></p><p>ç°åœ¨åœ¨ VSCode Remote-SSH ä¸Šä¹Ÿæ”¯æŒäº† X11 forwardingï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®Œæˆ</p><p>é¦–å…ˆä¿®æ”¹é…ç½® vscode <code>settings.json</code> ä¸­ <code>terminal.integrated.env.windows</code> å­—æ®µï¼Œæ·»åŠ æœ¬åœ°æ˜¾ç¤ºå˜é‡</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">   <span class="token property">"terminal.integrated.env.windows"</span><span class="token operator">:</span> <span class="token punctuation">{</span>       <span class="token property">"DISPLAY"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1:0.0"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨ ssh é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ç›¸å…³å­—æ®µ</p><pre class="line-numbers language-config" data-language="config"><code class="language-config">Host Arbitrary_Nane  HostName Host_ip  User User_Name  ForwardAgent yes  ForwardX11 yes  ForwardX11Trusted yes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ååœ¨æœåŠ¡å™¨ä¸ŠæŒ‡å®š <code>DISPLAY</code> ç¯å¢ƒå˜é‡</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span><span class="token string">"localhost:10.0"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨ <code>xeyes</code> æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚æœçœ‹åˆ°ä¸€ä¸ªçœ¼ç›çª—å£å°±æˆåŠŸäº†ğŸ˜</p><h3 id="Docker-with-GUI"><a href="#Docker-with-GUI" class="headerlink" title="Docker with GUI"></a>Docker with GUI</h3><p>å¦‚æœèƒ½å¤Ÿåœ¨ Docker ä¸­ä½¿ç”¨ GUI app å²‚ä¸æ˜¯ç¾æ»‹æ»‹ï¼Ÿæ—¢ç„¶èƒ½å¤Ÿåœ¨ VSCode ä¸­é€šè¿‡ X11 forward åè®®è¿è¡Œå›¾å½¢ç•Œé¢ï¼Œé‚£ä¹ˆç†è®ºä¸Š Docker ä¹Ÿæ˜¯å¯ä»¥çš„ï¼æ ¹æ®è¿™ä¸¤ä¸ªåšå®¢ï¼š<a href="https://www.cnblogs.com/larva-zhh/p/10531824.html">Link-1</a> <a href="https://medium.com/@SaravSun/running-gui-applications-inside-docker-containers-83d65c0db110">Link-2</a> è¿›è¡Œé…ç½®ï¼Œæ„æƒ³ä¸åˆ°åœ°æˆåŠŸäº†ï¼Œè¯´æ˜åšå®¢ä¸­çš„åŸç†æ˜¯æ­£ç¡®çš„ï¼Œåªè¦å°† Host ä¸­çš„ X11 æœåŠ¡å™¨åˆ†äº«ç»™ Docker å°±å¯ä»¥ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>Share the Hostâ€™s XServer with the Container by creating a volume</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">--volume<span class="token operator">=</span><span class="token string">"<span class="token environment constant">$HOME</span>/.Xauthority:/root/.Xauthority:rw"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯æ¬¡ç™»å½•çš„æ—¶ Host <code>.Xauthority</code> æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚æœç›´æ¥å¤åˆ¶è¯¥æ–‡ä»¶çš„è¯ï¼Œè¦æ¯æ¬¡æ›´æ–°</p></li><li><p>share the Hostâ€™s <strong>DISPLAY</strong> environment variable to the Container</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">--env<span class="token operator">=</span><span class="token string">"DISPLAY"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>Run container with <strong>host</strong> network driver with</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">--net<span class="token operator">=</span>host<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><h2 id="KITTI"><a href="#KITTI" class="headerlink" title="KITTI"></a>KITTI</h2><p>ä½¿ç”¨ KITTI æ•°æ®é›†è¿›è¡Œå®éªŒï¼Œä¸‹è½½é€šè¿‡ <a href="https://gas.graviti.cn/dataset/data-decorators/KITTIObject">GRAVITI</a></p><p><img src="/archives/93e5b117/image-20211028134043307.png" style="zoom:80%;"></p><p>å°†æ•°æ®é›†æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œå…¨éƒ¨è§£å‹</p><h2 id="SECOND-on-MMDetection3D"><a href="#SECOND-on-MMDetection3D" class="headerlink" title="SECOND on MMDetection3D"></a>SECOND on MMDetection3D</h2><p>å…ˆå°è¯•æµ‹è¯•ä¸€ä¸‹ç»å…¸çš„ backbone SECOND èƒ½ä¸èƒ½è¿è¡Œ</p><h3 id="Test-SECOND"><a href="#Test-SECOND" class="headerlink" title="Test SECOND"></a>Test SECOND</h3><ol><li><p>ä¸‹è½½ <a href="https://github.com/open-mmlab/mmdetection3d/blob/master/configs/second/README.md">SECOND</a> æ¨¡å‹</p></li><li><p>æ ¹æ® <a href="https://mmdetection3d.readthedocs.io/en/latest/datasets/kitti_det.html">doc</a> ç”Ÿæˆæ•°æ®é›†ï¼Œå…¶ä¸­ç”Ÿæˆäº†ä¸€äº› pkl æ–‡ä»¶ç”¨äºå­˜å‚¨æ•°æ®é›†æ¯ä¸ªæ ·æœ¬çš„ç›¸å…³ä¿¡æ¯ï¼Œå…³äº pkl æ–‡ä»¶å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/Ving_x/article/details/114488844">CSDN</a>ã€‚ä¸‹é¢æ˜¯ç¨‹åºè¿è¡Œä¸­æœ€åçš„è¾“å‡º</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">load <span class="token number">2207</span> Pedestrian database infosload <span class="token number">14357</span> Car database infosload <span class="token number">734</span> Cyclist database infosload <span class="token number">1297</span> Van database infosload <span class="token number">488</span> Truck database infosload <span class="token number">224</span> Tram database infosload <span class="token number">337</span> Misc database infosload <span class="token number">56</span> Person_sitting database infos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>Test SECOND on KITTI valï¼Œå…¶ä¸­ <code>AP@0.5 0.5 0.5</code> ä»£è¡¨ bbox, bev, 3d ä»»åŠ¡çš„ IoU é˜ˆå€¼åˆ†åˆ«ä¸º 0.5, 0.5, 0.5ï¼Œåˆ—å‡º Car ç›¸å…³çš„éƒ¨åˆ†</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Result is saved to /tmp/tmp50avi_bh/results.pkl.Car AP@0.70, <span class="token number">0.70</span>, <span class="token number">0.70</span>:bbox AP:98.1839, <span class="token number">89.7606</span>, <span class="token number">88.7837</span>bev  AP:89.6905, <span class="token number">87.4570</span>, <span class="token number">85.4865</span>3d   AP:87.4561, <span class="token number">76.7570</span>, <span class="token number">74.1302</span>aos  AP:97.70, <span class="token number">88.73</span>, <span class="token number">87.34</span>Car AP@0.70, <span class="token number">0.50</span>, <span class="token number">0.50</span>:bbox AP:98.1839, <span class="token number">89.7606</span>, <span class="token number">88.7837</span>bev  AP:98.4400, <span class="token number">90.1218</span>, <span class="token number">89.6270</span>3d   AP:98.3329, <span class="token number">90.0209</span>, <span class="token number">89.4035</span>aos  AP:97.70, <span class="token number">88.73</span>, <span class="token number">87.34</span>Overall AP@easy, moderate, hard:bbox AP:84.0061, <span class="token number">75.7857</span>, <span class="token number">73.6821</span>bev  AP:80.2144, <span class="token number">72.7919</span>, <span class="token number">69.1538</span>3d   AP:76.7926, <span class="token number">66.6667</span>, <span class="token number">62.3905</span>aos  AP:80.79, <span class="token number">72.30</span>, <span class="token number">70.19</span><span class="token punctuation">{</span><span class="token string">'KITTI/Car_3D_easy_strict'</span><span class="token builtin class-name">:</span> <span class="token number">87.45610724795893</span>, <span class="token string">'KITTI/Car_BEV_easy_strict'</span><span class="token builtin class-name">:</span> <span class="token number">89.69046011671303</span>, <span class="token string">'KITTI/Car_2D_easy_strict'</span><span class="token builtin class-name">:</span> <span class="token number">98.18389028596552</span>, <span class="token string">'KITTI/Car_3D_moderate_strict'</span><span class="token builtin class-name">:</span> <span class="token number">76.75701107649772</span>, <span class="token string">'KITTI/Car_BEV_moderate_strict'</span><span class="token builtin class-name">:</span> <span class="token number">87.45702960861706</span>, <span class="token string">'KITTI/Car_2D_moderate_strict'</span><span class="token builtin class-name">:</span> <span class="token number">89.76058109581083</span>, <span class="token string">'KITTI/Car_3D_hard_strict'</span><span class="token builtin class-name">:</span> <span class="token number">74.13015065869207</span>, <span class="token string">'KITTI/Car_BEV_hard_strict'</span><span class="token builtin class-name">:</span> <span class="token number">85.4865455582404</span>, <span class="token string">'KITTI/Car_2D_hard_strict'</span><span class="token builtin class-name">:</span> <span class="token number">88.78373491728972</span>, <span class="token string">'KITTI/Car_3D_easy_loose'</span><span class="token builtin class-name">:</span> <span class="token number">98.33288257217502</span>, <span class="token string">'KITTI/Car_BEV_easy_loose'</span><span class="token builtin class-name">:</span> <span class="token number">98.4400221898542</span>, <span class="token string">'KITTI/Car_2D_easy_loose'</span><span class="token builtin class-name">:</span> <span class="token number">98.18389028596552</span>, <span class="token string">'KITTI/Car_3D_moderate_loose'</span><span class="token builtin class-name">:</span> <span class="token number">90.02090501786836</span>, <span class="token string">'KITTI/Car_BEV_moderate_loose'</span><span class="token builtin class-name">:</span> <span class="token number">90.12184507731126</span>, <span class="token string">'KITTI/Car_2D_moderate_loose'</span><span class="token builtin class-name">:</span> <span class="token number">89.76058109581083</span>, <span class="token string">'KITTI/Car_3D_hard_loose'</span><span class="token builtin class-name">:</span> <span class="token number">89.40349529357029</span>, <span class="token string">'KITTI/Car_BEV_hard_loose'</span><span class="token builtin class-name">:</span> <span class="token number">89.62702775979791</span>, <span class="token string">'KITTI/Car_2D_hard_loose'</span><span class="token builtin class-name">:</span> <span class="token number">88.78373491728972</span>, <span class="token string">'KITTI/Overall_3D_easy'</span><span class="token builtin class-name">:</span> <span class="token number">76.79258397928281</span>, <span class="token string">'KITTI/Overall_BEV_easy'</span><span class="token builtin class-name">:</span> <span class="token number">80.21439732105783</span>, <span class="token string">'KITTI/Overall_2D_easy'</span><span class="token builtin class-name">:</span> <span class="token number">84.00606839712997</span>, <span class="token string">'KITTI/Overall_3D_moderate'</span><span class="token builtin class-name">:</span> <span class="token number">66.6666643647041</span>, <span class="token string">'KITTI/Overall_BEV_moderate'</span><span class="token builtin class-name">:</span> <span class="token number">72.7919003517221</span>, <span class="token string">'KITTI/Overall_2D_moderate'</span><span class="token builtin class-name">:</span> <span class="token number">75.78568527747004</span>, <span class="token string">'KITTI/Overall_3D_hard'</span><span class="token builtin class-name">:</span> <span class="token number">62.39046573028369</span>, <span class="token string">'KITTI/Overall_BEV_hard'</span><span class="token builtin class-name">:</span> <span class="token number">69.15381069261458</span>, <span class="token string">'KITTI/Overall_2D_hard'</span><span class="token builtin class-name">:</span> <span class="token number">73.68210872556001</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p>ä½†æ˜¯æƒ³è¦çš„é¢„æµ‹ç»“æœ <code>pred.obj</code> ä»¥åŠ <code>result.pkl</code> å¥½åƒå¹¶æ²¡æœ‰ä¿å­˜ï¼Œå¹¶ä¸”æŸ¥çœ‹äº†è¾“å‡ºä¸­çš„è·¯å¾„ <code>/tmp/tmp50avi_bh/results.pkl</code> ç”šè‡³éƒ½æ‰¾ä¸åˆ°è¿™ä¸ªè·¯å¾„ ï¼Œå†æ¬¡æŸ¥çœ‹äº†å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰ä»¥ä¸‹æè¿°</p><blockquote><ul><li><code>--show</code>: If specified, detection results will be plotted in the silient mode. It is only applicable to single GPU testing and used for debugging and visualization. This should be used with <code>--show-dir</code>.</li></ul></blockquote><p>å› ä¸ºæˆ‘åœ¨è¿è¡Œçš„æ—¶å€™åªæŒ‡å®šäº† <code>--show-dir</code>ï¼Œè€Œ  <code>--show</code> å’Œ <code>--show-dir</code> éœ€è¦ä¸€èµ·ä½¿ç”¨ã€‚è€Œæ²¡æœ‰çœ‹åˆ° <code>result.pkl</code> æ˜¯å› ä¸ºæˆ‘ä¼ å…¥ <code>--out</code> çš„å‚æ•°ä¸ºæ–‡ä»¶å¤¹ï¼Œåº”è¯¥ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶ã€‚å¯¹äº <code>--show</code> çš„ä½¿ç”¨ï¼Œéœ€è¦å®‰è£… open3dï¼Œ<code>pip install open3d</code> å³å¯ï¼Œæˆ‘åœ¨å®‰è£…çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é”™è¯¯ï¼Œè¿™é‡Œåˆ—å‡ºæ¥</p><ol><li><p>é‡åˆ°é”™è¯¯ <code>AttributeError: 'NoneType' object has no attribute 'point_size'</code>ï¼ŒåŸå› å¯èƒ½æ˜¯ç”±äº open3d ç‰ˆæœ¬é—®é¢˜ï¼Œå¯ä»¥å°è¯•æ›´æ¢ç‰ˆæœ¬ <code>pip install open3d==0.11</code>ï¼Œå‚è€ƒ  <a href="https://github.com/open-mmlab/mmdetection3d/issues/344">github issue</a> </p></li><li><p>ä½¿ç”¨ open3d==0.11 åé‡åˆ°é”™è¯¯ <code>OSError: libc++.so.1: cannot open shared object file: No such file or directory</code>ï¼ŒåŸå› åœ¨äºç¯å¢ƒå˜é‡æ²¡æœ‰è®¾ç½®ï¼Œå‚è€ƒ <a href="https://github.com/isl-org/Open3D/issues/2518">github issue</a> åŠ å…¥å¯¹åº”ç¯å¢ƒå˜é‡å³å¯</p></li><li><p>å¦‚æœä»¥ä¸Šé—®é¢˜éƒ½è§£å†³äº†ï¼Œä½†ä½ çš„æµ‹è¯•ç¯å¢ƒä¸ºè¿œç¨‹æœåŠ¡å™¨ï¼Œæ²¡æœ‰å›¾å½¢ç•Œé¢ GUIï¼Œé‚£ä¹ˆè¿˜å¯èƒ½é‡åˆ°æŠ¥é”™ <code>RuntimeError: [Open3D ERROR] GLFW Error: X11: The DISPLAY environment variable is missing</code>ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/open-mmlab/mmdetection3d/issues/851">github issue</a> å¯¹ <code>if show</code> éƒ¨åˆ†çš„ä»£ç è¿›è¡Œæ³¨é‡Šï¼Œæˆ–è€…å¦‚å‰æ–‡æåˆ°çš„æ–¹æ³•ï¼Œé…ç½®å¥½ GUI ç¯å¢ƒ</p></li></ol><h3 id="Train-SECOND"><a href="#Train-SECOND" class="headerlink" title="Train SECOND"></a>Train SECOND</h3><p>åªèƒ½è·‘1ä¸ª batch_size </p><p><img src="/archives/93e5b117/image-20211030195600143-16359966282161.png" alt="image-20211030195600143"></p><p>æˆ‘è®¤ä¸ºæˆ‘åº”è¯¥è½¬æˆ˜ä¸€ä¸‹ <a href="https://github.com/open-mmlab/OpenPCDet">OpenPCDet</a> é¡¹ç›®ï¼Œæ ¹æ® PV-RCNN è®ºæ–‡</p><blockquote><p>Our PV-RCNN framework is trained from scratch in an end-to-end manner with the ADAM optimizer. For the KITTI dataset, we train the entire network with the batch size 24, learning rate 0.01 for 80 epochs on 8 GTX 1080 Ti GPUs, which takes around 5 hours.</p></blockquote><p>ä½¿ç”¨8ä¸ª 1080Ti GPU ä¹Ÿèƒ½å¤Ÿè·‘24ä¸ª batch sizeï¼Œè¯´æ˜å®éªŒå®¤çš„ 2080Ti è‡³å°‘æ¯ä¸ªèƒ½è·‘3ä¸ª batch sizeã€‚ç„¶è€Œ MMDetection3D åªèƒ½è·‘ä¸€ä¸ªï¼Œç¡®å®å¤ªå°‘äº†ã€‚ç°åœ¨éœ€è¦å¯¹ OpenPCDet è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„ç ”ç©¶</p><h2 id="â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”"><a href="#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”" class="headerlink" title="â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-"></a>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</h2><h2 id="OpenPCDet-amp-spconv"><a href="#OpenPCDet-amp-spconv" class="headerlink" title="OpenPCDet &amp; spconv"></a>OpenPCDet &amp; spconv</h2><p>é¦–å…ˆé¢ä¸´çš„éš¾é¢˜å°±æ˜¯å®‰è£…  <a href="https://github.com/open-mmlab/OpenPCDet">OpenPCDet</a>ï¼Œæœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯ä½¿ç”¨ docker å®‰è£…ï¼Œä¹Ÿæœ‰äººå‘å¸ƒäº† <a href="https://hub.docker.com/r/xfbs/openpcdet">openpcdet-docker</a> ä½†æˆ‘ä¸‹è½½ä¸‹æ¥åï¼Œæ„Ÿè§‰ä¸å¤ªå¥½ç”¨ï¼Œæœ€åŸºæœ¬çš„ pip å‘½ä»¤éƒ½æ²¡æœ‰ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ‰“å¼€æ–¹å¼ä¸å¯¹ã€‚å°è¯•ç°æˆçš„ docker å¤±è´¥åï¼Œåªæœ‰è‡ªå·±é€æ­¥æ­å»ºäº†</p><h3 id="Install-spconv-v1-2-1"><a href="#Install-spconv-v1-2-1" class="headerlink" title="Install spconv v1.2.1"></a>Install spconv v1.2.1</h3><p>å®‰è£… OpenPCDet é¦–å…ˆéœ€è¦å®‰è£… spconvï¼Œè¿™ä¸ªéƒ¨åˆ†ä¹Ÿæ˜¯èŠ±è´¹äº†ä¸å°‘ç²¾åŠ›ï¼Œåˆ°å¤„éƒ½æ˜¯å›°éš¾å•ŠğŸ˜¥è€Œä¸”ç”±äº OpenPCDet é¡¹ç›®æ›´æ–°é€Ÿåº¦å¹¶ä¸å¿«ï¼Œä½†æ˜¯ spconv å·²ç»æ›´æ–°åˆ°äº† 2.0 ç‰ˆæœ¬ï¼Œè€ç‰ˆæœ¬å‡ ä¹å·²ç»åœæ­¢æ›´æ–°äº†ï¼Œæ‰€ä»¥æƒ³è¦å®‰è£…è€ç‰ˆæœ¬ <a href="https://github.com/traveller59/spconv/tree/v1.2.1">spconv v1.2.1</a> ä¹Ÿæ¯”æœ‰ä¸€äº›éš¾åº¦</p><h4 id="Install-by-docker-deprecate"><a href="#Install-by-docker-deprecate" class="headerlink" title="Install by docker (deprecate)"></a>Install by docker (deprecate)</h4><p>é¦–å…ˆæƒ³è¦é€šè¿‡ docker æ¥ä¸‹è½½ spconvï¼Œä½†æ˜¯ç”±äº spconv çš„é•œåƒä»ä¸æ‰“ tagï¼Œå¦‚æœæ ¹æ®åŸ Dockerfile ä¼šé»˜è®¤æ‹‰å–æœ€æ–°çš„é•œåƒï¼Œæ‰€ä»¥ CUDA ç‰ˆæœ¬å¹¶ä¸æ˜¯æˆ‘æƒ³è¦ä¸‹è½½çš„ 10.1ã€‚è€Œä¸”å®éªŒå®¤ Ubuntu çš„ Nvidia Driver ç‰ˆæœ¬ä¸å¤Ÿæ–°ï¼Œæ‰€ä»¥æ›´é«˜ç‰ˆæœ¬çš„ CUDA é•œåƒæ˜¯æ²¡åŠæ³•å¯åŠ¨çš„ã€‚äºæ˜¯å°±å°è¯•æ ¹æ® github ä¸­æœ€æ™šçš„æ›´æ–°æ—¶é—´ï¼Œä¸‹è½½è€ç‰ˆæœ¬çš„é•œåƒï¼Œè¿™é‡Œæˆ‘å®‰è£…çš„ tag æ˜¯</p><p><img src="/archives/93e5b117/image-20211031204629220.png" style="zoom:80%;"></p><p>ä¸‹è½½å¥½è¯¥é•œåƒåå°±èƒ½æ­£å¸¸è¿è¡Œ CUDA é•œåƒäº†ï¼Œç„¶åå°±æ ¹æ® OpenPCDet å®˜æ–¹ <a href="https://github.com/open-mmlab/OpenPCDet/blob/master/docs/INSTALL.md">Install</a> æ–‡æ¡£è¿›è¡Œå®‰è£…</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">git</span> clone https://github.com/open-mmlab/OpenPCDet.gitpip <span class="token function">install</span> -r requirements.txt python setup.py develop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½†ä¹‹ååœ¨å®‰è£… mayavi åº“çš„æ—¶å€™å‡ºç°äº†é—®é¢˜ï¼Œå› ä¸ºéœ€è¦ä½¿ç”¨ python3.7ï¼Œè€Œé•œåƒæ˜¯ python3.8ï¼Œå¹¶ä¸”é•œåƒæ²¡æœ‰ conda å‘½ä»¤ï¼Œä¸ªäººä¸æ˜¯å¾ˆä¹ æƒ¯ï¼Œäºæ˜¯æ‰“ç®—æ”¾å¼ƒé€šè¿‡ spconv docker å®‰è£…ã€‚è€ƒè™‘ä½¿ç”¨ mmdetection3d æä¾›çš„é•œåƒï¼Œä½œä¸ºåŸºç¡€é•œåƒä»é›¶å¼€å§‹å®‰è£…ï¼Œå› ä¸ºè¯¥é•œåƒçš„åŠŸèƒ½æ›´å¤šä¸€äº›ï¼Œç¯å¢ƒæ›´å®Œæ•´ï¼Œå…¶éƒ¨åˆ† Dockerfile å¦‚ä¸‹</p><pre class="line-numbers language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">ARG PYTORCH="1.6.0"ARG CUDA="10.1"ARG CUDNN="7"FROM pytorch/pytorch:${PYTORCH}-cuda${CUDA}-cudnn${CUDNN}-develENV TORCH_CUDA_ARCH_LIST="6.0 6.1 7.0+PTX"ENV TORCH_NVCC_FLAGS="-Xfatbin -compress-all"ENV CMAKE_PREFIX_PATH="$(dirname $(which conda))/../"RUN apt-get update &amp;&amp; apt-get install -y ffmpeg libsm6 libxext6 git ninja-build libglib2.0-0 libsm6 libxrender-dev libxext6 \    &amp;&amp; apt-get clean \    &amp;&amp; rm -rf /var/lib/apt/lists/*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Install-cmake"><a href="#Install-cmake" class="headerlink" title="Install cmake"></a>Install cmake</h4><p>é¦–å…ˆé‡åˆ°çš„éš¾é¢˜æ˜¯å®‰è£… cmakeï¼Œå‘ç°åŸæ¥é€šè¿‡ pip å®‰è£…æ‰æ˜¯æœ€å¿«çš„æ–¹å¼ï¼Œè€Œä¸”ç‰ˆæœ¬å¾ˆæ–°ï¼Œå‚è€ƒ <a href="https://stackoverflow.com/questions/49859457/how-to-reinstall-the-latest-cmake-version">stackoverflow</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">(</span>base<span class="token punctuation">)</span> root@fb873089e53c:/spconv<span class="token comment"># cmake --version</span>cmake version <span class="token number">3.21</span>.3CMake suite maintained and supported by Kitware <span class="token punctuation">(</span>kitware.com/cmake<span class="token punctuation">)</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Git-clone"><a href="#Git-clone" class="headerlink" title="Git clone"></a>Git clone</h4><p>ä¸€å®šè¦ä½¿ç”¨ <code>git clone ... --recursive</code> å‘½ä»¤æ¥ clone è¯¥é¡¹ç›®ï¼Œ<code>--recursive</code> å‘½ä»¤æ„æ€æ˜¯è¿™ä¸ªé¡¹ç›®è¿˜æœ‰ä¸€äº›å­é¡¹ç›®ä¹Ÿéœ€è¦ cloneï¼Œæˆ‘å°è¯•ä½¿ç”¨è¿‡ <code>cp</code> å‘½ä»¤å¤åˆ¶é¡¹ç›®ï¼Œä½†è¯¥ä¼¼ä¹æ— æ³•å®Œæ•´å¤åˆ¶ã€‚å¹¶ä¸”éœ€è¦åŠ ä¸Š <code>-b</code> å‚æ•°æŒ‡å®š clone çš„ branchï¼Œä¸ç„¶ä¼šé»˜è®¤ clone master åˆ†æ”¯ï¼Œè€Œä¸æ˜¯æˆ‘éœ€è¦çš„ v1.2.1 ç‰ˆæœ¬ã€‚æ•´ä¸ªä¸‹è½½çš„è¿‡ç¨‹å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨å›½å†…çš„é•œåƒæºï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„ <a href="https://hongkun.space/archives/2121b11b.html#toc-heading-1">git ç¬”è®°</a>ï¼ˆé¢˜å¤–è¯ï¼Œè‡ªå·±å°±æ˜¯å› ä¸º clone æ“ä½œæ²¡æœ‰å¼„å¯¹ï¼Œåœ¨å®‰è£…çš„æ—¶å€™é™¤äº†å¥½å¤šé”™â€¦å¿ƒæ€çˆ†ç‚¸ï¼‰</p><h4 id="Setup-py"><a href="#Setup-py" class="headerlink" title="Setup.py"></a>Setup.py</h4><p>è¿è¡Œ <code>setup.py</code> è¿›è¡Œç¼–è¯‘ï¼Œç„¶åè¿›å…¥ <code>./dist</code> æ–‡ä»¶å¤¹ä¸‹è½½ <code>xxx.whl</code> ä¸åŒç‰ˆæœ¬çš„ spconv ä¼šæœ‰ä¸åŒçš„ <code>.whl</code> æ–‡ä»¶ </p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python setup.py bdist_wheel<span class="token builtin class-name">cd</span> ./distpython xxx.whl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Install-OpenPCDet"><a href="#Install-OpenPCDet" class="headerlink" title="Install OpenPCDet"></a>Install OpenPCDet</h3><p>ä¸‹è½½å¥½äº† spconv ç»§ç»­å‰å¾€ OpenPCDet é¡¹ç›®ç»§ç»­å®‰è£…å§</p><h4 id="Install-requirements"><a href="#Install-requirements" class="headerlink" title="Install requirements"></a>Install requirements</h4><p><code>git clone https://github.com/open-mmlab/OpenPCDet.git</code> ä¸‹è½½é¡¹ç›®ï¼Œç„¶åå®‰è£…ç¯å¢ƒ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> -r requirements.txt <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ä¸‹è½½ requirements çš„æ—¶å€™å‘ç°è«åå…¶å¦™åœ°ä¸‹è½½äº†æœ€æ–°ç‰ˆçš„ torch==1.10.0 æ›¿æ¢äº†åŸæ¥çš„ torch==1.6.0ï¼Œ<code>requirements.txt</code> éƒ¨åˆ†å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">torch&gt;=1.1kornia<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸€èˆ¬æƒ…å†µä¸‹ pip æ˜¯ä¸ä¼šè‡ªåŠ¨æ›¿æ¢å·²ç»æ»¡è¶³è¦æ±‚çš„åŒ…çš„ï¼Œæˆ‘ä½¿ç”¨äº†å¦ä¸€ä¸ª docker ä¹Ÿæ²¡æœ‰å¤ç°å‡ºè¿™ä¸ªé”™è¯¯è¿‡ç¨‹ï¼Œæ‰€ä»¥å°±æš‚æ—¶ä¸è¦æ‹…å¿ƒè¿™ä¸ªæ“ä½œäº†ã€‚åœ¨ torch==1.10.0 çš„æƒ…å†µä¸‹è¿è¡Œ <code>setup.py</code> å¯èƒ½é‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼Œæ›´æ¢å¯¹åº”çš„ torch ç‰ˆæœ¬å°±å¥½</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">RuntimeError:The detected CUDA version <span class="token punctuation">(</span><span class="token number">10.1</span><span class="token punctuation">)</span> mismatches the version that was used to compilePyTorch <span class="token punctuation">(</span><span class="token number">10.2</span><span class="token punctuation">)</span>. Please <span class="token function">make</span> sure to use the same CUDA versions.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¹¶ä¸”ç”±äº kornia å¯¹äº Pytorch ä½ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼Œæ ¹æ® <a href="https://github.com/open-mmlab/OpenPCDet/issues/544">github issue</a> é€‰æ‹©ä¸‹è½½ <code>kornia==0.5</code> ç‰ˆæœ¬ï¼Œå¦‚æœä½ ä¸éœ€è¦ä½¿ç”¨ CaDNN ä¹Ÿå¯ä»¥é€‰æ‹©ä¸ä¸‹è½½ korniaã€‚ç°åœ¨é‡æ–°å®‰è£… torch==1.6.0 &amp; kornia==0.5</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> <span class="token assign-left variable">torch</span><span class="token operator">==</span><span class="token number">1.6</span>.0+cu101 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.7</span>.0+cu101 -f https://download.pytorch.org/whl/torch_stable.htmlpip <span class="token function">install</span> <span class="token assign-left variable">kornia</span><span class="token operator">==</span><span class="token number">0.5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Setup-py-1"><a href="#Setup-py-1" class="headerlink" title="Setup.py"></a>Setup.py</h4><p>è¿è¡Œ <code>setup.py</code> è¿›è¡Œç¼–è¯‘</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python setup.py develop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Install-mayavi"><a href="#Install-mayavi" class="headerlink" title="Install mayavi"></a>Install mayavi</h3><p>è¿™ä¸ªåº“æ˜¯ç”¨äºå¯è§†åŒ–çš„ï¼Œå…¶å®‰è£…ä¹Ÿæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹çš„ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š</p><ol><li><p><code>mayavi</code> æ˜¯éœ€è¦å›¾å½¢åŒ–ç•Œé¢ GUI çš„ï¼Œåˆ°äº†è¿™ä¸€æ­¥æˆ‘ä¸å¾—ä¸æƒ³åŠæ³•è®© docker èƒ½å¤Ÿè¿è¡Œ GUI appï¼Œè¿˜å¥½æ‰¾åˆ°äº†æ–¹æ³•ï¼Œå‚ç…§å‰æ–‡å³å¯å®Œæˆ</p></li><li><p>æ ¹æ® <a href="https://zhuanlan.zhihu.com/p/373668000">çŸ¥ä¹</a> ä¸‹è½½ <code>vtk==8.1.2</code>ï¼Œè‡ªåŠ¨å®‰è£…çš„ä¸º <code>vtk==9.0.x</code>ï¼Œ<a href="https://blog.csdn.net/weixin_43978293/article/details/118731248">æ®è¯´</a> åœ¨ python3.8 ç¯å¢ƒä¸­ä¼¼ä¹ä¼šå‡ºé—®é¢˜</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> <span class="token assign-left variable">vtk</span><span class="token operator">==</span><span class="token number">8.1</span>.2 <span class="token comment"># è‡ªåŠ¨å®‰è£…çš„vtkæ˜¯9ï¼Œä¼šäº§ç”Ÿå†²çª</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>è¿˜éœ€è¦ä¸‹è½½ <code>PyQt5</code> ä»¥è¿›è¡Œå¯è§†åŒ–</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> PyQt5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹‹åé‡åˆ°äº†ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„æŠ¥é”™ï¼Œä¹Ÿæ˜¯å›°æ‰°æˆ‘å¾ˆä¹…ï¼Œ<a href="https://www.jianshu.com/p/b51008566134">åšå®¢</a> è§£é‡Šæ˜¯å°‘äº†ä¸€äº›ä¾èµ–åº“ï¼Œå¯èƒ½æ˜¯å› ä¸º docker æ˜¯ä¸€ä¸ªç²¾ç®€çš„ ubuntuï¼Œæ²¡æœ‰å®Œæ•´çš„ä¾èµ–åº“</p><p>é€šè¿‡ <code>apt install python3-pyqt5</code> ä¸‹è½½äº†å…¶ç›¸å…³çš„ä¾èµ–åº“ </p></li></ol><p>é€šè¿‡ä¸æ–­åœ°å°è¯•ä¸æ–­åœ°æŠ˜è…¾å¯ç®—æ˜¯å®‰è£…å¥½äº†ğŸ˜€å…ˆæ¥è¿›è¡Œæµ‹è¯•å§ï¼</p><h2 id="Demo-on-OpenPCDet"><a href="#Demo-on-OpenPCDet" class="headerlink" title="Demo on OpenPCDet"></a>Demo on OpenPCDet</h2><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>å…ˆå°†åŸæ¥çš„ KITTI æ•°æ®é›†æ”¾åˆ° data ç›®å½•ä¸‹ï¼Œå·²ç»ä½¿ç”¨ MMDetection3d ç”Ÿæˆäº†åŸºæœ¬æ•°æ®ï¼Œä½† OpenPCDet æš‚æ—¶è¿˜ä¸éœ€è¦ç”Ÿæˆï¼ŒDemo åªéœ€è¦åŸå§‹æ•°æ®é›†å°±å¯ä»¥äº†ã€‚å‡†å¤‡å¥½æ¨¡å‹å’Œæ•°æ®é›†åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ SECOND</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">import</span> osCONFIG_FILE <span class="token operator">=</span> <span class="token string">'/OpenPCDet/tools/cfgs/kitti_models/second.yaml'</span>CKPT <span class="token operator">=</span> <span class="token string">'/OpenPCDet/checkpoints/second_7862.pth'</span>POINT_CLOUD_DATA <span class="token operator">=</span> <span class="token string">'/OpenPCDet/data/kitti/training/velodyne/000007.bin'</span>os.system<span class="token punctuation">(</span>f<span class="token string">'python demo.py --cfg_file {CONFIG_FILE} \    --ckpt {CKPT} \    --data_path {POINT_CLOUD_DATA}'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œ <code>Demo.py</code> åè·å¾—äº†å¦‚ä¸‹é¢„æµ‹ç»“æœï¼Œçœ‹ä¸Šå»è¿˜æŒºä¸é”™çš„</p><p><img src="/archives/93e5b117/image-20211102173223643.png" style="zoom:80%;"></p><h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><p>ç›´æ¥æµ‹è¯• SECOND åœ¨ KITTI éªŒè¯é›†ä¸Šçš„ç»“æœï¼Œåˆ—å‡º Car ç›¸å…³çš„éƒ¨åˆ†</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Car AP@0.70, <span class="token number">0.70</span>, <span class="token number">0.70</span>:bbox AP:90.7803, <span class="token number">89.8999</span>, <span class="token number">89.0433</span>bev  AP:90.0097, <span class="token number">87.9282</span>, <span class="token number">86.4528</span>3d   AP:88.6137, <span class="token number">78.6245</span>, <span class="token number">77.2243</span>aos  AP:90.76, <span class="token number">89.77</span>, <span class="token number">88.82</span>Car AP_R40@0.70, <span class="token number">0.70</span>, <span class="token number">0.70</span>:bbox AP:95.6261, <span class="token number">94.1728</span>, <span class="token number">91.7683</span>bev  AP:92.4184, <span class="token number">88.5586</span>, <span class="token number">87.6479</span>3d   AP:88.6137, <span class="token number">78.6245</span>, <span class="token number">77.2243</span>aos  AP:95.59, <span class="token number">94.01</span>, <span class="token number">91.52</span>Car AP@0.70, <span class="token number">0.50</span>, <span class="token number">0.50</span>:bbox AP:90.7803, <span class="token number">89.8999</span>, <span class="token number">89.0433</span>bev  AP:90.7940, <span class="token number">90.1441</span>, <span class="token number">89.5173</span>3d   AP:90.7940, <span class="token number">90.0886</span>, <span class="token number">89.4014</span>aos  AP:90.76, <span class="token number">89.77</span>, <span class="token number">88.82</span>Car AP_R40@0.70, <span class="token number">0.50</span>, <span class="token number">0.50</span>:bbox AP:95.6261, <span class="token number">94.1728</span>, <span class="token number">91.7683</span>bev  AP:95.6751, <span class="token number">94.8476</span>, <span class="token number">94.2478</span>3d   AP:95.6623, <span class="token number">94.7450</span>, <span class="token number">94.0537</span>aos  AP:95.59, <span class="token number">94.01</span>, <span class="token number">91.52</span><span class="token punctuation">..</span>.<span class="token number">2021</span>-11-01 <span class="token number">11</span>:48:15,756   INFO  Result is save to /OpenPCDet/output/OpenPCDet/tools/cfgs/kitti_models/second/default/eval/epoch_7862/val/default<span class="token number">2021</span>-11-01 <span class="token number">11</span>:48:15,756   INFO  ****************Evaluation done.*****************<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ MMDetection3D çš„ç»“æœè¿›è¡Œå¯¹æ¯”ï¼Œæ•´ä½“ä¸Šæ¥çœ‹è¿˜æ˜¯ç›¸è¿‘çš„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># OpenPCDet</span>Car AP@0.50, <span class="token number">0.70</span>3d   AP:90.7940, <span class="token number">90.0886</span>, <span class="token number">89.4014</span>3d   AP:88.6137, <span class="token number">78.6245</span>, <span class="token number">77.2243</span>Car AP_R40@0.50, <span class="token number">0.70</span>3d   AP:95.6623, <span class="token number">94.7450</span>, <span class="token number">94.0537</span>3d   AP:88.6137, <span class="token number">78.6245</span>, <span class="token number">77.2243</span><span class="token comment"># MMDetection3d</span>Car AP@0.50, <span class="token number">0.70</span>3d   AP:98.3329, <span class="token number">90.0209</span>, <span class="token number">89.4035</span>3d   AP:87.4561, <span class="token number">76.7570</span>, <span class="token number">74.1302</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Train"><a href="#Train" class="headerlink" title="Train"></a>Train</h3><p>æŸ¥çœ‹ä¸€ä¸‹ SECOND è®­ç»ƒçš„åŸºæœ¬æƒ…å†µï¼Œè¿™é‡Œæ”¹äº†ä¸€ä¸ªé…ç½®ï¼šUSE_ROAD_PLANE: False</p><p><img src="/archives/93e5b117/image-20211102184034692.png"></p><p>è®­ç»ƒé€Ÿåº¦è¿˜æ˜¯ä¸é”™çš„ï¼Œæ­¤æ—¶çš„ batch size per GPU = 4 æ¯” MMDetection3D æ•ˆç‡æ›´é«˜ï¼Œä¸‹é¢æ˜¯ GPU ä½¿ç”¨æƒ…å†µ</p><p><img src="/archives/93e5b117/image-20211102184056522.png"></p><h2 id="CenterPoint-on-MMDetection3D"><a href="#CenterPoint-on-MMDetection3D" class="headerlink" title="CenterPoint on MMDetection3D"></a>CenterPoint on MMDetection3D</h2><p>ç°åœ¨å°è¯•ä¸€ä¸‹ç”¨ MMDetection3D è¿è¡Œ CenterPointï¼Œæƒ³è¦çœ‹ä¸€çœ‹ KITTI æ•°æ®é›†çš„ç»“æœï¼Œæ¯•ç«ŸåŸè®ºæ–‡ä¸­æ²¡æœ‰åœ¨ KITTI ä¸Šè¿›è¡Œæµ‹è¯•ã€‚æœ‰äººåœ¨ <a href="https://github.com/open-mmlab/mmdetection3d/issues/871">github issue</a> ä¹Ÿè¿›è¡Œäº†ä¸€äº›å°è¯•ï¼ŒåŸæ–‡ä½œè€…ä¹Ÿæœ‰é¡¹ç›® <a href="https://github.com/tianweiy/CenterPoint-KITTI">CenterPoint-KITTI</a>ï¼Œä»å®éªŒç»“æœæ¥çœ‹ï¼Œå•é˜¶æ®µä¸ SECOND æ•ˆæœå·®ä¸å¤šï¼Œå¹¶æ²¡æœ‰éå¸¸äº®çœ¼çš„è¡¨ç°ï¼Œå¯èƒ½è¿˜éœ€è¦è¿›ä¸€æ­¥çš„å¾®è°ƒ</p><p>å°è¯•åœ¨ MMDetection3D ä¸Šç®€å•è¿è¡Œä¸€ä¸‹ï¼Œç„¶è€Œä¼¼ä¹æ˜¯æ˜¾å­˜ä¸å¤Ÿçš„åŸå› ï¼Œæ²¡èƒ½å¤Ÿè·‘èµ·æ¥ï¼Œåç»­å†è¿›ä¸€æ­¥ç ”ç©¶å§</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MMDetection3D </tag>
            
            <tag> OpenPCDet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Voxel R-CNN</title>
      <link href="/archives/de63c30e.html"/>
      <url>/archives/de63c30e.html</url>
      
        <content type="html"><![CDATA[<h1 id="Voxel-R-CNN"><a href="#Voxel-R-CNN" class="headerlink" title="Voxel R-CNN"></a>Voxel R-CNN</h1><hr><p>Deng, Jiajun, Shaoshuai Shi, Peiwei Li, Wengang Zhou, Yanyong Zhang, and Houqiang Li. â€œVoxel R-CNN: Towards High Performance Voxel-Based 3D Object Detection.â€ <em>ArXiv:2012.15712 [Cs]</em>, February 5, 2021. <a href="http://arxiv.org/abs/2012.15712">http://arxiv.org/abs/2012.15712</a>.</p><p>Comment: AAAI2021</p><hr><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>è¿™ç¯‡è®ºæ–‡æ˜¯ PV-RCNN çš„ä¸€ä¸ªåç»­ç ”ç©¶ï¼Œä¸ºäº†è§£å†³ PV-RCNN ä¸­çš„æ¨ç†é€Ÿåº¦é—®é¢˜ï¼Œåœ¨æ”¹è¿›ä¹‹åé€Ÿåº¦èƒ½å¤Ÿè¾¾åˆ° 25 fps çš„å®æ—¶æ¨ç†é€Ÿåº¦ï¼ˆon NVIDIA 2080 Tiï¼‰ï¼Œç›¸æ¯”äºå‰ä½œçš„ 8.9 fpsï¼ˆè®ºæ–‡æä¾›æ•°æ®ï¼‰æå‡äº†æ¥è¿‘2å€ã€‚åŒæ—¶åœ¨å‡†åº¦ä¸Šä¹Ÿè¶…è¶Šäº†å‰ä½œï¼Œè™½ç„¶è¶…è¶Šå¾—ä¸å¤šï¼Œä½†æ˜¯æœ¬è®ºæ–‡çš„æ•´ä¸ªæ¡†æ¶éå¸¸å¹²å‡€ï¼Œå‡ ä¹æ²¡æœ‰ä½¿ç”¨ä»»ä½•å…¶ä»–çš„æŠ€å·§ï¼Œåç»­æå‡ç©ºé—´éå¸¸å¤§</p><p>è®¸å¤šç°æœ‰çš„é«˜æ€§èƒ½ 3D æ¢æµ‹å™¨éƒ½æ˜¯åŸºäºç‚¹ point-basedï¼Œå› ä¸ºè¿™ç§ç»“æ„å¯ä»¥æ›´å¥½åœ°ä¿ç•™ç²¾ç¡®çš„ç©ºé—´ä¿¡æ¯ã€‚ç„¶è€Œç”±äºæ— åºå­˜å‚¨ï¼Œpoint-wise ç‰¹å¾ä¼šå¯¼è‡´é«˜è®¡ç®—å¼€é”€ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒåŸºäºä½“ç´  voxel-based çš„ç»“æ„æ›´é€‚åˆäºç‰¹å¾æå–ï¼Œä½†æ˜¯å‡†ç¡®åº¦ä¸é«˜ã€‚<strong>è€Œè¿™ç¯‡è®ºæ–‡å°±æ‰“ç ´äº†è¿™ä¸ªè§‚å¿µâ€”â€”å³ä½¿æ˜¯ç²—ç²’åº¦çš„ä½“ç´ å—ä¹Ÿèƒ½å¾ˆå¥½åœ°æä¾›ç©ºé—´ä¿¡æ¯ï¼Œç²¾ç¡®çš„ç‚¹äº‘ä¿¡æ¯å¹¶ä¸æ˜¯é«˜æ€§èƒ½çš„å…³é”®ç‚¹</strong>ã€‚ä¹‹å‰ voxel-based æ–¹æ³•ä¹‹æ‰€ä»¥æ•ˆæœä¸ä½³ï¼Œæ˜¯å› ä¸ºå°†ä¸‰ç»´ä½“ç´ ç‰¹å¾å›¾è°± 3D voxel feature map é‡å¡‘ä¸º 2D BEV feature map è¿‡åä¸å†åˆ©ç”¨åŸæ¥çš„ä¸‰ç»´ä½“ç´ ç‰¹å¾äº†ï¼Œè€Œé‡å¡‘çš„è¿‡ç¨‹ä¸­å°±æŸå¤±äº†ç©ºé—´ä¿¡æ¯</p><p>è®ºæ–‡çš„æ ¸å¿ƒé‡ç‚¹ä¸ºä½¿ç”¨äº† voxel RoI pooling æ“ä½œï¼Œé€šè¿‡æå– RoI ä¸­çš„ç‰¹å¾å¯¹é€‰æ¡†è¿›è¡Œç»†åŒ–ï¼Œå…¶ä¸­ RoI ç‰¹å¾æ¥æºäº backbone ä¸­æå–çš„ 3D featureï¼ˆè¿™é‡Œæˆ‘å«å®ƒä½“ç´ åŒ–ç‰¹å¾ voxel-wise featureï¼‰ï¼Œè€Œé PV-RCNN ä¸­çš„ç‚¹ç±»ç‰¹å¾ point-wise featureã€‚å»é™¤äº†è®¡ç®—é‡åºå¤§çš„ç‚¹ç±»ç‰¹å¾æå–ï¼Œä½¿å¾— Voxel R-CNN æ¨ç†é€Ÿåº¦å¤§å¤§å¢åŠ ï¼ŒåŒæ—¶ä¿æŒäº†ä¼˜å¼‚çš„å‡†ç¡®ç‡</p><h2 id="Voxel-R-CNN-Architecture"><a href="#Voxel-R-CNN-Architecture" class="headerlink" title="Voxel R-CNN Architecture"></a>Voxel R-CNN Architecture</h2><p><img src="/archives/de63c30e/image-20211019154543934.png"></p><p>å¯ä»¥è¯´è¿™ä¸ªç¤ºæ„å›¾å±•ç¤ºå‡ºæ¥çš„ç»“æ„éå¸¸å¹²å‡€ï¼Œæ²¡æœ‰å¤šä½™çš„æŠ€å·§ï¼Œå°±æ˜¯ RCNN æ¡†æ¶çš„ä¸‰éƒ¨æ›²ï¼š</p><ol><li>3D backboneç‰¹å¾æå–</li><li>RPN æå‡ºé€‰æ¡†</li><li>2-Stage ç»†åŒ–é€‰æ¡†</li></ol><h3 id="3D-backbone-amp-RPN"><a href="#3D-backbone-amp-RPN" class="headerlink" title="3D backbone &amp; RPN"></a>3D backbone &amp; RPN</h3><p>ç›´æ¥ä½¿ç”¨ SECOND ä½œä¸ºå…¶ backbone ç½‘ç»œæå–ç‰¹å¾ï¼Œå°†å¾—åˆ°çš„ 3D ç‰¹å¾æ²¿ Z è½´è¿›è¡Œå †å ï¼Œé‡å¡‘ä¸º 2D ä¿¯è§†ç‰¹å¾å›¾è°± BEV feature map ä½œä¸º RPN çš„è¾“å…¥ã€‚è®ºæ–‡åœ¨ç¬¬ä¸‰èŠ‚å°±è¿™æ ·ä¸€å¥å¸¦è¿‡ 3D backboneï¼Œè¯¥ backbone æœ‰4ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µçš„é¢‘é“æ•°åˆ†åˆ«ä¸º 16, 32, 48, 64</p><p>RPN è®¾è®¡ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p><ol><li>top-down ç‰¹å¾æå–ç½‘ç»œï¼Œä½¿ç”¨2ä¸ªå·ç§¯å—</li><li>å¯¹å°ºåº¦ç‰¹å¾èåˆç»“æ„ï¼Œå°†ä¸åŒåˆ†è¾¨ç‡çš„ç‰¹å¾å›¾è°±è¿›è¡Œä¸Šé‡‡æ ·å¹¶è¿æ¥èµ·æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„ç‰¹å¾å›¾è°±</li></ol><p>æœ€åæ—¶å€™è¯¥ç‰¹å¾å›¾è°±å»åšåˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡ï¼Œè¿™éƒ¨åˆ†ä¸ VoxelNet ä¸­çš„ RPN ç»“æ„ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œè¿™é‡Œè´´ä¸€ä¸‹ VoxelNet ä¸­ RPN çš„ç¤ºæ„å›¾</p><p><img src="/archives/de63c30e/image-20211019161506601.png" style="zoom: 67%;"></p><p>æŸå¤±å‡½æ•°ä½¿ç”¨ focal loss å’Œ Huber lossï¼Œæ•°å­¦è¡¨ç¤ºå¦‚ä¸‹</p><script type="math/tex; mode=display">\mathcal{L}_{\mathrm{RPN}}=\frac{1}{N_{\mathrm{fg}}}\left[\sum_{i} \mathcal{L}_{\text {cls }}\left(p_{i}^{a}, c_{i}^{*}\right)+\mathbb{1}\left(c_{i}^{*} \geq 1\right) \sum_{i} \mathcal{L}_{\text {reg }}\left(\delta_{i}^{a}, t_{i}^{*}\right)\right]</script><p>å…¶ä¸­ Huber loss ä¸é€šå¸¸ä½¿ç”¨çš„ smooth L1 loss ä¸åŒï¼Œç›®çš„æ˜¯ä¸ºäº†å‡å°å¥‡å¼‚ç‚¹çš„æŸå¤±ï¼Œå…¶å…·ä½“å…¬å¼å¦‚ä¸‹</p><script type="math/tex; mode=display">L_{\delta}(y, f(x))=\left\{\begin{array}{ll}\frac{1}{2}(y-f(x))^{2}, & \text { for }|y-f(x)| \leq \delta \\\delta \cdot\left(|y-f(x)|-\frac{1}{2} \delta\right), & \text { otherwise. }\end{array}\right.</script><p><img src="/archives/de63c30e/1182370-20180928094214405-164664611.gif" style="zoom:50%;"></p><h3 id="Voxel-RoI-pooling"><a href="#Voxel-RoI-pooling" class="headerlink" title="Voxel RoI pooling"></a>Voxel RoI pooling</h3><p>æ¥ä¸‹æ¥å°±æ˜¯è®ºæ–‡æ ¸å¿ƒæ“ä½œäº†ï¼Œå³å¦‚ä½•å¯¹æå–å‡ºçš„ä½“ç´ åŒ–ç‰¹å¾ voxel-wise feature è¿›è¡Œ RoI pooling</p><h4 id="Voxel-volumes-as-points"><a href="#Voxel-volumes-as-points" class="headerlink" title="Voxel volumes as points"></a>Voxel volumes as points</h4><p>å°†æ¯ä¸€ä¸ªä½“ç´ å— voxel volume è§†ä½œä¸ºä¸€ä¸ªç‚¹ï¼Œè¯¥ç‚¹çš„åæ ‡ä¸ºä½“ç´ ä¸­å¿ƒçš„åæ ‡</p><script type="math/tex; mode=display">\{v_i=x_i,y_i,z_i\}_{i=1}^N\\\{\phi_i\}_{i=1}^N</script><p>å…¶ä¸­ $\phi_i$ è¡¨ç¤ºè¯¥ä½“ç´ çš„ç‰¹å¾</p><h4 id="Voxel-query"><a href="#Voxel-query" class="headerlink" title="Voxel query"></a>Voxel query</h4><p>è¯¥æ“ä½œä¸ºå¯»æ‰¾æŸä¸ªä½“ç´ é™„è¿‘çš„éç©ºä½“ç´ ã€‚ç”±äºä½“ç´ çš„è§„èŒƒè¡¨è¾¾ï¼Œä¸¤ä¸ªä½“ç´ ä¹‹é—´çš„ä½ç½®å¯ä»¥ç”±ä»–ä»¬çš„åæ ‡ index è¿…é€Ÿè®¡ç®—ï¼Œè®ºæ–‡é‡‡ç”¨æ›¼å“ˆé¡¿è·ç¦» Manhattan distance è¡¨ç¤ºä¸¤ä¸ªä½“ç´  $\alpha,\beta$ çš„è·ç¦»</p><script type="math/tex; mode=display">\alpha = (i_\alpha, j_\alpha, k_\alpha),\ \beta = (i_\beta, j_\beta, k_\beta)\\D_{m}(\alpha, \beta)=\left|i_{\alpha}-i_{\beta}\right|+\left|j_{\alpha}-j_{\beta}\right|+\left|k_{\alpha}-k_{\beta}\right|</script><p>è®ºæ–‡ä½¿ç”¨çƒæœç´¢ ball query æ¥å¯»æ‰¾é™„è¿‘çš„ä½“ç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(K)$ï¼Œå…¶ä¸­ $K$ æ˜¯ï¼ˆæœ€å¤§ï¼‰é‚»å±…æ•°ã€‚ä½†è¿™ä¸ª ball query ç®—æ³•å…·ä½“æ€ä¹ˆå®ç°çš„æš‚æ—¶è¿˜ä¸ç†è§£â€¦ç»™è‡ªå·±ç•™ä¸ªå‘å§ï¼Œä»¥åè¡¥æœºå™¨å­¦ä¹ å’Œæ•°æ®ç»“æ„çš„æ—¶å€™çœ‹èƒ½ä¸èƒ½å¡«ä¸Šï¼</p><p><img src="/archives/de63c30e/image-20211019170427837.png" style="zoom: 50%;"></p><h4 id="Voxel-RoI-pooling-1"><a href="#Voxel-RoI-pooling-1" class="headerlink" title="Voxel RoI pooling"></a>Voxel RoI pooling</h4><p>é¦–å…ˆå°†æè®®é€‰æ¡† proposal å¹³å‡åˆ†æˆ $G\times G\times G$ ä¸ªå­ä½“ç´ å—ï¼Œå°†å­ä½“ç´ å—çš„ä¸­å¿ƒç‚¹ä½œä¸ºé‡‡æ ·æ …æ ¼ç‚¹ $g_i$ï¼Œç”¨äºè¿›ä¸€æ­¥èšé›†ä½“ç´ ç‰¹å¾ã€‚å¯¹äºæ¯ä¸€ä¸ªé‡‡æ ·æ …æ ¼ç‚¹ï¼Œä½¿ç”¨ voxel queryï¼Œå¾—åˆ°å…¶é‚»å±…é›†åˆ $\Gamma_i = \{v_i^1,â€¦,v_i^K\}$ ç„¶åä½¿ç”¨ PointNet æ¨¡å—è¿›è¡Œç‰¹å¾æå–</p><script type="math/tex; mode=display">\boldsymbol{\eta}_{i}=\max _{k=1,2, \cdots, K}\left\{\Psi\left(\left[\boldsymbol{v}_{i}^{k}-\boldsymbol{g}_{i} ; \boldsymbol{\phi}_{i}^{k}\right]\right)\right\}</script><p>åœ¨çœŸæ­£å®æ–½è¯¥ pooling æ“ä½œæ—¶ï¼Œå…¶ pooling å¯¹è±¡å…¶å®ä¸æ˜¯åˆå§‹çš„ä½“ç´ åŒ–ç‚¹äº‘ï¼Œè€Œæ˜¯ 3D backbone ä¸­æœ€åä¸¤ä¸ªé˜¶æ®µçš„ 3D voxel-wise featureã€‚å¹¶ä¸”å¯¹äºæ¯ä¸ªé˜¶æ®µï¼Œè®¾ç½®äº†å¤šä¸ªæ›¼å“ˆé¡¿è·ç¦»é˜ˆå€¼ä»¥è¿›è¡Œå¯¹å°ºåº¦èšé›† groupingï¼Œæœ€åå°†ä¸åŒé˜¶æ®µä¸åŒå°ºåº¦çš„èšé›†ç‰¹å¾è¿›è¡Œè¿æ¥å¾—åˆ°æœ€ç»ˆçš„ç‰¹å¾é›†</p><h4 id="Accelerated-local-aggregation"><a href="#Accelerated-local-aggregation" class="headerlink" title="Accelerated local aggregation"></a>Accelerated local aggregation</h4><p>è®ºæ–‡ä½¿ç”¨äº†åŠ é€Ÿç‰ˆæœ¬çš„ PointNetï¼ŒåŒºåˆ«ä¸åŸå§‹ç‰ˆæœ¬å…ˆåšé‚»å±…æœç´¢å†è¿›è¡Œç‰¹å¾æå–ï¼ŒåŠ é€Ÿç‰ˆæœ¬çš„ PointNet å°†ä½“ç´ å—çš„ä½ç½® $(x,y,z)$ å’Œç‰¹å¾ feature è¿›è¡Œåˆ†åˆ«å¤„ç†ï¼Œå›¾ç¤ºå¦‚ä¸‹</p><p><img src="/archives/de63c30e/image-20211019171951879.png" style="zoom:80%;"></p><p>å¦‚æœæŒ‰ç…§ PV-RCNN ä¸­çš„æ–¹æ³•è¿›è¡Œç‚¹äº‘ç‰¹å¾èšåˆï¼Œåˆ™è¦å…ˆå¯»æ‰¾é™„è¿‘çš„ç‚¹ groupingï¼Œç„¶åå†å¯¹é™„è¿‘çš„ç‚¹ä½¿ç”¨ MLP åšç‰¹å¾æå–ï¼Œè¿™ä¸€è¿‡ç¨‹çš„å¤æ‚åº¦ä¸º $(O(M Ã— K Ã— (C + 3) Ã— Câ€™ ))$ï¼Œå…¶ä¸­ $M=r\times G^3$ ä¸ºæ ¼ç‚¹æ•° grid pointsï¼Œ$r$ ä¸º RoI æ•°é‡ï¼Œ$K$ ä¸ºï¼ˆæœ€å¤§ï¼‰é‚»å±…æ•°ï¼Œ$C+3$ ä¸ºè¾“å…¥ç‰¹å¾ç»´æ•°ï¼Œ$Câ€™$ ä¸ºè¾“å‡ºç‰¹å¾ç»´æ•°</p><p>è€Œè®ºæ–‡å°†ç›¸å¯¹åæ ‡ä¸ä½“ç´ ç‰¹å¾åˆ†ç¦»ã€‚ç»™å®šæƒé‡ä¸º$ W âˆˆ \mathbb R^{Câ€™ ,C+3}$ çš„å…¨è¿æ¥å±‚ï¼Œè®ºæ–‡å°†å…¶åˆ†ä¸º $ W_F âˆˆ \mathbb R^{Câ€™ ,C}$  å’Œ  $ W_C âˆˆ \mathbb R^{Câ€™ ,3}$ã€‚ç”±äºä½“ç´ ç‰¹å¾ä¸ç½‘æ ¼ç‚¹æ— å…³ï¼Œå› æ­¤åœ¨æ‰§è¡Œ voxel query æœç´¢ä¹‹å‰ï¼Œç›´æ¥åœ¨ä½“ç´ ç‰¹å¾ä¸Šåº”ç”¨äº†æƒé‡ä¸º $W_F$ çš„å…¨è¿æ¥å±‚ã€‚ç„¶åï¼Œåœ¨ voxel query ä¹‹åï¼Œæˆ‘ä»¬åªå°†åˆ†ç»„çš„ç›¸å¯¹åæ ‡ä¹˜ä»¥ $W_C$ï¼Œå¾—åˆ°ç›¸å¯¹ä½ç½®ç‰¹å¾ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°åˆ†ç»„çš„ä½“ç´ ç‰¹å¾ä¸­</p><p>åŠ é€Ÿ PointNet æ¨¡å—çš„ FLOP ä¸º $O(N Ã—C Ã—Câ€™ +M Ã—K Ã— 3Ã—Câ€™)$ï¼Œç”±äºåˆ†ç»„ä½“ç´ çš„æ•°é‡ $M Ã—K$ æ¯” $N$ é«˜ä¸€ä¸ªæ•°é‡çº§ï¼Œå› æ­¤åŠ é€Ÿçš„ PointNet æ¨¡å—æ¯”åŸå§‹æ¨¡å—æ›´é«˜æ•ˆã€‚æ›´ç›´è§‚åœ°æ¥è®²ï¼Œè¿™æ ·å‡å°‘äº†å¾ˆå¤šç”±äºé‡å çš„é‚»å±…äº§ç”Ÿçš„ç‰¹å¾æå–æ“ä½œ</p><p>è¿™éƒ¨åˆ†å†…å®¹å¼•èµ·äº†æˆ‘å¯¹äº FC/MLP ä½œç”¨çš„æ€è€ƒï¼šMLP å°†åŸå§‹ç‰¹å¾é€šè¿‡<strong>ç®€å•çš„</strong>éçº¿æ€§å˜æ¢æ˜ å°„åˆ°æ–°çš„ç‰¹å¾ç©ºé—´ä¸­ï¼Œå…¶ä¸­ä¼´éšçš„ç»´åº¦å˜æ¢æ˜¯æœ€ç›´è§‚çš„ä½“ç°ã€‚ä»¥ä¸Šæ–¹æ³•åšç‰¹å¾èšé›†ç«Ÿç„¶å¯ä»¥å°†è¾“å…¥åˆ†å¼€æ¥çœ‹å¾…ï¼Œè¿™æ ·åšç«Ÿç„¶ä¸ä¼šå½±å“è¡¨ç°ï¼Œé‚£ä¸ºä»€ä¹ˆä¸å¯¹ç›¸å¯¹åæ ‡ä¹Ÿé‡‡ç”¨åŒæ ·çš„æ“ä½œï¼Œè¿™æ ·å¤æ‚åº¦ä¸º $O(N Ã—(C+3) Ã—Câ€™)$ ä¼šå˜å¾—æ›´å°</p><h3 id="Detection-head"><a href="#Detection-head" class="headerlink" title="Detection head"></a>Detection head</h3><p>ç»è¿‡ voxel RoI pooling è¿‡åæ¯ä¸€ä¸ªé€‰æ¡†éƒ½æœ‰å¯¹åº”çš„ç‰¹å¾å‘é‡é›†æ¥è¡¨ç¤ºï¼Œæ¥ä¸‹æ¥å°±ä½¿ç”¨è¿™äº›ç‰¹å¾å¯¹é€‰æ¡†è¿›è¡Œç»†åŒ–ã€‚å…·ä½“æ¥è®²ï¼Œä½¿ç”¨ä¸€ä¸ª shared 2-layer MLP å°† RoI ç‰¹å¾è¿›ä¸€æ­¥åšç‰¹å¾æå–ï¼Œå°†è¿™äº›ç‰¹å¾ç”¨äºç½®ä¿¡åº¦é¢„æµ‹å’Œå›å½’é¢„æµ‹ä¸¤ä¸ªä»»åŠ¡ã€‚å›å½’åˆ†æ”¯é¢„æµ‹ä» 3D é¢„æµ‹é€‰æ¡† proposals åˆ°çœŸå®æ¡†çš„æ®‹å·®ï¼Œç½®ä¿¡åº¦åˆ†æ”¯é¢„æµ‹ä¸ IoU ç›¸å…³çš„åˆ†æ•°ã€‚è¿™äº›éƒ½æ˜¯å¾ˆå¸¸è§„çš„æ“ä½œäº†ï¼Œä¸ PV-RCNN ä¸­æ˜¯ä¸€è‡´çš„ï¼Œä½¿ç”¨ binary cross entropy loss å’Œ smooth L1 lossï¼Œæ•°å­¦è¡¨ç¤ºå¦‚ä¸‹</p><script type="math/tex; mode=display">\begin{aligned}\mathcal{L}_{\text {head }}=& \frac{1}{N_{s}}\left[\sum_{i} \mathcal{L}_{\text {cls }}\left(p_{i}, l_{i}^{*}\left(\operatorname{IoU}_{i}\right)\right)\right.\\&\left.+\mathbb{1}\left(\operatorname{Io} U_{i} \geq \theta_{\text {reg }}\right) \sum_{i} \mathcal{L}_{\text {reg }}\left(\delta_{i}, t_{i}^{*}\right)\right]\end{aligned}</script><script type="math/tex; mode=display">l_{i}^{*}\left(\mathrm{IoU}_{i}\right)=\left\{\begin{array}{ll}0 & \mathrm{IoU}_{i}<\theta_{L} \\\frac{\mathrm{loU}_{i}-\theta_{L}}{\theta_{H}-\theta_{L}} & \theta_{L} \leq \mathrm{IoU}_{i}<\theta_{H} \\1 & \mathrm{IoU}_{i}>\theta_{H}\end{array}\right.</script><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><h3 id="SECOND-amp-PV-RCNN"><a href="#SECOND-amp-PV-RCNN" class="headerlink" title="SECOND &amp; PV-RCNN"></a>SECOND &amp; PV-RCNN</h3><p><img src="/archives/de63c30e/image-20211020194545864.png"></p><p>è®ºæ–‡å¯¹ SECOND å’Œ PV-RCNN è¿›è¡Œäº†å®éªŒï¼Œä¸¤å¼ å›¾åˆ†åˆ«è¯´æ˜äº†ï¼š</p><ol><li>2-Stage çš„ç»†åŒ–æ˜¯æœ‰æ•ˆæœçš„ï¼Œå‰ä½œ PV-RCNN çš„è¡¨ç°æ˜¯ç›¸å½“ä¸é”™çš„</li><li>PV-RCNN ä¸­èŠ±è´¹äº†å¤§é‡æ—¶é—´ï¼ˆè¶…è¿‡ä¸€èˆ¬ï¼‰ç”¨äº voxel set abstraction (VSA) æ“ä½œï¼Œé€ç‚¹æ“ä½œ point-wise operation è®¡ç®—é‡å¾ˆå¤§</li></ol><h3 id="KITTI"><a href="#KITTI" class="headerlink" title="KITTI"></a>KITTI</h3><p><img src="/archives/de63c30e/image-20211020195023758.png"></p><p>å¯¹æ ‡ SA-SSDï¼Œåœ¨å‡†åº¦å’Œé€Ÿåº¦ä¸Šå‡å®ç°äº†è¶…è¶Š</p><h3 id="Waymo"><a href="#Waymo" class="headerlink" title="Waymo"></a>Waymo</h3><p><img src="/archives/de63c30e/image-20211020195307759.png"></p><h3 id="Ablation-study"><a href="#Ablation-study" class="headerlink" title="Ablation study"></a>Ablation study</h3><p><img src="/archives/de63c30e/image-20211020200856394.png"></p><p>å…¶ä¸­ä¸ä½¿ç”¨ voxel query åˆ™ä½¿ç”¨ ball query æ›¿ä»£ï¼ŒåŒºåˆ«è¯·å‚è€ƒ voxel query ä¸€èŠ‚ Figure 3ã€‚å¯ä»¥çœ‹å‡º voxel query ç¨å¾®åŠ å¿«äº†é€Ÿåº¦ä¹Ÿç¨å¾®æå‡äº†å‡†ç¡®ç‡ï¼Œå¯¹äºé€Ÿåº¦æå‡æœ€å¤§çš„æ˜¯ accelerated PointNet æ“ä½œã€‚å¯¹äºå‡†åº¦æå‡æœ€å¤§çš„åˆ™æ˜¯ 2-Stage detection headï¼Œä½†åŒæ—¶ä¹Ÿè®©é€Ÿåº¦ä¸‹é™ä¸€åŠå¤š</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>è¿™ä¸€ç¯‡è®ºæ–‡çš„ä¸­å¿ƒæ€æƒ³å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯ç›´æ¥ä½¿ç”¨ voxel-wise feature å¯¹é¢„æµ‹é€‰æ¡†è¿›è¡Œç»†åŒ–ï¼Œç„¶ååŠ é€Ÿäº† PointNet ç‰¹å¾æå–æ“ä½œï¼ŒäºŒè€…çš„ç»“åˆå½¢æˆäº†æœ¬æ–‡çš„æ ¸å¿ƒ voxel RoI poolingã€‚Voxel R-CNN åœ¨é€Ÿåº¦å’Œå‡†åº¦ä¸Šå…¨é¢è¶…è¶Šäº†å‰ä½œ PV-RCNNï¼Œé‡ç‚¹åœ¨äºå…¶ç½‘ç»œç»“æ„éå¸¸å¹²å‡€ï¼Œæ²¡æœ‰ä½¿ç”¨è¿‡å¤šçš„è¾…åŠ©æŠ€å·§ï¼Œå¦‚æœå°†å…¶ä»–è®ºæ–‡ä¸­çš„æå‡æŠ€å·§ç»“åˆåˆ°æœ¬è®ºæ–‡ä¸­ï¼ˆä¾‹å¦‚è¯­ä¹‰åˆ†å‰²ï¼‰ï¼Œåº”è¯¥ä¼šæœ‰æ›´å¤šçš„æå‡ï¼ŒæœŸå¾…ä¹‹åçš„å‘å±•</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Voxel R-CNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker</title>
      <link href="/archives/f5f9fa9b.html"/>
      <url>/archives/f5f9fa9b.html</url>
      
        <content type="html"><![CDATA[<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><p>å¾ˆæ—©ä¹‹é—´å°±å¬è¯´ docker äº†ï¼Œæœ€è¿‘åœ¨ bilibili ä¸Šè¿˜çœ‹åˆ°äº†è¿™ä¹ˆä¸€ä¸ªè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV163411C7jE">ä¸ºä»€ä¹ˆæˆ‘ä¸ç”¨ Dockerï¼Ÿ</a> ç€å®æŠŠæˆ‘ç¬‘æ‹‰äº†ã€‚è€Œä¸”åœ¨çœ‹ MMDetection3D çš„æ—¶å€™å‘ç°å¯ä»¥é€šè¿‡ docker å®‰è£…ï¼Œé‚£ä¹ˆå°±å°è¯•ä¸€ä¸‹è¿™ä¸ªå·¥å…·å§ï¼ä¹Ÿè®¸åˆæ‰“å¼€äº†æ–°ä¸–ç•Œå¤§é—¨å‘¢ï¼Ÿæ›´å¤šå…³äºç§‘æ™®çš„çŸ¥è¯†å¯ä»¥çœ‹è¿™ç¯‡ <a href="https://zhuanlan.zhihu.com/p/187505981">çŸ¥ä¹</a>ï¼Œè¿™é‡Œå¼•ç”¨å…¶ä¸­ä¸€å¥è¯</p><blockquote><p>dockeræ˜¯ä¸€ä¸ªç”¨Goè¯­è¨€å®ç°çš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼Œdockerå°†ç¨‹åºä»¥åŠç¨‹åºæ‰€æœ‰çš„ä¾èµ–éƒ½æ‰“åŒ…åˆ°docker containerï¼Œè¿™æ ·ä½ çš„ç¨‹åºå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒéƒ½ä¼šæœ‰ä¸€è‡´çš„è¡¨ç°ï¼Œè¿™é‡Œç¨‹åºè¿è¡Œçš„ä¾èµ–ä¹Ÿå°±æ˜¯å®¹å™¨å°±å¥½æ¯”é›†è£…ç®±ï¼Œå®¹å™¨æ‰€å¤„çš„æ“ä½œç³»ç»Ÿç¯å¢ƒå°±å¥½æ¯”è´§èˆ¹æˆ–æ¸¯å£ï¼Œ<strong>ç¨‹åºçš„è¡¨ç°åªå’Œé›†è£…ç®±æœ‰å…³ç³»(å®¹å™¨)ï¼Œå’Œé›†è£…ç®±æ”¾åœ¨å“ªä¸ªè´§èˆ¹æˆ–è€…å“ªä¸ªæ¸¯å£(æ“ä½œç³»ç»Ÿ)æ²¡æœ‰å…³ç³»</strong>ã€‚</p></blockquote><p>æ•´ä¸ªç¬”è®°å‚è€ƒ <a href="https://www.bilibili.com/video/BV1og4y1q7M4">ç‹‚ç¥è¯´ Docker</a>ï¼Œæ‰“ç®—æ•´ç†ä¸€äº›åŸºæœ¬é€»è¾‘å’Œå‘½ä»¤ï¼Œæ–¹ä¾¿ä¹‹åå¤ä¹ ä¸æŸ¥çœ‹</p><p>Link: <a href="https://dockerlabs.collabnix.com/docker/cheatsheet/">Docker Cheat Sheet</a></p><h2 id="å®‰è£…-Docker"><a href="#å®‰è£…-Docker" class="headerlink" title="å®‰è£… Docker"></a>å®‰è£… Docker</h2><p>è¿™ä¸€æ­¥å°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥ä¸Š <a href="https://www.docker.com/">å®˜ç½‘</a> ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ä¸Šé¢æåˆ°çš„è§†é¢‘æ•™ç¨‹è¿›è¡Œä¸‹è½½ã€‚å¦‚æœä¸‹è½½å¾ˆæ…¢çš„è¯ä¾æ—§è€ƒè™‘é•œåƒå®‰è£…ï¼Œè¿™é‡Œè´´ä¸€ä¸ªè‡ªå®¶é•œåƒå…³äº docker çš„å¸®åŠ©æ–‡æ¡£ï¼š<a href="https://mirror.nju.edu.cn/help/docker-ce">NJU Mirror</a>ï¼ŒåŒæ—¶å®˜æ–¹ä¹Ÿæä¾›äº†å¸è½½ docker çš„æ“ä½œï¼Œå¯ä»¥æ”¾å¿ƒä¸‹è½½äº†ï¼ç°åœ¨æˆ‘æ˜¯åœ¨ windows ä¸Šç†Ÿæ‚‰ docker æ“ä½œï¼Œç›´æ¥å‚»ç“œå¼ä¸‹è½½äº† docker desktop</p><h2 id="Docker-åŸºæœ¬ç»„æˆ"><a href="#Docker-åŸºæœ¬ç»„æˆ" class="headerlink" title="Docker åŸºæœ¬ç»„æˆ"></a>Docker åŸºæœ¬ç»„æˆ</h2><ol><li><p>é•œåƒï¼ˆimageï¼‰</p><blockquote><p>When running a container, it uses an isolated filesystem. This custom filesystem is provided by a <strong>container image</strong>. Since the image contains the containerâ€™s filesystem, it must contain everything needed to run an application - all dependencies, configuration, scripts, binaries, etc. The image also contains other configuration for the container, such as environment variables, a default command to run, and other metadata.</p></blockquote></li><li><p>å®¹å™¨ï¼ˆcontainerï¼‰</p><blockquote><p>A container is a sandboxed process on your machine that is isolated from all other processes on the host machine. </p></blockquote><p>ä¸€ç§å½¢è±¡çš„è¯´æ³•æ—¶ï¼Œé•œåƒæ˜¯ç±» classï¼Œå®¹å™¨æ˜¯ç±»çš„å®ä¾‹ object</p></li><li><p>ä»“åº“ï¼ˆrepositoryï¼‰</p><p>å°±åƒ github ä¸€æ ·ï¼Œä»“åº“ dockerhub å¯ä»¥å­˜æ”¾å„ç§å¼€æºé•œåƒä»¥ä¾›å¤§å®¶ä¸‹è½½ï¼Œå¦‚æœä¸‹è½½ dockerhub çš„é€Ÿåº¦æ…¢ï¼Œä¾ç„¶å¯ä»¥ä½¿ç”¨å›½å†…é•œåƒæºè¿›è¡Œä¸‹è½½ï¼Œ<a href="https://mirror.nju.edu.cn/help/docker-hub">NJU Mirror</a></p></li></ol><h2 id="Docker-çš„å¸¸ç”¨å‘½ä»¤"><a href="#Docker-çš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Docker çš„å¸¸ç”¨å‘½ä»¤"></a>Docker çš„å¸¸ç”¨å‘½ä»¤</h2><p><a href="https://docs.docker.com/reference/">å®˜æ–¹å‚è€ƒæ–‡æ¡£</a></p><h3 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker version<span class="token comment"># æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</span>docker info<span class="token comment"># æ˜¾ç¤º docker çš„ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨çš„æ•°é‡</span>docker <span class="token punctuation">[</span>command<span class="token punctuation">]</span> --help<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># æŸ¥çœ‹é•œåƒ</span>docker images<span class="token comment"># æŸ¥çœ‹ images</span>docker images -aq<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰ images id.</span><span class="token comment"># a for all, q for quiet</span><span class="token comment"># æœç´¢é•œåƒ</span>docker search img_name<span class="token comment"># æœç´¢é•œåƒ</span>docker search -f<span class="token comment"># filter</span><span class="token comment"># ä¸‹è½½é•œåƒ</span>docker pull name:tag<span class="token comment"># ä¸‹è½½é•œåƒï¼Œå¯ä»¥æŒ‡å®šæ ‡ç­¾/ç‰ˆæœ¬</span><span class="token comment"># åˆ é™¤é•œåƒ</span>docker rmi img_name<span class="token comment"># ç§»é™¤é•œåƒ</span>docker rmi -f img_name<span class="token comment"># å¼ºåˆ¶åˆ é™¤é•œåƒ</span>docker rmi -f <span class="token variable"><span class="token variable">$(</span>docker images -aq<span class="token variable">)</span></span><span class="token comment"># å¼ºåˆ¶åˆ é™¤å…¨éƒ¨é•œåƒ</span>docker image prune -a<span class="token comment"># æ¸…ç†æ²¡æœ‰ä½¿ç”¨çš„é•œåƒ</span><span class="token comment"># ç»™é•œåƒæ‰“æ ‡ç­¾</span>docker tag src_img dst_img:tag<span class="token comment"># åˆ›é€ æ–°çš„é•œåƒåŠæ–°æ ‡ç­¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h3><p>æœ‰äº†é•œåƒ image è¿‡åæ‰èƒ½åˆ›å»ºå®¹å™¨ containerï¼Œè¿™ä¸€éƒ¨åˆ†çš„å‘½ä»¤æ˜¯æœ€æ ¸å¿ƒçš„ä¹Ÿæ˜¯æœ€å¤šçš„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># åˆ›å»ºå®¹å™¨</span>docker run <span class="token punctuation">[</span>opt<span class="token punctuation">]</span> img<span class="token comment"># å¸¸ç”¨å‚æ•°</span>--name string<span class="token comment"># ç»™å®¹å™¨å‘½å</span>-d, --detached<span class="token comment"># åå°è¿è¡Œ</span>-it<span class="token comment"># äº¤äº’ç»ˆç«¯ interactive terminal</span>-p host_port:ctn_port<span class="token comment"># æŒ‡å®šæš´éœ²ç«¯å£</span>--rm<span class="token comment"># é€€å‡ºååˆ é™¤å®¹å™¨</span>--hostname name<span class="token comment"># æŒ‡å®šä¸»æœºå</span><span class="token comment"># æŸ¥çœ‹å®¹å™¨</span>docker <span class="token function">ps</span><span class="token comment"># æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</span>docker <span class="token function">ps</span> -a<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span>docker <span class="token function">ps</span> -q<span class="token comment"># æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨id</span>docker <span class="token function">ps</span> -n int<span class="token comment"># é™åˆ¶æ˜¾ç¤ºæ•°é‡</span>docker logs --tail <span class="token number">10</span> ctn_id<span class="token comment"># æŸ¥çœ‹å®¹å™¨æ“ä½œæ—¥å¿—</span>docker <span class="token function">top</span> ctn_id<span class="token comment"># æŸ¥çœ‹å®¹å™¨è¿›ç¨‹</span>docker inspect ctn_id<span class="token comment"># æŸ¥çœ‹å®¹å™¨å…ƒæ•°æ®</span><span class="token comment"># é€€å‡ºå®¹å™¨</span><span class="token builtin class-name">exit</span><span class="token comment"># å®Œå…¨é€€å‡º</span>ctrl + P + Q<span class="token comment"># å®¹å™¨åœ¨åå°ä»è¿è¡Œ</span><span class="token comment"># å¯åŠ¨å’Œåœæ­¢å®¹å™¨</span>docker start ctn_iddocker start -ai ctn_id<span class="token comment"># å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨äº¤äº’</span>docker restart ctn_iddocker stop ctn_iddocker <span class="token function">kill</span> ctn_id<span class="token comment"># å¼ºåˆ¶åœæ­¢</span><span class="token comment"># è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨</span>docker <span class="token builtin class-name">exec</span> -it ctn_id<span class="token comment"># è¿›å…¥å®¹å™¨å¹¶å¼€å¯æ–°ç»ˆç«¯</span>docker attach ctn_id<span class="token comment"># è¿›å…¥æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯</span><span class="token comment"># åˆ é™¤å®¹å™¨</span>docker <span class="token function">rm</span> ctn_id<span class="token comment"># åˆ é™¤æŒ‡å®šå®¹å™¨</span>docker <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -aq<span class="token variable">)</span></span><span class="token comment"># å¼ºåˆ¶åˆ é™¤æ‰€æœ‰å®¹å™¨</span><span class="token comment"># æ‹·è´å®¹å™¨æ–‡ä»¶è‡³ä¸»æœº</span>docker <span class="token function">cp</span> ctn_id:src_path dst_path<span class="token comment"># ä¹‹åä½¿ç”¨å·æŠ€æœ¯ -v å¯ä»¥å®ç°æ–‡ä»¶å…±äº«</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šçš„ <code>ctn_id</code> æŒ‡çš„æ—¶å®¹å™¨ idï¼Œä¹Ÿå¯ä»¥ç”¨å®¹å™¨åæ›¿ä»£ï¼Œå¦‚æœæœ‰çš„è¯</p><p>è¡¥å……ï¼šè‡ªå·±æ‹…å¿ƒä¸‹è½½çš„é•œåƒå¤ªå¤šäº†ä¼šå ç”¨ C ç›˜ï¼Œæ‰€ä»¥ä½¿ç”¨ç›®å½•è¿æ¥ï¼Œå°† docker appdata ç§»åˆ°äº† D ç›˜</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd"># ç®¡ç†å‘˜æƒé™mklink /j Docker D:\AppData\Docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Docker-é•œåƒè®²è§£"><a href="#Docker-é•œåƒè®²è§£" class="headerlink" title="Docker é•œåƒè®²è§£"></a>Docker é•œåƒè®²è§£</h2><h3 id="é•œåƒåŠ è½½åŸç†"><a href="#é•œåƒåŠ è½½åŸç†" class="headerlink" title="é•œåƒåŠ è½½åŸç†"></a>é•œåƒåŠ è½½åŸç†</h3><p>UnionFS æ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ã€‚åœ¨è¿™ç§å±‚çº§ç»“æ„ä¸‹ï¼Œå¦‚æœæœ‰æ¶‰åŠåˆ°ç›¸åŒçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå±‚ä¸å±‚é—´å°±å¯ä»¥å…±ç”¨äº†ï¼Œæå¤§èŠ‚çœèµ„æº</p><p>docker çš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§æ–‡ä»¶ç³»ç»Ÿå°±æ˜¯ä¸Šè¿°çš„ UnionFSã€‚æ¥ç€ï¼Œåœ¨å†…éƒ¨åˆåˆ†ä¸º2éƒ¨åˆ†ï¼š</p><ul><li>boot file system ï¼ˆbootfsï¼‰ï¼šdockeré•œåƒçš„æœ€åº•å±‚æ˜¯bootfsï¼Œä¸»è¦åŒ…å« bootloaderï¼ˆåŠ è½½å™¨ï¼‰å’Œ kernelï¼ˆå†…æ ¸ï¼‰ã€‚bootloader ä¸»è¦æ˜¯å¼•å¯¼åŠ è½½ kernelã€‚æ³¨æ„ kernel æ˜¯ä¸å®¿ä¸»æœºå…±äº«çš„ï¼Œè€Œä¸”ä¸ç”¨åƒè™šæ‹Ÿæœºä¸€æ ·æ¨¡æ‹Ÿç¡¬ä»¶ï¼Œæ‰€ä»¥ docker åŠ è½½å¾ˆå¿«ï¼Œæ˜¯ç§’çº§çš„</li><li>root file system ï¼ˆrootfsï¼‰ï¼šåŒ…å«å…¸å‹çš„ç›®å½•ç»“æ„ï¼ŒåŒ…æ‹¬ /dev, /proc, /bin, /etc, /lib, /usr, and /tmp ç­‰å†åŠ ä¸Šè¦è¿è¡Œç”¨æˆ·åº”ç”¨æ‰€éœ€è¦çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿåœ¨ä¸åŒçš„Linux å‘è¡Œç‰ˆï¼ˆUbuntu, CentOSâ€¦ï¼‰ä¸­æ˜¯ä¸åŒçš„ã€‚è€Œä¸”ç”¨æˆ·å¯ä»¥å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œå¯¹æ¯”ä¹‹ä¸‹ï¼Œç”¨æˆ·å°±ä¸ä¼šä¿®æ”¹ bootfs</li></ul><p><img src="Docker/R-C.ff875ee1131ed5030cdf969e8a3c1ba8rik=wzeW33YFmj1oZA&amp;riu=http%3a%2f%2fimg.blog.csdn.net%2f20150618081016477&amp;ehk=Bi3E387Elx7weqFV2b16m8tk%2bwsL%2bdsCoXBEBPchK%2b8%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0" style="zoom:80%;"></p><p>Docker é•œåƒéƒ½æ˜¯åªè¯»çš„ï¼Œå½“å¯åŠ¨å®¹å™¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚è¢«åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨ï¼Œè¿™ä¸€å±‚å°±æ˜¯é€šå¸¸è¯´çš„å®¹å™¨å±‚ï¼Œå®¹å™¨ä¹‹ä¸‹çš„éƒ½å«é•œåƒå±‚</p><h3 id="Commit-image"><a href="#Commit-image" class="headerlink" title="Commit image"></a>Commit image</h3><p>å½“ä½ åœ¨å®¹å™¨ä¸­å®Œæˆäº†ä½ çš„åº”ç”¨ï¼Œæƒ³è¦å°†è¯¥å®¹å™¨ç”Ÿæˆé•œåƒï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>docker commit</code> å‘½ä»¤ã€‚æœ¬è´¨ä¸Šå°±æ˜¯æŠŠä½ çš„å®¹å™¨å±‚å˜ä¸ºé•œåƒå±‚ï¼ŒåŠ å…¥åˆ°åŸæ¥çš„é•œåƒå±‚ä¸­ï¼ˆroot file systemï¼‰å†æ‰“åŒ…ä¿å­˜èµ·æ¥ã€‚å› ä¸ºæ˜¯åˆ†å±‚æ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œæ‰€ä»¥è¿™æ ·çš„æ“ä½œå¾ˆæ–¹ä¾¿</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker commit -a <span class="token string">"author"</span> -m <span class="token string">"message"</span> ctn_id img_name:tag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±å¯ä»¥æ‰“é€ è‡ªå·±çš„ä¸ªæ€§åŒ–é•œåƒäº†ï¼Œä½†ä¹‹åè¿˜ä¼šæœ‰æ›´é«˜çº§çš„æ–¹æ³• Dockerfile æ¥åˆ›é€ é•œåƒ</p><h3 id="Save-amp-load-image"><a href="#Save-amp-load-image" class="headerlink" title="Save &amp; load image"></a>Save &amp; load image</h3><p>æœ‰æ—¶å€™ä¸å¸Œæœ›ä»ç½‘ç»œä¸‹è½½é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ <code>docker save</code> å‘½ä»¤æ‰“åŒ…é•œåƒï¼Œç„¶åæŠŠé•œåƒä¼ è¾“ç»™éœ€è¦çš„äººï¼Œåˆ«äººå†ç”¨ <code>docker load</code> å°†é•œåƒåŠ è½½å³å¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker save -o xxx.tar imgdocker save -i xxx.tar <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="å®¹å™¨æ•°æ®å·"><a href="#å®¹å™¨æ•°æ®å·" class="headerlink" title="å®¹å™¨æ•°æ®å·"></a>å®¹å™¨æ•°æ®å·</h2><p>è¿™æ˜¯ä¸€ç§å°†<strong>æ•°æ®æŒä¹…åŒ–/å…±äº«æ•°æ®</strong>çš„æŠ€æœ¯ã€‚æ•°æ®å·å¯ä»¥å°†å®¹å™¨ä¸å®¿ä¸»æœºï¼Œå®¹å™¨ä¸å®¹å™¨ä¹‹é—´è¿æ¥ä¸€ä¸ªé€šé“ï¼Œè¿›è¡Œæ•°æ®å…±äº«ï¼Œå¯åŒæ­¥ä¿®æ”¹ã€‚å¹¶ä¸”åˆ æ‰å…¶ä¸­ä¸€ä¸ªå®¹å™¨çš„æ•°æ®ï¼ˆä¸æ˜¯ä¿®æ”¹ï¼‰ï¼Œå…¶ä»–å®¹å™¨çš„å…±äº«æ•°æ®å¹¶ä¸ä¼šæŸåï¼Œè¿™å°±è¾¾åˆ°äº†æŒä¹…åŒ–çš„æ•ˆæœ</p><h3 id="ä½¿ç”¨æ•°æ®å·"><a href="#ä½¿ç”¨æ•°æ®å·" class="headerlink" title="ä½¿ç”¨æ•°æ®å·"></a>ä½¿ç”¨æ•°æ®å·</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># åœ¨åˆ›å»ºå®¹å™¨æ—¶é€šè¿‡å‚æ•° -v æŒ‚è½½</span>-v, --volume<span class="token operator">=</span><span class="token punctuation">[</span>host-src:<span class="token punctuation">]</span>container-dest<span class="token punctuation">[</span>:<span class="token operator">&lt;</span>options<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token comment"># The 'host-src' is an absolute path or a name value.</span><span class="token comment"># é€šè¿‡å¤šæ¬¡ -v å‚æ•°æŒ‚è½½å¤šä¸ªå·</span><span class="token comment"># æŒ‡å®šè·¯å¾„æŒ‚è½½</span><span class="token comment"># å¦‚æœä¸å­˜åœ¨è·¯å¾„åˆ™è‡ªåŠ¨åˆ›é€ </span>docker run -v host_dir:ctn_dir ctn_id<span class="token comment"># åŒ¿åæŒ‚è½½</span><span class="token comment"># ä»…ä¼ å…¥å®¹å™¨å†…è·¯å¾„</span>docker run -v ctn_dir ctn_id<span class="token comment"># å…·åæŒ‚è½½</span><span class="token comment"># ç»™å·æ·»åŠ åå­—ï¼Œæ³¨æ„è¿™åŒºåˆ«äºæŒ‡å®šè·¯å¾„æŒ‚è½½</span>docker run -v name:ctn_dir ctn_id <span class="token comment"># æŒ‡å®šè¯»å†™æƒé™ï¼Œå¦‚ ro æŒ‡å®¹å™¨åªèƒ½è¯»å·</span>docker run -v ctn_dir:ro ctn_iddocekr run -v ctn_dir:rw ctn_id<span class="token comment"># å®¹å™¨ä¹‹é—´çš„å…±äº«å·</span><span class="token comment"># å¯ä»¥å…¶ä»–å®¹å™¨çš„å·æŒ‚è½½åˆ°å½“å‰å®¹å™¨ä¸‹</span>docker run --volumes-from ctn_list ctn_id<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰å·çš„æƒ…å†µ</span>docker volume <span class="token function">ls</span>docker volume inspect volume_id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€æŒ‚è½½â€œçš„æœ¬è´¨æ˜¯åœ¨å®¿ä¸»æœºåˆ›é€ äº†ä¸€ä¸ªæ•°æ®å· volumeï¼ˆå¦‚æœå®ç°æ²¡æœ‰è¯¥ volume çš„è¯ï¼‰ï¼Œå¯ä»¥æŠŠè¿™ä¸ªå·çœ‹ä½œä¸ºä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ï¼Œé€šè¿‡æŒ‡å®šå‘½ä»¤å¤§å®¶éƒ½å¯ä»¥æ¥è®¿é—®å’Œä¿®æ”¹</p><p>æ•°æ®å·è¿˜å¯ä»¥ä½¿ç”¨ <code>docker inspect ctn_id</code> æŸ¥çœ‹è¯¦æƒ…ï¼Œåœ¨ <code>Mount</code> å­—æ®µä¸‹è®°å½•æœ‰ <code>Source &amp; Destination</code> åˆ†åˆ«å¯¹åº”å®¿ä¸»æœºå’Œå®¹å™¨å†…ç›®å½•</p><p>é™¤äº†é€šè¿‡ <code>-v</code> å‘½ä»¤æŒ‚è½½å·ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ Dockerfile è¿›è¡ŒæŒ‚è½½ï¼Œé€šè¿‡æŒ‡å®š VOLUME å­—æ®µï¼Œç¡®å®šå®¹å™¨å†…æŒ‚è½½è·¯å¾„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">VOLUME <span class="token punctuation">[</span><span class="token string">"DIR_1"</span>,<span class="token string">"DIR_2"</span>,<span class="token punctuation">..</span>.<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»¥ä¸Šçš„æ“ä½œéƒ½æ˜¯åœ¨åˆ›å»ºå®¹å™¨æ—¶æŒ‚è½½å·ï¼Œå¦‚æœåœ¨åˆ›å»ºå¥½å®¹å™¨ä¹‹åæƒ³è¦æŒ‚è½½å·åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿäº‹å®ä¸Šä¹Ÿæ²¡æœ‰ä¸€ä¸ªä¼˜é›…çš„åŠæ³•èƒ½è§£å†³ï¼Œå¯ä»¥é€‰æ‹©å°†è¯¥å®¹å™¨ commit ä¸ºé•œåƒï¼Œç„¶åå†è¿›è¡Œåˆ›å»º</p><h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>åœ¨ä¸Šä¸€èŠ‚é¦–æ¬¡æåˆ°äº†ä½¿ç”¨ dockerfile æŒ‚è½½å·ã€‚Dockerfile æ˜¯ç”¨æ¥æ„å»º docker é•œåƒçš„æ–‡ä»¶ï¼Œæœ¬è´¨ä¸ºä¸€ä¸ªå‘½ä»¤å‚æ•°è„šæœ¬ã€‚å…ˆæ¥çœ‹çœ‹ä¸€äº›å®˜æ–¹çš„ dockerfile æ˜¯æ€ä¹ˆå†™çš„ğŸ˜€</p><pre class="line-numbers language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM scratchADD ubuntu-focal-oci-amd64-root.tar.gz /# å‡è®¾è¯¥å‹ç¼©æ–‡ä»¶å·²ç»é¢„å…ˆä¸‹è½½åˆ°åé¢æŒ‡å®šçš„ç›®å½•CMD ["bash"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸‰è¡Œå°±åˆ›å»ºäº†ä¸€ä¸ª Ubuntu 20.04 dockerfileï¼Œä¸€èˆ¬å®˜æ–¹æ‰€ç»™çš„éƒ½æ˜¯æœ€åŸºç¡€çš„ï¼Œå¾ˆå¤šåŠŸèƒ½éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æœ‰æ—¶å€™éœ€è¦è‡ªå·±åˆ›å»º dockerfile ä»¥åŠå¯¹åº”çš„é•œåƒã€‚ç®€å•ä»‹ç»ä¸€ä¸‹åŸºç¡€çŸ¥è¯†ï¼š</p><ol><li>æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯å¤§å†™</li><li>å‘½ä»¤æŒ‰ç…§é¡ºåºä»ä¸Šåˆ°ä¸‹æ‰§è¡Œ</li><li>æ³¨é‡Šä½¿ç”¨äº•å· #</li><li>æ¯ä¸ªå‘½ä»¤éƒ½ä¼šå½¢æˆä¸€ä¸ªæ–°çš„é•œåƒå±‚</li></ol><h3 id="Dockerfile-å‘½ä»¤"><a href="#Dockerfile-å‘½ä»¤" class="headerlink" title="Dockerfile å‘½ä»¤"></a>Dockerfile å‘½ä»¤</h3><p>Dockerfile çš„å¸¸ç”¨å‘½ä»¤åŠå…¶ä½œç”¨</p><ul><li>FROMï¼šåŸºäºå“ªä¸ªåŸºç¡€é•œåƒ</li><li>WORKDIRï¼šæŒ‡å®šshellå‘½ä»¤è¿è¡Œåœ¨å“ªä¸ªç›®å½•ä¸‹ã€‚ä¸ºåç»­çš„ RUNã€CMDã€COPYã€ADD ç­‰å‘½ä»¤é…ç½®å·¥ä½œç›®å½•ã€‚æ¥ä¸‹æ¥çš„ COPY å’Œ ADD å‘½ä»¤ä¸­çš„ç›¸å¯¹è·¯å¾„å°±æ˜¯ç›¸å¯¹äº WORKDIR æŒ‡å®šçš„è·¯å¾„</li><li>COPYï¼šå°†å½“å‰å®¿ä¸»æœºçš„æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­å»ï¼ˆ<strong>copyçš„æ–‡ä»¶å¿…é¡»åœ¨buildå‘½ä»¤æœ€åæŒ‡å®šçš„è·¯å¾„å†…</strong>ï¼‰</li><li>ADDï¼šå’ŒCOPYä¸€æ ·ï¼Œå¹¶ä¸”è¿˜å¯ä»¥è§£å‹ç¼©ï¼Œæˆ–è€…ä» url æ‹·è´æ–‡ä»¶åˆ°é•œåƒä¸­ã€‚<strong>COPY å’Œ ADD å‘½ä»¤å…·æœ‰ç›¸åŒçš„ç‰¹ç‚¹ï¼šåªå¤åˆ¶ç›®å½•ä¸­çš„å†…å®¹è€Œä¸åŒ…å«ç›®å½•è‡ªèº«</strong>ã€‚</li><li>RUNï¼šæ„å»ºé•œåƒæ—¶è¿è¡Œçš„shellå‘½ä»¤</li><li>CMDï¼šå®¹å™¨è¿è¡Œæ—¶æ‰§è¡Œçš„shellå‘½ä»¤ï¼ˆ<strong>å¤šä¸ªCMDåªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼Œè¦æƒ³éƒ½æ‰§è¡Œå¯ä»¥ä½¿ç”¨&amp;&amp;è¿æ¥å¤šä¸ªå‘½ä»¤</strong>ï¼‰ï¼ˆ<strong>å¦‚æœå®¹å™¨runæ—¶ï¼Œåé¢æŒ‡å®šäº†shellç‰ˆæœ¬ï¼ŒDockerfileä¸­çš„CMDä¹Ÿä¼šè¢«è¦†ç›–</strong>ï¼‰</li><li>ENTRYPOINTï¼šå’ŒCMDä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥è¿½åŠ ï¼ˆå¿…é¡»ä½¿ç”¨execæ ¼å¼ï¼Œå³ï¼šENTRYPOINT [./entrypoint.shï¼Œå‚æ•°1ï¼Œå‚æ•°2â€¦â€¦]ï¼‰</li><li>EXPOSEï¼šæŒ‡å®šé•œåƒæš´éœ²å‡ºæ¥çš„ç«¯å£</li><li>VOLUMUï¼šæ•°æ®å®¹å™¨å·ï¼ŒæŒ‡å®šæ˜ å°„æ–‡ä»¶ï¼Œç”¨äºæ•°æ®æŒä¹…åŒ–</li><li>ENVï¼šæŒ‡å®šç¯å¢ƒå˜é‡</li><li>LABELï¼šæŒ‡å®šå®¹å™¨è¿è¡Œæ—¶æ ‡ç¤º</li><li>SHELLï¼šæŒ‡å®šshell</li><li>MAINTAINERï¼šé•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€</li><li>ONBUILDï¼šå½“æ„å»ºä¸€ä¸ªçˆ¶é•œåƒæ—¶ï¼Œçˆ¶é•œåƒè¢«å­é•œåƒç»§æ‰¿æ—¶ï¼ŒONBUILDè¢«è§¦å‘</li></ul><p>è¿™é‡Œè´´ä¸€ä¸ª mmdetection 3D å†™çš„ dockerfile</p><pre class="line-numbers language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">ARG PYTORCH="1.6.0"ARG CUDA="10.1"ARG CUDNN="7"FROM pytorch/pytorch:${PYTORCH}-cuda${CUDA}-cudnn${CUDNN}-devel# å¦‚æœé¢„å…ˆæ²¡æœ‰ä¸‹è½½è¯¥é•œåƒï¼ŒçŒœæµ‹ä¼šè‡ªåŠ¨è£…ï¼Œç±»ä¼¼ docker runENV TORCH_CUDA_ARCH_LIST="6.0 6.1 7.0+PTX"ENV TORCH_NVCC_FLAGS="-Xfatbin -compress-all"ENV CMAKE_PREFIX_PATH="$(dirname $(which conda))/../"RUN apt-get update &amp;&amp; apt-get install -y ffmpeg libsm6 libxext6 git ninja-build libglib2.0-0 libsm6 libxrender-dev libxext6 \    &amp;&amp; apt-get clean \    &amp;&amp; rm -rf /var/lib/apt/lists/*# Install MMCV, MMDetection and MMSegmentationRUN pip install mmcv-full==1.3.8 -f https://download.openmmlab.com/mmcv/dist/cu101/torch1.6.0/index.htmlRUN pip install mmdet==2.17.0RUN pip install mmsegmentation==0.18.0# Install MMDetection3DRUN conda clean --allRUN git clone https://github.com/open-mmlab/mmdetection3d.git /mmdetection3dWORKDIR /mmdetection3dENV FORCE_CUDA="1"RUN pip install -r requirements/build.txtRUN pip install --no-cache-dir -e .<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ dockerfile ç”Ÿæˆé•œåƒçš„å¸¸ç”¨å‘½ä»¤</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker build -t name:tag -f dockerfile_name FILE_PATH<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å‘å¸ƒé•œåƒ"><a href="#å‘å¸ƒé•œåƒ" class="headerlink" title="å‘å¸ƒé•œåƒ"></a>å‘å¸ƒé•œåƒ</h2><h3 id="DockerHub"><a href="#DockerHub" class="headerlink" title="DockerHub"></a>DockerHub</h3><ol><li><p>æ³¨å†Œ dockerhub è´¦æˆ·</p></li><li><p>ç™»å½•ï¼Œç›´æ¥è¾“å…¥ <code>docker login</code> å°±ä¼šæç¤ºè¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥å¸¦å‚æ•°</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker login -u username<span class="token comment"># Password:</span>docker <span class="token builtin class-name">logout</span><span class="token comment"># é€€å‡ºç™»å½•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å‘å¸ƒé•œåƒ <code>docker push img:tag</code></p></li></ol><p>ä¹Ÿå¯ä»¥é€‰æ‹©å›½å†…ä»“åº“è¿›è¡Œå‘å¸ƒï¼Œä¾‹å¦‚é˜¿é‡Œäº‘ï¼Œè¿™é‡Œä¸è¿‡å¤šä»‹ç»äº†</p><h2 id="ä»¥å›¾ç‰‡å°ç»“-Docker"><a href="#ä»¥å›¾ç‰‡å°ç»“-Docker" class="headerlink" title="ä»¥å›¾ç‰‡å°ç»“ Docker"></a>ä»¥å›¾ç‰‡å°ç»“ Docker</h2><p><img src="/archives/f5f9fa9b/format,png.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VoxelNet &amp; SECOND</title>
      <link href="/archives/4486189f.html"/>
      <url>/archives/4486189f.html</url>
      
        <content type="html"><![CDATA[<h1 id="VoxelNet-amp-SECOND"><a href="#VoxelNet-amp-SECOND" class="headerlink" title="VoxelNet &amp; SECOND"></a>VoxelNet &amp; SECOND</h1><hr><p>Zhou, Yin, and Oncel Tuzel. â€œVoxelNet: End-to-End Learning for Point Cloud Based 3D Object Detection.â€ <em>ArXiv:1711.06396 [Cs]</em>, November 16, 2017. <a href="http://arxiv.org/abs/1711.06396">http://arxiv.org/abs/1711.06396</a>.</p><p>Yan, Yan, Yuxing Mao, and Bo Li. â€œSECOND: Sparsely Embedded Convolutional Detection.â€ <em>Sensors</em> 18, no. 10 (October 6, 2018): 3337. <a href="https://doi.org/10.3390/s18103337">https://doi.org/10.3390/s18103337</a>.</p><hr><h2 id="VoxelNet"><a href="#VoxelNet" class="headerlink" title="VoxelNet"></a>VoxelNet</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>VoxelNet ä½œä¸ºä½“ç´ åŒ–å¤„ç†ç‚¹äº‘çš„å¥ åŸºä¹‹ä½œï¼Œå…¶åœ°ä½ä¹Ÿæ˜¯ç›¸å½“é«˜çš„ã€‚è¯¥è®ºæ–‡ä¸ºä¹‹åçš„ä½“ç´ åŒ–æ¡†æ¶æä¾›äº†é€šç”¨çš„æ€è·¯ï¼šè¯¥ç½‘ç»œå°†ç‚¹äº‘åˆ†å‰²ä¸ºå‡åŒ€çš„ 3D ä½“ç´ å—ï¼Œå¹¶å°†æ¯ä¸€ä¸ªä½“ç´ å†…çš„ç‚¹ä½¿ç”¨ç»Ÿä¸€çš„ç‰¹å¾è¡¨ç¤ºã€‚ç„¶åå†å°† 3D ç‰¹å¾å›¾è°±è½¬åŒ–ä¸º BEV ç‰¹å¾å›¾è°±è¿›è¡Œé€‰æ¡†é¢„æµ‹</p><p>åœ¨å½“æ—¶å¯¹äºç‚¹äº‘ç‰¹å¾æå–è¿˜å¤„äºèµ·æ­¥é˜¶æ®µï¼ŒPointNet åˆšåˆšé—®ä¸–ï¼Œå¯¹äºç‰¹å¾æå–ä¸å†ä½¿ç”¨äººå·¥è®¾è®¡ç‰¹å¾ï¼Œå¤šè§†è§’èåˆçš„æ–¹æ³•ä¹Ÿé€æ¸è¢«è¶…è¶Šã€‚ä½†æ˜¯ PointNet åºå¤§çš„è¿ç®—é‡æ˜¯ä¸€ä¸ªäºŸéœ€è§£å†³çš„é—®é¢˜ï¼Œä¸ºäº†æœ‰æ•ˆåœ°åˆ©ç”¨ç‚¹äº‘ï¼Œå°†å…¶è¿›è¡Œä½“ç´ åŒ–è¡¨ç¤ºä¸å¤±ä¸ºä¸€ä¸ªå¥½æ–¹å‘ï¼Œè§„åˆ™åŒ–çš„æ•°æ®ç»“æ„ä¸€èˆ¬æ˜¯æ›´åˆ©äºå­˜å‚¨ä¸å­¦ä¹ çš„ï¼ŒVoxelNet åº”è¿è€Œç”Ÿ </p><h3 id="VoxelNet-Architecture"><a href="#VoxelNet-Architecture" class="headerlink" title="VoxelNet Architecture"></a>VoxelNet Architecture</h3><p><img src="/archives/4486189f/image-20211018182525929.png"></p><h4 id="Feature-Learning-Network"><a href="#Feature-Learning-Network" class="headerlink" title="Feature Learning Network"></a>Feature Learning Network</h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯æ•´ä¸ªç½‘ç»œçš„æ ¸å¿ƒï¼Œè¯¦ç»†åœ°æè¿°äº†å¦‚ä½•å°†ç‚¹äº‘ç¼–ç ä¸ºä½“ç´ åŒ–ç‰¹å¾å›¾è°±ã€‚é¦–å…ˆæ˜¯å°†ç½‘ç»œåˆ†å‰²ä¸ºå‡åŒ€çš„ä½“ç´ å—ï¼Œæœ€ç»ˆå¯ä»¥ä½¿ç”¨ $(D,H,W)$ å½¢çŠ¶çš„çŸ©é˜µæ¥è¡¨ç¤ºè¯¥ä½“ç´ åŒ–ç‚¹äº‘ã€‚ç”±äºç‚¹äº‘ä¸­èƒ½å¤ŸåŒ…å« ~100k æ•°é‡çº§çš„ç‚¹ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªä½“ç´ å— $(d,h,w)$ ä¸­çš„ç‚¹çš„æ•°é‡è¿›è¡Œé™åˆ¶ï¼Œæœ€å¤šä¸è¶…è¿‡ $T$ ä¸ªç‚¹ï¼Œè¿™æ ·çš„é™åˆ¶èƒ½å¤Ÿå¾ˆå¥½çš„èŠ‚çº¦è®¡ç®—ï¼Œå¹³è¡¡æ¯ä¸ªä½“ç´ å—å†…çš„ç‚¹äº‘æ•°é‡</p><p>æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨å¤šä¸ªä½“ç´ ç‰¹å¾ç¼–ç æ¨¡å— voxel feature encoding (VFE) å¯¹æ¯ä¸ªä½“ç´ å—å†…çš„ç‚¹äº‘è¿›è¡Œç‰¹å¾æå–ï¼Œä¸‹é¢å¯¹ VFE æ¨¡å—è¿›è¡Œè¯¦ç»†äº†è§£ã€‚å…¶ä¸­<strong>ä¸€ä¸ª</strong>éç©ºä½“ç´ å—ç‰¹å¾è¡¨ç¤ºä¸ºå¦‚ä¸‹å…¬å¼</p><script type="math/tex; mode=display">\mathbf{V}=\left\{\mathbf{p}_{i}=\left[x_{i}, y_{i}, z_{i}, r_{i}\right]^{T} \in \mathbb{R}^{4}\right\}_{i=1 \ldots t}</script><p>å³è¯¥ä½“ç´ å—ä¸­æ‰€æœ‰çš„ç‚¹ï¼Œå…¶ä¸­ $r_i$ ä¸ºåå°„å¼ºåº¦ã€‚å°†è¯¥ç‰¹å¾è¿›è¡Œå¢å¼ºï¼ŒåŠ å…¥æ¯ä¸ªç‚¹è·ç¦»è¯¥ä½“ç´ ä¸­å¿ƒçš„åç§»é‡</p><script type="math/tex; mode=display">\mathbf{V_in}=\left\{\hat{\mathbf{p}}_{i}=\left[x_{i}, y_{i}, z_{i}, r_{i}, x_i-v_x, y_i-v_y, z_i-v_z\right]^{T} \in \mathbb{R}^{4}\right\}_{i=1 \ldots t}</script><p>å°†è¯¥ç‰¹å¾é€å…¥ç½‘ç»œï¼ˆFCN + BN + ReLUï¼‰å¾—åˆ°æ¯ä¸€ä¸ªç‚¹çš„ç‰¹å¾ $\mathbf{f}_i \in \mathbb{R}^m$ï¼Œç„¶åå†ä½¿ç”¨ MaxPooling è·å¾—è¯¥ä½“ç´ çš„æ•´ä½“ç‰¹å¾ $\tilde{\mathbf{f}}_i \in \mathbb{R}^m$ ã€‚ï¼ˆå…¶å®è¿™ä¸ªç»“æ„ä¸ PointNet æ˜¯ç›¸ä¼¼çš„ï¼Œåªä¸è¿‡è®ºæ–‡ä¸­åç§°å« FCN/MLP è€Œä¸æ˜¯ shared MLPï¼Œä½†å®é™…ä¸Š FCN çš„æƒé‡æ˜¯æ‰€æœ‰éç©ºä½“ç´ å…±äº«çš„ï¼‰</p><p>å°†ä½“ç´ çš„ç‰¹å¾ä¸é€ç‚¹çš„ç‰¹å¾ point-wise feature è¿æ¥èµ·æ¥</p><script type="math/tex; mode=display">\mathbf{f}_{i}^{o u t}=\left[\mathbf{f}_{i}^{T}, \tilde{\mathbf{f}}^{T}\right]^{T} \in \mathbb{R}^{2 m}</script><p>è¯¥æ“ä½œæ˜¯ä¸ºäº†ç»™æ¯ä¸ªç‚¹å¢åŠ å…¶æ‰€åœ¨ä½“ç´ çš„ä¿¡æ¯ã€‚ä»¥ä¸Šå°±æ˜¯ç¬¬ä¸€ä¸ª VFE æ¨¡å—çš„æ“ä½œè¿‡ç¨‹ï¼Œå°†ä½“ç´ ä¸­çš„ç‚¹äº‘ç¼–ç ä¸ºç»Ÿä¸€å½¢çŠ¶çš„ç‰¹å¾å‘é‡ï¼Œå›¾ç¤ºå¦‚ä¸‹</p><p><img src="/archives/4486189f/image-20211018193130912.png" style="zoom: 80%;"></p><p>è®ºæ–‡ä½¿ç”¨å¤šä¸ªè¿™æ ·çš„ VFE æ¨¡å—ï¼Œä¸æ–­åœ°å¯¹ç‚¹äº‘è¿›è¡Œç‰¹å¾æå–æ“ä½œï¼Œæœ€åä¸€ä¸ª VFE æ¨¡å—åœ¨ä½¿ç”¨ MaxPooling åï¼Œä¸å†å°†å…¶è¿æ¥åˆ°é€ç‚¹çš„ç‰¹å¾ä¸Šï¼Œå³æœ€ç»ˆå¾—åˆ°äº†ä¸€ä¸ªé€ä½“ç´ çš„ç‰¹å¾å›¾è°± voxel-wise featureï¼Œæ¯ä¸ªä½“ç´ çš„ç‰¹å¾ç»´æ•°è®°ä¸º $C$ï¼Œæ•´ä¸ªç‚¹äº‘çš„ç‰¹å¾å›¾è°±è¡¨ç¤ºä¸º $(C, D, H, W)$ å½¢çŠ¶çš„çŸ©é˜µ</p><h4 id="Convolutional-middle-layers"><a href="#Convolutional-middle-layers" class="headerlink" title="Convolutional middle layers"></a>Convolutional middle layers</h4><p>è¿™éƒ¨åˆ†è®ºæ–‡ä»¥å°‘é‡çš„æ–‡å­—æè¿°ç•¥è¿‡ã€‚å°±æ˜¯å¯¹æå–å‡ºæ¥çš„ä½“ç´ ç‰¹å¾è¿›è¡Œå·ç§¯æ“ä½œï¼Œè¡¨ç¤ºä¸º Conv3D(C_in, C_out, kernel_size, stride, padding)ã€‚è¿™ä¸€ç»“æ„çš„é€æ¸èšé›†ä½“ç´ ç‰¹å¾ï¼Œç¼©å°ç‰¹å¾å›¾è°±åˆ†è¾¨ç‡ï¼Œä¸æ–­æå‡å›¾è°±ä¸­æ¯ä¸ªåƒç´ çš„æ„Ÿå—é‡</p><h4 id="Region-Proposal-Network"><a href="#Region-Proposal-Network" class="headerlink" title="Region Proposal Network"></a>Region Proposal Network</h4><p>é¦–å…ˆå°† 3D çš„ç‰¹å¾å›¾è°±æ²¿ç€ z è½´ï¼Œé‡å¡‘ reshape ä¸º 2D çš„ BEV ä¿¯è§†ç‰¹å¾å›¾è°±ã€‚è½¬æ¢åˆ°äºŒç»´è¿‡åå°±æ˜¯ç†Ÿæ‚‰çš„é¢†åŸŸäº†ï¼Œå…ˆä½¿ç”¨å¤šä¸ªäºŒç»´å·ç§¯æ¨¡å— Conv2D è¿›è¡Œç‰¹å¾æå–ï¼Œç„¶åå°†ä¸åŒåˆ†è¾¨ç‡çš„ç‰¹å¾å›¾è°±è¿›è¡Œä¸Šé‡‡æ ·æˆ–è€…å«åå·ç§¯ upsampling/deconvolutionã€‚ç»è¿‡ä¸Šé‡‡æ ·åï¼Œå¾—åˆ°å¤šä¸ªåˆ†è¾¨ç‡ç›¸åŒçš„ç‰¹å¾å›¾è°±ï¼Œç„¶åå°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œä½¿ç”¨ anchor-based detector è¿›è¡Œåˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡ã€‚æ•´ä¸ª RPN ç½‘ç»œçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤º    </p><p><img src="/archives/4486189f/image-20211018193754367.png"></p><p>å¯¹äº anchor çš„è®¾ç½®ä¸åƒäºŒç»´ä¸€æ ·æœ‰å¾ˆå¤šä¸ªå°ºåº¦çš„ anchorï¼Œè®ºæ–‡ä»…ä½¿ç”¨äº†ä¸€ä¸ª anchor size å’Œä¸¤ä¸ªæ—‹è½¬è§’åº¦ï¼ˆæ°´å¹³å’Œå‚ç›´ï¼‰ä½œä¸ºé¢„å®šä¹‰é€‰æ¡†</p><h4 id="Loss-function"><a href="#Loss-function" class="headerlink" title="Loss function"></a>Loss function</h4><p>å…³äºå›å½’ä»»åŠ¡ä½¿ç”¨çš„æ˜¯å¯¹æ•°å¤§å° logarithmic size çš„æ®‹å·®å€¼ä½œä¸ºæ‹Ÿåˆå¯¹è±¡/æ ‡ç­¾ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨çœŸå®çš„æ®‹å·®å€¼ï¼Œå…·ä½“è¿™ä¹ˆåšçš„åŸå› æˆ‘ä¸å¤ªæ¸…æ¥šï¼Œå¯èƒ½å¯¹æ•°å‡½æ•°èƒ½å¤Ÿè®©æ ‡ç­¾æ›´åŠ å¹³æ»‘ï¼Œå¹¶ä¸”ä»å›¾åƒä¸Šæ¥çœ‹ï¼Œlog å‡½æ•°èƒ½å¤Ÿç¨å¾®é™ä½æƒ©ç½š</p><script type="math/tex; mode=display">\begin{array}{l}\Delta x=\frac{x_{c}^{g}-x_{c}^{a}}{d^{a}}, \Delta y=\frac{y_{c}^{g}-y_{c}^{a}}{d^{a}}, \Delta z=\frac{z_{c}^{g}-z_{c}^{a}}{h^{a}} \\\Delta l=\log \left(\frac{l^{g}}{l^{a}}\right), \Delta w=\log \left(\frac{w^{g}}{w^{a}}\right), \Delta h=\log \left(\frac{h^{g}}{h^{a}}\right) \\\Delta \theta=\theta^{g}-\theta^{a}\end{array}\\</script><script type="math/tex; mode=display">where \ d^{a}=\sqrt{\left(l^{a}\right)^{2}+\left(w^{a}\right)^{2}}</script><p>å›å½’ä»»åŠ¡çš„æŸå¤±å‡½æ•°ä¸º smooth L1 lossï¼Œåˆ†ç±»ä»»åŠ¡ä½¿ç”¨äº¤å‰ç†µæŸå¤± cross entropy lossï¼ˆè¿™ä¸ªæ—¶å€™ focal loss è¿˜æ²¡è¯ç”Ÿï¼Œåœ¨ä¹‹åå…¶å‡çº§æ¡†æ¶ SECOND ä¸­ä½¿ç”¨äº†ï¼‰</p><p><img src="/archives/4486189f/image-20211018195534649.png" style="zoom: 80%;"></p><p>ç”±äºæ˜¯ anchor-based RPN ä¾ç„¶æ˜¯è¦å¯¹é¢„å®šä¹‰é€‰æ¡† pre-defined anchors è¿›è¡Œæ­£è´Ÿåˆ†ç±»çš„ï¼Œè€Œä¸”å›å½’æŸå¤±å¯¹ positive anchor æ‰€é¢„æµ‹çš„é€‰æ¡†è®¡ç®—æŸå¤±</p><h4 id="Data-structure"><a href="#Data-structure" class="headerlink" title="Data structure"></a>Data structure</h4><p>æ—¢ç„¶ä½¿ç”¨äº†ä½“ç´ åŒ–è¡¨ç¤ºï¼Œå¿…å®šå¸¦æ¥æ•°æ®ç»“æ„ä¸Šçš„è¡¨ç¤ºä¼˜åŠ¿ã€‚ç”±äºç‚¹äº‘çš„ç¨€ç–æ€§ï¼Œæœ‰å¤§é‡çš„ä½“ç´ å†…éƒ¨æ˜¯æ²¡æœ‰ç‚¹äº‘çš„ï¼Œæ­¤æ—¶ä½¿ç”¨å“ˆå¸Œè¡¨èƒ½å¤Ÿå¿«é€Ÿåœ°æŸ¥æ‰¾ä½“ç´ é˜µä¸­çš„éç©ºä½“ç´ ã€‚å‡è®¾éç©ºçš„ä½“ç´ å—æœ€å¤šæœ‰ $K$ ä¸ªï¼Œåˆå§‹åŒ–ä¸€ä¸ª $(K,T,7)$ å½¢çŠ¶çš„çŸ©é˜µä»¥å­˜å‚¨æ¯ä¸ªä½“ç´ åŠå…¶å†…éƒ¨ç‚¹äº‘çš„ç‰¹å¾ï¼Œå…¶ä¸­ $T$ ä»£è¡¨ä¸€ä¸ªä½“ç´ å†…æœ€å¤šæœ‰ $T$ ä¸ªç‚¹ï¼Œ$7$ ä»£è¡¨åŸå§‹ç‚¹äº‘çš„ç‰¹å¾ã€‚ä»¥æ¯ä¸ªä½“ç´ çš„åæ ‡ä½œä¸º hash key åˆ¶ä½œ hash tableï¼Œé€šè¿‡éå†æ‰€æœ‰çš„ç‚¹ï¼Œå°±èƒ½å¤Ÿå°†æ¯ä¸ªç‚¹åˆ†é…åˆ°å¯¹åº”ä½“ç´ ä¸­ï¼Œæœ€ç»ˆç»™å‡ºä½“ç´ çš„åæ ‡ï¼Œå°±èƒ½å¤Ÿè¿…é€ŸæŸ¥æ‰¾å‡ºè¯¥ä½“ç´ å†…æ‰€æœ‰é‡‡æ ·ç‚¹çš„ä¿¡æ¯ã€‚ä»¥ä¸Šæ„é€ å“ˆå¸Œè¡¨+ç‰¹å¾æå–çš„è¿‡ç¨‹å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤º</p><p><img src="/archives/4486189f/image-20211018203646922.png"></p><h2 id="SECOND"><a href="#SECOND" class="headerlink" title="SECOND"></a>SECOND</h2><p>SECOND å¯ä»¥è¯´å°±æ˜¯ VoxelNet çš„å‡çº§ç‰ˆæœ¬ï¼Œæ›´å¿«æ›´å‡†ï¼Œå…¶æ•´ä¸ª SSD æ£€æµ‹æ¡†æ¶å¯ä»¥è¯´å·²ç»æˆä¸º Voxel-based SSD çš„ä¸»æµï¼Œæ˜¯ç°åœ¨ç»å¸¸ä½¿ç”¨çš„ backbone ä¹‹ä¸€ï¼Œèƒ½å¤Ÿéå¸¸æœ‰æ•ˆåœ°å°†ç‚¹äº‘ä½“ç´ åŒ–å¹¶è¿›è¡Œä¸‰ç»´å·ç§¯æ“ä½œã€‚è¿™ä¸€éƒ¨åˆ†ä»…ä»‹ç»ä¸€ä¸‹ SECOND ç½‘ç»œä¸ºä»€ä¹ˆæ›´å¿«ï¼Œè¿™ä¹Ÿæ˜¯è¯¥è®ºæ–‡çš„é‡ç‚¹è´¡çŒ®ä¹‹ä¸€ï¼Œä½¿ç”¨äº†ç¨€ç–å·ç§¯/å­æµå½¢å·ç§¯ sparse convolution/submanifold convolution æ”¹è¿›äº†åŸæ¥çš„ä¸‰ç»´å·ç§¯æ“ä½œï¼Œçœå»äº†å¤§é‡å¯¹ç©ºä½“ç´ çš„å·ç§¯æ“ä½œï¼ˆç‚¹äº‘çš„ç¨€ç–æ€§å¯¼è‡´å¤§é‡ä½“ç´ å—ä¸ºç©ºï¼‰ï¼Œä»è€ŒåŠ é€Ÿè®¡ç®—ã€‚ä¸‹é¢ç•™ä¸¤ä¸ªå‚è€ƒé“¾æ¥ï¼Œ</p><ol><li><p>çŸ¥ä¹ï¼š<a href="https://zhuanlan.zhihu.com/p/382365889">Link1</a> <a href="https://zhuanlan.zhihu.com/p/383299678">Link2</a>ï¼ˆä¸¤ä¸ªé“¾æ¥å†…å®¹ç›¸ä¼¼ï¼Œè®²è§£ç¨€ç–å·ç§¯/å­æµå½¢å·ç§¯ï¼‰</p></li><li><p>å­æµå½¢å·ç§¯å®šä¹‰ï¼š<a href="https://paperswithcode.com/method/submanifold-convolutions">Link3</a></p></li></ol><p>å…¶æ ¸å¿ƒæ€æƒ³ä¹Ÿæ˜¯å’Œ hash table ç±»ä¼¼ï¼Œåˆ›å»ºä¸€ä¸ª RuleBook è®°å½•ä¸‹æ¯ä¸ªä½“ç´ å—çš„è¾“å…¥ä½ç½®åœ¨å“ªé‡Œã€è¾“å‡ºä½ç½®åœ¨å“ªé‡Œã€å¯¹åº”ç›¸ä¹˜çš„å·ç§¯æ ¸æƒé‡åœ¨å“ªé‡Œã€‚é€šè¿‡éå†è¿™ä¸ª RuleBook å³å¯å®Œæˆä¸‰ç»´å·ç§¯æ“ä½œ</p><p>ä¸‹é¢ä»…ç•™ä¸€å¼ ç¤ºæ„å›¾ä»¥ä¾¿å¿«é€Ÿå¤ä¹ ï¼ˆå¦‚æœæ²¡çœ‹è¿‡å‚è€ƒé“¾æ¥åº”è¯¥æ˜¯å¾ˆéš¾çœ‹æ‡‚ï¼‰</p><p><img src="/archives/4486189f/v2-80514738ec783b83d56a2506a0a2150b_r.jpg"></p><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><p><img src="/archives/4486189f/image-20211018213219777.png" alt="image-20211018213219777"></p><p>SECOND åœ¨é€Ÿåº¦ä¸Šç›¸æ¯”äº VoxelNet æå‡äº†æ¥è¿‘5å€ï¼Œå·²ç»èƒ½å¤Ÿè¾¾åˆ°å®æ—¶æ£€æµ‹çš„æ ‡å‡†ï¼ˆ20+ fpsï¼‰ï¼Œè¿™åœ¨é€Ÿåº¦ä¸Šæ˜¯å®Œå…¨çš„ç¢¾å‹ï¼Œè€Œä¸”åœ¨å‡†ç¡®ç‡ä¸Šä¹Ÿè¿œè¿œé¢†å…ˆ</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>ä»¥ä¸Šåˆ™æ˜¯å¯¹ VoxelNet å’Œ SECOND çš„æ€»ç»“ï¼Œè¿™ä¸¤ç¯‡å·²ç»æ˜¯å¥½å‡ å¹´å‰çš„æ–‡ç« äº†ï¼Œä¹Ÿæ˜¯ä¸‰ç»´ç‚¹äº‘ä½“ç´ åŒ–æ–¹å‘çš„å¥ åŸºä¹‹ä½œã€‚åœ¨å¾ˆå¤šè®ºæ–‡ä¸­éƒ½å°†åˆ°äº†è¿™ä¸¤ç¯‡çš„èº«å½±ï¼Œæ‰€ä»¥äº†è§£ä¸€ä¸‹å…¶ä¸­çš„å®ç°ç»†èŠ‚ï¼Œèƒ½å¤Ÿå¸®åŠ©æ›´å¥½åœ°ç†è§£å…¶ä»–è®ºæ–‡çš„ç»“æ„</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VoxelNet </tag>
            
            <tag> SECOND </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SE-SSD</title>
      <link href="/archives/774e60d7.html"/>
      <url>/archives/774e60d7.html</url>
      
        <content type="html"><![CDATA[<h1 id="SE-SSD"><a href="#SE-SSD" class="headerlink" title="SE-SSD"></a>SE-SSD</h1><hr><p>Zheng, Wu, Weiliang Tang, Li Jiang, and Chi-Wing Fu. â€œSE-SSD: Self-Ensembling Single-Stage Object Detector From Point Cloud.â€ <em>ArXiv:2104.09804 [Cs]</em>, April 20, 2021. <a href="http://arxiv.org/abs/2104.09804">http://arxiv.org/abs/2104.09804</a>.</p><hr><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>æœ¬è®ºæ–‡çš„æ ¸å¿ƒä¸ºä½¿ç”¨çŸ¥è¯†è’¸é¦ <strong>Knowledge Distill</strong> + <strong>Mean Teacher</strong>çš„æ€æƒ³ï¼ŒåŠ å…¥è½¯ç›®æ ‡ soft target å¯¹ç½‘ç»œçš„é¢„æµ‹ç»“æœè¿›è¡Œç›‘ç£å­¦ä¹ ã€‚ç”Ÿæˆè¯¥ soft target ä¸æ˜¯ä½¿ç”¨åŸå§‹æ–¹æ³•ï¼Œå°†ä¸åŒæ¨¡å‹çš„ prediction è¿›è¡Œé›†æˆï¼Œè€Œæ˜¯å…ˆå°†æ¨¡å‹è¿›è¡Œé›†æˆï¼Œå†ä½¿ç”¨é›†æˆæ¨¡å‹è¿›è¡Œé¢„æµ‹ predictionã€‚é›†æˆæ¨¡å‹ç»“æ„ ensemble model ä¸åŸå§‹ç½‘ç»œç›¸åŒï¼Œç§°ä¸º Teacher-SSDï¼Œè€ŒåŸå§‹ç½‘ç»œç§°ä¸º Student-SSDï¼Œå…¶ä¸­ Teacher-SSD çš„å‚æ•°ä¸º Student-SSD å‚æ•°çš„é›†æˆï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ¨¡å‹åå«è‡ªåµŒå…¥ SSD (self-embedding)</p><h3 id="Why-soft-target"><a href="#Why-soft-target" class="headerlink" title="Why soft target"></a>Why soft target</h3><p>æ‰‹åŠ¨æ³¨é‡Šçš„ç¡¬ç›®æ ‡ï¼ˆå³æ ‡ç­¾ hard target/labelï¼‰ç›¸æ¯”ï¼Œè½¯ç›®æ ‡é€šå¸¸å…·æœ‰æ›´é«˜çš„ç†µï¼Œä»è€Œä¸ºå­¦ç”Ÿæä¾›æ›´å¤šä¿¡æ¯ä»¥ä¾›å­¦ä¹ ï¼Œå¼¥è¡¥äº†ç›‘ç£ä¿¡å·çš„ä¸è¶³ã€‚å¹¶ä¸”è®ºæ–‡çš„è½¯ç›®æ ‡æ¥è‡ªäºè‡ªèº«æ¨¡å‹çš„é›†æˆï¼Œæ‰€ä»¥ä¸è‡ªèº«çš„é¢„æµ‹ç»“æœæ¯”è¾ƒç›¸ä¼¼ï¼Œé¿å…äº†æ¢¯åº¦çš„å‰§çƒˆå˜åŒ–ã€‚è€Œæ‰€è°“æ›´é«˜çš„ç†µè¯¥å¦‚ä½•å»ç†è§£ï¼Ÿå‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/390167950">çŸ¥ä¹</a></p><p>å±•å¼€åˆ†æä¸€ä¸‹è½¯ç›®æ ‡çš„ä½œç”¨ï¼Œä»¥åˆ†ç±»ä»»åŠ¡ä¸ºä¾‹ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>åˆ†ç±»æ ‡ç­¾ä¸º one hot å‘é‡ï¼Œä»…ä¸ºä¸€ä¸ªç‚¹ï¼Œä¹Ÿå³è¯¥ç›®æ ‡æ‰€å±ç±»åˆ«ã€‚è€Œä½¿ç”¨ teacher model å¯¹äºæ¯ä¸ªæ ·æœ¬è¾“å‡ºä¸€ä¸ªè¿ç»­çš„ label åˆ†å¸ƒï¼Œè¿™æ ·å¯ä»¥åˆ©ç”¨çš„ç›‘ç£ä¿¡æ¯å°±è¿œæ¯” one hot çš„å¤šäº†</li><li>è½¯ç›®æ ‡è¿˜æä¾›äº†å…¶ä»–åˆ†ç±»çš„å¾—åˆ†/å¯èƒ½æ€§ï¼Œå«æœ‰äº†ç±»åˆ«ä¸ç±»åˆ«ä¹‹é—´çš„ä¿¡æ¯</li><li>ï¼ˆåœ¨æœ¬è®ºæ–‡ä¸­ï¼‰å°†å­¦ä¹ æ›²çº¿å˜å¾—æ›´åŠ å¹³æ»‘ï¼Œå‡å°‘äº†æ¢¯åº¦æ–¹å·®ï¼Œå¸®åŠ©æ›´å¥½çš„å¾®è°ƒ</li></ol><p>é™¤äº†è¯¥æ ¸å¿ƒæ€æƒ³å¤–ï¼Œè®ºæ–‡è¿˜æå‡ºäº†æ–°çš„æ•°æ®å¢å¼ºçš„æ–¹å¼å’Œæ–°çš„æŸå¤±å‡½æ•°ä»¥æå‡ç½‘ç»œè¡¨ç°ï¼š</p><ol><li>Shape-aware data augmentation</li><li>Consistency loss for soft target</li><li>Orientation-aware distance-IoU loss for hard target </li></ol><h2 id="SE-SSD-Architecture"><a href="#SE-SSD-Architecture" class="headerlink" title="SE-SSD Architecture"></a>SE-SSD Architecture</h2><p><img src="/archives/774e60d7/image-20211014170119221.png"></p><p>SE-SSD çš„æ•´ä½“ç»“æ„éå¸¸çš„ç®€æ´ã€‚ç½‘ç»œçš„è®¡ç®—æœ‰ä¸¤æ¡è·¯çº¿ï¼Œteacher è·¯çº¿ &amp; student è·¯çº¿</p><ol><li><p>Teacher è·¯çº¿ï¼ˆå›¾ä¸­æ ‡ä»¥è“è‰²ç®­å¤´ï¼‰ï¼šå°†åŸå§‹ç‚¹äº‘è¾“å…¥åˆ° Teacher SSD ä¸­äº§ç”Ÿé¢„æµ‹ç»“æœ predictionsï¼Œå¯¹é¢„æµ‹é€‰æ¡†è¿›è¡Œå…¨å±€å˜æ¢ global transformation (including a random translation, flipping, and scaling) ç”Ÿæˆè½¯ç›®æ ‡ soft target</p></li><li><p>Student è·¯çº¿ï¼ˆé€”ä¸­æ ‡ä»¥ç»¿è‰²ç®­å¤´ï¼‰ï¼šå°†åŸå§‹ç‚¹äº‘è¿›è¡Œå…¨å±€å˜æ¢ global transformationï¼Œç„¶åè¿›è¡Œæ•°æ®å¢å¼º shape aware data augmentationï¼Œç”Ÿæˆå¢å¼ºè¿‡åçš„è¾“å…¥å’Œç¡¬ç›®æ ‡ã€‚å°†å¢å¼ºåçš„æ•°æ®è¾“å…¥ Student SSD åšå¤šä»»åŠ¡ï¼šå›å½’ä»»åŠ¡å’Œåˆ†ç±»ä»»åŠ¡ï¼Œæœ€ç»ˆå¾—åˆ°é¢„æµ‹ç»“æœ student predictionsã€‚è¯¥é¢„æµ‹ç»“æœå°†ä¸ç¡¬ç›®æ ‡å’Œè½¯ç›®æ ‡åŒæ—¶è¾“å…¥æŸå¤±å‡½æ•°ï¼Œè¿›è¡Œè®¡ç®—å¹¶ä¼˜åŒ–ç½‘ç»œå‚æ•°</p></li></ol><p>ä»¥ä¸Šå°±æ˜¯æ•´ä½“çš„æµç¨‹ï¼Œä¸‹é¢éœ€è¦å¯¹ Student SSDï¼Œæ•°æ®å¢å¼ºæ–¹æ³•ä»¥åŠæŸå¤±å‡½æ•°è¿›è¡Œè¯¦ç»†çš„äº†è§£</p><h3 id="Architecture-of-Student-SSD"><a href="#Architecture-of-Student-SSD" class="headerlink" title="Architecture of Student SSD"></a>Architecture of Student SSD</h3><p>SSD çš„ç»“æ„ä¸ä½œè€…çš„å‰ä½œæ–‡ç«  CIA-SSD æ˜¯ä¸€è‡´çš„ã€‚è¯¥ç½‘ç»œä¸ºä¸€ä¸ªè½»é‡å‹ç»“æ„ï¼Œä½†æ˜¯æ¨ç†æ•ˆæœä¾ç„¶å¾ˆå¥½ã€‚æŒ‰ç†æ¥è®² SA-SSD å·²ç»å¾ˆå¿«äº†ï¼Œä½†æ˜¯è¯¥æ¨¡å‹æ¯”å…¶æ›´å¿«æ›´å¥½ã€‚è®ºæ–‡ä¸­è§£é‡Šäº†é€Ÿåº¦çš„åŸå› ï¼šCIA-SSD ä½¿ç”¨çš„ channel æ•°å¤§éƒ¨åˆ†éƒ½æ˜¯ SA-SSD çš„ä¸€åŠï¼Œä½†æ˜¯å°†è¯­ä¹‰å’Œç©ºé—´ä¿¡æ¯çš„å­¦ä¹ ç§»åˆ°äº†ä¸»å¹²ç½‘ç»œä¸­ï¼Œç»¼åˆä¹‹ä¸‹èƒœå‡ºã€‚è¿˜æœ‰ä¸€ç¯‡è®ºæ–‡ Voxel R-CNN çš„è¡¨ç°ä¹Ÿéå¸¸ä¼˜ç§€ï¼Œéƒ½åœ¨é€Ÿåº¦å’Œå‡†ç¡®ç‡ä¸Šè¶…è¶Šäº† SA-SSDã€‚è¿™äº›ç»“æœæ˜¯å¦æ„å‘³ç€è¾…åŠ©ç½‘ç»œçš„å½»åº•å¤±è´¥å‘¢ï¼Ÿ</p><p>æˆ‘è®¤ä¸ºè¾…åŠ©ç½‘ç»œæä¾›äº†ä¸€ç§å¯èƒ½æ€§ï¼šå³ä½¿æ˜¯å°æ¨¡å‹ä¹Ÿèƒ½å¤Ÿä½¿ç”¨æ›´å¥½çš„å‚æ•°è¾¾åˆ°ä¸€æµçš„æ•ˆæœã€‚å¹¶ä¸”è¾…åŠ©ç½‘ç»œçš„æ€æƒ³å¾ˆç®€å•ï¼Œèƒ½å¤Ÿè½»æ¾åœ°åŠ å…¥åˆ°å¤§éƒ¨åˆ†çš„ç»“æ„å½“ä¸­ï¼Œè€Œä¸éœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´è¿›è¡Œç»“æ„è®¾è®¡</p><p>ä¸‹é¢å¯¹ CIA-SSD çš„é‡è¦ç»“æ„è¿›è¡Œç®€è¦çš„ä»‹ç»</p><p><img src="/archives/774e60d7/image-20211016161605882.png" style="zoom: 80%;"></p><ol><li>ä½¿ç”¨ç¨€ç–å·ç§¯å°†ä½“ç´ åŒ–ç‚¹äº‘è¿›è¡Œç¼–ç ï¼Œå¹¶è½¬åŒ–ä¸º BEV ç‰¹å¾å›¾è°±</li><li>ä½¿ç”¨ SSFA æ¨¡å—å¯¹ BEV ç‰¹å¾å›¾è°±è¿›è¡Œè¿›ä¸€æ­¥ç‰¹å¾æå–ï¼š<ol><li>ä¿æŒåŸ BEV ç‰¹å¾å›¾è°±çš„å½¢çŠ¶ï¼Œè¿›è¡Œå¤šæ¬¡å·ç§¯ç»§ç»­æå–å°å°ºåº¦çš„ç©ºé—´ç‰¹å¾ spatial groupï¼Œå‡è®¾æœ€ç»ˆå¾—åˆ°ç©ºé—´ç‰¹å¾å›¾è°± $F_{spatial}$</li><li>å°† $F_{spatial}$ ä½œä¸ºè¾“å…¥ï¼Œè¿›ä¸€æ­¥æå–é«˜çº§/æ„Ÿå—é‡æ›´å¤§çš„è¯­ä¹‰ç‰¹å¾ semantic groupï¼Œå‡è®¾æœ€ç»ˆå¾—åˆ°è¯­ä¹‰ç‰¹å¾å›¾è°± $F_{semantic}$</li><li>å°†è¯­ä¹‰ç‰¹å¾è¿›è¡Œä¸Šé‡‡æ ·/åå·ç§¯ upsampling/deconvolution è¾¾åˆ°å’Œç©ºé—´ç‰¹å¾ä¸€æ ·çš„å½¢çŠ¶ï¼Œä»¥å‡†å¤‡èåˆ</li><li>èåˆé˜¶æ®µï¼Œå°†ä¸¤ä¸ªç‰¹å¾å›¾è°±çš„é€šé“æ•°å‹ç¼©ä¸º1ï¼Œå¹¶ä½¿ç”¨ sigmoid å‡½æ•°æ˜ å°„è‡³ 0-1 åŒºé—´ï¼Œå¾—åˆ°ä¸¤ä¸ªæ–°çš„æƒé‡ç‰¹å¾å›¾è°±ã€‚ç„¶åå°†æƒé‡ç‰¹å¾å›¾è°±ä¸åŸæ¥çš„ç‰¹å¾å›¾è°±é€å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°æœ€ç»ˆç”¨äºå¤šä»»åŠ¡çš„ç‰¹å¾å›¾è°± $F$</li></ol></li><li>è¿›è¡Œå¤šä»»åŠ¡é¢„æµ‹ï¼šåˆ†ç±»ä»»åŠ¡ã€IoU é¢„æµ‹ä»»åŠ¡ã€box å›å½’é¢„æµ‹ä»»åŠ¡ã€æ–¹å‘åˆ†ç±»ä»»åŠ¡</li></ol><p>CIA-SSD ä¸­æåˆ°äº†ä¸€äº› trick åœ¨æœ¬è®ºæ–‡ä¹‹ä¸­å‡æ²¡æœ‰ä½¿ç”¨ï¼Œä¸ªäººè§‰å¾—æ¯”è¾ƒå¤æ‚ï¼Œä¸å¤ªå¥½ç†è§£ï¼Œå°±ä¸ç»§ç»­æ·±å…¥ç ”ç©¶äº†ï¼Œè€Œä¸”å¦‚æ˜¯å¥½ trick çš„è¯æœ¬è®ºæ–‡åº”è¯¥ä¼šæ²¿ç”¨ã€‚æ€»ä½“æ¥çœ‹ CIA-SSD çš„ç»“æ„ä¾ç„¶æ˜¯åŠ å¼ºå¯¹å¤šå°ºåº¦ä¿¡æ¯çš„æå–å¹¶è¿›è¡Œèåˆ</p><h3 id="Shape-aware-data-augmentation"><a href="#Shape-aware-data-augmentation" class="headerlink" title="Shape-aware data augmentation"></a>Shape-aware data augmentation</h3><p>ç”±äºç‚¹äº‘æ•°æ®çš„ä¸è§„åˆ™æ€§ï¼Œå¾ˆå¤šç‰©ä½“è¡¨é¢ä¸Šçš„ç‚¹éƒ½æ²¡æœ‰è¢«é‡‡é›†åˆ°ï¼Œè¿™æ˜¯ç‰©ç†å±‚é¢çš„åŸå› ã€‚ä¸ºäº†æ¨¡æ‹Ÿè¿™ç§æ•°æ®ç¼ºå¤±å¹¶å¢åŠ æ ·æœ¬å¤šæ ·æ€§ï¼Œè®ºæ–‡é‡‡å–äº†ä¸‹å›¾æ‰€ç¤ºçš„åšæ³•</p><p><img src="/archives/774e60d7/image-20211016165328812.png" style="zoom: 80%;"></p><p>ç”¨è¯­è¨€ç®€è¦å™è¿°ï¼š</p><ol><li>åœ¨è¿›è¡Œæ“ä½œå‰å…ˆå¯¹æ•°æ®é›†è¿›è¡ŒåŸºæœ¬çš„æ•°æ®å¢å¼º global transformation (including a random translation, flipping, and scaling)</li><li>å°†æ¯ä¸ª3Dé€‰æ¡†åˆ†ä¸º6ä¸ªå­åŒºåŸŸï¼Œæ–¹æ³•ä¸ºå°†é€‰æ¡†é¡¶ç‚¹ä¸é€‰æ¡†ä¸­å¿ƒç›¸è¿æ¥ï¼Œå½¢æˆå…­ä¸ªå››æ£±é”¥</li><li>å¯¹æ¯ä¸ª3Dé€‰æ¡†ï¼Œåœ¨6ä¸ªå­åŒºåŸŸä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå‰”é™¤ï¼Œä»¥æ¨¡æ‹Ÿé‡‡é›†æ—¶ç‚¹äº‘ä¸¢å¤±çš„æƒ…å†µ</li><li>å°†ä¸åŒ3Dé€‰æ¡†ä¹‹é—´çš„å­åŒºåŸŸè¿›è¡Œäº¤æ¢ï¼Œå­åŒºåŸŸçš„ç›¸å¯¹ä½ç½®æ˜¯ä¸€æ ·çš„ï¼Œä¾‹å¦‚å°†ä¸¤ä¸ªé€‰æ¡†çš„å³ä¾§çš„å››æ£±é”¥è¿›è¡Œäº¤æ¢ã€‚è¯¥æ“ä½œå¢åŠ æ ·æœ¬çš„å¤šæ ·æ€§</li><li>å¯¹æ¯ä¸ª3Dé€‰æ¡†ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªå­åŒºåŸŸè¿›è¡Œä¸‹é‡‡æ ·ï¼Œä½¿å…¶æ›´åŠ ç¨€ç–ã€‚é‡‡æ ·æ–¹æ³•ä¸º farthest point sampling (FPS)</li></ol><h3 id="Consistency-loss"><a href="#Consistency-loss" class="headerlink" title="Consistency loss"></a>Consistency loss</h3><p>ä¸ºäº†è®©è½¯ç›®æ ‡ä¸ä¼šå¯¹é¢„æµ‹é€‰æ¡†è¿›è¡Œé”™è¯¯å¼•å¯¼ï¼Œéœ€è¦å…ˆå¯¹è½¯ç›®æ ‡å’Œé¢„æµ‹é€‰æ¡†åŒæ—¶è¿›è¡Œç­›é€‰ï¼š</p><ol><li>å»æ‰ç½®ä¿¡åº¦ä½äºé˜ˆå€¼ $\tau_c$ çš„è½¯ç›®æ ‡å’Œé¢„æµ‹é€‰æ¡†</li><li>ä»…åŒ¹é… IoU é«˜çš„è½¯ç›®æ ‡å’Œé¢„æµ‹é€‰æ¡†ï¼ŒäºŒè€… IoU ä½äºé˜ˆå€¼ $\tau_I$ çš„ä¸è¿›è¡ŒæŸå¤±å‡½æ•° consistency loss è®¡ç®—</li></ol><p>æ•°å­¦è¡¨ç°å½¢å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">\begin{array}{c}\mathcal{L}_{b o x}^{c}=\frac{1}{N^{\prime}} \sum_{i=1}^{N} \mathbb{1}\left(I o U_{i}>\tau_{I}\right) \sum_{e} \frac{1}{7} \mathcal{L}_{\delta_{e}}^{c} \\\\\delta_{e}=\left\{\begin{array}{ll}\left|e_{s}-e_{t}\right| & \text { if } e \in\{x, y, z, w, l, h\} \\\left|\sin \left(e_{s}-e_{t}\right)\right| & \text { if } e \in\{r\}\end{array}\right.\end{array}</script><p>$\mathcal{L}_{\delta_e}^c$ ä¸º smooth L1 lossï¼Œ$N$ å’Œ $Nâ€™$ ä¸ºèµ·å§‹é¢„æµ‹é€‰æ¡†æ•°å’Œç­›é€‰åçš„é€‰æ¡†æ•°ã€‚å¯¹äºåˆ†ç±»ä¹Ÿä½¿ç”¨ç±»ä¼¼çš„æŸå¤±å‡½æ•°</p><script type="math/tex; mode=display">\mathcal{L}_{c l s}^{c}=\frac{1}{N^{\prime}} \sum_{i=1}^{N} \mathbb{1}\left(I o U_{i}>\tau_{I}\right) \mathcal{L}_{\delta_{c}}^{c}\\\delta_{c}=\left|\sigma\left(c_{s}\right)-\sigma\left(c_{t}\right)\right|</script><h3 id="Orientation-aware-distance-IoU-loss"><a href="#Orientation-aware-distance-IoU-loss" class="headerlink" title="Orientation-aware distance-IoU loss"></a>Orientation-aware distance-IoU loss</h3><p>ä¸ºäº†è®©é¢„æµ‹é€‰æ¡†çš„å‡ ä½•å‚æ•°æ›´å…³æ³¨ç›®æ ‡ä¸­å¿ƒå’Œæ—‹è½¬æ–¹å‘ï¼Œè®ºæ–‡è®¾è®¡äº†ç›¸å…³çš„æŸå¤±å‡½æ•°ï¼Œå¼•å¯¼é€‰æ¡†ä¸ç¡¬ç›®æ ‡å¯¹é½</p><script type="math/tex; mode=display">\mathcal{L}_{b o x}^{s}=1-\operatorname{IoU}\left(B_{p}, B_{g}\right)+\frac{c^{2}}{d^{2}}+\gamma(1-|\cos (\Delta r)|)</script><p>$B_p$ å’Œ $B_g$ ä»£è¡¨é¢„æµ‹é€‰æ¡†å’Œç¡¬ç›®æ ‡/æ ‡ç­¾ï¼Œ$c$ ä»£è¡¨ä¸­å¿ƒè·ç¦»ï¼Œ$d$ ä»£è¡¨åŒ…å›´ä¸¤ä¸ªé€‰æ¡†çš„æœ€å°é•¿æ–¹ä½“çš„å¯¹è§’çº¿ï¼Œ$\Delta r$ ä»£è¡¨ä¸¤ä¸ªé€‰æ¡† BEV ç›¸å·®çš„è§’åº¦ï¼Œ$\gamma$ ä¸ºè¶…å‚æ•°ï¼Œå›¾ç¤ºå¦‚ä¸‹</p><p><img src="/archives/774e60d7/image-20211016191827057.png"></p><p>è®ºæ–‡ç”»å‡ºäº† $(1-|cos(\Delta r)|)$ çš„å›¾åƒï¼Œæ–¹å‘å·®åˆ«è¶Šå¤§æŸå¤±å‡½æ•°è¶Šå¤§</p><p><img src="/archives/774e60d7/image-20211016193642630.png" style="zoom: 80%;"></p><p>é™¤äº†å›å½’ä»»åŠ¡ï¼Œè¿˜æœ‰é€‰æ¡†çš„åˆ†ç±»ä»»åŠ¡ï¼Œä»¥åŠé€‰æ¡†æœå‘çš„åˆ†ç±»ä»»åŠ¡ï¼Œä¸¤ä¸ªä»»åŠ¡çš„æŸå¤±å‡½æ•°åˆ†åˆ«ä¸º focal loss å’Œ binary cross entropy lossã€‚æ•…æ•´ä¸ªç½‘ç»œçš„å…¨éƒ¨æŸå¤±å‡½æ•°å†™ä¸º</p><script type="math/tex; mode=display">\mathcal{L}_{\text {student }}=\mathcal{L}_{\text {cls }}^{s}+\omega_{1} \mathcal{L}_{\text {box }}^{s}+\omega_{2} \mathcal{L}_{\text {dir }}^{s}+\mu_{t}\left(\mathcal{L}_{\text {cls }}^{c}+\mathcal{L}_{\text {box }}^{c}\right)</script><p>å‰ä¸‰é¡¹ä¸ºé¢„æµ‹é€‰æ¡†ä¸ç¡¬ç›®æ ‡çš„æŸå¤±å‡½æ•°ï¼Œåˆ†åˆ«å¯¹åº”ï¼šé€‰æ¡†åˆ†ç±»ä»»åŠ¡ï¼Œé€‰æ¡† $(x, y ,z ,w, l, h, \theta)$ å›å½’ä»»åŠ¡ï¼Œé€‰æ¡†æœå‘åˆ†ç±»ä»»åŠ¡</p><p>åä¸¤é¡¹ä¸ºé¢„æµ‹é€‰æ¡†ä¸è½¯ç›®æ ‡çš„æŸå¤±å‡½æ•° consistency lossï¼Œåˆ†åˆ«å¯¹åº”ï¼šåˆ†ç±»ä¸€è‡´æŸå¤±ï¼Œé€‰æ¡†ä¸€è‡´æŸå¤±ã€‚å…¶ä½™å‚æ•°ä¸ºæƒé‡è¶…å‚æ•°ï¼Œå…¶ä¸­ $\mu_t$ éšæ—¶é—´ä»0å¢é•¿è‡³1</p><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><h3 id="KITTI"><a href="#KITTI" class="headerlink" title="KITTI"></a>KITTI</h3><p><img src="/archives/774e60d7/image-20211016200424581.png" style="zoom: 80%;"></p><p>ç›®å‰ï¼ˆ2021/10/16ï¼‰ SE-SSD ä¾æ—§åœ¨ KITTI æ¦œå•ä¸Šæ’åé¡¶å°– $9^{th}$</p><h3 id="Ablation-study"><a href="#Ablation-study" class="headerlink" title="Ablation study"></a>Ablation study</h3><p><img src="/archives/774e60d7/image-20211016202758864.png"></p><p>è®ºæ–‡ä¸­çš„ä¸‰ä¸ªé‡è¦ç»“æ„ï¼Œåœ¨éªŒè¯é›†ä¸Š Easy éš¾åº¦æå‡æ˜¯æœ€å°çš„ï¼Œå› ä¸ºå·²ç»æ¯”è¾ƒå‡†äº†ï¼Œè€Œåœ¨ Moderate å’Œ Hard éš¾åº¦ä¸­éƒ½æå‡äº† 3% å·¦å³ã€‚å…¶ä¸­å¯ä»¥çœ‹åˆ°å•ç‹¬ä½œç”¨æœ€å¤§çš„ç»“æ„ä¸º consistency lossï¼Œè€Œä¸”åœ¨è¯¥ç»“æ„çš„åŠ æŒä¸‹ï¼Œ ODIoU loss çš„æ•ˆæœä¼¼ä¹ä¹Ÿå˜å¾—æ›´å¥½</p><p>å¯¹äº ODIoU ä¸èƒ½ç›´æ¥å»æ‰ï¼Œè®ºæ–‡ä½¿ç”¨çš„æ˜¯ smooth L1 loss ä»£æ›¿</p><h3 id="Consistency-loss-1"><a href="#Consistency-loss-1" class="headerlink" title="Consistency loss"></a>Consistency loss</h3><p><img src="/archives/774e60d7/image-20211016203125284.png" style="zoom:80%;"></p><p>ä¸¤ä¸ªè¡¨åˆ†åˆ«è¯´æ˜äº†ï¼š</p><ol><li><p>åˆ†ç±»å’Œå›å½’ï¼Œä¸¤ä¸ªä»»åŠ¡çš„é¢„æµ‹ç»“æœåŒæ—¶å¯¹é½è½¯ç›®æ ‡æ—¶æ•ˆæœæœ€å¥½</p></li><li><p>å¹¶ä¸”å¯¹è½¯ç›®æ ‡è¿›è¡Œç­›é€‰æ—¶ï¼ŒåŸºäº IoU ç­–ç•¥çš„ç­›é€‰èƒ½å¤Ÿä¿ç•™æ›´å¤šçš„ä¿¡æ¯ã€‚å…¶ä¸­ nms filter ä»£è¡¨çš„æ˜¯ä½¿ç”¨ NMS ç­–ç•¥å¯¹è½¯ç›®æ ‡è¿›è¡Œç­›é€‰ï¼Œ gt filter ä»£è¡¨çš„æ˜¯å‰”é™¤ä¸ ground truth æ ‡ç­¾é‡å çš„è½¯ç›®æ ‡</p></li></ol><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>SE-SSD çš„è¡¨ç°å¯ä»¥è¯´æ˜¯éå¸¸çš„æƒŠè‰³ï¼Œæ‰€ä½¿ç”¨çš„ Teacher-SSD &amp; Student-SSD &amp; soft target æ€æƒ³ç®€å•ä¸”æœ‰æ•ˆï¼Œæˆ–è®¸åœ¨ä¹‹åèƒ½å¤Ÿæˆä¸ºä¸€ç§å¸¸ç”¨çš„æå‡ç½‘ç»œæ•ˆæœçš„æ‰‹æ®µã€‚è®ºæ–‡è®¾è®¡çš„æ•°æ®å¢å¼ºå’ŒæŸå¤±å‡½æ•°ä¹Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç½‘ç»œå‡†ç¡®ç‡ï¼Œè¿™ä¹Ÿè¯´æ˜äº†é™¤äº†ç½‘ç»œç»“æ„æœ¬èº«ï¼Œ<strong>å…¶ä»–çš„ä¿¡æ¯ï¼ˆæ ‡ç­¾ã€æ ·æœ¬ï¼‰ä»¥åŠè¯„ä¼°æ¨¡å‹çš„æ–¹å¼</strong>ä¹Ÿæ˜¯ç›¸å½“é‡è¦çš„ã€‚åœ¨é˜…è¯»æœŸé—´ä¹Ÿæœ‰ä¸€äº›ç–‘é—®å’Œæƒ³æ³•äº§ç”Ÿ</p><p><strong>Q:</strong> åŒæ—¶è½¯ç›®æ ‡ç›¸å¯¹äºé¢„å…ˆè®¾å®šçš„ anchorï¼Œå…·æœ‰æ›´ç²¾ç¡®çš„è¾¹ç•Œæ¡†å’Œç½®ä¿¡åº¦ï¼Œè¿™é‡Œæ˜¯å¦å¯ä»¥å€Ÿé‰´ 2-Stage ä¸­çš„æ€æƒ³ï¼Œå¯¹äºè½¯ç›®æ ‡è¿›ä¸€æ­¥çš„åˆ©ç”¨ï¼Œå°†å…¶ä½œä¸ºæ›´é«˜çº§çš„æ³¨æ„åŠ›æœºåˆ¶</p><p><strong>Q:</strong> å¯¹äºè½¯ç›®æ ‡æ˜¯å¦ä¸€å®šè¦æ¥è‡ªäºè‡ªèº«çš„é›†æˆï¼Œä½¿ç”¨å…¶ä»–æ¨¡å‹çš„æ•ˆæœä¼šå¦‚ä½•ã€‚å¯¹äºé›†æˆæ¨¡å‹çš„å‚æ•°æ›´æ–°æ–¹å¼ä¸ä¸€å®šä½¿ç”¨ EWAï¼Œå¯å¦å€Ÿé‰´å¼ºåŒ–å­¦ä¹ ä¸­çš„æ–¹æ³•ã€‚å¯¹äº consistency loss èƒ½å¦è¿›ä¸€æ­¥æ”¹è¿›ï¼Œæ¯”å¦‚å¢åŠ  IoU ç›¸å…³æŸå¤±</p><p><strong>Q:</strong> ï¼ˆä¸ SA-SSD è”åŠ¨ï¼‰è¾…åŠ©ä»»åŠ¡ä¸è½¯ç›®æ ‡çš„å¼‚æ­¥è¿›è¡Œï¼Œå…ˆä½¿ç”¨è¾…åŠ©å‡½æ•°è¿›è¡ŒåŸºç¡€å­¦ä¹ ï¼Œå†ä½¿ç”¨è½¯ç›®æ ‡è¿›è¡ŒçŸ¥è¯†è’¸é¦</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SE-SSD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SA-SSD</title>
      <link href="/archives/82cec617.html"/>
      <url>/archives/82cec617.html</url>
      
        <content type="html"><![CDATA[<h1 id="SA-SSD"><a href="#SA-SSD" class="headerlink" title="SA-SSD"></a>SA-SSD</h1><hr><p>He, Chenhang, Hui Zeng, Jianqiang Huang, Xian-Sheng Hua, and Lei Zhang. â€œStructure Aware Single-Stage 3D Object Detection From Point Cloud.â€ In <em>2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 11870â€“79. Seattle, WA, USA: IEEE, 2020. <a href="https://doi.org/10.1109/CVPR42600.2020.01189">https://doi.org/10.1109/CVPR42600.2020.01189</a>.</p><hr><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>ç°é˜¶æ®µç‚¹äº‘ç›®æ ‡æ£€æµ‹å¸¸ç”¨ SSD æ–¹æ³•ä¸ºï¼Œä½¿ç”¨å·ç§¯ç½‘ç»œé€æ­¥ç¼©å° feature map å½¢çŠ¶ï¼ŒåŒæ—¶æ„Ÿå—é‡ä¹Ÿåœ¨é€æ¸æé«˜ï¼Œæœ€ç»ˆä½¿ç”¨ downscale çš„ç‰¹å¾å›¾è°±å»åšé€‰æ¡†çš„é¢„æµ‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸å¯é¿å…åœ°ä¼šä¸¢å¤±ç©ºé—´ä¿¡æ¯ï¼š</p><ol><li>åœ¨å°†ç‚¹äº‘è¿›è¡Œä½“ç´ åŒ–æ—¶ä¼šä¸¢å¤±åŸå§‹ç‚¹äº‘çš„ç©ºé—´ä¿¡æ¯</li><li>åœ¨è¿›è¡Œå·ç§¯æ“ä½œæ—¶ï¼Œè™½ç„¶è¿›ä¸€æ­¥æå–äº†å±€éƒ¨ç‰¹å¾ï¼Œä½†åŒæ—¶ä¹Ÿä¼šä¸¢å¤±ç»†èŠ‚ä¿¡æ¯</li></ol><p>ä¸ºäº†è§£å†³ä¿¡æ¯ä¸¢å¤±é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ 2-Stage ç›®æ ‡æ£€æµ‹ç½‘ç»œã€‚åœ¨ç¬¬äºŒé˜¶æ®µå¯ä»¥åˆ©ç”¨æ›´ç²¾ç»†çš„ç©ºé—´ä¿¡æ¯ï¼Œé‡ç‚¹å…³æ³¨ç¬¬ä¸€é˜¶æ®µæå‡ºçš„ RoIï¼Œä»è€Œé¢„æµ‹æ›´åŠ ç²¾å‡†ï¼Œè¿™æ­ç¤ºäº†åˆ©ç”¨ç‚¹äº‘çš„ç»†ç²’åº¦ fine-grained ç©ºé—´ä¿¡æ¯çš„é‡è¦æ€§ã€‚ç„¶è€Œï¼Œå¯¹æ¯ä¸ªç‚¹è¿›è¡Œæ“ä½œå¹¶ä¸ºæ¯ä¸ª RoI é‡æ–°æå–ç‰¹å¾ä¼šå¤§å¤§å¢åŠ è®¡ç®—æˆæœ¬ï¼Œä½¿å¾—ä¸¤é˜¶æ®µæ–¹æ³•éš¾ä»¥è¾¾åˆ°å®æ—¶é€Ÿåº¦</p><p>ä½¿ç”¨è¾…åŠ©ä»»åŠ¡æ¥æå‡ä¸»ä»»åŠ¡çš„è¡¨ç°ï¼Œåœ¨ç›®æ ‡æ£€æµ‹ç½‘ç»œä¸­ä¹Ÿæ˜¯éå¸¸å¸¸è§çš„æ–¹æ³•ã€‚ä¾‹å¦‚åœ¨ PV-RCNN ä¸­åˆ™è¿›è¡Œäº†å‰æ™¯ç‚¹ä»»åŠ¡ï¼Œå¹¶åˆ©ç”¨è¯¥ä»»åŠ¡å¯¹ä¸åŒç‚¹çš„ç‰¹å¾è¿›è¡Œæƒé‡åˆ†é…ï¼Œå‰æ™¯ç‚¹å°†è·å¾—æ›´å¤§çš„æƒé‡ã€‚</p><p>è®ºæ–‡ä½¿ç”¨å¯åˆ†ç¦»è¾…åŠ©ç½‘ç»œæ¥è¡¥å¿æŸå¤±çš„ç©ºé—´ä¿¡æ¯ã€‚è¾…åŠ©ç½‘ç»œçš„è¾“å…¥ä¸º backbone ä¸­ä¸åŒåˆ†è¾¨ç‡çš„ feature mapï¼Œå°†ç‰¹å¾å›¾è°±çš„æ …æ ¼åŒ–ç‰¹å¾è¡¨ç¤ºï¼Œä½¿ç”¨ç‰¹å¾ä¼ æ’­ feature propagation è½¬åŒ–ä¸ºé€ç‚¹çš„ç‰¹å¾è¡¨ç¤ºï¼Œç„¶åä½¿ç”¨é€ç‚¹çš„ç‰¹å¾å»åšä¸¤ä¸ªè¾…åŠ©ä»»åŠ¡ï¼šå‰æ™¯ç‚¹åˆ†ç¦»å’Œä¸­å¿ƒé¢„æµ‹ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¾…åŠ©ç½‘ç»œä¸ä¸»å¹²ç½‘ç»œè¿›è¡Œè”åˆä¼˜åŒ–ï¼Œæ‰€ä»¥ä¸»å¹²ç½‘ç»œçš„ backbone å‚æ•°ä¸­å°†å…·æœ‰åŸå§‹ç‚¹äº‘çš„è¯­ä¹‰ä¿¡æ¯ã€‚è€Œåœ¨è¿›è¡Œæ¨ç†çš„æ—¶å€™ï¼Œè¾…åŠ©ç½‘ç»œå°†ä»ä¸»å¹²ç½‘ç»œä¸­åˆ†ç¦»ï¼Œæ•…ä¸å¢åŠ ä»»ä½•çš„è®¡ç®—</p><p><a href="https://blog.csdn.net/qq_39732684/article/details/105147497">CSDN</a> ä¸Šå¯¹äºè¿™ç¯‡è®ºæ–‡çš„ä»£ç è§£è¯»ï¼Œè¯¥ç½‘ç»œçš„ä»£ç æ„å»ºæ˜¯åŸºäº MMDetection å’Œ SECOND</p><h3 id="ç–‘é—®"><a href="#ç–‘é—®" class="headerlink" title="ç–‘é—®"></a>ç–‘é—®</h3><p>åœ¨ç½‘ç»œä¸­é—´æ’å…¥è¾…åŠ©ä»»åŠ¡çš„åšæ³•ï¼Œæˆ‘åœ¨äºŒç»´ç›®æ ‡æ£€æµ‹ä¸­çš„ä¸€ç¯‡æ–‡ç« ï¼ˆHourglass Networksï¼‰ä¸­ä¹Ÿçœ‹åˆ°è¿‡ç±»ä¼¼çš„ç»“æ„ã€‚ä½†åœ¨ Hourglass ä¸­è¿™ç§åšæ³•å«åšä¸­é—´ç›‘ç£ intermediate supervisionï¼Œä½†è¯¥ç»“æ„åœ¨æ¨ç†ä¸­å¹¶æ²¡æœ‰è¢«åˆ†ç¦»ï¼Œå…¶ä¸­çš„ç‰¹å¾å›¾è°±ç»è¿‡è½¬åŒ–è¿‡åå†ä¸€æ¬¡åŠ å…¥åˆ°äº†ä¸»å¹²ç½‘ç»œä¸­</p><p>å¦‚æœå°† SA-SSD è¾…åŠ©ç½‘ç»œä¸­å­¦ä¹ çš„ç‰¹å¾å†æ¬¡é€å…¥ä¸»å¹²ç½‘ç»œä¹‹ä¸­æ•ˆæœä¼šæ›´å¥½å—ï¼Ÿäº‹å®ä¸Šï¼Œè¿™æ ·å°±å›åˆ°äº† 2-Stage ç›®æ ‡æ£€æµ‹ç½‘ç»œç»“æ„ã€‚ä¾‹å¦‚ PV-RCNN ä¹Ÿæ˜¯å°† voxel-wise ç‰¹å¾è½¬åŒ–ä¸º point-wise ç‰¹å¾ï¼Œå†ä½¿ç”¨ point-wise ç‰¹å¾æ ¹æ® RoI åšé€‰æ¡†ç»†åŒ–ã€‚æ‰€ä»¥éœ€è¦æå‡ºçš„é—®é¢˜ä¸ºï¼šä»€ä¹ˆæ ·çš„è¾…åŠ©ç½‘ç»œç»“æ„ï¼Œèƒ½å¤Ÿè®©ä¸»å¹²ç½‘ç»œæœ‰æ•ˆæå–ç²¾ç»†çš„ç©ºé—´ä¿¡æ¯ã€‚<strong>è¿™ä¸ªé—®é¢˜å°†åˆå¼•ç”³å‡ºä¸¤ä¸ªç–‘é—®ï¼šå¦‚æœè¾…åŠ©ç½‘ç»œçš„å¯¹ç‰¹å¾çš„è½¬æ¢è¿‡äºå¤æ‚ï¼Œé‚£ä¹ˆæ›´æ–°åˆ°ä¸»å¹²ç½‘ç»œä¸­çš„å‚æ•°æ˜¯å¦è¿˜æœ‰æ„ä¹‰ï¼Ÿå¦‚æœé‡‡ç”¨ä¸ä¸»å¹²ç½‘ç»œç›¸ä¼¼çš„ç»“æ„ä½œä¸ºè¾…åŠ©ç½‘ç»œçš„ç»“æ„ï¼Œè¿™ç§ç›¸ä¼¼ç»“æ„æ˜¯å¦ä¼šå¸®åŠ©ç‰¹å¾å­¦ä¹ ï¼Ÿ</strong></p><h2 id="SA-SSD-Architecture"><a href="#SA-SSD-Architecture" class="headerlink" title="SA-SSD Architecture"></a>SA-SSD Architecture</h2><p><img src="/archives/82cec617/image-20211012145648239.png"></p><h3 id="Input-pre-process"><a href="#Input-pre-process" class="headerlink" title="Input pre-process"></a>Input pre-process</h3><p>è®ºæ–‡é‡‡ç”¨äº†ç®€å• floor æ“ä½œï¼Œå°†æ‰€æœ‰ç‚¹çš„åæ ‡æ˜ å°„åˆ°æ …æ ¼ç‚¹ä¸Šã€‚è¿™æ ·çš„é¢„å¤„ç†ä¸ SECOND ç›¸æ¯”ï¼Œä½¿ç”¨æ—¶é—´éå¸¸çŸ­ï¼Œåœ¨æœ€åçš„å®éªŒéƒ¨åˆ†æœ‰å›¾è¡¨</p><script type="math/tex; mode=display">\overline{p_i} = (âŒŠ \frac{x_i}{d_x} âŒ‹, âŒŠ \frac{y_i}{d_y} âŒ‹, âŒŠ \frac{z_i}{d_z} âŒ‹)</script><h3 id="Backbone-network"><a href="#Backbone-network" class="headerlink" title="Backbone network"></a>Backbone network</h3><p>ä¸»å¹²ç½‘ç»œçš„ç»“æ„æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯åŸºäº VoxelNet/SECOND ç½‘ç»œç»“æ„ï¼Œä½¿ç”¨ 3D ç¨€ç–å·ç§¯ sparse convolution è¿›è¡Œç‰¹å¾æå–ã€‚å°†å¾—åˆ°çš„ 3D ç‰¹å¾å›¾è°±é‡å¡‘ reshape ä¸ºäºŒç»´ BEV ç‰¹å¾å›¾è°±è¡¨ç¤ºï¼Œå³å°† z è½´æ–¹å‘çš„ç‰¹å¾è¿æ¥èµ·æ¥ã€‚æœ€ç»ˆä½¿ç”¨è¯¥ BEV ç‰¹å¾å›¾è°±åˆ†ä¸ºå¤´ï¼Œåšé€‰æ¡†é¢„æµ‹ä»»åŠ¡å’Œåˆ†ç±»ä»»åŠ¡</p><h3 id="Detachable-auxiliary-network"><a href="#Detachable-auxiliary-network" class="headerlink" title="Detachable auxiliary network"></a>Detachable auxiliary network</h3><p>è¾…åŠ©ç½‘ç»œçš„ç›®æ ‡æ˜¯å¸®åŠ©ä¸»å¹²ç½‘ç»œæ„ŸçŸ¥ 3D ç‚¹äº‘çš„ç»“æ„ä¿¡æ¯ã€‚ä¸‹é¢è¯¦ç»†åœ°ä»‹ç»è¾…åŠ©ç½‘ç»œçš„ä½¿ç”¨åŠ¨æœº</p><h4 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h4><p>åœ¨ä¸»å¹²ç½‘ç»œæå–ç‚¹äº‘ç‰¹å¾çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä¸æ–­åœ°è¿›è¡Œå·ç§¯æ“ä½œï¼Œè¯¥æ“ä½œä¹Ÿæ˜¯ä¸€ä¸ªä¸‹é‡‡æ ·æ“ä½œï¼Œå°†ä¸å¯é¿å…åœ°ä¸¢å¤±å‡†ç¡®çš„ç©ºé—´ä¿¡æ¯ã€‚å½“ä»…ä½¿ç”¨éƒ¨åˆ†ç‚¹ï¼ˆç”±äºä¸‹é‡‡æ ·çš„åŸå› ï¼‰å¯¹ 3D é€‰æ¡†è¿›è¡Œé¢„æµ‹æ—¶ï¼Œå¦‚æœæ·»åŠ ä¸€äº›å…¶ä»–ä¿¡æ¯è¿›è¡Œè¾…åŠ©ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°å¸®åŠ©é¢„æµ‹ç»“æœï¼Œæ¯”å¦‚ï¼šæ¯ä¸ªç‚¹çš„æ˜¯å¦ä¸ºå‰æ™¯ç‚¹ã€æ¯ä¸ªç‚¹çš„é€‰æ¡†ä¸­å¿ƒåœ¨ä½•å¤„ã€‚æœ‰äº†è¿™äº›è¾…åŠ©ä¿¡æ¯ï¼Œèƒ½å¤Ÿè®©é¢„æµ‹çš„é€‰æ¡†æ›´åŠ å‡†ç¡®</p><p><img src="/archives/82cec617/image-20211012165858427.png"></p><p>å—æ­¤å¯å‘ï¼Œæœ€ç®€å•æ“ä½œä¸ºï¼Œç›´æ¥ä½¿ç”¨æ›´å¤šçš„ç½‘ç»œæ¥å®Œæˆå¯¹äºè¾…åŠ©ä¿¡æ¯çš„é¢„æµ‹ï¼Œç„¶åå†å°†è¿™äº›è¾…åŠ©ç‰¹å¾ã€ä¿¡æ¯ä¸ä¸»å¹²ç½‘ç»œçš„ç‰¹å¾ç›¸è¿æ¥ï¼Œè¿›è¡Œæœ€ç»ˆçš„é¢„æµ‹ã€‚ä½†æ˜¯è¿™äº›ç½‘ç»œå°†ä¼šä½¿ç”¨æ›´å¤šçš„è®¡ç®—èµ„æºï¼Œæœ¬è®ºæ–‡åˆ™å¸Œæœ›åœ¨ä¸å¢åŠ è®¡ç®—èµ„æºçš„åŒæ—¶è·å¾—è¿™äº›è¾…åŠ©ä»»åŠ¡çš„ç‰¹å¾ä¸ä¿¡æ¯ï¼ŒåŸºäºæ­¤æå‡ºäº†å¯åˆ†ç¦»è¾…åŠ©ç½‘ç»œã€‚è¯¥è¾…åŠ©ç½‘ç»œåœ¨è®­ç»ƒæ—¶ä¸ä¸»å¹²ç½‘ç»œè”åˆä¼˜åŒ–ï¼Œè€Œåœ¨æ¨ç†æ—¶å°†ä»ä¸»å¹²ç½‘ç»œä¸­åˆ†ç¦»ï¼Œä¹Ÿå³åœ¨è®­ç»ƒæ—¶ç”±äºè¾…åŠ©ç½‘ç»œçš„å¼•è¿›ä¼šå¢åŠ æ›´å¤šçš„è®¡ç®—ï¼Œä½†åœ¨æ¨ç†æ—¶æ²¡æœ‰å…¶ä»–å¤šä½™çš„è®¡ç®—ï¼Œä¿æŒä¸»å¹²ç½‘ç»œçš„é«˜æ•ˆç‡</p><h3 id="Point-wise-feature-representation"><a href="#Point-wise-feature-representation" class="headerlink" title="Point-wise feature representation"></a>Point-wise feature representation</h3><p>ä¸ºè§£å†³ä»¥ä¸Šæå‡ºçš„é—®é¢˜ï¼Œè®ºæ–‡çš„è§£å†³æ–¹æ¡ˆä¸ºï¼šæ„å»ºä¸€ä¸ªå…·æœ‰ç‚¹çº§ point-level ç›‘ç£çš„è¾…åŠ©ç½‘ç»œï¼Œä»¥å¼•å¯¼ä¸»å¹²ç½‘ç»œåœ¨ä¸åˆ†è¾¨ç‡çš„ç‰¹å¾å›¾è°±å»å­¦ä¹ æ›´ç»†ç²’åº¦çš„ç»“æ„ã€‚è¯¥å¼•å¯¼ä¸ºéšæ€§çš„å¼•å¯¼ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€šè¿‡è¾…åŠ©ä»»åŠ¡å’Œåå‘è½¬æ’­å»è°ƒæ•´ä¸»å¹²ç½‘ç»œä¸­çš„å‚æ•°ï¼Œä½¿å¾—ä¸»å¹²ç½‘ç»œè·å¾—æ›´ç»†èŠ‚çš„ç‰¹å¾ä¿¡æ¯ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li><p>ä½¿ç”¨ç‰¹å¾ä¼ æ’­ feature propagationï¼Œå°†ä¸åŒåˆ†è¾¨ç‡ä¸‹çš„ voxel-level ç‰¹å¾è½¬åŒ–ä¸º point-level ç‰¹å¾ï¼Œè¯¥æ“ä½œä¸ PointNet++ ä¸­çš„ç‰¹å¾ä¼ æ’­æ˜¯ä¸€è‡´çš„ï¼Œæ˜¯åŸºäºç©ºé—´è·ç¦»çš„æ’å€¼æ“ä½œ inverse distance weighted average </p><script type="math/tex; mode=display">f^{(j)}(x)=\frac{\sum_{i=1}^{k} w_{i}(x) f_{i}^{(j)}}{\sum_{i=1}^{k} w_{i}(x)} \quad \text { where } \quad w_{i}(x)=\frac{1}{d\left(x, x_{i}\right)^{p}}, j=1, \ldots, C</script><p>è€Œè¿™äº›æ’å€¼ç‚¹çš„æ¥æºè®ºæ–‡ä¸­å¹¶æ²¡æœ‰æåŠï¼Œä½†æ˜¯æ¯ä¸€ä¸ª voxel-level ç‰¹å¾æ‰€è½¬æ¢å‡ºæ¥çš„ point-level ç‰¹å¾åº”è¯¥éƒ½æ˜¯ç›¸åŒå½¢çŠ¶çš„</p></li><li><p>å°†ä¸åŒåˆ†è¾¨ç‡ä¸‹å¾—åˆ°çš„ point-level ç‰¹å¾è¿æ¥èµ·æ¥ä½¿ç”¨ shared MLP è¿›è¡Œç¼–ç ï¼ˆåœ¨è®ºæ–‡çš„ä»£ç ä¸­å¹¶æ²¡æœ‰ä½“ç°ï¼‰</p></li><li>å°†ç¼–ç å¾—åˆ°çš„ç‰¹å¾ï¼Œä½¿ç”¨ MLP å»é¢„æµ‹ä¸¤ä¸ªç»“æœï¼šæ¯ä¸ªç‚¹çš„å±äºå‰æ™¯ç‚¹çš„æ¦‚ç‡ï¼Œå‰æ™¯ç‚¹åˆ°ç›®æ ‡ä¸­å¿ƒçš„åç§»é‡ã€‚è¿™é‡Œçš„ unit point convolutions åº”è¯¥è¿˜æ˜¯</li></ol><p>ä¸¤ä¸ªä»»åŠ¡çš„æŸå¤±å‡½æ•°ä¹Ÿæ˜¯å¸¸è§„çš„ focal loss å’Œ smooth L1 lossï¼Œä¸” L1 loss ä»…é’ˆå¯¹äºå‰æ™¯ç‚¹</p><script type="math/tex; mode=display">\mathcal{L}_{\mathrm{seg}}=\frac{1}{N_{\text {pos }}} \sum_{i}^{N}-\alpha\left(1-\hat{s}_{i}\right)^{\gamma} \log \left(\hat{s}_{i}\right)\\where \ \hat{s}_{i}=\left\{\begin{array}{ll}\tilde{s}_{i} & \text { if } s_{i}=1 \\1-\tilde{s}_{i} & \text { otherwise. }\end{array}\right.</script><script type="math/tex; mode=display">\mathcal{L}_{\mathrm{ctr}}=\frac{1}{N_{\text {pos }}} \sum_{i}^{N} \text { Smooth- } l_{1}(\Delta \tilde{\mathbf{p}}-\Delta \mathbf{p}) \cdot \mathbb{1}\left[s_{i}=1\right]</script><h3 id="Part-sensitive-warping"><a href="#Part-sensitive-warping" class="headerlink" title="Part-sensitive warping"></a>Part-sensitive warping</h3><p>å¦‚æœä½¿ç”¨ anchor-based æ–¹æ³•è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œä¾‹å¦‚ï¼šFaster RCNNï¼Œä¼šå‡ºç°é¢„æµ‹é€‰æ¡†ä¸åˆ†ç±»ç½®ä¿¡åº¦ä¹‹é—´å¹¶ä¸åŒ¹é…ã€‚åˆ†ç±»ç½®ä¿¡åº¦çš„ç‰¹å¾æ¥æºæ˜¯ç”±é¢„å…ˆè®¾å€¼çš„ anchor å†³å®šçš„ï¼Œè€Œä¸æ˜¯æ¥è‡ªæ‰€é¢„æµ‹çš„é€‰æ¡†ã€‚ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œè®ºæ–‡æå‡ºäº† part-sensitive warping operation (PSWarp) ç”¨äºçŸ«æ­£è¿™ä¸€ä¸åŒ¹é…ç°è±¡ï¼Œå…¶ä¸­å¿ƒæ€æƒ³ä¸ºï¼šè®©é¢„æµ‹é€‰æ¡†çš„åˆ†ç±»ç½®ä¿¡åº¦ï¼Œæ¥è‡ªäºè¯¥é€‰æ¡†åŒºåŸŸå¯¹åº”çš„åˆ†ç±»ç‰¹å¾å›¾è°±åŒºåŸŸã€‚å…·ä½“æ“ä½œæ›´åŠ å¤æ‚ä¸€ç‚¹ï¼ˆä¸ªäººä¸å¤ªå–œæ¬¢è¿™ä¸€éƒ¨åˆ†ï¼‰</p><ol><li><p>å°†åˆ†ç±»ç‰¹å¾å›¾è°±æ”¹å˜ç»´åº¦ï¼Œä» $(W, L, F)$ è‡³ $(W,L,C, K)$ å…¶ä¸­ C è¡¨ç¤ºç±»åˆ«æ•°é‡ï¼ŒK è¡¨ç¤ºå°†é¢„æµ‹é€‰æ¡†çš„ä¿¯è§†å›¾å¹³å‡åˆ†æˆäº† K ä»½ï¼ˆè®ºæ–‡å°†é€‰æ¡†åˆ†ä¸ºäº† 4x7=28 ä»½ï¼‰</p></li><li><p>å°†é¢„æµ‹é€‰æ¡†çš„ä¿¯è§†å›¾å¹³å‡åˆ†ä¸º K ä»½åï¼Œå–æ¯ä¸€ä¸ªéƒ¨åˆ†çš„ä¸­å¿ƒç‚¹ä½œä¸ºé‡‡æ ·ç‚¹ï¼Œå†ä½¿ç”¨åŒçº¿æ€§æ’å€¼ bilinear interpolation è·å¾—é‡‡æ ·ç‚¹çš„ç‰¹å¾å€¼ã€‚ä¸ºäº†æ›´å…·ä½“çš„è¯´æ˜æ’å€¼è¿‡ç¨‹ï¼Œå°†è¿™ K ä¸ªé‡‡æ ·ç‚¹è¿›è¡Œç¼–å· $\{S_k: k=1, 2,â€¦,K\}$ï¼Œå‡è®¾ç¬¬ i ä¸ªé‡‡æ ·ç‚¹ $S_i$ å…¶æ’å€¼å‚è€ƒçš„ç‰¹å¾å›¾è°± feature map $\mathcal{X}$ ä¹Ÿä¸ºç¬¬ i ä¸ªï¼Œå³ $(W,L,C,i)$ è®°ä¸º $\mathcal{X^i}$ã€‚ä»£æ•°è¿‡ç¨‹å¦‚ä¸‹</p><script type="math/tex; mode=display">\mathcal{C}_{p}=\frac{1}{K} \sum_{k=1}^{K} \sum_{i\in\{\lfloor{u^k}\rfloor ,\lfloor{u^k+1}\rfloor\}\atop  j\in\{\lfloor{v^k}\rfloor ,\lfloor{v^k+1}\rfloor\}} \mathcal{X_{ij}^k}\times b(i,j,u^k,v^k)</script><p>ä»£ç å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/themasterbi/article/details/106913582">CSDN</a>ï¼Œè¿™ç¯‡åšå®¢çš„æ‰€å†™çš„æºä»£ç æ³¨é‡Šï¼Œæ˜¯ä¼—å¤šåšå®¢ä¸­è®©æˆ‘å”¯ä¸€ç†è§£çš„æ³¨é‡Šï¼Œä¸ç„¶é€šè¿‡è®ºæ–‡ä¸­çš„æ–‡å­—å¾ˆéš¾ç†è§£ PSWarp æ“ä½œã€‚æœ€ç»ˆè·å¾—è¾“å‡º $(K, 1, N, 1)$ï¼Œå…¶ä¸­ $N$ ä¸ºè¯¥åœºæ™¯ä¸­é¢„æµ‹é€‰æ¡†çš„æ•°é‡ã€‚å›¾ç¤ºå¦‚ä¸‹</p><p><img src="/archives/82cec617/image-20211013182126400.png" style="zoom:80%;"></p></li><li><p>å– K ä¸ªé‡‡æ ·ç‚¹ç‰¹å¾å€¼çš„å¹³å‡å€¼ä½œä¸ºåˆ†ç±»è¯„åˆ†ï¼Œæœ€åä½¿ç”¨ sigmoid å‡½æ•°è·å¾—åˆ†ç±»ç½®ä¿¡åº¦</p></li></ol><p>å°†è¾…åŠ©ä»»åŠ¡å’Œä¸»ä»»åŠ¡çš„æŸå¤±å‡½æ•°ä¹˜ä»¥æƒé‡è¶…å‚æ•°ï¼Œç›¸åŠ åå¾—åˆ°æ•´ä¸ªç½‘ç»œçš„æŸå¤±å‡½æ•°</p><script type="math/tex; mode=display">\mathcal{L}=\mathcal{L}_{\text {cls }}+\omega \mathcal{L}_{\text {box }}+\mu \mathcal{L}_{\text {seg }}+\lambda \mathcal{L}_{\text {ctr }}</script><p>å‰ä¸¤é¡¹å³ä¸ºä¸»ä»»åŠ¡çš„åˆ†ç±»ä»»åŠ¡å’Œé¢„æµ‹é€‰æ¡†ä»»åŠ¡ï¼Œåä¸¤é¡¹ä¸ºè¾…åŠ©ä»»åŠ¡çš„åˆ†å‰²ä»»åŠ¡å’Œé¢„æµ‹ä¸­å¿ƒä»»åŠ¡ã€‚æ‰€æœ‰çš„åˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡éƒ½æ˜¯ focal loss å’Œ smooth L1 loss</p><p>æŸå¤±å‡½æ•°æ²¡æœ‰ä½¿ç”¨åˆ° IoU ç›¸å…³çš„éƒ¨åˆ†ï¼ŒIoU å…¶å®æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„ç»¼åˆè¯„ä¼°æ ‡å‡†ï¼ŒåŒ…å«äº†ä¸å°‘çš„ä¿¡æ¯ã€‚ä¹‹åå¯ä»¥è€ƒè™‘åŠ å…¥é¢„æµ‹ IoU çš„ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡æˆ–è®¸å¯¹åŸç½‘ç»œæœ‰ä¸é”™çš„ä¼˜åŒ–</p><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><h3 id="Train"><a href="#Train" class="headerlink" title="Train"></a>Train</h3><p>åœ¨ RPN ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç”±äº anchor-based å±æ€§ï¼Œéœ€è¦æä¾› anchor çš„ positive/negative å±æ€§ä»¥è¿›è¡Œåˆ†ç±»ä»»åŠ¡çš„è®­ç»ƒï¼Œå…¶ IoU é˜ˆå€¼åˆ†åˆ«ä¸º0.6å’Œ0.45ã€‚åœ¨æ¨ç†é˜¶æ®µä½¿ç”¨é˜ˆå€¼ä¸º0.1çš„ NMS æ“ä½œ </p><h3 id="KITTI"><a href="#KITTI" class="headerlink" title="KITTI"></a>KITTI</h3><p><img src="/archives/82cec617/image-20211013184635247.png"></p><h3 id="Weight-selection-of-auxiliary-tasks"><a href="#Weight-selection-of-auxiliary-tasks" class="headerlink" title="Weight selection of auxiliary tasks"></a>Weight selection of auxiliary tasks</h3><p><img src="/archives/82cec617/image-20211013184733794.png"></p><p>è®ºæ–‡é‡‡ç”¨ $\mu=0.9,\lambda=2$</p><h3 id="Ablation-study-amp-compare"><a href="#Ablation-study-amp-compare" class="headerlink" title="Ablation study &amp; compare"></a>Ablation study &amp; compare</h3><p><img src="/archives/82cec617/image-20211013185112410.png"></p><p>å¯ä»¥çœ‹å‡º3ä¸ªç‰¹æ®Šè®¾è®¡å„æœ‰0.5%å·¦å³çš„æå‡ï¼Œæœ€ç»ˆæä¾›äº†æ¥è¿‘1.5%çš„æå‡ï¼ŒåŒæ—¶ç½‘ç»œé€Ÿåº¦ä¹Ÿä¿æŒå¾—ç›¸å½“ä¸é”™</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>è®ºæ–‡åˆ›æ–°æ€§åœ°ä½¿ç”¨äº†å¯åˆ†ç¦»è¾…åŠ©ç½‘ç»œï¼Œåœ¨æ¨ç†æ—¶ä¸å¢åŠ é¢å¤–è®¡ç®—é‡ï¼ŒåŒæ—¶æå‡äº†æœ€ç»ˆçš„è¡¨ç°ã€‚å¯ä»¥æ„Ÿè§‰è¯¥æ€æƒ³æ˜¯ä¸€ä¸ªä¸é”™çš„çªç ´å£ï¼Œä½†æ˜¯è¿™èƒŒåç•™ä¸‹äº†æ›´å¤šçš„ç–‘é—®ï¼šè¾…åŠ©ç½‘ç»œçš„å…·ä½“ç»“æ„åº”è¯¥å¦‚ä½•è®¾è®¡ï¼Œæ˜¯è¯¥ç®€å•ï¼Œè¿˜æ˜¯è¯¥å¤æ‚ï¼Œæˆ–è€…éƒ½ä¸æ˜¯ï¼›è¯¥æ–¹æ³•æ˜¯å¦èƒ½ç§°ä¸ºä¸€ç§ä¸»æµçš„æ–¹æ³•ï¼Œå°†æ•´ä¸ªç›®æ ‡æ£€æµ‹çš„æ¡†æ¶å¸¦åˆ°ä¸€ä¸ªæ–°çš„å°é˜¶ä¸Šï¼›ç»†ç²’åº¦ä¿¡æ¯åº”è¯¥ä»¥æ€æ ·çš„è¡¨ç¤ºæ–¹æ³•åŠ å…¥åˆ°å…¶ä¸­ï¼Œå°¤å…¶ä¸ 2-Stage æ–¹æ³•åšæ¯”è¾ƒï¼Œç›´æ¥çš„ç‰¹å¾åŠ å…¥å’Œé—´æ¥çš„ç‰¹å¾å¼•å¯¼å­¦ä¹ ï¼Œä¸¤è€…è¯¥æ€ä¹ˆè¡¡é‡â€¦</p><p>PSWarp æ–¹æ³•æƒ³è¦è§£å†³çš„å›°éš¾æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¹Ÿå°±æ˜¯ç½®ä¿¡åº¦ä¸é€‰æ¡†ä¸åŒ¹é…é—®é¢˜ã€‚ä½†è¯¥æ–¹æ³•æ˜¯å¦ä¸ºè§£å†³è¯¥é—®é¢˜æœ€å¥½çš„ï¼Œæˆ–è®¸å…¶ä»–è®ºæ–‡æœ‰æ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Œè¿˜æœ‰å¾…ç»§ç»­å­¦ä¹ </p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SA-SSD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CenterPoint</title>
      <link href="/archives/807a20df.html"/>
      <url>/archives/807a20df.html</url>
      
        <content type="html"><![CDATA[<h1 id="CenterPoint"><a href="#CenterPoint" class="headerlink" title="CenterPoint"></a>CenterPoint</h1><hr><p>Yin, Tianwei, Xingyi Zhou, and Philipp KrÃ¤henbÃ¼hl. â€œCenter-Based 3D Object Detection and Tracking.â€ <em>ArXiv:2006.11275 [Cs]</em>, January 6, 2021. <a href="http://arxiv.org/abs/2006.11275">http://arxiv.org/abs/2006.11275</a>.</p><hr><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><h3 id="ä¸‰ç»´ç›®æ ‡æ£€æµ‹éš¾ç‚¹"><a href="#ä¸‰ç»´ç›®æ ‡æ£€æµ‹éš¾ç‚¹" class="headerlink" title="ä¸‰ç»´ç›®æ ‡æ£€æµ‹éš¾ç‚¹"></a>ä¸‰ç»´ç›®æ ‡æ£€æµ‹éš¾ç‚¹</h3><p>ä¸äºŒç»´ç›®æ ‡æ£€æµ‹ç›¸æ¯”ï¼Œä¸‰ç»´ç›®æ ‡æ£€æµ‹æœ‰å‡ ä¸ªåŸºæœ¬çš„éš¾ç‚¹</p><ol><li><p>ç‚¹äº‘æ•°æ®çš„ç¨€ç–æ€§ï¼Œæœ‰å¤§é‡çš„ç©ºé—´æ²¡æœ‰ç‚¹äº‘ </p></li><li><p>é€‰æ¡†çš„è‡ªç”±åº¦é«˜ï¼Œä¸ä»…æœ‰æ›´çµæ´»çš„æ–¹å‘ï¼Œè¿˜æœ‰æ›´å¤šçš„å°ºå¯¸</p></li></ol><h3 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h3><p>CenterPoint æ˜¯ä¸€ä¸ª 2-Stage ä¸‰ç»´ç›®æ ‡æ£€æµ‹ç½‘ç»œï¼Œæ˜¯ center-based ç³»åˆ—æ€æƒ³åœ¨ä¸‰ç»´ä¸­çš„åº”ç”¨ï¼Œå…¶å‰ä½œ CenterNet (Objects as Points) åœ¨äºŒç»´ç›®æ ‡æ£€æµ‹ä¸­æœ‰ä¸é”™çš„æ•ˆæœï¼ŒåŒæ—¶ä¹Ÿåœ¨ CenterPoint ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚æœ¬è®ºæ–‡æå‡ºçš„æ˜¯ä¸€ç§åŸºæœ¬æ¡†æ¶ï¼Œä½¿ç”¨ center-based æ€æƒ³èƒ½å¤Ÿä¸åŒç¨‹åº¦æå‡ backbone çš„è¡¨ç°ï¼ˆçº¦ 3-4 mAPï¼‰ã€‚å†ç»è¿‡ç¬¬äºŒé˜¶æ®µçš„ç»†åŒ– refinement è¿˜èƒ½å¤Ÿç»§ç»­æå‡çº¦ 2 mAP çš„è¡¨ç°ï¼Œä¸”ç‰ºç‰²çš„è®¡ç®—è¾ƒå°‘ï¼Œæ§åˆ¶åœ¨ 10% ä»¥å†…ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ä¸¤ä¸ªé˜¶æ®µçš„è¿‡ç¨‹ï¼š</p><ol><li>é¦–å…ˆä½¿ç”¨ 3D backbone æå–ç‚¹äº‘ç‰¹å¾ï¼Œè¯¥ç‰¹å¾æ˜¯ä»¥ map-view çš„å½¢å¼ï¼ˆä¿¯è§†æ …æ ¼ï¼‰å‘ˆç°ã€‚ç¬¬ä¸€é˜¶æ®µ Stage-1 ä½¿ç”¨ map-view features æ£€æµ‹å„ä¸ªç›®æ ‡ç‚¹çš„ä¸­å¿ƒä½ç½®ï¼Œç„¶åä½¿ç”¨ä¸­å¿ƒä½ç½®çš„ç‰¹å¾å›å½’é¢„æµ‹ 3D é€‰æ¡†çš„å…¶ä»–å±æ€§ï¼ŒåŒ…æ‹¬å¤§å°ã€æ–¹å‘ã€é€Ÿåº¦ç­‰</li><li>ç¬¬äºŒé˜¶æ®µ Stage-2 ä½¿ç”¨æ›´å¤šçš„ç›¸å…³ç‚¹çš„ç‰¹å¾æ¥å¯¹é€‰æ¡†è¿›è¡Œç»†åŒ–</li></ol><h2 id="CenterPoint-Architecture"><a href="#CenterPoint-Architecture" class="headerlink" title="CenterPoint Architecture"></a>CenterPoint Architecture</h2><h3 id="3D-æ£€æµ‹ç½‘ç»œé€šç”¨æ¡†æ¶"><a href="#3D-æ£€æµ‹ç½‘ç»œé€šç”¨æ¡†æ¶" class="headerlink" title="3D æ£€æµ‹ç½‘ç»œé€šç”¨æ¡†æ¶"></a>3D æ£€æµ‹ç½‘ç»œé€šç”¨æ¡†æ¶</h3><p>è®ºæ–‡é‡Œæäº†ä¸€ä¸‹ç°ä»£ 3D detector çš„å¸¸è§å¤„ç†è¿‡ç¨‹ã€‚é¦–å…ˆæ˜¯ä½¿ç”¨ä¸€ä¸ª backbone å¯¹ç‚¹äº‘æ•°æ®è¿›è¡Œç‰¹å¾æå–ï¼Œè¯¥ backbone ä¹Ÿå¯ä»¥å«åš encoderã€‚backbone çš„è¾“å‡ºä¸ºä¸€ä¸ª map-view feature map $M\in R^{W\times L\times F}$ï¼Œå…¶ä¸­ W &amp; L ä¸º width &amp; length å’Œä¸‰ç»´åœºæ™¯çš„é•¿å®½ç›¸å…³ï¼ŒF ä¸ºç‰¹å¾ç»´åº¦çš„å¤§å°æˆ–è€…ç§°ä¸º channel numberã€‚è®ºæ–‡ä¸­é‡‡ç”¨çš„ backbone æœ‰ä¸¤ä¸ª VoxelNet &amp; PointPillarsï¼ˆå»ºè®®äº†è§£ä¸€ä¸‹è¿™ä¸¤ä¸ªç½‘ç»œï¼‰ï¼Œå¯¹è¿™ä¸¤ä¸ª backbone åšäº†å®éªŒå’Œæ¯”è¾ƒ</p><p>ç„¶åå¸¸ä½¿ç”¨ bounding box detector åœ¨è¯¥ feature map ä¸Šè¿›è¡Œæ£€æµ‹ã€‚è¿™æ ·çš„ detector åœ¨äºŒç»´å½“ä¸­æœ‰å¾ˆå¤šå¯ä»¥å€Ÿé‰´çš„ç½‘ç»œï¼Œè®ºæ–‡ä½¿ç”¨äº† CenterNet è€Œä¸æ˜¯å¸¸è§„çš„ anchor-based ç½‘ç»œã€‚ä¸‹å›¾å³ä¸º CenterPoint ç»“æ„ç¤ºæ„å›¾ï¼Œæ¥ä¸‹æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹ä¸¤ä¸ªé˜¶æ®µçš„ç»†èŠ‚</p><p><img src="/archives/807a20df/2f857fd4-fe6f-447b-9817-c1a9079d245e.png" style="zoom: 80%;"></p><h3 id="Stage-1"><a href="#Stage-1" class="headerlink" title="Stage-1"></a>Stage-1</h3><p>ç¬¬ä¸€é˜¶æ®µåŸºæœ¬ä¸Šå°±æ˜¯ CenterNet æ€æƒ³çš„å¤åˆ»ï¼Œä¸ç®¡æ˜¯ä¸­å¿ƒé¢„æµ‹ï¼Œè¿˜æ˜¯å›å½’å…¶ä»–å±æ€§ï¼Œæ‰€ä»¥ç»†èŠ‚éƒ¨åˆ†è¯·é˜…è¯» Objects as Pointsã€‚è¿™äº›é¢„æµ‹éƒ½å±äº dense prediction ä¹Ÿå°±æ˜¯è¯´æ¯ä¸€ä¸ªæ …æ ¼ bin éƒ½ä¼šæœ‰è‡ªå·±çš„é¢„æµ‹ç»“æœï¼Œæ‰€æœ‰çš„ç¬¬ä¸€é˜¶æ®µç½‘ç»œéƒ½æ˜¯å¸¸è§çš„å·ç§¯ç½‘ç»œ</p><h4 id="Center-heatmap-head"><a href="#Center-heatmap-head" class="headerlink" title="Center heatmap head"></a>Center heatmap head</h4><p>é¦–å…ˆéœ€è¦ä½¿ç”¨ feature map é¢„æµ‹å„ä¸ªç›®æ ‡çš„ä¸­å¿ƒç‚¹åœ¨å“ªé‡Œã€‚è¿™é‡Œçš„è¿‡ç¨‹å’Œ CenterNet æ˜¯ç›¸ä¼¼çš„ï¼Œä¸‹é¢åˆ—å‡ºå…¶ä¸­çš„å…³é”®éƒ¨åˆ†ï¼š</p><ol><li><p>æ ‡ç­¾ labelï¼šå°† ground truth ä¸­å¿ƒç‚¹çš„ä½ç½®æ˜ å°„åˆ° feature map ä¸­å½¢æˆä¸­å¿ƒç‚¹çš„ heatmap $Y\in [0,1]^{W\times L\times C}$ï¼Œå…¶ä¸­ C ä¸ºç±»åˆ«æ•°é‡ã€‚è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ª 0~1 çš„åŒºé—´ï¼Œæ˜¯ç”±äºè¯¥æ ‡ç­¾å¹¶ä¸æ˜¯ç¡¬æ ‡ç­¾ï¼Œè€Œæ˜¯ä½¿ç”¨äº†é«˜æ–¯æ ¸ï¼Œå°†è¯¥æ ‡ç­¾é™„è¿‘çš„æ …æ ¼ä¹Ÿä½œä¸ºäº†è½¯ç›®æ ‡ä¸­å¿ƒï¼Œå…¶è®¡ç®—å½¢å¦‚ä¸‹é¢çš„å…¬å¼</p><script type="math/tex; mode=display">Y_{xyc}=\exp \left(-\frac{\left(x-\tilde{p}_{x}\right)^{2}+\left(y-\tilde{p}_{y}\right)^{2}}{2 \sigma_{p}^{2}}\right)</script></li><li><p>æŸå¤±å‡½æ•° loss functionï¼šfocal loss</p></li></ol><p>ä»¥ä¸Šä¸¤ä¸ªæ“ä½œéƒ½æ˜¯åŸºäºç‚¹äº‘çš„ç¨€ç–æ€§ã€æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡è€Œè®¾è®¡ã€‚åˆ¶ä½œè½¯æ ‡ç­¾çš„åŸå› æ˜¯åœ¨äºä¸­å¿ƒç‚¹çš„èŒƒå›´å®åœ¨å¤ªå°ï¼Œå¿…é¡»å°†å…¶è¾å°„å‡ºå»ï¼›è€Œä½¿ç”¨ focal loss ä¹Ÿæ˜¯å› ä¸ºèƒŒæ™¯ç‚¹å¤ªå¤šï¼Œè€Œä¸­å¿ƒç‚¹å¤ªå°‘</p><h4 id="Regression-heads"><a href="#Regression-heads" class="headerlink" title="Regression heads"></a>Regression heads</h4><p>ä¸ºäº†é¢„æµ‹é€‰æ¡†ï¼Œè¿˜éœ€è¦é¢„æµ‹å…¶ä»–çš„å±æ€§</p><ol><li><strong>æ …æ ¼åå·®</strong> offsetï¼Œç”±äºä¸­å¿ƒç›®æ ‡ç‚¹æ˜¯è¢«æ˜ å°„åˆ°äº†æ …æ ¼ä¸­ï¼Œå¹¶ä¸æ˜¯ç²¾å‡†çš„ï¼Œæ‰€ä»¥éœ€è¦é¢„æµ‹ä¸€ä¸ªåå·®å€¼è¿›è¡Œä¿®æ­£ a sub-voxel location refinement $o \in R^2$ , The subvoxel location refinement o reduces the quantization error</li><li><strong>é«˜åº¦</strong> height-above-ground $h_g \in R$, The height-above-ground hg helps localize the object in 3D and adds the missing elevation information removed by the mapview projection</li><li><strong>é€‰æ¡†å¤§å°</strong> the 3D size $s \in R^3$ </li><li><strong>é€‰æ¡†æ–¹å‘</strong> and a yaw rotation angle $(sin(Î±), cos(Î±)) \in R^2$ </li></ol><p>æŸå¤±å‡½æ•°å¯¹äºä¸­å¿ƒ center ä½¿ç”¨çš„ä¸€èˆ¬ L1 lossï¼Œå¯¹äºé€‰æ¡†å¤§å° size å®é™…é¢„æµ‹çš„æ˜¯å¯¹æ•°å¤§å° logarithmic sizeï¼Œç„¶åå†è®¡ç®— L1 lossã€‚ä½¿ç”¨å¯¹æ•°å¤§å°ï¼Œå¯¹äºä¸åŒå½¢çŠ¶çš„é€‰æ¡†æ›´å¯èƒ½æ›´æœ‰ä¼˜åŠ¿ï¼ŒæŸå¤±å‡½æ•°çš„æ›²çº¿ä¼šæ›´å¹³æ»‘ä¸€äº›</p><p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ‰€æœ‰çš„æŸå¤±å‡½æ•°ä»…åœ¨æ ‡ç­¾ä½ç½® keypoint location è¿›è¡Œï¼Œå³ç›´æ¥å°†æ ‡ç­¾ç‚¹æ‰€åœ¨çš„ bin çš„é¢„æµ‹çš„ç»“æœè¿›è¡ŒæŸå¤±å‡½æ•°çš„è®¡ç®—ï¼Œè¿™ä¸ªæ€æƒ³å’Œ PointRCNN, SECOND ç­‰ä¸€è‡´ï¼Œä»…å¯¹ positive proposals åšå›å½’æŸå¤±è®¡ç®—ï¼ˆä»¥ä¸Šä¸ºæ ¹æ® CenterNet çš„æ¨æµ‹ï¼ŒåŸæ–‡ä¼¼ä¹å¹¶æœªæåŠï¼‰</p><h3 id="Stage-2"><a href="#Stage-2" class="headerlink" title="Stage-2"></a>Stage-2</h3><p>ç¬¬äºŒé˜¶æ®µæœ‰ä¸¤ä¸ªä»»åŠ¡ï¼Œç»†åŒ– refinement å’Œè¯„åˆ† scoreã€‚æˆ‘ä»¬ä»é¢„æµ‹é€‰æ¡†çš„æ¯ä¸ªé¢çš„ä¸­å¿ƒæå–ä¸€ä¸ªç‚¹ç‰¹å¾ï¼Œè¿™æ ·å°±æœ‰6ä¸ªç‰¹å¾ç‚¹ï¼Œä½†åœ¨ä¿¯è§†å›¾ä¸­ä¸Šä¸‹è¡¨é¢ä¸­å¿ƒç‚¹é‡åˆï¼Œæ•…åªæœ‰5ä¸ªç‰¹å¾ç‚¹ã€‚å¯¹äºæ¯ä¸ªç‚¹ï¼Œä½¿ç”¨åŒçº¿æ€§æ’å€¼  <a href="https://www.cnblogs.com/xpvincent/archive/2013/03/15/2961448.html">bilinear interpolation</a> ä» feature map ä¸­æå–å‡ºå„è‡ªçš„ç‰¹å¾ï¼Œç„¶åå°†æ‰€æœ‰ç‰¹å¾è¿æ¥ concat é€å…¥ MLP ä¸­é¢„æµ‹ç½®ä¿¡åº¦ confidence score $I$ &amp; 3D bounding box</p><h4 id="ç½®ä¿¡åº¦"><a href="#ç½®ä¿¡åº¦" class="headerlink" title="ç½®ä¿¡åº¦"></a>ç½®ä¿¡åº¦</h4><p>å…¶ä¸­çš„ç½®ä¿¡åº¦ $I$ ä¸åˆ†ç±»æ— å…³ class-agnosticï¼Œä»…ä¸ IoU ç›¸å…³ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹</p><script type="math/tex; mode=display">I=\min \left(1, \max \left(0,2 \times I o U_{t}-0.5\right)\right)</script><p><img src="/archives/807a20df/image-20211007171708779.png" style="zoom: 67%;"></p><p>æŸå¤±å‡½æ•°ä¸ºäºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°</p><script type="math/tex; mode=display">L_{\text {score }}=-I_{t} \log \left(\hat{I}_{t}\right)-\left(1-I_{t}\right) \log \left(1-\hat{I}_{t}\right)</script><p>æœ€ç»ˆçš„é¢„æµ‹åˆ†æ•°ä¸ºå¦‚ä¸‹å…¬å¼</p><script type="math/tex; mode=display">\hat{Q}_{t}=\sqrt{\hat{Y}_{t} * \hat{I}_{t}}</script><h4 id="ç»†åŒ–"><a href="#ç»†åŒ–" class="headerlink" title="ç»†åŒ–"></a>ç»†åŒ–</h4><p>è¯¥ç»†åŒ–å·¥ä½œæ˜¯åœ¨ç¬¬ä¸€é˜¶æ®µçš„æè®® proposal ä¹‹ä¸Šè¿›è¡Œï¼Œå³å›å½’é¢„æµ‹ç¬¬ä¸€é˜¶æ®µæ‰€é¢„æµ‹çš„é€‰æ¡†ä¸çœŸå®é€‰æ¡†ä¹‹é—´çš„æ®‹å·®ã€‚å¹¶ä¸”ï¼ˆåœ¨è®­ç»ƒæ—¶ï¼‰ç»†åŒ–åº”è¯¥æ˜¯ä»…å¯¹æ­£æ ·æœ¬è¿›è¡Œï¼Œæ­£è´Ÿæ ·æœ¬çš„æ ‡å‡†åˆ¤å®šä¸ºé¢„æµ‹é€‰æ¡†ä¸æ ‡ç­¾ IoU å¤§äº0.55ï¼Œä»¥ 1:1 æ­£è´Ÿæ¯”ä¾‹å„é‡‡æ ·128ä¸ª</p><blockquote><p>During the training of two-stage CenterPoint, we randomly sample 128 boxes with 1:1 positive negative ratio [43] from the first stage predictions.</p></blockquote><p>åœ¨æµ‹è¯•\æ¨ç†æ—¶æ²¡æœ‰æ ‡ç­¾ï¼Œåˆ™å…ˆä½¿ç”¨ NMS ç­›é€‰å‡ºå€™é€‰é€‰æ¡†ï¼Œç„¶åé€‰å–å¾—åˆ†æœ€é«˜çš„500ä¸ªé€‰æ¡†ï¼Œæœ€åå†è¿›è¡Œç¬¬äºŒé˜¶æ®µçš„ç½®ä¿¡åº¦é¢„æµ‹å’Œç»†åŒ–ã€‚NMS çš„å¾—åˆ†æ ¹æ®åº”è¯¥æ˜¯ heatmap $Y$ï¼Œæ¯•ç«Ÿæ­¤æ—¶ç½®ä¿¡åº¦ $I$ è¿˜æ²¡æœ‰è®¡ç®—å‡ºæ¥</p><p>ç¬¬ä¸€é˜¶æ®µå’Œç¬¬äºŒé˜¶æ®µçš„ç½‘ç»œç»“æ„ä»¥åŠè®­ç»ƒæ–¹æ³•éƒ½ä»‹ç»å®Œäº†ï¼Œä¸€äº›æ›´å…·ä½“çš„åŸºç¡€ç»“æ„å¯ä»¥å‚è€ƒä¸‹é¢çš„åŸæ–‡</p><blockquote><p>All first-stage outputs share a first 3 Ã— 3 convolutional layer, Batch Normalization [25], and ReLU. Each output then uses its own branch of two 3Ã—3 convolutions separated by a batch norm and ReLU. Our second-stage uses a shared two-layer MLP, with a batch norm, ReLU, and Dropout [22] with a drop rate of 0.3, followed by two branches of three fully-connected layers, one for confidence score and one for box regression prediction.</p></blockquote><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><h3 id="Waymo"><a href="#Waymo" class="headerlink" title="Waymo"></a>Waymo</h3><p><img src="/archives/807a20df/5a04d50f-941e-48ec-a14c-b65a2d6d46fc.png"></p><h3 id="nuScenes"><a href="#nuScenes" class="headerlink" title="nuScenes"></a>nuScenes</h3><p><img src="/archives/807a20df/e847f9af-5198-4628-9797-ae958aa73c63.png"></p><h3 id="Anchor-vs-center"><a href="#Anchor-vs-center" class="headerlink" title="Anchor vs. center"></a>Anchor vs. center</h3><p><img src="/archives/807a20df/bfeb0fb3-b716-4ac0-9f38-f1ecc1b6a683.png"></p><h3 id="One-stage-vs-Two-stage"><a href="#One-stage-vs-Two-stage" class="headerlink" title="One-stage vs. Two-stage"></a>One-stage vs. Two-stage</h3><p><img src="/archives/807a20df/5d0b419b-6226-40a5-8632-879a222a9da1.png"></p><blockquote><p>Two-stage refinement does not bring an improvement over the single-stage CenterPoint model on nuScenes in our experiments. Similar results have been observed in previous two-stage methods like PointRCNN [45] and PV-RCNN [44].</p></blockquote><p>nuScenes å¯¹äº 2-Stage æ¨¡å‹åé¦ˆå¹¶ä¸å¥½ï¼ŒåŸå› å¯èƒ½åœ¨äºå…¶é‡‡æ ·ç‚¹è¾ƒå°‘ï¼Œé™åˆ¶äº†è¿›ä¸€æ­¥çš„ç²¾ç¡®ç»†åŒ–</p><h3 id="Effects-of-different-feature-components"><a href="#Effects-of-different-feature-components" class="headerlink" title="Effects of different feature components"></a>Effects of different feature components</h3><p>å¯¹äºç¬¬äºŒé˜¶æ®µçš„ç»†åŒ–ï¼Œè®ºæ–‡ç›´æ¥ä½¿ç”¨äº†åŒçº¿æ€§æ’å€¼å¾—åˆ°çš„ BEV ç‰¹å¾ï¼Œå®é™…ä¸Šè¿˜æœ‰å…¶ä»–çš„æ–¹æ³•å¾—åˆ°å„ä¸ªé‡‡æ ·ç‚¹çš„ç‰¹å¾ã€‚æ¯”å¦‚ï¼š</p><ol><li>PV-RCNN ä¸­é‡‡ç”¨çš„ voxel set abstraction (VSA) æ“ä½œï¼Œä¹Ÿå¯ä»¥å°†å‘¨å›´ voxel ç‰¹å¾æå–åˆ°é‡‡æ ·ç‚¹ä¸Š</li><li>SA-SSD ä¸­é‡‡ç”¨çš„åŸºäºç©ºé—´è·ç¦»çš„æ’å€¼ inverse distance weighted average ä¹Ÿå¯ä»¥å°† voxel ç‰¹å¾ä¼ æ’­åˆ°é‡‡æ ·ç‚¹ä¸Š</li></ol><p>è®ºæ–‡å°†è¿™ä¸¤ç§æ–¹å¼åœ¨ç¬¬äºŒé˜¶æ®µçš„ç»†åŒ–ç¯èŠ‚ä¸­ä¸è®ºæ–‡é‡‡ç”¨çš„ BEV æ’å€¼æ³•è¿›è¡Œå¯¹æ¯”å®éªŒï¼Œè™½ç„¶æ•ˆæœä¸æ˜¯æœ€å¥½ï¼Œä½†å·®è·ä¸å¤§ï¼Œèƒœåœ¨ç”¨æ—¶</p><p><img src="/archives/807a20df/image-20211014212255839.png"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>CenterPoint çš„ç»“æ„å…¶å®ç›¸å¯¹ç®€å•ï¼Œä½†å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œä¼¼ä¹åœ¨å‘Šè¯‰æˆ‘æ›´å¤šçš„å‚æ•°å°±è®©ç½‘ç»œè‡ªå·±å»é¢„æµ‹å¥½äº†ï¼Œæˆ–è®¸å½“äººä¸ºå¼•å…¥ä¸€äº› anchor ç›¸å…³çš„å‚æ•°ï¼Œåè€Œè®©ç½‘ç»œä¸å¥½å­¦ä¹ ã€‚å¹¶ä¸”ç”±äºå…¶ç»“æ„çš„ç®€å•ï¼Œè®¡ç®—æ—¶é—´ç›¸å¯¹å…¶ä»– 2-Stage ç½‘ç»œæ¥è®²æ›´å°‘ï¼Œä¸çŸ¥é“è¿™ç§ center-based æ€æƒ³æœ‰æœºä¼šèƒ½å¦è¿ç”¨åˆ°æ›´å¹¿æ³›çš„åœ°æ–¹</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CenterPoint </tag>
            
            <tag> Point Cloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D2L 01 å‰è¨€</title>
      <link href="/archives/786d359c.html"/>
      <url>/archives/786d359c.html</url>
      
        <content type="html"><![CDATA[<h1 id="Dive-into-deep-learning"><a href="#Dive-into-deep-learning" class="headerlink" title="Dive into deep learning"></a>Dive into deep learning</h1><p>ä¸­æ–‡æ•™æï¼ˆç¬¬äºŒç‰ˆï¼‰<a href="https://zh-v2.d2l.ai/">https://zh-v2.d2l.ai/</a> </p><p>è‹±æ–‡æ•™æï¼š<a href="https://d2l.ai/">https://d2l.ai/</a> </p><p>ä¸­æ–‡æ•™æåªæœ‰éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘é€‰æ‹©å…ˆä»ä¸­æ–‡å¼€å§‹çœ‹å‡å°‘ä¸€äº›éš¾åº¦ï¼Œæ²¡æœ‰çš„ç« èŠ‚å†å»çœ‹è‹±æ–‡éƒ¨åˆ†ã€‚è¯·å…ˆé˜…è¯» <a href="http://zh-v2.d2l.ai/chapter_installation/index.html">å®‰è£…</a> <a href="http://zh-v2.d2l.ai/chapter_notation/index.html">ç¬¦å·</a> ä¸¤ä¸ªç« èŠ‚ï¼Œé‡Œé¢åŒ…å«äº†å¦‚ä½•ä¸‹è½½è¯¥ä¹¦çš„ notebook ä»¥åŠè®²è§£äº†è¯¥ä¹¦ä½¿ç”¨çš„æ•°å­¦ç¬¦å·</p><h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1. å‰è¨€"></a>1. å‰è¨€</h1><h2 id="å…³é”®ç»„ä»¶"><a href="#å…³é”®ç»„ä»¶" class="headerlink" title="å…³é”®ç»„ä»¶"></a>å…³é”®ç»„ä»¶</h2><h3 id="æ•°æ®"><a href="#æ•°æ®" class="headerlink" title="æ•°æ®"></a>æ•°æ®</h3><ol><li>æ•°æ®çš„åˆ†å¸ƒï¼Œä¸€èˆ¬å‡è®¾ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒã€‚æ‰€ä»¥å½“åˆ†å¸ƒå‡ºç°åå·®ï¼Œæ¨¡å‹ä¹Ÿä¼šç›¸åº”åœ°è¢«å½±å“</li><li>æ•°æ®çš„ç»´æ•°ï¼Œæ¯ä¸€ä¸ªæ ·æœ¬éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå›ºå®šç»´æ•°çš„æ ·æœ¬ï¼Œä¾‹å¦‚æ¯ä¸ªæ ·æœ¬ä¸ºä¸€ä¸ªä¸‰ç»´å‘é‡ï¼Œè®°å½•äººçš„èº«é«˜ã€ä½“é‡ã€æ€§åˆ«ã€‚ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ï¼Œä¾‹å¦‚æ ·æœ¬ä¸ºå›¾ç‰‡æ—¶ï¼Œæ•°æ®ä¸ºä¸‰ç»´å¼ é‡ (width, height, 3)ï¼Œç»´åº¦çš„å…·ä½“åˆ†é‡ç”±å…¶é•¿å®½å†³å®šã€‚æ³¨æ„è¿™é‡Œè¦åŒºåˆ†ä¸€ä¸‹ï¼Œå‘é‡çš„ç»´åº¦å’Œå¼ é‡çš„ç»´åº¦ä¸æ˜¯åŒä¸€ä¸ªå®šä¹‰</li><li>æ•°æ®çš„æ ‡ç­¾ï¼Œéœ€è¦æœ‰æ­£ç¡®çš„æ•°æ®æ¥å¼•å¯¼æ¨¡å‹çš„å­¦ä¹ </li></ol><h3 id="æ¨¡å‹"><a href="#æ¨¡å‹" class="headerlink" title="æ¨¡å‹"></a>æ¨¡å‹</h3><p>ç›´æ¥å¼•ç”¨åŸæ–‡</p><blockquote><p><strong>å¤§å¤šæ•°æœºå™¨å­¦ä¹ ä¼šæ¶‰åŠåˆ°æ•°æ®çš„è½¬æ¢ã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªâ€œæ‘„å–ç…§ç‰‡å¹¶é¢„æµ‹ç¬‘è„¸â€çš„ç³»ç»Ÿã€‚å†æ¯”å¦‚ï¼Œæˆ‘ä»¬æ‘„å–ä¸€ç»„ä¼ æ„Ÿå™¨è¯»æ•°ï¼Œå¹¶é¢„æµ‹è¯»æ•°çš„æ­£å¸¸ä¸å¼‚å¸¸ç¨‹åº¦ã€‚ è™½ç„¶ç®€å•çš„æ¨¡å‹èƒ½å¤Ÿè§£å†³å¦‚ä¸Šç®€å•çš„é—®é¢˜ï¼Œä½†æœ¬ä¹¦ä¸­å…³æ³¨çš„é—®é¢˜è¶…å‡ºäº†ç»å…¸æ–¹æ³•çš„æé™ã€‚ æ·±åº¦å­¦ä¹ ä¸ç»å…¸æ–¹æ³•çš„åŒºåˆ«ä¸»è¦åœ¨äºï¼šå‰è€…å…³æ³¨çš„åŠŸèƒ½å¼ºå¤§çš„æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ç”±ç¥ç»ç½‘ç»œé”™ç»¼å¤æ‚çš„äº¤ç»‡åœ¨ä¸€èµ·ï¼ŒåŒ…å«å±‚å±‚æ•°æ®è½¬æ¢ï¼Œå› æ­¤è¢«ç§°ä¸º<em>æ·±åº¦å­¦ä¹ </em>ï¼ˆdeep learningï¼‰ã€‚ åœ¨è®¨è®ºæ·±åº¦æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå°†æåŠä¸€äº›ä¼ ç»Ÿæ–¹æ³•ã€‚</strong></p></blockquote><h3 id="ç›®æ ‡å‡½æ•°"><a href="#ç›®æ ‡å‡½æ•°" class="headerlink" title="ç›®æ ‡å‡½æ•°"></a>ç›®æ ‡å‡½æ•°</h3><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æ¨¡å‹çš„ä¼˜åŠ£ç¨‹åº¦çš„åº¦é‡ï¼Œè¿™ä¸ªåº¦é‡åœ¨å¤§å¤šæ•°æƒ…å†µæ˜¯â€œå¯ä¼˜åŒ–â€çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<em>ç›®æ ‡å‡½æ•°</em>ï¼ˆobjective functionï¼‰ã€‚ æˆ‘ä»¬é€šå¸¸å®šä¹‰ä¸€ä¸ªç›®æ ‡å‡½æ•°ï¼Œå¹¶å¸Œæœ›ä¼˜åŒ–å®ƒåˆ°æœ€ä½ç‚¹ã€‚å› ä¸ºè¶Šä½è¶Šå¥½ï¼Œæ‰€ä»¥è¿™äº›å‡½æ•°æœ‰æ—¶è¢«ç§°ä¸º<em>æŸå¤±å‡½æ•°</em>ï¼ˆloss function, æˆ–cost functionï¼‰</p><h3 id="ä¼˜åŒ–ç®—æ³•"><a href="#ä¼˜åŒ–ç®—æ³•" class="headerlink" title="ä¼˜åŒ–ç®—æ³•"></a>ä¼˜åŒ–ç®—æ³•</h3><p>æ·±åº¦å­¦ä¹ ä¸­ï¼Œå¤§å¤šæµè¡Œçš„ä¼˜åŒ–ç®—æ³•é€šå¸¸åŸºäºä¸€ç§åŸºæœ¬æ–¹æ³•â€“<em>æ¢¯åº¦ä¸‹é™</em>ï¼ˆgradient descentï¼‰</p><h2 id="å„ç§æœºå™¨å­¦ä¹ é—®é¢˜"><a href="#å„ç§æœºå™¨å­¦ä¹ é—®é¢˜" class="headerlink" title="å„ç§æœºå™¨å­¦ä¹ é—®é¢˜"></a>å„ç§æœºå™¨å­¦ä¹ é—®é¢˜</h2><h3 id="ç›‘ç£å­¦ä¹ "><a href="#ç›‘ç£å­¦ä¹ " class="headerlink" title="ç›‘ç£å­¦ä¹ "></a>ç›‘ç£å­¦ä¹ </h3><p>ç›‘ç£å­¦ä¹ å°±æ¯”è¾ƒç»å…¸äº†ï¼Œæœ‰å›å½’é—®é¢˜ã€åˆ†ç±»é—®é¢˜ã€æ ‡è®°é—®é¢˜ã€æœç´¢é—®é¢˜ã€æ¨èç³»ç»Ÿã€åºåˆ—å­¦ä¹ ã€‚å‰ä¸¤ä¸ªé—®é¢˜æ¯”è¾ƒå¸¸è§äº†ï¼Œæä¸€ä¸‹åé¢å‡ ä¸ª</p><ol><li>æ ‡è®°é—®é¢˜ï¼Œå¯ä»¥æ˜¯ç›®æ ‡æ£€æµ‹ç›¸å…³ï¼Œä¹Ÿå¯ä»¥æ˜¯æè¿°æ ·æœ¬ (image captioning) ç›¸å…³</li><li>æœç´¢é—®é¢˜ï¼Œä¸€å¤§åº”ç”¨å³ä¸ºæœç´¢å¼•æ“ï¼Œåœ¨æµ·é‡æ•°æ®åº“ä¸­æ‰¾åˆ°ä¸æœç´¢å†…å®¹æœ€åŒ¹é…çš„é€‰é¡¹</li><li>æ¨èç³»ç»Ÿï¼Œæ ¹æ®ç”¨æˆ·å–œå¥½å¯¹ç”¨æˆ·è¿›è¡Œä¸ªæ€§åŒ–æ¨è</li><li>åºåˆ—å­¦ä¹ ï¼Œè¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯å¯å˜é•¿åº¦çš„åºåˆ—ï¼Œå¯åº”ç”¨äºæœºå™¨ç¿»è¯‘ã€æ–‡æœ¬è¯­éŸ³è½¬æ¢ç­‰</li></ol><h3 id="æ— ç›‘ç£å­¦ä¹ "><a href="#æ— ç›‘ç£å­¦ä¹ " class="headerlink" title="æ— ç›‘ç£å­¦ä¹ "></a>æ— ç›‘ç£å­¦ä¹ </h3><p>åªæœ‰æ ·æœ¬ï¼Œæ²¡æœ‰æ ‡ç­¾ï¼Œæ„åœ¨å­¦ä¹ æ•°æ®ä¹‹é—´çš„å†…éƒ¨å…³ç³»ã€‚èšç±»ã€ä¸»æˆåˆ†åˆ†æã€å› æœå…³ç³»å’Œæ¦‚ç‡å›¾æ¨¡å‹ã€ç”Ÿæˆå¯¹æŠ—ç½‘ç»œéƒ½æ˜¯æ— ç›‘ç£å­¦ä¹ çš„ä¾‹å­ï¼Œå…¶ä¸­ç”Ÿæˆå¯¹æŠ—ç½‘ç»œæ˜¯ç°åœ¨æ·±åº¦å­¦ä¹ ä¸­éå¸¸é‡è¦å’Œæ´»è·ƒçš„é¢†åŸŸ</p><h3 id="å¼ºåŒ–å­¦ä¹ "><a href="#å¼ºåŒ–å­¦ä¹ " class="headerlink" title="å¼ºåŒ–å­¦ä¹ "></a>å¼ºåŒ–å­¦ä¹ </h3><p>å¼ºåŒ–å­¦ä¹ åˆæ˜¯å¦ä¸€ä¸ªåºå¤§çš„æ¡†æ¶ï¼Œè€Œä¸”ååˆ†å¼ºå¤§ï¼Œå¼ºåŒ–å­¦ä¹ çš„ç›®æ ‡æ˜¯äº§ç”Ÿä¸€ä¸ªç­–ç•¥ï¼Œè®©ç­–ç•¥çš„å¥–åŠ±è¾¾åˆ°æœ€å¤§ã€‚æ·±åº¦å¼ºåŒ–å­¦ä¹ å°†æ·±åº¦å­¦ä¹ åº”ç”¨äºå¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œä¹Ÿæ˜¯éå¸¸çƒ­é—¨çš„ç ”ç©¶æ–¹å‘</p><h2 id="æ·±åº¦å­¦ä¹ å‘å±•ä¹‹è·¯"><a href="#æ·±åº¦å­¦ä¹ å‘å±•ä¹‹è·¯" class="headerlink" title="æ·±åº¦å­¦ä¹ å‘å±•ä¹‹è·¯"></a>æ·±åº¦å­¦ä¹ å‘å±•ä¹‹è·¯</h2><ol><li>ç®—åŠ›çš„å‘å±•å’Œæ•°æ®é›†çš„å‘å±•æ˜¯æ·±åº¦å­¦ä¹ çˆ†å‘çš„åŸºç¡€ã€‚ä¸”ç”±äºè¿™ä¸¤è€…çš„é™åˆ¶ï¼Œè®¸å¤šä¼˜ç§€çš„ç®—æ³•å’Œæ¨¡å‹å…¶å®åœ¨å¾ˆæ—©çš„æ—¶å€™å°±è¢«æå‡ºï¼Œå¦‚å¤šå±‚æ„ŸçŸ¥æœºã€å·ç§¯ç½‘ç»œï¼Œä½†æ— æ³•æ–½å±•æ›´å¼ºå¤§çš„å¨åŠ›</li><li>åˆ—ä¸¾éƒ¨åˆ†æœ€è¿‘åå¹´ä¸­çš„äº‹ä»¶ï¼Œå¸®åŠ©æ·±åº¦å­¦ä¹ å–å¾—å·¨å¤§æˆå°±ï¼š</li></ol><ul><li>æ–°çš„å®¹é‡æ§åˆ¶æ–¹æ³•ï¼Œå¦‚ dropoutï¼Œæœ‰åŠ©äºå‡è½»è¿‡æ‹Ÿåˆ</li><li>æå‡ºæ³¨æ„åŠ›æœºåˆ¶</li><li>ç”Ÿæˆå¯¹æŠ—ç½‘ç»œçš„å‘æ˜</li><li>æ„å»ºå¹¶è¡Œå¼å’Œåˆ†å¸ƒå¼è®­ç»ƒç®—æ³•</li><li>å¼€æºçš„æ·±åº¦å­¦ä¹ æ¡†æ¶</li></ul><h2 id="æ·±åº¦å­¦ä¹ ç‰¹ç‚¹"><a href="#æ·±åº¦å­¦ä¹ ç‰¹ç‚¹" class="headerlink" title="æ·±åº¦å­¦ä¹ ç‰¹ç‚¹"></a>æ·±åº¦å­¦ä¹ ç‰¹ç‚¹</h2><ol><li><p><strong>æ·±åº¦å­¦ä¹ æ˜¯â€œæ·±åº¦â€çš„ï¼Œæ¨¡å‹å­¦ä¹ è®¸å¤šè½¬æ¢çš„â€œå±‚â€ï¼Œæ¯ä¸€å±‚æä¾›ä¸€ä¸ªå±‚æ¬¡çš„è¡¨ç¤º</strong>ã€‚ ä¾‹å¦‚ï¼Œé è¿‘è¾“å…¥çš„å±‚å¯ä»¥è¡¨ç¤ºæ•°æ®çš„ä½çº§ç»†èŠ‚ï¼Œè€Œæ¥è¿‘åˆ†ç±»è¾“å‡ºçš„å±‚å¯ä»¥è¡¨ç¤ºç”¨äºåŒºåˆ†çš„æ›´æŠ½è±¡çš„æ¦‚å¿µã€‚ ç”±äºè¡¨ç¤ºå­¦ä¹ çš„ç›®çš„æ˜¯å¯»æ‰¾è¡¨ç¤ºæœ¬èº«ï¼Œå› æ­¤æ·±åº¦å­¦ä¹ å¯ä»¥ç§°ä¸ºâ€œå¤šçº§è¡¨ç¤ºå­¦ä¹ â€</p></li><li><p>æ¯‹åº¸ç½®ç–‘ï¼Œæ·±åº¦å­¦ä¹ æ–¹æ³•ä¸­æœ€æ˜¾è‘—çš„å…±åŒç‚¹æ˜¯ä½¿ç”¨<strong>ç«¯åˆ°ç«¯è®­ç»ƒ</strong>ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…¶åŸºäºå•ç‹¬è°ƒæ•´çš„ç»„ä»¶ç»„è£…ç³»ç»Ÿï¼Œä¸å¦‚æ„å»ºç³»ç»Ÿï¼Œç„¶åè”åˆè°ƒæ•´å®ƒä»¬çš„æ€§èƒ½ã€‚ ä¾‹å¦‚ï¼Œåœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œç§‘å­¦å®¶ä»¬ä¹ æƒ¯äºå°†ç‰¹å¾å·¥ç¨‹çš„è¿‡ç¨‹ä¸å»ºç«‹æœºå™¨å­¦ä¹ æ¨¡å‹çš„è¿‡ç¨‹åˆ†å¼€ã€‚ Cannyè¾¹ç¼˜æ£€æµ‹å™¨ <a href="https://zh-v2.d2l.ai/chapter_references/zreferences.html#canny-1987">[Canny, 1987]</a> å’ŒSIFTç‰¹å¾æå–å™¨ <a href="https://zh-v2.d2l.ai/chapter_references/zreferences.html#lowe-2004">[Lowe, 2004]</a> ä½œä¸ºå°†å›¾åƒæ˜ å°„åˆ°ç‰¹å¾å‘é‡çš„ç®—æ³•ï¼Œåœ¨è¿‡å»çš„åå¹´é‡Œå æ®äº†è‡³é«˜æ— ä¸Šçš„åœ°ä½ã€‚ åœ¨è¿‡å»çš„æ—¥å­é‡Œï¼Œå°†æœºå™¨å­¦ä¹ åº”ç”¨äºè¿™äº›é—®é¢˜çš„å…³é”®éƒ¨åˆ†æ˜¯æå‡ºäººå·¥è®¾è®¡çš„ç‰¹å¾å·¥ç¨‹æ–¹æ³•ï¼Œå°†æ•°æ®è½¬æ¢ä¸ºæŸç§é€‚åˆäºæµ…å±‚æ¨¡å‹çš„å½¢å¼ã€‚ ç„¶è€Œï¼Œä¸ä¸€ä¸ªç®—æ³•è‡ªåŠ¨æ‰§è¡Œçš„æ•°ç™¾ä¸‡ä¸ªé€‰æ‹©ç›¸æ¯”ï¼Œäººç±»é€šè¿‡ç‰¹å¾å·¥ç¨‹æ‰€èƒ½å®Œæˆçš„äº‹æƒ…å¾ˆå°‘ã€‚ å½“æ·±åº¦å­¦ä¹ å¼€å§‹æ—¶ï¼Œ<strong>è¿™äº›ç‰¹å¾æŠ½å–å™¨è¢«è‡ªåŠ¨è°ƒæ•´çš„æ»¤æ³¢å™¨æ‰€å–ä»£ï¼Œäº§ç”Ÿäº†æ›´é«˜çš„ç²¾ç¡®åº¦</strong></p></li><li><p>æ­¤å¤–ï¼Œé€šè¿‡å–ä»£å¤§éƒ¨åˆ†ç‰¹å®šé¢†åŸŸçš„é¢„å¤„ç†ï¼Œæ·±åº¦å­¦ä¹ æ¶ˆé™¤äº†ä»¥å‰åˆ†éš”è®¡ç®—æœºè§†è§‰ã€è¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€åŒ»å­¦ä¿¡æ¯å­¦å’Œå…¶ä»–åº”ç”¨é¢†åŸŸçš„è®¸å¤šç•Œé™ï¼Œ<strong>ä¸ºè§£å†³å„ç§é—®é¢˜æä¾›äº†ä¸€å¥—ç»Ÿä¸€çš„å·¥å…·</strong></p></li><li><p><strong>é™¤äº†ç«¯åˆ°ç«¯çš„è®­ç»ƒï¼Œæˆ‘ä»¬æ­£åœ¨ç»å†ä»å‚æ•°ç»Ÿè®¡æè¿°åˆ°å®Œå…¨éå‚æ•°æ¨¡å‹çš„è½¬å˜ã€‚</strong> å½“æ•°æ®ç¨€ç¼ºæ—¶ï¼Œäººä»¬éœ€è¦ä¾é ç®€åŒ–å¯¹ç°å®çš„å‡è®¾æ¥è·å¾—æœ‰ç”¨çš„æ¨¡å‹ã€‚ å½“æ•°æ®ä¸°å¯Œæ—¶ï¼Œå¯ä»¥ç”¨æ›´å‡†ç¡®åœ°æ‹Ÿåˆå®é™…æƒ…å†µçš„éå‚æ•°æ¨¡å‹æ¥ä»£æ›¿ã€‚ åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œè¿™åæ˜ äº†ç‰©ç†å­¦åœ¨ä¸Šä¸ªä¸–çºªä¸­å¶éšç€è®¡ç®—æœºçš„å‡ºç°æ‰€ç»å†çš„è¿›æ­¥ã€‚ ç°åœ¨äººä»¬å¯ä»¥å€ŸåŠ©äºç›¸å…³åå¾®åˆ†æ–¹ç¨‹çš„æ•°å€¼æ¨¡æ‹Ÿï¼Œè€Œä¸æ˜¯ç”¨æ‰‹æ¥æ±‚è§£ç”µå­è¡Œä¸ºçš„å‚æ•°è¿‘ä¼¼ã€‚<strong>è¿™å¯¼è‡´äº†æ›´ç²¾ç¡®çš„æ¨¡å‹ï¼Œå°½ç®¡å¸¸å¸¸ä»¥ç‰ºç‰²å¯è§£é‡Šæ€§ä¸ºä»£ä»·</strong></p></li><li><p><strong>ä¸ä»¥å‰å·¥ä½œçš„å¦ä¸€ä¸ªä¸åŒä¹‹å¤„æ˜¯æ¥å—æ¬¡ä¼˜è§£ï¼Œå¤„ç†éå‡¸éçº¿æ€§ä¼˜åŒ–é—®é¢˜ï¼Œå¹¶ä¸”æ„¿æ„åœ¨è¯æ˜ä¹‹å‰å°è¯•</strong>ã€‚ è¿™ç§åœ¨å¤„ç†ç»Ÿè®¡é—®é¢˜ä¸Šæ–°å‘ç°çš„ç»éªŒä¸»ä¹‰ï¼ŒåŠ ä¸Šäººæ‰çš„è¿…é€Ÿæ¶Œå…¥ï¼Œå¯¼è‡´äº†å®ç”¨ç®—æ³•çš„å¿«é€Ÿè¿›æ­¥ã€‚ å°½ç®¡åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä»¥ä¿®æ”¹å’Œé‡æ–°å‘æ˜å­˜åœ¨äº†æ•°åå¹´çš„å·¥å…·ä¸ºä»£ä»·çš„ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ </category>
          
          <category> Dive into deep learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> Dive into deep learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Numpy Cheat Sheet</title>
      <link href="/archives/19c6ccbf.html"/>
      <url>/archives/19c6ccbf.html</url>
      
        <content type="html"><![CDATA[<h1 id="Numpy-Cheat-Sheet"><a href="#Numpy-Cheat-Sheet" class="headerlink" title="Numpy Cheat Sheet"></a>Numpy Cheat Sheet</h1><h2 id="Basics-åŸºç¡€"><a href="#Basics-åŸºç¡€" class="headerlink" title="Basics åŸºç¡€"></a>Basics åŸºç¡€</h2><h3 id="ç®€å•åˆ›å»º"><a href="#ç®€å•åˆ›å»º" class="headerlink" title="ç®€å•åˆ›å»º"></a>ç®€å•åˆ›å»º</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> step<span class="token punctuation">)</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Placeholders-åˆ›å»º"><a href="#Placeholders-åˆ›å»º" class="headerlink" title="Placeholders åˆ›å»º"></a>Placeholders åˆ›å»º</h3><p>åŒ…æ‹¬åˆ›å»º linespace, zeros, ones, random, empty æ•°ç»„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>linespace<span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> num<span class="token punctuation">)</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>shape<span class="token punctuation">)</span>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>shape<span class="token punctuation">)</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span>shape<span class="token punctuation">)</span><span class="token comment"># 0-1 uniform</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token operator">*</span>dimensions<span class="token punctuation">)</span><span class="token comment"># normal/gaussian</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>low<span class="token punctuation">,</span> high<span class="token punctuation">,</span> shape<span class="token punctuation">)</span><span class="token comment"># high is exclusive</span>np<span class="token punctuation">.</span>empty<span class="token punctuation">(</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Array-æ•°ç»„"><a href="#Array-æ•°ç»„" class="headerlink" title="Array æ•°ç»„"></a>Array æ•°ç»„</h2><h3 id="Array-Properties-å±æ€§"><a href="#Array-Properties-å±æ€§" class="headerlink" title="Array Properties å±æ€§"></a>Array Properties å±æ€§</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">.</span>shapearray<span class="token punctuation">.</span>ndim<span class="token comment"># dimensions of array</span>array<span class="token punctuation">.</span>sizearray<span class="token punctuation">.</span>dtypearray<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token comment"># convert data type</span><span class="token builtin">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token builtin">type</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Copy-å¤åˆ¶"><a href="#Copy-å¤åˆ¶" class="headerlink" title="Copy å¤åˆ¶"></a>Copy å¤åˆ¶</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>array<span class="token punctuation">)</span>other <span class="token operator">=</span> array<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Sort-æ’åº"><a href="#Sort-æ’åº" class="headerlink" title="Sort æ’åº"></a>Sort æ’åº</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>array<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Array-Operations-æ•°ç»„æ“ä½œ"><a href="#Array-Operations-æ•°ç»„æ“ä½œ" class="headerlink" title="Array Operations æ•°ç»„æ“ä½œ"></a>Array Operations æ•°ç»„æ“ä½œ</h2><h3 id="Adding-amp-removing"><a href="#Adding-amp-removing" class="headerlink" title="Adding &amp; removing"></a>Adding &amp; removing</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>np<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># not common</span>np<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># not common</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Combining"><a href="#Combining" class="headerlink" title="Combining"></a>Combining</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span>arrays<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span>arrays<span class="token punctuation">)</span>np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span>arrays<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Shaping"><a href="#Shaping" class="headerlink" title="Shaping"></a>Shaping</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>shape<span class="token punctuation">)</span>array<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>array<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># equals array.T</span>array<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>axes<span class="token punctuation">)</span><span class="token comment"># permute axes</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Math-æ•°å­¦"><a href="#Math-æ•°å­¦" class="headerlink" title="Math æ•°å­¦"></a>Math æ•°å­¦</h2><h3 id="Operations-åŸºç¡€è¿ç®—"><a href="#Operations-åŸºç¡€è¿ç®—" class="headerlink" title="Operations åŸºç¡€è¿ç®—"></a>Operations åŸºç¡€è¿ç®—</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># basic</span>np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token comment"># equals x @ y</span>np<span class="token punctuation">.</span>dop<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token comment"># dot product of 1D array</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>power<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token comment"># x1 &amp; x2 have the same shape or x2 can broadcast</span>np<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment"># preprocess</span>np<span class="token punctuation">.</span>isnan<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>isinf<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> ndigits<span class="token punctuation">)</span>np<span class="token punctuation">.</span>nan_to_num<span class="token punctuation">(</span>x<span class="token punctuation">,</span> nan<span class="token punctuation">)</span><span class="token comment"># Replace NaN with zero and infinity with large finite numbers (default behaviour) or with the numbers defined by the user using the nan, posinf and/or neginf keywords.</span>np<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span><span class="token comment"># test whether all be true along a axis</span>np<span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span><span class="token comment"># compare</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token comment"># Element-wise maximum of array elements.</span>np<span class="token punctuation">.</span>minimum<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token comment"># cumulative</span>np<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span><span class="token comment"># cumulative sum, if axis=None, flatten x</span>np<span class="token punctuation">.</span>diff<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span><span class="token comment"># differences</span>np<span class="token punctuation">.</span>prod<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span><span class="token comment"># product along given axis</span><span class="token comment"># arg-relative</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>bincount<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># Count number of occurrences of each value in array of non-negative ints.</span><span class="token comment"># linear algebra</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>x<span class="token punctuation">)</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment"># Statistics</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token punctuation">)</span>np<span class="token punctuation">.</span>corrcoef<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Slicing-åˆ‡ç‰‡"><a href="#Slicing-åˆ‡ç‰‡" class="headerlink" title="Slicing åˆ‡ç‰‡"></a>Slicing åˆ‡ç‰‡</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># n dimensions</span>array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token comment"># upper bound is exclusive</span>array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token comment"># reverse slicing</span>array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># step is 2</span><span class="token comment"># bool</span>array<span class="token punctuation">[</span>array <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span>array<span class="token punctuation">[</span><span class="token punctuation">(</span>array<span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>array<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># Fancy indexing</span>array<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># could be any iterable int array</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Broadcast-å¹¿æ’­"><a href="#Broadcast-å¹¿æ’­" class="headerlink" title="Broadcast å¹¿æ’­"></a>Broadcast å¹¿æ’­</h2><p>å¹¿æ’­æ•°ç»„ç»´åº¦éœ€è¦æ»¡è¶³ä»¥ä¸‹è¦æ±‚ä»»æ„ä¸€ä¸ªï¼š</p><ol><li><p>ä»åå¾€å‰æ¯”ï¼Œä¸¤ä¸ªæ•°ç»„å„ä¸ªç»´åº¦å¤§å°ç›¸åŒ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">A <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>B <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>C <span class="token operator">=</span> A <span class="token operator">+</span> B<span class="token comment"># B will broadcast to (2, 3, 4, 5)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>ä¸¤ä¸ªæ•°ç»„å­˜åœ¨ç»´åº¦å¤§å°ä¸ç›¸ç­‰æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªä¸ç›¸ç­‰ç»´åº¦å¤§å°ä¸º1</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">A <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>B <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>C <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>D <span class="token operator">=</span> A <span class="token operator">+</span> B <span class="token operator">+</span> A <span class="token operator">*</span> C<span class="token comment"># B &amp; C will broadcast to (2, 3, 4, 5)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h2 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h2><p>ä½¿ç”¨ <code>tofile &amp; fromfile</code> å°† ndarray å­˜å‚¨ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Pathbin_file <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">'./xxx.bin'</span><span class="token punctuation">)</span>a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>binfile<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    a<span class="token punctuation">.</span>tofile<span class="token punctuation">(</span>f<span class="token punctuation">)</span>b <span class="token operator">=</span> np<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span>binfile<span class="token punctuation">,</span> dtype<span class="token operator">=</span>a<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Numpy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PV-RCNN</title>
      <link href="/archives/b179cc3a.html"/>
      <url>/archives/b179cc3a.html</url>
      
        <content type="html"><![CDATA[<h1 id="PV-RCNN"><a href="#PV-RCNN" class="headerlink" title="PV-RCNN"></a>PV-RCNN</h1><hr><p>Shi, Shaoshuai, Chaoxu Guo, Li Jiang, Zhe Wang, Jianping Shi, Xiaogang Wang, and Hongsheng Li. â€œPV-RCNN: Point-Voxel Feature Set Abstraction for 3D Object Detection.â€ <em>ArXiv:1912.13192 [Cs, Eess]</em>, April 9, 2021. <a href="http://arxiv.org/abs/1912.13192">http://arxiv.org/abs/1912.13192</a>.</p><p>Comment: Accepted by CVPR 2020. arXiv admin note: substantial text overlap with arXiv:2102.00463</p><hr><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>å¤§å¤šæ•°ç°æœ‰çš„ 3D æ£€æµ‹æ–¹æ³•åœ¨ç‚¹äº‘è¡¨ç¤ºæ–¹é¢å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p><ol><li>åŸºäºä½“ç´ åŒ–çš„è¡¨ç¤ºï¼Œthe grid-based methods (e.g. VoxelNet)</li><li>åŸºäºç‚¹çš„è¡¨ç¤ºï¼Œthe point-based methods (e.g. Point R-CNN)</li></ol><p>è¿™ä¸¤ç§æ–¹æ³•å„æœ‰ä¼˜ç¼ºç‚¹ï¼š</p><ol><li>åŸºäºä½“ç´ åŒ–çš„æ“ä½œæœ‰æ•ˆåœ°ç¼–ç å¤šå°ºåº¦ç‰¹å¾ multi-scale feature representationsï¼Œå¹¶å¯ä»¥ç”Ÿæˆé«˜è´¨é‡çš„ 3D proposals</li><li>åŸºäº PointNet çš„ set abstraction æ“ä½œï¼Œä¿ç•™äº†æ›´å‡†ç¡®çš„ä½ç½®ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥æœ‰æ›´åŠ çµæ´»çš„æ„Ÿå—é‡</li></ol><p>è€Œ PV-RCNN å°±æ˜¯å—è¿™ä¸¤ç±»è¡¨ç¤ºçš„å¯å‘ï¼Œå°†è¿™ä¸¤ç±»æ–¹æ³•æœ‰æ•ˆç»“åˆèµ·æ¥ï¼Œä½¿å¾—ç‚¹äº‘ç‰¹å¾æ—¢æœ‰ä½“ç´ åŒ–çš„å¤šå°ºåº¦ä¿¡æ¯ï¼Œåˆå¢åŠ äº† set abstraction çš„ç²¾å‡†åº¦ä¸çµæ´»åº¦</p><p>è®ºæ–‡æ€»ç»“äº†4ä¸ªè´¡çŒ®ç‚¹ï¼š</p><ol><li>ç»“åˆäº†ä¸¤ç§ç‚¹äº‘è¡¨ç¤ºçš„ä¼˜ç‚¹ï¼šåŸºäºä½“ç´ çš„è¡¨ç¤ºå’ŒåŸºäºç‚¹çš„è¡¨ç¤º</li><li>æå‡ºäº† <strong>voxel-to-keypoint scene encoding scheme</strong>ï¼Œå°†ä½“ç´ ç±»çš„ç‰¹å¾ç¼–ç è½¬åŒ–ä¸ºç‚¹äº‘ç±»ç‰¹å¾</li><li><p>æå‡ºäº† <strong>multi-scale RoI feature abstraction layer</strong>ï¼Œå°† RoI ä¸­çš„ç‚¹äº‘ç‰¹å¾ç¼–ç è½¬åŒ–ä¸ºæ …æ ¼ç‚¹ç‰¹å¾ RoI-grid pooling via set abstraction</p></li><li><p>PV-RCNN ä»¥æ˜¾è‘—çš„ä¼˜åŠ¿åœ¨å½“æ—¶çš„ KITTI &amp; Waymo æ¦œå•ä¸Šæ’åç¬¬ä¸€</p></li></ol><p>ä¸­é—´ä¸¤ç‚¹æå¾—æ¯”è¾ƒç¬¼ç»Ÿï¼Œéœ€è¦å…·ä½“çœ‹çœ‹ PV-RCNN çš„ç»“æ„æ‰èƒ½æœ‰ä¸€ä¸ªå½¢è±¡çš„äº†è§£</p><h2 id="PV-RCNN-Architecture"><a href="#PV-RCNN-Architecture" class="headerlink" title="PV-RCNN Architecture"></a>PV-RCNN Architecture</h2><p><img src="/archives/b179cc3a/ee6744b0-bff5-448b-a317-1557749f9588.png"></p><h3 id="3D-voxel-CNN"><a href="#3D-voxel-CNN" class="headerlink" title="3D voxel CNN"></a>3D voxel CNN</h3><p>é¦–å…ˆå°†è¾“å…¥ç‚¹äº‘ P åˆ’åˆ†ä¸ºç©ºé—´åˆ†è¾¨ç‡ä¸º $L Ã— W Ã— H$ çš„å°ä½“ç´ /æ …æ ¼ï¼Œå…¶ä¸­éç©ºä½“ç´ çš„ç‰¹å¾ç›´æ¥è®¡ç®—ä¸ºæ‰€æœ‰å†…éƒ¨ç‚¹çš„é€ç‚¹ç‰¹å¾çš„å¹³å‡å€¼ã€‚å¸¸ç”¨çš„ç‰¹å¾æ˜¯ 3D åæ ‡ coordinate å’Œåå°„å¼ºåº¦ reflectance intensityã€‚Voxel CNN èƒ½å¤Ÿåœ¨å¤šä¸ªä¸‹é‡‡æ ·åˆ†è¾¨ç‡ä¸‹ (1x, 2x, 4x, 8x) è¿›è¡Œç‰¹å¾æå–ï¼Œå¾—åˆ°ä¸åŒ level çš„ voxel-wise feature vectorsï¼Œè¿™å°±æ˜¯ä½“ç´ åŒ–æ–¹æ³•çš„å¥½å¤„ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨æˆç†Ÿçš„å·ç§¯æ–¹æ³•</p><p>ä½†æ˜¯ä½¿ç”¨ voxel CNN ä¹Ÿä¼šæœ‰ä¸€å®šçš„å±€é™æ€§ï¼š</p><ol><li>è¿™äº›ç‰¹å¾é€šå¸¸ä¸ºä½åˆ†è¾¨ç‡çš„ç©ºé—´ç‰¹å¾ï¼ŒæŸå¤±äº†å¤§é‡çš„ç©ºé—´ä¿¡æ¯ï¼Œé˜»ç¢äº†å¯¹è±¡çš„å‡†ç¡®å®šä½</li><li>å³ä½¿é€šè¿‡ä¸Šé‡‡æ · upsample è¿™äº›ç‰¹å¾å›¾è°±éƒ½ä¼šæ˜¯æ¯”è¾ƒç¨€ç–çš„ï¼Œä¼ ç»Ÿçš„æ± åŒ–æ–¹æ³•å¯èƒ½å¾—åˆ°è®¸å¤šé›¶ç‰¹å¾å‘é‡</li></ol><h3 id="Proposal-generation"><a href="#Proposal-generation" class="headerlink" title="Proposal generation"></a>Proposal generation</h3><p>å°†æå–çš„ 3D ç‰¹å¾è½¬æ¢ reshape ä¸º 2D ä¿¯è§†ç‰¹å¾å›¾ bird-view feature mapsï¼ŒæŒ‰ç…§åŸºäºé”š anchor çš„æ–¹æ³•ç”Ÿæˆé«˜è´¨é‡çš„ 3D proposal (e.g. PointPillars)ã€‚è¿™é‡Œå¯ä»¥å°è¯•ä½¿ç”¨å…¶ä»–çš„ç”Ÿæˆç®—æ³•ï¼Œä¾‹å¦‚å°† anchor-based æ¢ä¸º anchor-freeï¼Œæå‡æ•ˆç‡å’Œå‡†ç¡®ç‡</p><h3 id="Voxel-to-keypoint-encoding"><a href="#Voxel-to-keypoint-encoding" class="headerlink" title="Voxel-to-keypoint encoding"></a>Voxel-to-keypoint encoding</h3><p>äº†è§£äº† voxel CNN çš„ä¸€äº›å±€é™æ€§ï¼Œæ˜¯å¦æœ‰æ–¹æ³•å»è¡¥å¿æŸå¤±çš„ç©ºé—´ä¿¡æ¯å‘¢ï¼Ÿè¿™é‡Œè®ºæ–‡å°†æå‡ºä¸€ç§å…¨æ–°çš„ encoding æ–¹æ³• <strong>voxel set abstraction (VSA)</strong>ï¼Œæ¥å°†æ•´ä¸ªåœºæ™¯çš„ç¼–ç ä» voxel-like è½¬æ¢ä¸º point-likeï¼Œå…·ä½“æ¥è¯´ voxel set abstraction ä½¿ç”¨ PointNet++ ç½‘ç»œä¸­çš„ set abstraction æ€æƒ³ï¼Œå°† voxel ç‰¹å¾èšåˆåˆ°åœºæ™¯ä¸­çš„å…³é”®ç‚¹é›† $K$ä¸Šï¼Œè¿™äº›å…³é”®ç‚¹ç”± FurthestPoint-Sampling (FPS) ç®—æ³•é‡‡æ ·å¾—å‡ºã€‚è¿™ä¸€æ“ä½œæˆ‘è®¤ä¸ºæ˜¯æ•´ä¸ªè®ºæ–‡é‡Œæœ€å…·åˆ›æ„çš„æ“ä½œï¼Œå°† set abstraction çš„æ“ä½œè¿›è¡Œäº†æ›´å¹¿çš„æ‹“å±•ï¼Œä»åŸæ¥çš„ point-to-point ç‰¹å¾èšåˆæ“ä½œï¼Œåˆ°è¿™é‡Œä¸º voxel-to-pointã€‚æ›´è¯¦ç»†çš„åŠ¨æœºå¯ä»¥å‚è€ƒåŸä½œè€…åœ¨ <a href="https://zhuanlan.zhihu.com/p/148942116">çŸ¥ä¹</a> ä¸Šçš„å›ç­”</p><p>ç°åœ¨ä»¥æ›´åŠ æ•°å­¦åŒ–çš„è¯­è¨€æ¥è¡¨è¾¾ <strong>voxel set abstraction (VSA)</strong>ã€‚å…³é”®ç‚¹é›†åˆ $K=\{p_1,â€¦,p_n\}$ï¼Œå¯¹äºæ¯ä¸ªå…³é”®ç‚¹ $p_i$ ï¼Œæˆ‘ä»¬åœ¨å¤šä¸ªåŠå¾„ $r_k$ å†…å¯»æ‰¾å…¶ç›¸é‚»çš„éç©ºä½“ç´  $v_j^{(l_k)}$ å…¶å¯¹ç‰¹å¾ä¸º $f_j^{(l_k)}$ï¼Œ$l_k$ ä»£è¡¨çš„æ˜¯åœ¨ voxel CNN é˜¶æ®µä¸­çš„ä¸åŒåˆ†è¾¨ç‡é˜¶æ®µ</p><script type="math/tex; mode=display">S_{i}^{\left(l_{k}\right)}=\left\{\left[f_{j}^{\left(l_{k}\right)} ; v_{j}^{\left(l_{k}\right)}-p_{i}\right]^{T}\middle|\ \ \begin{array}{ll}\left\|v_{j}^{\left(l_{k}\right)}-p_{i}\right\|^{2}<r_{k}, \\\forall v_{j}^{\left(l_{k}\right)} \in \mathcal{V}^{\left(l_{k}\right)} \\\forall f_{j}^{\left(l_{k}\right)} \in \mathcal{F}^{\left(l_{k}\right)}\end{array}\right\}</script><p>ç„¶åä½¿ç”¨ PointNet++ ä¸­çš„ set abstraction æ“ä½œï¼Œå°†è¿™äº›ç‰¹å¾èšåˆä¸ºä¸€ä¸ªç‰¹å¾å‘é‡</p><script type="math/tex; mode=display">f_{i}^{\left(p v_{k}\right)}=\max \left\{G\left(\mathcal{M}\left(S_{i}^{\left(l_{k}\right)}\right)\right)\right\}</script><p>å…¶ä¸­ $M(Â·)$ è¡¨ç¤ºä»ç›¸é‚»é›†åˆ $S^{(l_k)}_i$ ä¸­éšæœºé‡‡æ ·æœ€å¤š $T_k$ ä¸ªä½“ç´ ä»¥èŠ‚çœè®¡ç®—ï¼Œ$G(Â·)$ è¡¨ç¤ºä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥å™¨ç½‘ç»œ MLPï¼ˆåŒºåˆ«äº PoinNet ä¸­çš„ Shared MLPï¼‰ã€‚å°†å¤šä¸ªåŠå¾„çš„ç‰¹å¾å‘é‡è¿æ¥èµ·æ¥å°±èƒ½å¾—åˆ°å¤šå°ºåº¦çš„ç‰¹å¾ï¼Œç±»ä¼¼äº PointNet++ ä¸­çš„ multi-scale grouping (MSG)</p><p>ç°åœ¨å°†ä¸åŒåˆ†è¾¨ç‡çš„ç‰¹å¾è¿æ¥èµ·æ¥ï¼ŒåŸè®ºæ–‡æœ‰4ä¸ªä¸åŒçš„åˆ†è¾¨ç‡</p><script type="math/tex; mode=display">f_{i}^{(p v)}=\left[f_{i}^{\left(p v_{1}\right)}, f_{i}^{\left(p v_{2}\right)}, f_{i}^{\left(p v_{3}\right)}, f_{i}^{\left(p v_{4}\right)}\right], \text { for } i=1, \cdots, n</script><p>å†æ·»åŠ ä¸€äº›ç‰¹å¾ï¼šåŸç‚¹äº‘æ•°æ® raw point feature å’Œå¯¹åº”ç‚¹çš„ä¿¯è§†å›¾ç‰¹å¾ bird-eye view featureï¼Œå¾—åˆ°æœ€ç»ˆçš„æ•´ä¸ªç‚¹äº‘çš„ç‰¹å¾é›†åˆ</p><script type="math/tex; mode=display">f_{i}^{(p)}=\left[f_{i}^{(p v)}, f_{i}^{(r a w)}, f_{i}^{(b e v)}\right], \text { for } i=1, \cdots, n</script><p>å†è¿›è¡Œä¸€äº›æƒé‡è°ƒæ•´ï¼Œæƒé‡ä¾æ®ä¸ºè¯¥ç‚¹æ˜¯å¦ä¸ºå‰æ™¯ç‚¹ï¼Œå¦‚æœä¸ºèƒŒæ™¯ç‚¹åˆ™æƒé‡é™ä½ï¼Œè¿™å°†ç»™æ¨¡å‹å¸¦æ¥æ›´å¥½çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚ä½¿ç”¨å¾—åˆ°çš„ç‚¹äº‘ç‰¹å¾ï¼Œé€å…¥åˆ°ä¸‰å±‚çš„ MLP $A(Â·)$ ä¸­å»é¢„æµ‹è¯¥ç‚¹çš„æƒé‡ï¼Œç„¶åå†ä¸åŸç‰¹å¾ç›¸ä¹˜</p><script type="math/tex; mode=display">\tilde{f}_{i}^{(p)}=\mathcal{A}\left(f_{i}^{(p)}\right) \cdot f_{i}^{(p)}</script><p>è¿™é‡Œçš„æƒé‡è°ƒæ•´æœºåˆ¶è®ºæ–‡ç§°ä¸º <strong>predicted key weighting (PKW)</strong>ï¼Œå…¶å›¾ç¤ºå¦‚ä¸‹</p><p><img src="/archives/b179cc3a/image-20211008181557465.png"></p><h3 id="Keypoint-to-grid-RoI-feature-abstraction"><a href="#Keypoint-to-grid-RoI-feature-abstraction" class="headerlink" title="Keypoint-to-grid RoI feature abstraction"></a>Keypoint-to-grid RoI feature abstraction</h3><p>ç»™å®šæ¯ä¸ª 3D RoI/proposalï¼Œè®ºæ–‡æå‡º RoI-grid poolingï¼Œå°†å…³é”®ç‚¹ç‰¹å¾èšåˆåˆ°å…·æœ‰å¤šä¸ªæ„Ÿå—é‡çš„ RoI-grid ç‚¹ï¼Œç‰¹å¾èšåˆæ–¹æ³•ä¾æ—§ç±»ä¼¼äº PointNet++ MSGï¼Œå›¾ç¤ºå¦‚ä¸‹ï¼Œè“è‰²è™šçº¿æ˜¯æˆ‘è‡ªå·±ç”»çš„ï¼Œæ–¹ä¾¿ä½“ç°å‡º grid</p><p><img src="/archives/b179cc3a/image-20211008183015394.png" style="zoom: 50%;"></p><p>å…¶æ•°å­¦è¡¨è¾¾ä¹Ÿæ˜¯ç±»ä¼¼çš„</p><script type="math/tex; mode=display">\begin{array}{l}\tilde{\Psi}=\left\{\left[\tilde{f}_{j}^{(p)} ; p_{j}-g_{i}\right]^{T} \Biggl|\ \begin{array}{l}\left\|p_{j}-g_{i}\right\|^{2}<\tilde{r}, \\\forall p_{j} \in \mathcal{K}, \forall \tilde{f}_{j}^{(p)} \in \tilde{\mathcal{F}}\end{array}\right\} \\\tilde{f}_{i}^{(g)}=\max \{G(\mathcal{M}(\tilde{\Psi}))\}\end{array}</script><p>ä¸ºä»€ä¹ˆè¿™é‡Œè¿˜è¦å†æ¬¡è¿›è¡Œç¼–ç ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨é€‰æ¡†å†…çš„æ‰€æœ‰ç‚¹è¿›è¡Œèšåˆï¼Œå¾—åˆ°ä¸€ä¸ªå…¨å±€çš„è¡¨è¾¾ï¼ŸåŸå› å¯èƒ½æ˜¯ä¸ºäº†è·å¾—å¤šå°ºåº¦çš„ç‰¹å¾ï¼Œåˆ©äºä¹‹åçš„ç»†åŒ– refinement å’Œè¯„åˆ† score è€Œä¸”å½“åŠå¾„å–å¾—è¾ƒå¤§çš„æ—¶å€™ï¼Œè¿˜èƒ½èšåˆåˆ°é€‰æ¡†ä¹‹å¤–çš„ç‰¹å¾ç‚¹</p><h3 id="Refinement-and-confidence-prediction"><a href="#Refinement-and-confidence-prediction" class="headerlink" title="Refinement and confidence prediction"></a>Refinement and confidence prediction</h3><p>é‡‡ç”¨2å±‚ MLPï¼Œå»åšç½®ä¿¡åº¦é¢„æµ‹å’Œé€‰æ¡†ç»†åŒ–ä¸¤ä¸ªä»»åŠ¡ã€‚é‡‡ç”¨ 3D RoI/proposal ä¸å…¶å¯¹åº”çš„çœŸå®é€‰æ¡† ground truth ä¹‹é—´çš„ 3D IoU ä½œä¸ºè®­ç»ƒç›®æ ‡ï¼Œå¹¶é‡‡ç”¨äºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°</p><script type="math/tex; mode=display">y_{k}=\min \left(1, \max \left(0,2 \mathrm{IoU}_{k}-0.5\right)\right)\\L_{\mathrm{iou}}=-y_{k} \log \left(\tilde{y}_{k}\right)-\left(1-y_{k}\right) \log \left(1-\tilde{y}_{k}\right)</script><p>è¿™ç§  quality-aware ç½®ä¿¡åº¦é¢„æµ‹ç­–ç•¥æ¯”ä¼ ç»Ÿåˆ†ç±»æ ‡ç­¾å®ç°äº†æ›´å¥½çš„æ€§èƒ½ï¼ˆè¿™ç§æŸå¤±å‡½æ•°æ˜¯å¦è¿˜èƒ½è¿›ä¸€æ­¥æ”¹è¿›å‘¢ï¼Ÿæ¯”å¦‚é€šè¿‡ç®€å•çš„å¹³æ»‘è¿‡æ¸¡æ“ä½œï¼Œä½¿å¾—å­¦ä¹ æ›²çº¿æ›´å¹³ç¼“ï¼‰å¯¹äºç»†åŒ– refinement çš„ç›®æ ‡å’ŒæŸå¤±å‡½æ•°è®ºæ–‡æ²¡æœ‰å®Œæ•´åˆ—å‡ºï¼Œæ•´ä½“æ€æƒ³æ˜¯é¢„æµ‹å…¶æ®‹å·®ï¼Œå¹¶ä½¿ç”¨ smooth-L1 lossï¼Œå…·ä½“è¯·å‚è€ƒ SECOND, Part-A^2</p><script type="math/tex; mode=display">L_{\mathrm{rcnn}}=L_{\mathrm{iou}}+\sum_{\mathrm{r} \in\{x, y, z, l, h, w, \theta\}} \mathcal{L}_{\text {smooth-L1 }}\left(\widehat{\Delta \mathrm{r}^{p}}, \Delta \mathrm{r}^{p}\right)</script><p>åœ¨ voxel CNN é˜¶æ®µï¼Œregion proposal å’Œ classification çš„æŸå¤±å‡½æ•°ä¹Ÿæ²¡æœ‰å®Œæ•´åˆ—å‡ºï¼Œå¦‚ä¸‹</p><script type="math/tex; mode=display">L_{\mathrm{rpn}}=L_{\mathrm{cls}}+\beta \sum_{\mathrm{r} \in\{x, y, z, l, h, w, \theta\}} \mathcal{L}_{\text {smooth-L1 }}\left(\widehat{\Delta \mathrm{r}^{a}}, \Delta \mathrm{r}^{a}\right)</script><p>å…¶ä¸­åˆ†ç±»ä»»åŠ¡å’Œåˆ†å‰²ä»»åŠ¡éƒ½ä½¿ç”¨çš„æ˜¯ focal loss</p><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><h3 id="KITTI"><a href="#KITTI" class="headerlink" title="KITTI"></a>KITTI</h3><p>PV-RCNN åœ¨ KITTI æ•°æ®é›†ä¸Šçš„å‡†ç¡®ç‡å’Œå¬å›ç‡</p><p><img src="/archives/b179cc3a/image-20211008205557923.png"></p><p><img src="/archives/b179cc3a/image-20211008210508478.png" style="zoom:80%;"></p><h3 id="Waymo"><a href="#Waymo" class="headerlink" title="Waymo"></a>Waymo</h3><p><img src="/archives/b179cc3a/image-20211008210829402.png"></p><h3 id="Ablation-study"><a href="#Ablation-study" class="headerlink" title="Ablation study"></a>Ablation study</h3><p><img src="/archives/b179cc3a/image-20211008211127226.png"></p><p>æ¶ˆèå®éªŒé’ˆå¯¹ voxel set abstraction, RoI-grid pooling, PKW, IoU-guided scoreing è¿›è¡Œæ·±å…¥ç ”ç©¶ï¼Œè¿™äº›ç»“æ„èƒ½å°†æœ€ç»ˆè¡¨ç°æå‡ 1-3 mAP</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>PV-RCNN ä¸­çš„ä¸€ä¸ªå·¨å¤§å¯å‘æ˜¯å¯¹äºç‰¹å¾çš„ aggregation ä¸éœ€è¦è¢«æ•°æ®å®é™…çš„å½¢å¼ç»™é™åˆ¶ï¼Œç»“åˆå¤šç§æ•°æ®æå–ç‰¹å¾çš„ä¼˜åŠ¿ï¼Œåˆ›é€ å…¶ä¸­çš„æ¡¥æ¢ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡Œå±€éƒ¨å’Œå…¨å±€çš„æŠŠæ§ï¼Œåˆå°†ç‚¹äº‘è¡¨ç¤ºå¸¦åˆ°äº†ä¸€ä¸ªæ–°çš„é«˜åº¦ï¼Œå³ä½¿æ¥è¿‘ä¸¤å¹´è¿‡å»äº†ï¼Œè¯¥æ–¹æ³•ä»åœ¨ KITTI æ¦œå•æ’åå‰50ã€‚è¯¥ç½‘ç»œçš„æ¨ç†é€Ÿåº¦åœ¨ 80ms å·¦å³ï¼Œä¾æ—§è¿˜æœ‰æå‡çš„ç©ºé—´ï¼Œé¡¹ç›®å¼€æºåœ¨äº† OpenMMLabï¼Œç°åœ¨ OpenMMLab åˆæå‡ºäº†æ–°çš„ç½‘ç»œ Voxel R-CNNï¼Œæ¨ç†é€Ÿåº¦å‡å°‘äº†ä¸€åŠï¼Œè¾¾åˆ°äº† 40ms å·¦å³ï¼Œè€Œä¸”å‡†ç¡®åº¦ä¹Ÿä¸Šå‡äº†ï¼Œå¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œå­¦ä¹ </p><h2 id="TO-READ"><a href="#TO-READ" class="headerlink" title="TO READ"></a>TO READ</h2><ol><li>SECOND</li><li>Part-A^2</li><li>Voxel R-CNN</li></ol>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Point Cloud </tag>
            
            <tag> PV-RCNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PointNet &amp; PointNet++</title>
      <link href="/archives/63387d0d.html"/>
      <url>/archives/63387d0d.html</url>
      
        <content type="html"><![CDATA[<h1 id="PointNet-amp-PointNet"><a href="#PointNet-amp-PointNet" class="headerlink" title="PointNet &amp; PointNet++"></a>PointNet &amp; PointNet++</h1><hr><p>Qi, Charles R., Hao Su, Kaichun Mo, and Leonidas J. Guibas. â€œPointNet: Deep Learning on Point Sets for 3D Classification and Segmentation.â€ <em>ArXiv:1612.00593 [Cs]</em>, April 10, 2017. <a href="http://arxiv.org/abs/1612.00593">http://arxiv.org/abs/1612.00593</a>.</p><p>Comment: CVPR 2017</p><p>Qi, Charles R., Li Yi, Hao Su, and Leonidas J. Guibas. â€œPointNet++: Deep Hierarchical Feature Learning on Point Sets in a Metric Space.â€ <em>ArXiv:1706.02413 [Cs]</em>, June 7, 2017. <a href="http://arxiv.org/abs/1706.02413">http://arxiv.org/abs/1706.02413</a>.</p><p>From zotero</p><hr><p>PointNet ç®—æ˜¯åˆ©ç”¨æ·±åº¦å­¦ä¹ å¤„ç†ç‚¹äº‘æ•°æ®çš„å¼€å±±ä¹‹ä½œã€‚ç”±äºç‚¹äº‘æ•°æ®å¯¹æ¯”å›¾ç‰‡æ•°æ®æ›´åŠ æ··ä¹±å’Œå¤æ‚ï¼ŒåŸæœ‰çš„äºŒç»´å¤„ç†æ–¹æ³•é¢å¯¹ç‚¹äº‘æ•°æ®å¹¶æ²¡æœ‰èµ·åˆ°å¥½çš„æ•ˆæœï¼Œä½†åœ¨ PointNet æå‡ºåï¼Œå¤„ç†ä¸‰ç»´ç‚¹äº‘æ•°æ®æœ‰äº†æ–°çš„æ€è·¯ï¼Œå¹¶ä¸”å®éªŒç»“æœæœ‰äº†æ˜¾è‘—çš„æå‡ã€‚è¯¥ç¬”è®°ä¸»è¦ä¸ºäº†æ€»ç»“ PointNet å’Œ PointNet++ ä¸­å¿ƒæ€æƒ³ï¼Œå‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/weixin_39373480/article/details/88878629">CSDN</a></p><h2 id="PointNet"><a href="#PointNet" class="headerlink" title="PointNet"></a>PointNet</h2><h3 id="ä¸‰ç»´è¡¨ç¤º"><a href="#ä¸‰ç»´è¡¨ç¤º" class="headerlink" title="ä¸‰ç»´è¡¨ç¤º"></a>ä¸‰ç»´è¡¨ç¤º</h3><p><img src="/archives/63387d0d/image-20211004162518323.png" style="zoom: 50%;"></p><p>ä¸‰ç»´æ•°æ®çš„è¡¨è¿°å½¢å¼ä¸€èˆ¬åˆ†ä¸ºå››ç§ï¼š</p><ol><li><p>ç‚¹äº‘ï¼šç”± N ä¸ª D ç»´çš„ç‚¹ç»„æˆï¼Œå½“è¿™ä¸ª D = 3 çš„æ—¶å€™ä¸€èˆ¬ä»£è¡¨ç€ $(x, y, z)$ çš„åæ ‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŒ…æ‹¬ä¸€äº›æ³•å‘é‡ã€å¼ºåº¦ç­‰åˆ«çš„ç‰¹å¾</p></li><li><p>Meshï¼šç”±ä¸‰è§’é¢ç‰‡å’Œæ­£æ–¹å½¢é¢ç‰‡ç»„æˆ</p></li><li><p>ä½“ç´ ï¼šç”±ä¸‰ç»´æ …æ ¼å°†ç‰©ä½“ç”¨0å’Œ1è¡¨å¾</p></li><li><p>å¤šè§’åº¦çš„RGBå›¾åƒæˆ–è€…RGB-Då›¾åƒ</p></li></ol><p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨ç‚¹äº‘æ•°æ®ï¼Ÿ</strong></p><ol><li>ç‚¹äº‘æ›´æ¥è¿‘äºè®¾å¤‡çš„åŸå§‹è¡¨å¾ï¼ˆå³é›·è¾¾æ‰«æç‰©ä½“ç›´æ¥äº§ç”Ÿç‚¹äº‘ï¼‰</li><li>ç‚¹äº‘çš„è¡¨è¾¾æ–¹å¼æ›´åŠ ç®€å•ï¼Œä¸€ä¸ªç‰©ä½“ä»…ç”¨ä¸€ä¸ª N Ã— D çš„çŸ©é˜µè¡¨ç¤º</li></ol><h3 id="Properties-of-Point-Sets"><a href="#Properties-of-Point-Sets" class="headerlink" title="Properties of Point Sets"></a>Properties of Point Sets</h3><ul><li>Unorderedï¼Œæ— åºæ€§</li><li>Interaction among pointsï¼Œç‚¹ä¸ç‚¹ä¹‹é—´çš„ä½œç”¨</li><li>Invariance under transformationsï¼Œç©ºé—´ä¸å˜æ€§</li></ul><p>ä»¥ä¸Šæ€§è´¨çš„å‰ä¸¤ç‚¹æ˜¯åŒºåˆ«äºäºŒç»´å›¾åƒæ•°æ®çš„ï¼Œä¹Ÿæ˜¯å¤„ç†ç‚¹äº‘æ•°æ®çš„éš¾ç‚¹ã€‚PointNet æ ¸å¿ƒçš„è´¡çŒ®æœ‰ä¸¤ç‚¹ï¼Œä¸€ä¸ªæ˜¯è§£å†³æ— åºçš„ç‚¹äº‘è¾“å…¥ï¼Œä¸€ä¸ªæ˜¯è§£å†³ç©ºé—´ä¸å˜æ€§ã€‚ä½†æ˜¯å¯¹äºå¤„ç†ç©ºé—´ä¸å˜æ€§çš„ç»“æ„ï¼Œåœ¨ç°åœ¨çœ‹æ¥ä¼¼ä¹æ²¡æœ‰å¿…è¦æ€§ã€‚è€Œä¸”å¯¹äºç‚¹ä¸ç‚¹ä¹‹é—´çš„ä½œç”¨ PointNet ä¹Ÿæ²¡æœ‰æ·±å…¥è€ƒè™‘ï¼Œä½†åœ¨ä¹‹åçš„ PointNet++ ä¸­æå‡ºäº†è§£å†³æ–¹æ³•</p><h3 id="PointNet-Architecture"><a href="#PointNet-Architecture" class="headerlink" title="PointNet Architecture"></a>PointNet Architecture</h3><p>å…ˆçœ‹ä¸‹å›¾æœ‰ä¸ªæ•´ä½“æ„Ÿå—<img src="/archives/63387d0d/eef95113-fb3d-4ba8-b8a4-6c377d66d2bd.png" style="zoom: 50%;"></p><p>PointNet èƒ½å¤Ÿå¤„ç†åˆ†ç±»ä»»åŠ¡å’Œåˆ†å‰²ä»»åŠ¡ï¼Œåˆ†åˆ«å¯¹åº”ç€æµç¨‹å›¾çš„ä¸Šä¸‹ä¸¤ä¸ªéƒ¨åˆ†</p><p>input transform å’Œ feature transform çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†è®©ç½‘ç»œé¢å¯¹ç©ºé—´çš„æ—‹è½¬ã€ç¼©æ”¾ç­‰æœ‰ä¸€å®šçš„é²æ£’æ€§ï¼Œåœ¨è®ºæ–‡ä¸­çš„æ–¹æ³•æ˜¯æ–°å¼•å…¥äº†ä¸€ä¸ª <strong>T-Net</strong> ç½‘ç»œå»å­¦ä¹ ç‚¹äº‘çš„æ—‹è½¬ï¼Œå°†ç‰©ä½“æ ¡å‡†ï¼Œå…·ä½“çš„ç»“æ„åœ¨è¯¥ç¬”è®°ä¸­ä¸ä¼šè¯¦ç»†ä»‹ç»</p><p>Shared MLP æœ¬è´¨ä¸ºä¸€ç»´çš„å·ç§¯ <a href="https://pytorch.org/docs/stable/generated/torch.nn.Conv1d.html">Conv1d</a>ï¼Œå¯ä»¥å‚è€ƒé“¾æ¥ <a href="https://blog.csdn.net/Passersby__/article/details/104941591">CSDN</a> è¿›ä¸€æ­¥å­¦ä¹ ã€‚Shared MLP + Max Pooling æ“ä½œå®ç°äº†å¯¹æ— åºæ€§ç‚¹äº‘æ•°æ®çš„å¯¹ç§°å¤„ç†ï¼Œå³å½“ç‚¹äº‘è¾“å…¥é¡ºåºæ”¹å˜æ—¶ï¼Œè¾“å‡ºç»“æœä¸ä¼šå› ä¸ºè¾“å…¥é¡ºåºçš„æ”¹å˜è€Œæ”¹å˜ã€‚æ³¨æ„ Max Pooling æ˜¯å¯¹ä¸åŒçš„ç‚¹è€Œè¨€çš„ï¼Œè€Œä¸æ˜¯å¯¹äºåŒä¸€ä¸ªç‚¹çš„ç‰¹å¾å‘é‡æ“ä½œçš„ã€‚ä¸‹é¢æˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºä¸ºä½•ä½¿ç”¨ Shared MLP + Max Pooling</p><h3 id="Symmetry-Function-for-Unordered-Input"><a href="#Symmetry-Function-for-Unordered-Input" class="headerlink" title="Symmetry Function for Unordered Input"></a>Symmetry Function for Unordered Input</h3><p>ç‚¹äº‘å®é™…ä¸Šæ‹¥æœ‰<strong>ç½®æ¢ä¸å˜æ€§</strong>çš„ç‰¹ç‚¹ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ç½®æ¢ä¸å˜æ€§å‘¢ï¼Œç®€å•åœ°è¯´å°±æ˜¯ç‚¹çš„æ’åºä¸å½±å“ç‰©ä½“çš„æ€§è´¨ã€‚å› æ­¤é’ˆå¯¹ç‚¹äº‘çš„ç½®æ¢ä¸å˜æ€§ï¼Œå…¶è®¾è®¡çš„ç½‘ç»œå¿…é¡»æ˜¯ä¸€ä¸ª<strong>å¯¹ç§°çš„å‡½æ•°</strong>ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°çš„ <strong>sum</strong> å’Œ <strong>max</strong> ç­‰å‡½æ•°å…¶å®éƒ½æ˜¯å¯¹ç§°å‡½æ•°</p><p>æ–‡ç« çš„å…·ä½“åšæ³•ä¸ºï¼šå°†ç‚¹äº‘æ•°æ®ä½¿ç”¨ Shared MLP å‡ç»´ï¼ˆä»3ç»´æœ€ç»ˆå‡è‡³1024ç»´ï¼‰ï¼Œç„¶åä½¿ç”¨ max pooling æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªå…¨å±€çš„ç‰¹å¾å‘é‡ global featureã€‚ä½¿ç”¨è¯¥ global feature å°±å¯ä»¥è¿›è¡Œç‚¹äº‘çš„åˆ†ç±»ä»»åŠ¡äº†ï¼Œè€Œå¦‚æœæ˜¯è¿›è¡Œç‚¹äº‘åˆ†å‰²ä»»åŠ¡ï¼Œåˆ™éœ€è¦å’Œæ¯ä¸ªç‚¹çš„å±€éƒ¨ç‰¹å¾ç»“åˆèµ·æ¥ï¼Œå†è¿›è¡Œè®¡ç®—</p><p>Qï¼šå‡ç»´ï¼ˆæˆ–è€…è¯´å¤šå·ç§¯æ ¸ï¼‰åœ¨æ·±åº¦å­¦ä¹ å½“ä¸­æ˜¯éå¸¸å¸¸è§çš„ï¼Œè¯¥æ“ä½œçš„æœ¬è´¨æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸ªäººçŒœæµ‹ï¼šå¯¹é«˜ç»´åº¦çš„ç©ºé—´è¿›è¡Œåˆ†å‰²æ›´ç®€å•ï¼Œå¹¶å¯¹æ•°æ®ä¿ç•™è¶³å¤Ÿçš„ç‰¹å¾</p><h3 id="Shared-MLP-Max-Pooling-çš„åˆç†æ€§"><a href="#Shared-MLP-Max-Pooling-çš„åˆç†æ€§" class="headerlink" title="Shared MLP + Max Pooling çš„åˆç†æ€§"></a>Shared MLP + Max Pooling çš„åˆç†æ€§</h3><p>è¯¥è®ºæ–‡æå‡ºäº†å¦‚ä¸‹çš„å®šç†ï¼Œè¯¥å®šç†åŸºäºä¸‡èƒ½è¿‘ä¼¼å®šç†ï¼ˆUniversal Approximate Theoremï¼‰</p><p><img src="/archives/63387d0d/3b3fa29d-44f5-4724-af23-8438e1961530.png" style="zoom: 67%;"></p><p>å¯¹äºæ–‡ç« è¯æ˜ç†è§£ï¼Œæœ‰2ä¸ªæ¦‚å¿µéœ€è¦è¿›ä¸€æ­¥äº†è§£ï¼Œä¸€ä¸ªæ˜¯ <a href="https://en.wikipedia.org/wiki/Hausdorff_distance">Hausdorff_distance</a> ä¸€ä¸ªæ˜¯ <a href="https://en.wikipedia.org/wiki/Power_set">Power set</a>ï¼Œå‰è€…è¡¨ç¤ºäº†ä¸¤ä¸ªé›†åˆçš„è·ç¦»ï¼Œåè€…è¡¨ç¤ºäº†ä¸€ä¸ªé›†åˆçš„æ‰€æœ‰å­é›†</p><p>è¯¥å®šç†çš„ç»“è®ºæ˜¯ï¼Œè®ºæ–‡æå‡ºçš„ç»“æ„ï¼Œèƒ½å¤Ÿæ‹Ÿåˆä»»æ„çš„è¿ç»­é›†åˆå‡½æ•°ã€‚è¿™ä¸ªå®šç†çš„ç»“è®ºï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šæ„ä¹‰ï¼Œå› ä¸ºä¸‡èƒ½è¿‘ä¼¼å®šç†æ—©å°±å‘Šè¯‰æˆ‘ä»¬ï¼Œè¶³å¤Ÿå¤šèŠ‚ç‚¹çš„ MLP èƒ½å¤Ÿè¿‘ä¼¼ä»»ä½•è¿ç»­å‡½æ•°ã€‚é‡ç‚¹åœ¨äºè®ºæ–‡çš„è¯æ˜è¿‡ç¨‹ï¼Œç»™å‡ºäº† Shared MLP + Max Pooling çš„åˆç†æ€§ï¼Œè¯¥åˆç†æ€§æ€»ç»“ä¸ºå¦‚ä¸‹</p><blockquote><p>The proof to this theorem can be found in our supplementary material. The key idea is that in the worst case the network can learn to convert a point cloud into a volumetric representation, by partitioning the space into equal-sized voxels. In practice, however, the network learns a much smarter strategy to probe the space, as we shall see in point function visualizations.</p></blockquote><p>è¿™é‡Œçš„ worst case çš„â€œæœ€å·®â€ä½“ç°åœ¨ä½•å¤„æˆ‘å¹¶ä¸ç†è§£ï¼Œä½†æ˜¯è¯æ˜è¿‡ç¨‹ä¸­æŒ‡å‡ºäº†ç½‘ç»œçš„ä¸€æ¡å¯èƒ½çš„å­¦ä¹ è·¯å¾„ã€‚è¯¥å­¦ä¹ è·¯å¾„æè¿°ä¸ºå¦‚ä¸‹ï¼š</p><ol><li>å°†æ‰€æœ‰çš„ç‚¹æ˜ å°„åˆ°å…¶â€œé™„è¿‘â€çš„æ …æ ¼ç‚¹ä¸­ï¼Œè¿™æ ·å¾—åˆ°ä¸€ä¸ªæ–°çš„ç‚¹é›†ï¼Œå¯ä»¥è¯æ˜ä½¿ç”¨è¯¥æ …æ ¼ç‚¹é›†ä½œä¸ºè¾“å…¥å»æ›¿æ¢åŸç‚¹é›†ï¼Œå¹¶ä¸ä¼šå¯¹è¾“å‡ºé€ æˆå¤ªå¤§çš„å½±å“ï¼Œæ‰€ä»¥è¯¥æ …æ ¼ç‚¹é›†å°±æ˜¯å¯¹åŸç‚¹é›†çš„ä¸€ä¸ªå¾ˆå¥½çš„è¿‘ä¼¼ã€‚è€Œè¿™ä¸ªæ˜ å°„å°±æ˜¯ç”± Shared MLP + Max Pooling + MLP å®Œæˆ</li><li>æ­¤æ—¶è¿˜éœ€è¦ä½¿ç”¨æ–°çš„ MLP å®Œæˆå¯¹åŸè¿ç»­é›†å‡½æ•°çš„æ‹Ÿåˆã€‚è¯¥ MLP å’Œç¬¬ä¸€æ­¥ä¸­çš„ MLP å¯ä»¥å åŠ èµ·æ¥ï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“çš„ MLPï¼Œåœ¨å…¬å¼ä¸­å³è¡¨ç¤ºä¸º Î³ å‡½æ•°</li></ol><p>é€šè¿‡äººä¸ºè®¾ç½®çš„å­¦ä¹ è·¯å¾„ï¼Œè§£é‡Šäº†è¯¥ç»“æ„çš„åˆç†æ€§ã€‚ä½†é€šè¿‡ç½‘ç»œè‡ªèº«çš„å­¦ä¹ ï¼Œèƒ½å¤Ÿè·å¾—æ›´å¥½çš„æ•ˆæœï¼Œå‰©ä¸‹çš„å°±äº¤ç»™ä¼˜åŒ–ç®—æ³•å§ï¼</p><h2 id="PointNet-1"><a href="#PointNet-1" class="headerlink" title="PointNet++"></a>PointNet++</h2><p>PointNet++ çš„æå‡ºæºäº PointNet çš„ç¼ºç‚¹â€”â€”ç¼ºå¤±å±€éƒ¨ç‰¹å¾ã€‚PointNetå¯¹äºåœºæ™¯çš„åˆ†å‰²æ•ˆæœååˆ†ä¸€èˆ¬ï¼Œç”±äºå…¶ç½‘ç»œç›´æ¥æš´åŠ›åœ°å°†æ‰€æœ‰çš„ç‚¹æœ€å¤§æ± åŒ–ä¸ºäº†ä¸€ä¸ªå…¨å±€ç‰¹å¾ï¼Œå› æ­¤å±€éƒ¨ç‚¹ä¸ç‚¹ä¹‹é—´çš„è”ç³»å¹¶æ²¡æœ‰è¢«ç½‘ç»œå­¦ä¹ åˆ°ã€‚PointNet++ ä¸­ä¸»è¦å€Ÿé‰´äº† CNN çš„å¤šå±‚æ„Ÿå—é‡çš„æ€æƒ³ï¼Œå¢å¼ºäº†ç½‘ç»œå¯¹äºå±€éƒ¨ç‰¹å¾çš„æå–èƒ½åŠ›</p><p>å…·ä½“æ¥è®²å°±æ˜¯ï¼šå¯¹äºç‚¹äº‘æ•°æ®ï¼Œå°†ç‚¹äº‘æ•°æ®è¿›è¡Œé‡‡æ ·å’Œåˆ†ç»„ï¼Œä½¿ç”¨åŸ PointNet å¯¹è¿™äº›åˆ†ç»„åçš„ç‚¹äº‘å­é›†è¿›è¡Œç‰¹å¾æå–ï¼ˆè€Œéä¹‹å‰çš„å…¨å±€ç‰¹å¾æå–ï¼‰ï¼Œå¾—åˆ°äº†æ–°çš„ç‰¹å¾é›†åˆï¼Œå¯¹äºæ–°çš„ç‰¹å¾é›†åˆï¼Œå¯ä»¥é‡å¤ä¹‹å‰çš„é‡‡æ ·ã€åˆ†ç»„ã€æå–è¿‡ç¨‹ï¼Œä¸æ–­åœ°è¿­ä»£ã€‚éšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ ï¼ŒPointNet çš„æ„Ÿå—é‡ä¹Ÿè¶Šæ¥è¶Šå¤§ï¼Œä¸‹å›¾ä¸º PointNet++  (single scale grouping) çš„ç»“æ„å›¾ï¼Œèƒ½å¤Ÿæœ‰ä¸€ä¸ªæ›´åŠ ç›´è§‚çš„æ„Ÿå—</p><p><img src="/archives/63387d0d/a4bc72c1-997d-4536-b50a-78a1917af8d6.png" style="zoom: 67%;"></p><h3 id="PointNet-Architecture-1"><a href="#PointNet-Architecture-1" class="headerlink" title="PointNet++ Architecture"></a>PointNet++ Architecture</h3><p>å’Œ PointNet ç±»ä¼¼ï¼Œæ•´ä½“ä¾æ—§æ˜¯ encoder-decoder æ¨¡å¼ï¼Œå¯ä»¥å¤„ç†åˆ†å‰²ä»»åŠ¡å’Œåˆ†ç±»ä»»åŠ¡ï¼Œä½†ä¸¤ä¸ªä»»åŠ¡çš„ decoder ä¸ç›¸åŒ</p><h4 id="Encoder"><a href="#Encoder" class="headerlink" title="Encoder"></a>Encoder</h4><p>Encoder ç”±å¤šä¸ª set abstraction ç»“æ„ç»„æˆï¼Œå…¶ä¸­ set abstraction ç”±3ä¸ªé‡è¦éƒ¨åˆ†ç»„æˆï¼šsampling é‡‡æ ·ï¼Œgrouping åˆ†ç»„ï¼ŒPointNet ä½¿ç”¨ PointNet é‡‡é›†ç‰¹å¾ï¼Œæ¥ä¸‹æ¥è¿›ä¸€æ­¥äº†è§£è¿™ä¸‰ä¸ªéƒ¨åˆ†</p><ol><li>Samplingï¼šä½¿ç”¨åˆ©ç”¨ FPSï¼ˆæœ€è¿œç‚¹é‡‡æ ·ï¼‰éšæœºé‡‡æ ·ç‚¹ï¼Œå‚è€ƒé“¾æ¥ <a href="https://blog.csdn.net/minhuaQAQ/article/details/107280596">CSDN</a></li><li>Groupingï¼šåˆ©ç”¨ Ball Query åˆ’ä¸€ä¸ª R ä¸ºåŠå¾„çš„åœˆï¼Œå°†æ¯ä¸ªåœˆé‡Œé¢çš„ç‚¹äº‘ä½œä¸ºä¸€ç°‡</li><li>PointNetï¼š å¯¹ Sampling + Grouping ä»¥åçš„ç‚¹äº‘è¿›è¡Œç‰¹å¾æå–ï¼Œæ³¨æ„è¿™é‡Œçš„ PointNet å’ŒåŸ PointNet ç›¸æ¯”ï¼Œå»æ‰äº†å…¶ä¸­çš„ T-Net transform çš„éƒ¨åˆ†</li></ol><p>æ•°æ®çš„å½¢çŠ¶å˜åŒ–ä¸ºï¼š</p><p>Input (N, d) -&gt; sampling (n, d) -&gt; grouping (n, K, d) -&gt; PointNet (n, C + d) -&gt; â€¦</p><p>å…¶ä¸­ d åº”è¯¥ä¸ºç‚¹çš„åŸå§‹ä¿¡æ¯ï¼Œä¼šä¸€ç›´è·Ÿéšç€ç‚¹å­˜åœ¨ï¼Œå› ä¸º sampling + grouping å°†ä¼šä½¿ç”¨</p><h4 id="Decoder"><a href="#Decoder" class="headerlink" title="Decoder"></a>Decoder</h4><p>åˆ†ç±»ä»»åŠ¡çš„ decoder ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä½¿ç”¨ PointNet æå–å…¨å±€ç‰¹å¾ï¼Œç„¶åé€å…¥ MLP ä¸­è¿›è¡Œåˆ†ç±»</p><p>åˆ†å‰²ä»»åŠ¡çš„ decoder éœ€è¦å¾—åˆ°æ¯ä¸€ä¸ªç‚¹çš„ç‰¹å¾å‘é‡ï¼Œä½†æ˜¯ç»è¿‡ encoder æˆ‘ä»¬åªæœ‰å°‘æ•°ä¸€äº›ç‚¹çš„ç‰¹å¾ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè®ºæ–‡é‡‡å–çš„ç»“æ„ä¸º Point Feature Propagationï¼Œå°†å°‘æ•°ç‚¹çš„ç‰¹å¾é€å±‚ä¼ æ’­åˆ°æ¯ä¸€ä¸ªç‚¹ï¼Œå…¶æœ¬è´¨ä¸ºæ’å€¼ interpolationã€‚å…¬å¼å¦‚ä¸‹ï¼Œç”± <a href="https://www.latexlive.com/">latexlive</a> ä»å›¾ç‰‡ç”Ÿæˆ</p><script type="math/tex; mode=display">f^{(j)}(x)=\frac{\sum_{i=1}^{k} w_{i}(x) f_{i}^{(j)}}{\sum_{i=1}^{k} w_{i}(x)} \quad \text { where } \quad w_{i}(x)=\frac{1}{d\left(x, x_{i}\right)^{p}}, j=1, \ldots, C</script><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†è¯¥ç‚¹å‘¨å›´çš„ç‚¹çš„ç‰¹å¾å€¼è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œä½œä¸ºè¯¥ç‚¹è‡ªå·±çš„ç‰¹å¾ï¼Œè®ºæ–‡å– k = 3, p = 2ï¼Œå³ neighbor æœ‰3ä¸ªï¼Œè·ç¦»ä¸ºæ¬§æ°è·ç¦»</p><p>é™¤äº†å¯¹ç‚¹è¿›è¡Œæ’å€¼ï¼Œè¿›è¡Œç‰¹å¾ä¼ æ’­å¤–ï¼Œè®ºæ–‡è¿˜å°†æ’å€¼å¾—åˆ°ç‰¹å¾ä¸ encoder ä¸­å¯¹åº”å±‚çš„ç›¸åŒç‚¹çš„ç‰¹å¾è¿æ¥èµ·æ¥ concatenateï¼Œä½¿å¾—ç‰¹å¾çš„ä¿¡æ¯ä¿ç•™æ›´å¤š</p><h4 id="å¤šå°ºåº¦-MSG-amp-MRG"><a href="#å¤šå°ºåº¦-MSG-amp-MRG" class="headerlink" title="å¤šå°ºåº¦ MSG &amp; MRG"></a>å¤šå°ºåº¦ MSG &amp; MRG</h4><p>ä¸ºäº†ç»§ç»­å¢åŠ ç½‘ç»œå¯¹äºå¤šå°ºåº¦ä¿¡æ¯çš„æå–ï¼Œè®ºæ–‡ä¹Ÿæå‡ºäº†ä¸¤ç§å¤šå°ºåº¦ grouping æ–¹æ³•ï¼ŒMSG &amp; MRG å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="/archives/63387d0d/4c9a6b7b-e492-40fe-b552-5a63e7aab832.png" style="zoom:43%;"></p><ol><li>MSGï¼šæ¯”è¾ƒå¥½ç†è§£ï¼Œå°±æ˜¯ä½¿ç”¨å¤šä¸ªåŠå¾„ï¼Œå»è·å–å¤šä¸ªå°ºåº¦çš„ç‰¹å¾ï¼Œç„¶åå°†è¿™äº›ç‰¹å¾è¿æ¥èµ·æ¥</li><li>MRGï¼šMSG çš„è®¡ç®—é‡ç›¸å¯¹æ¯”è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯åœ¨ç‚¹æ¯”è¾ƒå¤šçš„æ—¶å€™ã€‚è®ºæ–‡æå‡ºäº† MRGï¼ŒMRG åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå·¦è¾¹ç‰¹å¾ä¸ºä¸€èˆ¬çš„ grouping å¾—åˆ°çš„ç‰¹å¾ï¼Œå³è¾¹ç‰¹å¾ä¸ºè¯¥ grouping èŒƒå›´åœ¨åŸå§‹ç‚¹äº‘ä¸­çš„ä½ç½®ï¼Œå¯¹è¯¥ä½ç½®èŒƒå›´å†…çš„åŸå§‹ç‚¹äº‘åšç‰¹å¾æå–ã€‚ç”±äº MRG ä½œè€…å¹¶ä¸ºå°†å…¶ä»£ç å¼€æºï¼Œæ‰€ä»¥å¯èƒ½ç†è§£å¹¶ä¸æ·±åˆ»ï¼Œæ‰€ä»¥è¯·å‚è€ƒåŸæ–‡åŠå…¶é™„å½•</li></ol><h4 id="æ•°æ®é¢„å¤„ç†-Dropout"><a href="#æ•°æ®é¢„å¤„ç†-Dropout" class="headerlink" title="æ•°æ®é¢„å¤„ç† Dropout"></a>æ•°æ®é¢„å¤„ç† Dropout</h4><p>å¤šå°ºåº¦è®­ç»ƒçš„ç›®çš„ä¹‹ä¸€æ˜¯ä¸ºäº†æ›´å¥½åº”å¯¹ç‚¹äº‘å¯†åº¦çš„å˜åŒ–ï¼Œå¯¹äºå¯†åº¦ä½çš„ç‚¹äº‘ï¼Œé€‰å–æ›´å¤§å°ºåº¦èŒƒå›´çš„ç‰¹å¾æ•ˆæœä¼šæ›´å¥½ã€‚åŒæ—¶è®ºæ–‡ä¹Ÿé‡‡ç”¨äº† dropout æ“ä½œï¼Œå¯¹è®­ç»ƒæ•°æ®ç‚¹ä»¥ dropout ratio Î¸ è¿›è¡Œéšæœºå‰”é™¤ï¼Œè€Œ Î¸ æ˜¯ä» 0-0.95 ä¸­å‡åŒ€é‡‡æ ·å¾—åˆ°ï¼Œè¿™æ ·å°±èƒ½åˆ›å»ºä¸åŒå¯†åº¦çš„ç‚¹äº‘æ•°æ®äº†</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>PointNet ç³»åˆ—æ˜¯ç‚¹äº‘åˆ†å‰²ç½‘ç»œæœ€åˆçš„ baselineï¼Œä¸€äº›ç½‘ç»œä¹Ÿæ˜¯é€šè¿‡ä»¥è¿™ä¸¤ä¸ªç½‘ç»œä¸ºåŸºç¡€æ„é€ å‡ºæ¥çš„ã€‚å…¶ä¼˜ç‚¹éå¸¸çš„æ˜æ˜¾ï¼Œå°±æ˜¯<strong>å‚æ•°é‡å°</strong>ï¼›ä½†å…¶ç¼ºç‚¹å°±æ˜¯å¯¹äº<strong>å±€éƒ¨çš„ç‰¹å¾çš„æŠ“å–è¿˜ä¸æ˜¯ç‰¹åˆ«çš„å®Œå–„</strong>ï¼Œè¿™ä¹Ÿæ˜¯æœªæ¥å¯ä»¥æ”¹è¿›çš„åœ°æ–¹</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Point Cloud </tag>
            
            <tag> PointNet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Point-GNN</title>
      <link href="/archives/74da7df7.html"/>
      <url>/archives/74da7df7.html</url>
      
        <content type="html"><![CDATA[<h1 id="Point-GNN-note"><a href="#Point-GNN-note" class="headerlink" title="Point-GNN note"></a>Point-GNN note</h1><p>ç”±äºå¯¹äºGNNæ²¡æœ‰è¿‡å¤šçš„äº†è§£ï¼Œå¹¶ä¸èƒ½æ„Ÿå—åˆ°GNNç›¸å¯¹äºCNNæœ‰æå¤§çš„ä¼˜åŠ¿ã€‚ç›¸åçš„ï¼Œåœ¨å…¶ä¸­è®¾è®¡çš„å¾ˆå¤šç»“æ„ï¼Œä¸ä½¿ç”¨CNNå¤„ç†æ˜¯ç›¸ä¼¼çš„ï¼Œæœ€æ ¸å¿ƒçš„è§‚ç‚¹å°±æ˜¯æ•æ‰åˆ° (multi-scale) local featureï¼Œè¿™ç¯‡ç¬”è®°ä»…æ½¦è‰è®°å½•ä¸€ä¸‹</p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>æ„å»ºå›¾çš„æ–¹æ³•ï¼šä»¥ç‚¹ä½œä¸ºå›¾çš„é¡¶ç‚¹ï¼Œå°†æ¯ä¸ªç‚¹å’Œé™„è¿‘çš„ç‚¹ç›¸è¿å½¢æˆè¾¹</p><p>We encode the point cloud natively in a graph by using the points as the graph vertices. The edges of the graph connect neighborhood points that lie within a fixed radius, which allows feature information to flow between neighbors.  </p><p>A graph neural network reuses the graph edges in every layer, and avoids grouping and sampling the points repeatedly.</p><p><strong>å‡ ä¸ªç‰¹ç‚¹</strong>ï¼š</p><ol><li>Use a graph representation can <strong>preserve the irregularity</strong> of a point cloud</li><li>Unlike the techniques that sample and group the points into sets repeatedly, <strong>we construct the graph once</strong>. </li><li>The proposed Point-GNN then extracts features of the point cloud by <strong>iteratively updating vertex features</strong> on the same graph. Our work is a <strong>single-stage detection</strong> method.</li></ol><h2 id="Point-GNN-for-3D-Object-Detection-in-a-Point-Cloud"><a href="#Point-GNN-for-3D-Object-Detection-in-a-Point-Cloud" class="headerlink" title="Point-GNN for 3D Object Detection in a Point Cloud"></a>Point-GNN for 3D Object Detection in a Point Cloud</h2><p>our method contains three components:</p><p>(a) graph construction, </p><p>(b) a GNN of T iterations, and </p><p>(c) bounding box merging and scoring.</p><p><img src="/archives/74da7df7/image-20210615114208241.png" style="zoom:80%;"></p><h3 id="Graph-construction"><a href="#Graph-construction" class="headerlink" title="Graph construction"></a>Graph construction</h3><p>Formally, we define a point cloud of N points as a set $P = \{p_1, â€¦, p_N \}$, where $p_i = (x_i, s_i)$</p><p>$x_i$æ˜¯åæ ‡ï¼Œ$s_i$ä¸ºstate valueå¯ä»¥çœ‹ä½œfeature</p><p> we construct a graph G = (P, E) by using P as the vertices and connecting a point to its neighbors within a fixed radius r</p><p><img src="/archives/74da7df7/image-20210614174123691.png" style="zoom:80%;"></p><p>ç”±äºç‚¹å¤ªå¤šäº†ï¼Œéœ€è¦ä¸‹é‡‡æ ·</p><p>we use a voxel downsampled point cloud $\hat{P}$ for the graph construction.</p><p>ä¸ºäº†ä¿ç•™åŸç‚¹äº‘çš„ä¿¡æ¯ï¼Œå…ˆç”¨PointNetå°†ç‚¹äº‘encodeï¼ˆæ–‡ç« è¯´ä¸ç”¨grouping and samplingå…¶å®åˆ°å¤„éƒ½åœ¨ç”¨ï¼‰</p><p>To preserve the information within the original point cloud, we encode the dense point cloud in the initial state value si of the vertex. More specifically, we search the raw points within a r0 radius of each vertex and use the neural network on sets to extract their features. </p><h3 id="Graph-Neural-Network-with-Auto-Registration"><a href="#Graph-Neural-Network-with-Auto-Registration" class="headerlink" title="Graph Neural Network with Auto-Registration"></a>Graph Neural Network with Auto-Registration</h3><p><strong>GNNä¸€èˆ¬è¿­ä»£è¿‡ç¨‹</strong></p><p>A typical graph neural network refines the vertex features by aggregating features along the edges.</p><p>åœ¨ $(t+1)^{th}$ è¿­ä»£ä¸­ï¼Œé¡¶ç‚¹æ›´æ–°å…¬å¼ä¸º</p><p><img src="/archives/74da7df7/image-20210614214253822.png" style="zoom:80%;"></p><p>where  $e^t$ and $v^t$ are the edge and vertex features from the $t^{th}$ iteration.</p><p>$f^t(Â·)$ é€šè¿‡ä¸¤ä¸ªé¡¶ç‚¹çš„ç‰¹å¾æ¥æ›´æ–°è¾¹çš„ç‰¹å¾</p><p>$\rho(Â·)$ ä¸ºä¸€ä¸ªé›†å‡½æ•°ï¼Œå°†æ¯ä¸ªé¡¶ç‚¹çš„è¾¹çš„ç‰¹å¾è¿›è¡Œç»¼åˆ</p><p>$g^t(Â·)$ æ›´æ–°é¡¶ç‚¹içš„ç‰¹å¾</p><p>åœ¨æœ¬æ–‡ä¸­ï¼Œé¡¶ç‚¹çš„ç‰¹å¾ $v_i$ï¼Œå°±æ˜¯ä¹‹å‰æ‰€è¯´çš„æ¯ä¸ªç‚¹çš„çŠ¶æ€ $s_i$</p><p>åœ¨æœ¬æ–‡æ–°çš„è¿­ä»£æ›´æ–°æ–¹ç¨‹è¢«æå‡ºï¼Œä½†æˆ‘ä¸ç†è§£å…¶ä¸­çš„æ„ä¹‰ï¼Œæ–‡ç« è¯´è¿™æ ·çš„æ›´æ–°æ˜¯ä¸ºäº†å¢åŠ translation invariance</p><p><img src="/archives/74da7df7/image-20210614215842089.png" style="zoom:50%;"></p><h3 id="LOSS"><a href="#LOSS" class="headerlink" title="LOSS"></a>LOSS</h3><p> We use the average cross-entropy loss as the classification loss.</p><p><img src="/archives/74da7df7/image-20210614220904072.png" style="zoom: 67%;"></p><p>We encode the bounding box with the vertex coordinates (xv, yv, zv) as follows:</p><p><img src="/archives/74da7df7/image-20210614220942233.png" style="zoom:67%;"></p><p>We then average the localization loss of all the vertices:</p><p><img src="/archives/74da7df7/image-20210614221044678.png" style="zoom:67%;"></p><p>To prevent over-fitting, we add L1 regularization to each MLP. The total loss is then:</p><p><img src="/archives/74da7df7/image-20210614221104990.png" style="zoom: 80%;"></p><h3 id="Box-Merging-and-Scoring"><a href="#Box-Merging-and-Scoring" class="headerlink" title="Box Merging and Scoring"></a>Box Merging and Scoring</h3><p>æ–‡ç« é€šè¿‡ä¸€äº›çš„æ–¹æ³•æ¥å®ç°è¿‘ä¼¼äºï¼ˆæ›´å¥½äºï¼‰NMSçš„æ•ˆæœï¼Œæˆ‘æ²¡æœ‰ä»”ç»†çœ‹</p><h2 id="Eperiment"><a href="#Eperiment" class="headerlink" title="Eperiment"></a>Eperiment</h2><p>æœ€ç»ˆå®éªŒç»“æœè¿˜æ˜¯å¾ˆä¸é”™çš„</p><p><img src="/archives/74da7df7/image-20210614221626269.png" style="zoom:80%;"></p><p><img src="/archives/74da7df7/image-20210614221800920.png" style="zoom:80%;"></p><p>æ„Ÿè§‰æ¯”è¾ƒç®€å•çš„è®¾è®¡ä½†è¾¾åˆ°äº†è¾ƒå¥½çš„æ•ˆæœï¼Œä¹Ÿä¸æ¸…æ¥šè¿™ä¸ªç½‘ç»œçš„è¡¨ç°å¥½åˆ°åº•æ¥æºäºå“ªä¸€éƒ¨åˆ†â€¦</p><p>ä¸ä½œä¸ºä»Šåå»¶ç”³çš„é‡ç‚¹ï¼ŒæŒè§‚æœ›æ€åº¦</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Point Cloud </tag>
            
            <tag> Point-GNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PointPillars (dev)</title>
      <link href="/archives/f3e8f95c.html"/>
      <url>/archives/f3e8f95c.html</url>
      
        <content type="html"><![CDATA[<h1 id="PointPillars-note"><a href="#PointPillars-note" class="headerlink" title="PointPillars note"></a>PointPillars note</h1><p>è¿™ç¯‡æ–‡ç« ä¹Ÿç»å¸¸åœ¨å…¶ä»–æ–‡ç« ä¸­è¢«æåˆ°ï¼Œè¯¥ç½‘ç»œç‰¹ç‚¹å°±æ˜¯å…·æœ‰éå¸¸å¿«çš„æ¨ç†é€Ÿåº¦ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/nutonomy/second.pytorch">https://github.com/nutonomy/second.pytorch</a></p><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>In this work we propose PointPillars, a novel encoder which <strong>utilizes PointNets to learn a representation of point clouds organized in vertical columns (pillars).</strong> While <strong>the encoded features can be used with any standard 2D convolutional detection architecture,</strong> we further propose a lean downstream network</p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Recently SECOND  improved the inference speed of VoxelNet but the 3D convolutions remain a bottleneck. è¿™ç¯‡æ–‡ç« çš„ä¸€ä¸ªå‡ºå‘ç‚¹ä¹‹ä¸€ï¼Œå°±æ˜¯ä¸æƒ³ä½¿ç”¨3D convolutionï¼Œæ–‡ç« çš„å¿«é€Ÿæ¨ç†èƒ½åŠ›ä¸€éƒ¨åˆ†ä¹Ÿæ¥è‡ªäºæ²¡æœ‰ä½¿ç”¨3D convolution</p><p>In this work we use a single stage method</p><p>We show how all computations on pillars can be posed as dense 2D convolutions which enables <strong>inference at 62 Hz;</strong> a factor of 2-4 times faster than other methods</p><h2 id="PointPillars-Network"><a href="#PointPillars-Network" class="headerlink" title="PointPillars Network"></a>PointPillars Network</h2><p>It consists of three main stages (Figure 2): </p><p>(1) A feature encoder network that <strong>converts a point cloud to a sparse pseudoimage;</strong></p><p>(2) <strong>a 2D convolutional backbone</strong> to process the pseudo-image into high-level representation; and </p><p>(3) a detection head that <strong>detects and regresses 3D boxes.</strong></p><p><img src="/archives/f3e8f95c/image-20210615120459627.png" style="zoom:80%;"></p><h3 id="Pointcloud-to-Pseudo-Image"><a href="#Pointcloud-to-Pseudo-Image" class="headerlink" title="Pointcloud to Pseudo-Image"></a>Pointcloud to Pseudo-Image</h3><p>As a first step the point cloud is discretized into an evenly spaced grid in the x-y plane, creating a set of pillars P with |P| = B</p><p>The points in <strong>each pillar are then augmented with</strong> $x_c, y_c, z_c, x_p, y_p$ where the c subscript denotes distance to the arithmetic mean of all points in the pillar and the p subscript denotes the offset from the pillar x, y center. </p><p>The augmented lidar point l is now <strong>D = 9</strong> dimensional $(x, y, z, r, x_c, y_c, z_c, x_p, y_p)$ </p><p>The set of pillars will be mostly empty due to sparsity of the point cloud</p><p>ä¸ºäº†æ›´è¿‘ä¸€æ­¥å¤„ç†sparsityï¼Œè§„å®šäº†æ¯ä¸ªsampleï¼Œæœ€å¤šæœ‰ P ä¸ª non-empty Pillarsï¼Œæ¯ä¸ª pillar æœ€å¤šæœ‰ N ä¸ª pointsï¼Œå¤šäºå°±è¿›è¡Œéšæœºé‡‡æ ·ã€‚æœ€ç»ˆå¾—åˆ° tensor of size (D, P, N)</p><p>ä¹‹åä½¿ç”¨PointNetï¼Œå°†æ¯ä¸ªPillarè¿›è¡Œ aggreagte å¾—åˆ° feature tensor (C, P)ï¼Œå†å°†è¿™ä¸ª feature tensor è¿˜åŸæˆä¸º feature map</p><h3 id="Backbone"><a href="#Backbone" class="headerlink" title="Backbone"></a>Backbone</h3><p><strong>We use a similar backbone as VoxelNet</strong> and the structure is shown in Figure 2. The backbone has two sub-networks: one top-down network that produces features at increasingly small spatial resolution and a second network that performs upsampling and concatenation of the top-down features. </p><p><strong>The top-down backbone can be characterized by a series of blocks Block(S, L, F).</strong> Each block operates at stride S (measured relative to the original input pseudo-image). A block has L 3x3 2D conv-layers with F output channels, each followed by BatchNorm and a ReLU</p><h3 id="Detection-Head"><a href="#Detection-Head" class="headerlink" title="Detection Head"></a>Detection Head</h3><p>In this paper, we use the Single Shot Detector (SSD) [18] setup to perform 3D object detection. Similar to SSD, we match the priorboxes to the ground truth using 2D Intersection over Union (IoU) [4]. ä½¿ç”¨ 2D IoU æ¥è®¡ç®— positive and negative anchors</p><h2 id="Loss"><a href="#Loss" class="headerlink" title="Loss"></a>Loss</h2><p>Ground truth boxes and anchors are defined by $(x, y, z, w, l, h, \theta)$. The localization regression residuals between ground truth and anchors are defined by:</p><p><img src="/archives/f3e8f95c/image-20210615124243246.png" style="zoom:67%;"></p><p>å…¶ä¸­ $d^a = \sqrt{(w^a)^2+(l^a)^2}$ ï¼Œthe total localization loss is: </p><p><img src="/archives/f3e8f95c/image-20210615124445132.png" style="zoom:67%;"></p><p>ä¸ºäº†è¾¨åˆ«è½¦å­çš„æœå‘ï¼ˆæœå‰è¿˜æ˜¯æœåï¼‰ï¼Œè¿˜è¦é¢„æµ‹ directionï¼Œæ–‡ç« ç›´æ¥ä½¿ç”¨ softmax åˆ†ç±»</p><p>For the object classification loss, we use the focal loss [16]:</p><p><img src="/archives/f3e8f95c/image-20210615124612144.png" style="zoom:67%;"></p><p> The total loss is therefore</p><p><img src="/archives/f3e8f95c/image-20210615124700683.png" style="zoom:67%;"></p><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><p>é‡è¦å‚æ•°ï¼šUnless explicitly varied in an experimental study, we use an xy resolution: 0.16 m, max number of pillars (P): 12000, and max number of points per pillar (N): 100.</p><p><img src="/archives/f3e8f95c/image-20210615124819976.png" style="zoom:80%;"></p><h3 id="Speed-v-s-resolution-amp-presicion"><a href="#Speed-v-s-resolution-amp-presicion" class="headerlink" title="Speed v.s. resolution &amp; presicion"></a>Speed v.s. resolution &amp; presicion</h3><p><img src="/archives/f3e8f95c/image-20210615124859420.png" style="zoom:80%;"></p><h3 id="Ground-truth-sampling"><a href="#Ground-truth-sampling" class="headerlink" title="Ground truth sampling"></a>Ground truth sampling</h3><p>å®šä¹‰å¦‚ä¸‹ï¼šfollowing SECOND [28], we create a lookup table of the ground truth 3D boxes for all classes and the associated point clouds that falls inside these 3D boxes. Then for each sample, we randomly select 15, 0, 8 ground truth samples for cars, pedestrians, and cyclists respectively and place them into the current point cloud. We found these settings to perform better than the proposed settings </p><p>æ–‡ç« æåˆ°è¿™ä¸ªæŠ€å·§æå‡/è§£é‡Šå¾ˆå¤šæ–¹æ³•çš„è¡¨ç°</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Point Cloud </tag>
            
            <tag> PointPillars </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PointRCNN</title>
      <link href="/archives/51543c70.html"/>
      <url>/archives/51543c70.html</url>
      
        <content type="html"><![CDATA[<h1 id="PointRCNN"><a href="#PointRCNN" class="headerlink" title="PointRCNN"></a>PointRCNN</h1><hr><p>Shi, Shaoshuai, Xiaogang Wang, and Hongsheng Li. â€œPointRCNN: 3D Object Proposal Generation and Detection from Point Cloud.â€ <em>ArXiv:1812.04244 [Cs]</em>, May 16, 2019. <a href="http://arxiv.org/abs/1812.04244">http://arxiv.org/abs/1812.04244</a>.</p><p>Comment: Accepted by CVPR 2019</p><hr><p>ä»Šåçš„è®ºæ–‡æ•´ç†åº”è¯¥éµå¾ªä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ï¼š</p><ol><li>å‰è¨€ï¼šä¸»è¦ä¸ºäº†æå‡ºé—®é¢˜ï¼Œå¼•å…¥èƒŒæ™¯ï¼Œå¼•å‡ºè®ºæ–‡ã€‚æè¿°ä¸€ä¸‹æ–‡ç« è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠå…¶é‡è¦äº®ç‚¹ Remark</li><li>ç»“æ„ï¼šæè¿°è®ºæ–‡ä¸­çš„ç½‘ç»œç»“æ„ï¼ŒåŠå…¶æ ¸å¿ƒæ€æƒ³</li><li>å®éªŒï¼šè®ºæ–‡çš„ç»“æœå¥½å</li><li>æ€»ç»“ï¼šå†™ä¸€äº›è‡ªå·±çš„æƒ³æ³•ï¼Œæå‡ºå¯èƒ½çš„æ–¹å‘</li></ol><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>PointRCNN çš„ä¸€å¤§ç‰¹ç‚¹æ˜¯ï¼Œè¯¥æ–¹æ³•<strong>åŸºäºåŸå§‹çš„ç‚¹äº‘æ•°æ®ç›´æ¥è¿›è¡Œç‰¹å¾æå–å’Œ RPN æ“ä½œ</strong>ã€‚éšç€ PointNet ç³»åˆ—è®ºæ–‡çš„å‡ºç°ï¼Œå¯ä»¥ç›´æ¥åŸºäºç‚¹äº‘åŸå§‹æ•°æ®è¿›è¡Œç‰¹å¾æå–ï¼Œè€Œä¸éœ€è¦è¿›è¡Œä½“ç´ åŒ– (VoxelNetï¼ŒSECOND) æˆ–è€…å¯¹ç‚¹äº‘è¿›è¡ŒæŠ•å½± (PointPillar) å†ä½¿ç”¨äºŒç»´çš„ä¸€äº›æ–¹æ³•ã€‚ç›´æ¥ä½¿ç”¨ç‚¹äº‘æ•°æ®ï¼Œæœ€æ˜æ˜¾çš„å¥½å¤„å°±æ˜¯å‡å°‘äº†ä¿¡æ¯ä¸¢å¤± information loss</p><p>ä½†åœ¨å…¶ä»–çš„æ–‡ç« å½“ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äºŒç»´çš„å¤„ç†æ–¹æ³•å¹¶ä¸æ˜¯å®Œå…¨è¢«æ’æ–¥çš„ (CenterPoint)ã€‚å› ä¸º 3D é€‰æ¡†æœ‰7ç»´ $(x, y, z, w, h, l, \theta)$ï¼Œæœ€åä¸€ä¸ªç»´åº¦ä»£è¡¨çš„æ˜¯è§’åº¦ï¼Œç†è®ºä¸Šæ¥è®²ä¸‰ç»´ä¸­ç‰©ä½“çš„è§’åº¦åº”è¯¥æ˜¯æœ‰3ä¸ªåˆ†é‡çš„ï¼Œè€Œè¿™é‡Œä»…æœ‰æŸä¸€ä¸ªå¹³é¢ï¼ˆä¿¯è§†ï¼‰çš„è§’åº¦ï¼Œè¿™é‡Œè§’åº¦ç»´åº¦çš„ç¡®å®æœ¬èº«å°±ä¸ºäºŒç»´æ–¹æ³•æä¾›äº†å¾ˆå¥½çš„å…¥å£</p><p>PointRCNN æå‡ºçš„è´¡çŒ®ï¼š</p><ol><li>æå‡ºäº† 3D é€‰æ¡†ç”Ÿæˆç®—æ³•ï¼Œa bottom-up point cloud-based 3D bounding box proposal generation algorithm</li><li>æå‡ºäº† bin-based lossesï¼Œæå‡ç½‘ç»œè¡¨ç°ä¸æ”¶æ•›é€Ÿåº¦</li><li>ä½¿ç”¨è§„èŒƒå˜æ¢ Canonical transformation</li></ol><p>åä¸¤ä¸ªè´¡çŒ®<strong>ä¼¼ä¹</strong>åœ¨æŒ‡å‘ä¸¤ä¸ªæ–¹å‘ï¼šç½‘ç»œæ›´å€¾å‘ç”±æ˜“åˆ°éš¾çš„å­¦ä¹ ï¼Œç½‘ç»œæ›´æ“…äºå­¦ä¹ è§„èŒƒåŒ–çš„æ•°æ®</p><h2 id="PointRCNN-Architecture"><a href="#PointRCNN-Architecture" class="headerlink" title="PointRCNN Architecture"></a>PointRCNN Architecture</h2><p><img src="/archives/51543c70/image-20211006164534924.png" style="zoom: 80%;"></p><p>PointRCNN çš„å­¦ä¹ åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p><ol><li><p>3D é€‰æ¡†ç”Ÿæˆ proposal generationï¼Œä½¿ç”¨ PointNet++ æå–æ¯ä¸€ä¸ªç‚¹çš„ç‰¹å¾å‘é‡ï¼Œä½¿ç”¨è¿™äº›å‘é‡é¢„æµ‹å‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹ï¼Œå¹¶ç”Ÿæˆåˆæ­¥é€‰æ¡†</p></li><li><p>3D é€‰æ¡†ç»†åŒ– box refinementï¼Œåˆ©ç”¨åˆæ­¥æå–çš„é€‰æ¡†ï¼Œå†å¯¹è¿™äº›é€‰æ¡†è¿›è¡Œç²¾ç»†åŒ–å¤„ç†</p></li></ol><h3 id="Stage-1-3D-é€‰æ¡†ç”Ÿæˆ"><a href="#Stage-1-3D-é€‰æ¡†ç”Ÿæˆ" class="headerlink" title="Stage-1: 3D é€‰æ¡†ç”Ÿæˆ"></a>Stage-1: 3D é€‰æ¡†ç”Ÿæˆ</h3><h4 id="å‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹åˆ†å‰²"><a href="#å‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹åˆ†å‰²" class="headerlink" title="å‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹åˆ†å‰²"></a>å‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹åˆ†å‰²</h4><p>è®ºæ–‡ä½¿ç”¨ PointNet++ with multi-scale grouping ä½œä¸º backboneï¼Œæå–æ¯ä¸€ä¸ªç‚¹çš„ç‰¹å¾å‘é‡ï¼Œæ¯ä¸ªç‚¹çš„ç‰¹å¾å‘é‡æ˜¯å…·æœ‰ä¸€å®šçš„æ„Ÿå—é‡çš„ï¼Œä¹Ÿå°±æ˜¯åŒ…å«äº†å±€éƒ¨èŒƒå›´çš„ä¿¡æ¯ã€‚å½“ç„¶è¿™ä¸ª backbone ä¹Ÿå¯ä»¥æ¢æˆå…¶ä»–ç½‘ç»œç»“æ„ï¼Œå¯èƒ½æ•ˆæœä¼šæ›´å¥½</p><p>ç°åœ¨è·å¾—äº†é€ç‚¹çš„ç‰¹å¾å‘é‡ point-wise feature vectorï¼Œå…ˆä½¿ç”¨è¿™äº›ç‰¹å¾å‘é‡åšå‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹çš„åˆ†ç±»ä»»åŠ¡ï¼Œå…¶æŸå¤±å‡½æ•°ä¸º focal loss</p><script type="math/tex; mode=display">\mathcal{L}_{\text {focal }}\left(p_{t}\right)=-\alpha_{t}\left(1-p_{t}\right)^{\gamma} \log \left(p_{t}\right)\\\text{where }p_{t}=\left\{\begin{array}{ll}p & \text { for forground point } \\ 1-p & \text { otherwise }\end{array}\right.</script><p>focal loss åœ¨ä¸‰ç»´ç›®æ ‡æ£€æµ‹ä¸­æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„æŸå¤±å‡½æ•°ï¼Œä¸‹å›¾å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œåœ¨ Î³ æ¯”è¾ƒå¤§æ—¶ï¼Œå¤§éƒ¨åˆ†çš„losså€¼éƒ½æ˜¯æ¯”è¾ƒä½çš„ï¼Œé™¤éç½‘ç»œçš„é¢„æµ‹éå¸¸çš„ç¦»è°±ï¼Œæƒ©ç½šæ‰ä¼šæ€¥å‰§å¢åŠ ã€‚å¯ä»¥è¯´ focal loss èƒ½å¤Ÿå‡è½»æƒ©ç½šï¼Œå¯¹äºæ­£è´Ÿæ ·æœ¬ä¸å‡åŒ€çš„æ•°æ®æ¥è¯´ä¼šå¾ˆæœ‰ç”¨</p><p><img src="/archives/51543c70/a8c1f242-8cf0-4310-bd10-a488658a3463-16335112903811.png" style="zoom: 80%;"></p><h4 id="é€‰æ¡†ç”Ÿæˆ"><a href="#é€‰æ¡†ç”Ÿæˆ" class="headerlink" title="é€‰æ¡†ç”Ÿæˆ"></a>é€‰æ¡†ç”Ÿæˆ</h4><p>ç»è¿‡äº†å‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹çš„äºŒå…ƒåˆ†ç±»ä»»åŠ¡ï¼Œç½‘ç»œå°±è¦æ­£å¼è¿›è¡Œé€‰æ¡†ç”Ÿæˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç½‘ç»œä»…é‡‡ç”¨å‰æ™¯ç‚¹æ¥ç”Ÿæˆé€‰æ¡†ï¼Œå°½ç®¡åœ¨ç½‘ç»œè®­ç»ƒä¹‹åˆï¼Œå‰æ™¯ç‚¹å’ŒèƒŒæ™¯ç‚¹çš„åˆ†ç±»ç»“æœå¹¶ä¸é è°±ï¼Œä½†éšç€è®­ç»ƒçš„æ·±å…¥ä¼šè¶Šæ¥è¶Šå‡†ç¡®</p><p>æ€æ ·é€šè¿‡å‰æ™¯ç‚¹ç”Ÿæˆé€‰æ¡†å‘¢ï¼Ÿä¸€ä¸ªç®€å•çš„æƒ³æ³•å°±æ˜¯ï¼šæ¯ä¸€ä¸ªç‚¹éƒ½å»å›å½’é¢„æµ‹è¯¥ç‚¹æ‰€å±çš„é€‰æ¡†ã€‚è®ºæ–‡åœ¨æŸäº›ç›®æ ‡ä¸Šé‡‡å–äº†å›å½’çš„æ€æƒ³ï¼Œåœ¨ä¸€äº›é‡è¦ç›®æ ‡ä¸Šé‡‡ç”¨äº†åˆ†ç±»+å›å½’çš„é¢„æµ‹æ–¹æ³•ï¼Œè®ºæ–‡ç§°è¿™ç§æ€æƒ³ä¸º bin-basedã€‚ç°åœ¨æ¥çœ‹çœ‹åœ¨è¿™ä¸€é˜¶æ®µç½‘ç»œæƒ³è¦é¢„æµ‹çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Œ</p><script type="math/tex; mode=display">\begin{array}{l}\operatorname{bin}_{x}^{(p)}=\left\lfloor\frac{x^{p}-x^{(p)}+\mathcal{S}}{\delta}\right\rfloor, \operatorname{bin}_{z}^{(p)}=\left\lfloor\frac{z^{p}-z^{(p)}+\mathcal{S}}{\delta}\right\rfloor \\\operatorname{res}_{u \in\{x, z\}}^{(p)}=\frac{1}{\mathcal{C}}\left(u^{p}-u^{(p)}+\mathcal{S}-\left(\operatorname{bin}_{u}^{(p)} \cdot \delta+\frac{\delta}{2}\right)\right),(2) \\\operatorname{res}_{y}^{(p)}=y^{p}-y^{(p)}\end{array}</script><p>ç»“åˆä¸‹é¢è¿™å¼ å›¾æ¥è§£é‡Šä¸€ä¸‹å…¶ä¸­çš„å˜é‡</p><p><img src="/archives/51543c70/image-20211006172654158.png" style="zoom: 80%;"></p><p>$(x^{(p)}, y^{(p)}, z^{(p)})$ ä»£è¡¨çš„æ˜¯å‰æ™¯ç‚¹çš„åæ ‡ï¼Œ$(x^{p}, y^{p}, z^{p})$ ä»£è¡¨çš„æ˜¯ç›®æ ‡ä¸­å¿ƒç‚¹çš„åæ ‡ï¼Œå…¶ä½™é‡å‡ä¸ºå¸¸é‡ï¼Œå¦‚ S ä¸ºæœç´¢èŒƒå›´ï¼ŒÎ´ ä¸º bin çš„é•¿åº¦ï¼ŒC ä¸ºå½’ä¸€åŒ–å¸¸é‡ã€‚åœ¨æ–‡ç« å¹¶æ²¡æœ‰æ˜ç¡®æŒ‡å‡ºï¼Œå¦‚æœè¶…å‡ºäº†æœç´¢èŒƒå›´æ˜¯å¦å°±ä¸ä½¿ç”¨è¯¥ç‚¹è¿›è¡Œé¢„æµ‹ï¼Œæ‰€ä»¥ä¸å¤ªç†è§£è¿™é‡Œæœç´¢èŒƒå›´çš„æ„ä¹‰</p><p>ç°åœ¨å¯ä»¥å…·ä½“æ¥çœ‹ç›®æ ‡çš„å«ä¹‰ï¼Œé¦–å…ˆæ˜¯ $(bin_x^{(p)}, bin_z^{(p)})$ å¯ä»¥å°†å…¶çœ‹ä½œä¸­å¿ƒç‚¹ç›¸å¯¹äºå‰æ™¯ç‚¹çš„æ …æ ¼åæ ‡ã€‚ç„¶åæ˜¯æ®‹å·®ï¼Œå¯¹äº x, z åæ ‡è®¡ç®—äº†æ …æ ¼åæ ‡å’Œå®é™…åæ ‡çš„æ®‹å·®ï¼Œå¯¹äº y åæ ‡åˆ™ç›´æ¥è®¡ç®—ä¸­å¿ƒç‚¹ç›¸å¯¹äºå‰æ™¯ç‚¹çš„å·®è·</p><p>æƒ³è¦å¾—åˆ°çš„é€‰æ¡†æœ‰7ä¸ªå˜é‡  $(x, y, z, w, h, l, \theta)$ï¼Œä¸Šé¢ä»…æåˆ°äº†3ä¸ªï¼Œå‰©ä½™çš„å››ä¸ªä¸­ï¼Œè§’åº¦ Î¸ é‡‡å–å’Œ x, z ç±»ä¼¼çš„æ€è·¯ä½¿ç”¨ bin-based æ€æƒ³ï¼Œå°†è§’åº¦åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼›è€Œé€‰æ¡†çš„é•¿æ¬¾é«˜åˆ™é‡‡å–å’Œ y ç±»ä¼¼çš„æ€è·¯ï¼Œç›´æ¥é¢„æµ‹å…¶æ®‹å·®ï¼Œå…¶æ®‹å·®ä¸ºè¯¥æ ‡ç­¾ä¸æ•´ä¸ªæ•°æ®é›†çš„å¹³å‡å€¼çš„å·®</p><p>å¦‚æœå¾—åˆ°äº†ä»¥ä¸Šé¢„æµ‹å€¼ï¼šbin, resï¼Œé‚£ä¹ˆé€šè¿‡ç®€å•çš„è®¡ç®—ï¼Œå°±èƒ½å¤Ÿå¾—åˆ°é¢„æµ‹é€‰æ¡†çš„æ‰€æœ‰å‚æ•°ã€‚è®¾ç½®è¿™æ ·çš„é¢„æµ‹ç›®æ ‡æ„ä¹‰åœ¨å“ªé‡Œå‘¢ï¼Ÿä»¥ä¸‹ä¸ºä¸ªäººç†è§£ï¼š</p><ol><li>ä½¿ç”¨ bin-based æ€æƒ³ï¼Œå°†å›å½’é—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Œå…ˆå»é¢„æµ‹ä¸­å¿ƒç‚¹è½åœ¨å“ªä¸ªæ …æ ¼ä¸­ï¼Œç„¶åå†é€šè¿‡æ®‹å·®ç²¾ç»†è°ƒæ•´</li><li>ä½¿ç”¨æ®‹å·®ï¼Œé¢„æµ‹ä¸€ä¸ªç›¸å¯¹å€¼æ˜¯æ›´å®¹æ˜“çš„ï¼Œé¢„æµ‹ä¸€ä¸ªç»å¯¹å€¼éœ€è¦æ›´å¤šçš„è®¡ç®—ã€‚ä»ç‰©ç†çš„è§’åº¦ä¸Šæ¥è¯´ï¼Œå°±å¥½åƒè§„å®šäº†ä¸€ä¸ªé›¶åŠ¿èƒ½é¢ï¼Œè®©è®¡ç®—å˜å¾—æœ‰æ ‡å‡†</li></ol><p>æœ‰äº†ç›®æ ‡æ ‡ç­¾å’Œç½‘ç»œé¢„æµ‹çš„ç»“æœï¼Œå°±éœ€è¦æŸå¤±å‡½æ•°æ¥è¡¡é‡ç»“æœçš„å¥½å</p><script type="math/tex; mode=display">\begin{array}{l}\mathcal{L}_{\text {bin }}^{(p)}=\sum_{u \in\{x, z, \theta\}}\left(\mathcal{F}_{\mathrm{cls}}\left(\widehat{\mathrm{bin}}_{u}^{(p)}, \operatorname{bin}_{u}^{(p)}\right)+\mathcal{F}_{\text {reg }}\left(\widehat{\operatorname{res}}_{u}^{(p)}, \operatorname{res}_{u}^{(p)}\right)\right) \\\mathcal{L}_{\text {res }}^{(p)}=\sum_{v \in\{y, h, w, l\}} \mathcal{F}_{\text {reg }}\left(\widehat{\operatorname{res}}_{v}^{(p)}, \operatorname{res}_{v}^{(p)}\right) \\\mathcal{L}_{\text {reg }}=\frac{1}{N_{\text {pos }}} \sum_{p \in \text { pos }}\left(\mathcal{L}_{\text {bin }}^{(p)}+\mathcal{L}_{\text {res }}^{(p)}\right)\end{array}</script><p>åˆ†ç±»ä»»åŠ¡é‡‡å–çš„æ˜¯ cross entropy classification lossï¼Œå›å½’ä»»åŠ¡é‡‡å–çš„æ˜¯ smooth L1 loss</p><h4 id="NMS"><a href="#NMS" class="headerlink" title="NMS"></a>NMS</h4><p>ä½¿ç”¨ non-maximum suppression (NMS) ç®—æ³•å»é™¤å¤šä½™çš„é€‰æ¡†ï¼Œå…³äºè®­ç»ƒå’Œæ¨ç†æ—¶çš„å…·ä½“å‚æ•°è¯·å‚è€ƒåŸæ–‡ã€‚ç­›é€‰å‡ºæ¥çš„é€‰æ¡†ï¼Œå°†è¿›è¡Œä¸‹ä¸€æ­¥ç»†åŒ–ï¼ŒNMS å‡ ä¹æ˜¯ç­›é€‰æœ€ç»ˆé€‰æ¡†/ç»†åŒ–é€‰æ¡†å¿…ä¸å¯ç¼ºçš„ï¼Œå¯èƒ½ä¹‹åçš„æ€»ç»“é‡Œä¸ä¼šæï¼Œä½†ä¸ä»£è¡¨æ²¡æœ‰è¿™ä¸€æ­¥éª¤</p><blockquote><p>For training, we use 0.85 as the birdâ€™s view IoU threshold and after NMS we keep top 300 proposals for training the stage-2 sub-network. For inference, we use oriented NMS with IoU threshold 0.8, and only top 100 proposals are kept for the refinement of stage-2 sub-network.</p></blockquote><p>å…³äº NMS çš„å‚è€ƒé“¾æ¥ï¼š<a href="https://www.cnblogs.com/makefile/p/nms.html">link</a></p><h3 id="Stage2-3D-é€‰æ¡†ç»†åŒ–"><a href="#Stage2-3D-é€‰æ¡†ç»†åŒ–" class="headerlink" title="Stage2: 3D é€‰æ¡†ç»†åŒ–"></a>Stage2: 3D é€‰æ¡†ç»†åŒ–</h3><p>é€‰æ¡†ç»†åŒ– refinement æœ‰4ä¸ªä¸»è¦æ­¥éª¤ï¼š</p><ol><li><p>å¢å¤§é€‰æ¡† region poolingï¼Œç¨å¾®å°†åˆæ­¥å¾—åˆ°çš„é€‰æ¡†æ‰©å¤§ä¸€ç‚¹ï¼Œä½¿å¾—è¯¥é€‰æ¡†åŒ…å«æ›´å¤šçš„å‰æ™¯ç‚¹ï¼ŒåŒæ—¶å‰”é™¤é€‰æ¡†ä¸­çš„èƒŒæ™¯ç‚¹ã€‚è¿™å¯¹ Stage-1 çš„åˆ†å‰²ä»»åŠ¡æœ‰ä¸€å®šè¦æ±‚</p></li><li><p>è§„èŒƒå˜æ¢ canonical transformationï¼Œå¯¹æ¯ä¸ªé€‰æ¡†å»ºç«‹äº†ä¸€ä¸ªä»¥è‡ªå·±ä¸ºä¸­å¿ƒçš„<strong>ä¸ªä½“åæ ‡ç³»</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="/archives/51543c70/4c790bdd-2912-45d4-ab7a-31de52926ed6-16335194333043.png" style="zoom: 80%;"></p></li><li><p>ç‰¹å¾å­¦ä¹  feature learning</p></li><li><p>ç»†åŒ–ä¸åˆ†ç±» refinement &amp; classification</p></li></ol><p>ç°åœ¨å¯¹ç‰¹å¾å­¦ä¹ å’Œé‡æ–°ç»†åŒ–è¿›è¡Œè¯¦ç»†åœ°äº†è§£</p><h4 id="ç‰¹å¾å­¦ä¹ "><a href="#ç‰¹å¾å­¦ä¹ " class="headerlink" title="ç‰¹å¾å­¦ä¹ "></a>ç‰¹å¾å­¦ä¹ </h4><p>ç”±äºç»è¿‡äº†è§„èŒƒå˜æ¢ä¸¢å¤±äº†æ·±åº¦ä¿¡æ¯ï¼Œä¸ºæ¯ä¸€ä¸ªç‚¹åŠ ä¸Šäººä¸ºæ„é€ çš„æ·±åº¦ç‰¹å¾</p><script type="math/tex; mode=display">d^{(p)} = \sqrt{(x^{(p)})^2+ (y^{(p)})^2 + (z^{(p)})^2}</script><p>æ¯ä¸ªç‚¹é™¤äº†æ·±åº¦ç‰¹å¾å¤–ï¼Œè¿˜å¢åŠ äº†åå°„å¼ºåº¦ç‰¹å¾ r å’Œåˆ†å‰²é¢ç½© mã€‚å°†è¿™äº›è§„èŒƒå˜æ¢å¹¶ä¸”å¢å¼ºåçš„ç‰¹å¾ï¼Œé€å…¥åˆ°ä¸€ä¸ª MLP ä¸­è¿›è¡Œè½¬æ¢å¾—åˆ°ä¸€ä¸ªè¾“å‡ºï¼Œå°†è¯¥è¾“å‡ºä¸ PointNet++ ä¸­å­¦ä¹ çš„è¯­ä¹‰ç‰¹å¾è¿æ¥èµ·æ¥ï¼Œè¿›è¡Œæœ€åçš„ç»†åŒ–å·¥ä½œ</p><p><img src="/archives/51543c70/image-20211006193601408.png" style="zoom: 80%;"></p><h4 id="ç»†åŒ–ä¸åˆ†ç±»"><a href="#ç»†åŒ–ä¸åˆ†ç±»" class="headerlink" title="ç»†åŒ–ä¸åˆ†ç±»"></a>ç»†åŒ–ä¸åˆ†ç±»</h4><p>è¿™é‡Œçš„å­¦ä¹ è¿‡ç¨‹å’Œ Stage-1 ä¸­çš„å­¦ä¹ è¿‡ç¨‹æ˜¯ç›¸ä¼¼çš„ã€‚è¿™é‡Œéœ€è¦é¢„æµ‹çš„ç›®æ ‡ä¾ç„¶æ˜¯ bin-based æ€æƒ³ï¼Œä¸è¿‡æ˜¯åœ¨è§„èŒƒå˜åŒ–åçš„åæ ‡ä¸‹è¿›è¡Œï¼Œè€Œä¸”ä»…å¯¹åœ¨ Stage-1 äº§ç”Ÿçš„åŸºç¡€é€‰æ¡†å†…çš„ç‚¹è¿›è¡Œè®¡ç®—ã€‚å…¶å…·ä½“é¢„æµ‹ç›®æ ‡å€¼å°±ä¸å†èµ˜è¿°ï¼Œè®ºæ–‡é‡Œç»™å‡ºäº†è§„èŒƒå˜åŒ–åçš„ ground truth bounding box å¦‚ä½•è®¡ç®—</p><script type="math/tex; mode=display">\tilde{\mathbf{b}}_{i}^{\mathrm{gt}}=\left(x_{i}^{\mathrm{gt}}-x_{i}, y_{i}^{\mathrm{gt}}-y_{i}, z_{i}^{\mathrm{gt}}-z_{i}, h_{i}^{\mathrm{gt}}, w_{i}^{\mathrm{gt}}, l_{i}^{\mathrm{gt}}, \theta_{i}^{\mathrm{gt}}-\theta_{i}\right)</script><p>å…¶ä¸­æ²¡æœ‰ gt ä¸Šæ ‡çš„å€¼å³ä¸ºå¯¹åº”åŸºç¡€é€‰æ¡†çš„å‚æ•°ã€‚é™¤äº†å¯¹é€‰æ¡†è¿›è¡Œè¿›ä¸€æ­¥çš„ç²¾ç»†åŒ–å¤–ï¼Œè¿˜è¦æ‰§è¡Œå¤šåˆ†ç±»ä»»åŠ¡ï¼Œè¯¥å¤šåˆ†ç±»ä»»åŠ¡çš„ç½‘ç»œè®ºæ–‡å¹¶æ²¡æœ‰è¯¦ç»†è¯´æ˜ï¼Œåº”è¯¥å¯ä»¥å‚ç…§ PointNet ç³»åˆ—</p><p>æœ€ç»ˆå°†ç²¾ç»†åŒ–ä»»åŠ¡å’Œå¤šåˆ†ç±»ä»»åŠ¡çš„æŸå¤±å‡½æ•°ç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆçš„æŸå¤±å‡½æ•°</p><script type="math/tex; mode=display">\begin{aligned}\mathcal{L}_{\text {refine }}=& \frac{1}{\| \mathcal{B}\|} \sum_{i \in \mathcal{B}} \mathcal{F}_{\text {cls }}\left(\operatorname{prob}_{i}, \text { label }_{i}\right) \\&+\frac{1}{\left\|\mathcal{B}_{\text {pos }}\right\|} \sum_{i \in \mathcal{B}_{\text {pos }}}\left(\tilde{\mathcal{L}}_{\text {bin }}^{(i)}+\tilde{\mathcal{L}}_{\text {res }}^{(i)}\right)\end{aligned}</script><p>å…¶ä¸­ positive bounding box å®šä¹‰ä¸ºå¦‚ä¸‹</p><blockquote><p>For training the box classification head, a proposal is considered as positive if its maximum 3D IoU with ground-truth boxes is above 0.6</p></blockquote><p>åœ¨æµ‹è¯•\æ¨ç†æ—¶ä¸ºäº†é€‰å‡ºæœ€ç»ˆå¾—åˆ†æœ€é«˜çš„é€‰æ¡†ï¼Œè¿˜è¦å†ä½¿ç”¨ä¸€æ¬¡ NMS ç®—æ³•</p><blockquote><p>We finally apply oriented NMS with birdâ€™s view IoU threshold 0.01 to remove the overlapping bounding boxes</p></blockquote><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯ PointRCNN ä¸¤ä¸ªé˜¶æ®µæ˜¯åˆ†å¼€è®­ç»ƒçš„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„è®­ç»ƒã€‚åˆ†å¼€è®­ç»ƒå’Œç«¯å¯¹ç«¯è®­ç»ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿å—ï¼Ÿ</p><h3 id="KITTI"><a href="#KITTI" class="headerlink" title="KITTI"></a>KITTI</h3><p><img src="/archives/51543c70/image-20211006202449787.png"></p><p>å…³äº average precision (AP) å’Œ recall å‚è€ƒé“¾æ¥ï¼š<a href="https://zhuanlan.zhihu.com/p/56961620">çŸ¥ä¹</a></p><h3 id="Ablation-study"><a href="#Ablation-study" class="headerlink" title="Ablation study"></a>Ablation study</h3><p><img src="/archives/51543c70/image-20211006202739285.png"></p><p>å¯ä»¥çœ‹åˆ°è§„èŒƒå˜æ¢çš„ä½œç”¨éå¸¸å¤§ï¼Œå¤§å¾—ç¦»è°±</p><h3 id="Bin-based-loss-recall"><a href="#Bin-based-loss-recall" class="headerlink" title="Bin-based loss recall"></a>Bin-based loss recall</h3><p><img src="/archives/51543c70/image-20211006202846004.png"></p><p>è“è‰²æ›²çº¿ä¸ºè®ºæ–‡ä¸­ä½¿ç”¨çš„æŸå¤±å‡½æ•°ï¼Œæ•ˆæœæœ€å¥½</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>PointRCNN ä¸º 2-Stage ç½‘ç»œï¼Œæå‡ºçš„ bin-based æŸå¤±å‡½æ•°å’Œè§„èŒƒå˜æ¢ canonical transformation æå‡äº†ç½‘ç»œçš„æ€§èƒ½ã€‚å¹¶ä¸”ç›´æ¥ä½¿ç”¨ç‚¹äº‘æ•°æ®ï¼Œå‡å°‘äº†åŸå§‹ç‚¹äº‘çš„ä¿¡æ¯æŸå¤±ã€‚ä½†æ˜¯æ•´ä½“çœ‹ä¸‹æ¥æ„Ÿè§‰ trick å’Œç»†èŠ‚æŒºå¤šçš„ï¼Œæ¯”å¦‚å…¶ region pooling å’Œå‰æ™¯èƒŒæ™¯ç‚¹åˆ†å‰²ç­‰ç­‰ï¼Œè®ºæ–‡é‡Œå¹¶æ²¡æœ‰è®°å½•å…¶æ¨ç†é€Ÿåº¦ï¼Œåœ¨å…¶ä»–æ–‡çŒ®ä¸­æ‰¾åˆ°å¤§çº¦ä¸º 10 fpsï¼Œæˆ–è®¸ä»Šåéœ€è¦åœ¨é€Ÿåº¦ä¸Šè¿›è¡Œæ›´å¿«çš„çªç ´</p><h2 id="TO-READ"><a href="#TO-READ" class="headerlink" title="TO READ"></a>TO READ</h2><p>LiDAR R-CNN</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Point Cloud </tag>
            
            <tag> PointRCNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pytorch cn231n note (dev)</title>
      <link href="/archives/88f138aa.html"/>
      <url>/archives/88f138aa.html</url>
      
        <content type="html"><![CDATA[<h1 id="Pytorch-cs231n-note"><a href="#Pytorch-cs231n-note" class="headerlink" title="Pytorch cs231n note"></a>Pytorch cs231n note</h1><p>è·Ÿç€ä½œä¸šè¿‡ä¸€éï¼Œçœ‹çœ‹æœ‰å“ªäº›éœ€è¦ç†Ÿæ‚‰çš„ pytorch çŸ¥è¯†ç‚¹ï¼Œç¬”è®°é‡Œçš„è‹±æ–‡æ˜¯ä» notebook ä¸­çš„åŸæ–‡</p><p>ç°åœ¨çœ‹æ¥2017å¹´çš„ cs231n è¯¾ç¨‹è§†é¢‘å·²ç»æœ‰å¾ˆå¤šå†…å®¹éœ€è¦è¡¥å……äº†ï¼Œå°¤å…¶æ˜¯ç°åœ¨ transformer å¾ˆç«çš„æƒ…å†µä¸‹</p><p>åŸæ¥è¿™ä¸ªè€å¸ˆ <strong>Justin Johnson</strong> å·²ç»ä¸åœ¨ Stanford äº†ï¼Œç°åœ¨åœ¨UMich <a href="https://web.eecs.umich.edu/~justincj/">ä¸ªäººä¸»é¡µ</a> å¼€äº†ä¸€ä¸ªè®¡ç®—æœºè§†è§‰çš„è¯¾ç¨‹ <a href="https://web.eecs.umich.edu/~justincj/teaching/eecs498/FA2020/">Deep Learning for Computer Vision</a>ï¼Œè¿™ä¸ªè¯¾ç¨‹æ¯”è¾ƒæ–°ï¼Œæœ‰2020å¹´çš„æ•™å­¦èµ„æº</p><h2 id="How-do-I-learn-PyTorch"><a href="#How-do-I-learn-PyTorch" class="headerlink" title="How do I learn PyTorch?"></a>How do I learn PyTorch?</h2><p>One of our former instructors, Justin Johnson, made an excellent <a href="https://github.com/jcjohnson/pytorch-examples">tutorial</a> for PyTorch. (è¿™ä¸ª github ä»“åº“æ„Ÿè§‰å¥½è€äº†ï¼Œå¯ä»¥çœ‹çœ‹ pytorch <a href="https://pytorch.org/tutorials/">å®˜æ–¹ tutorial</a>)</p><p>You can also find the detailed <a href="http://pytorch.org/docs/stable/index.html">API doc</a> here. If you have other questions that are not addressed by the API docs, the <a href="https://discuss.pytorch.org/">PyTorch forum</a> is a much better place to ask than StackOverflow.</p><h2 id="GPU"><a href="#GPU" class="headerlink" title="GPU"></a>GPU</h2><p>æ£€æŸ¥ cuda</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># basic check</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>version<span class="token punctuation">.</span>cuda<span class="token comment"># cuda device</span>torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cuda'</span><span class="token punctuation">,</span> device_oridinal<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Part-1-Preparation"><a href="#Part-1-Preparation" class="headerlink" title="Part 1: Preparation"></a>Part 1: Preparation</h2><h3 id="torchvision-transform"><a href="#torchvision-transform" class="headerlink" title="torchvision.transform"></a>torchvision.transform</h3><p><strong>torchvision ç‹¬ç«‹äº torchã€‚torchvision åŒ…ç”±æµè¡Œçš„æ•°æ®é›†ï¼ˆtorchvision.datasetsï¼‰ã€æ¨¡å‹æ¶æ„(torchvision.models)å’Œç”¨äºè®¡ç®—æœºè§†è§‰çš„å¸¸è§å›¾åƒè½¬æ¢ç»„æˆ t(torchvision.transforms)</strong></p><p>The torchvision.transforms package provides tools for preprocessing data and for performing data augmentation</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torchvison<span class="token punctuation">.</span>transfoms <span class="token keyword">as</span> T<span class="token comment"># T.Compose: Composes several transforms together</span><span class="token comment"># T.ToTensor: Converts a PIL Image or numpy.ndarray (H x W x C) in the range</span><span class="token comment"># T.Normalize: Normalize a tensor image with mean and standard deviation</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span> to a torch<span class="token punctuation">.</span>FloatTensor of shape <span class="token punctuation">(</span>C x H x W<span class="token punctuation">)</span> <span class="token keyword">in</span> the <span class="token builtin">range</span> <span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span>transform <span class="token operator">=</span> T<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>                T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                T<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.4914</span><span class="token punctuation">,</span> <span class="token number">0.4822</span><span class="token punctuation">,</span> <span class="token number">0.4465</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.2023</span><span class="token punctuation">,</span> <span class="token number">0.1994</span><span class="token punctuation">,</span> <span class="token number">0.2010</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="torchvision-dataset"><a href="#torchvision-dataset" class="headerlink" title="torchvision.dataset"></a>torchvision.dataset</h3><p>ä½¿ç”¨ CIFAR10 æ•°æ®é›†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>datasets <span class="token keyword">as</span> dset<span class="token comment"># args</span><span class="token comment"># root: root directory of dataset where it might exist or will be saved to if download</span><span class="token comment"># train: if true create dataset from traning set</span><span class="token comment"># transform: A function/transform that takes in an PIL image and returns a transformed version</span>cifar10_train <span class="token operator">=</span> dset<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span><span class="token string">'./cs231n/datasets'</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform<span class="token punctuation">)</span>cifar10_test <span class="token operator">=</span> dset<span class="token punctuation">.</span>CIFAR10<span class="token punctuation">(</span><span class="token string">'./cs231n/datasets'</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œéœ€è¦å­¦ä¹ å¤„ç†æ•°æ®é›†å¸¸ç”¨çš„å‡ ä¸ªæ–¹æ³•</p><h4 id="DataLoader-amp-Sampler"><a href="#DataLoader-amp-Sampler" class="headerlink" title="DataLoader &amp; Sampler"></a>DataLoader &amp; Sampler</h4><blockquote><p>DataLoader: Combines a dataset and a sampler, and provides single- or multi-process iterators over the dataset.</p></blockquote><p>åˆ›å»º train, val, test ä¸‰ä¸ª DataLoader</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">NUM_TRAIN <span class="token operator">=</span> <span class="token number">49000</span><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoaderfromt torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> samplerloader_train <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>cifar10_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> sampler<span class="token operator">=</span>sampler<span class="token punctuation">.</span>SubsetRandomSampler<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>NUM_TRAIN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>loader_val <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>cifar10_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> sampler<span class="token operator">=</span>sampler<span class="token punctuation">.</span>SubsetRandomSampler<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>NUM_TRAIN<span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>loader_test <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>cifar10_test<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</p><h3 id="train-a-model"><a href="#train-a-model" class="headerlink" title="train a model"></a>train a model</h3><h2 id="Part-2-Barebones-by-PyTorch"><a href="#Part-2-Barebones-by-PyTorch" class="headerlink" title="Part 2: Barebones by PyTorch"></a>Part 2: Barebones by PyTorch</h2><h3 id="Autograd-engine"><a href="#Autograd-engine" class="headerlink" title="Autograd engine"></a>Autograd engine</h3><blockquote><p>When we create a PyTorch Tensor with <code>requires_grad=True</code>, then operations involving that Tensor will not just compute values; they will also build up a computational graph in the background</p></blockquote><h3 id="torch-nn-functional"><a href="#torch-nn-functional" class="headerlink" title="torch.nn.functional"></a>torch.nn.functional</h3><p>å„ç§å‡½æ•°éƒ½åœ¨è¿™ä¸ªæ–‡ä»¶å½“ä¸­ï¼Œä½œä¸šé‡Œç”¨äº† relu, conv2d</p><h4 id="Bug"><a href="#Bug" class="headerlink" title="Bug"></a>Bug</h4><p>Run into errors when using  F.conv2d</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>funtional <span class="token keyword">as</span> Ffilters <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>inputs <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token comment"># the next line produce error: Illegal instruction (core dumped)</span>x <span class="token operator">=</span> F<span class="token punctuation">.</span>conv2d<span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> filters<span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ›´æ¢ pytorch ç‰ˆæœ¬å¾—åˆ°è§£å†³ï¼Œå¸è½½ <code>conda uninstall pytorch</code></p><p>é‡æ–°ä¸‹è½½ <code>conda install pytorch==1.2.0 torchvision==0.4.0</code></p><p>nn.Conv2d å’Œ nn.function.conv2d æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå°¤å…¶æ˜¯ä¼ å…¥çš„å‚æ•°çœ‹</p><h3 id="Kaiming-normalization"><a href="#Kaiming-normalization" class="headerlink" title="Kaiming normalization"></a>Kaiming normalization</h3><p>è¿™ä¸ªåˆå§‹åŒ–æ˜¯ä»€ä¹ˆï¼Ÿå¾…æ•´ç†</p><h3 id="bug"><a href="#bug" class="headerlink" title="bug"></a>bug</h3><p>ä½¿ç”¨ cuda è°ƒç”¨ GPU å¤±è´¥ </p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># run: torch.randn(shape, device=device, dtype=dtype)</span>RuntimeError: CUDA error: all CUDA-capable devices are busy or unavailable<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ£€æŸ¥äº† <code>torch.cuda.is_available()</code> è¿˜æœ‰ <code>torch.version.cuda</code> éƒ½æ˜¯å¥½çš„ï¼Œç½‘ä¸Šä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•ï¼Œåœ¨ StackOverflow ä¸Šæ‰¾åˆ°äº†æ–¹æ³•ï¼š<strong>é‡å¯!!!</strong> ï¼ˆå¯æ¶ï¼Œé‡å¯ç¡®å®ç®¡ç”¨ï¼‰</p><h3 id="to-device"><a href="#to-device" class="headerlink" title="to_device"></a>to_device</h3><h3 id="with-no-grad-with-torch-no-grad-ä»€ä¹ˆæ„æ€ï¼Ÿ"><a href="#with-no-grad-with-torch-no-grad-ä»€ä¹ˆæ„æ€ï¼Ÿ" class="headerlink" title="with no_grad(), with torch.no_grad() ä»€ä¹ˆæ„æ€ï¼Ÿ"></a>with no_grad(), with torch.no_grad() ä»€ä¹ˆæ„æ€ï¼Ÿ</h3><h3 id="æ ¼å¼åŒ–è¾“å‡º-2f-ä»€ä¹ˆæ„æ€"><a href="#æ ¼å¼åŒ–è¾“å‡º-2f-ä»€ä¹ˆæ„æ€" class="headerlink" title="æ ¼å¼åŒ–è¾“å‡º %.2f%% ä»€ä¹ˆæ„æ€"></a>æ ¼å¼åŒ–è¾“å‡º %.2f%% ä»€ä¹ˆæ„æ€</h3><h2 id="Part-3-Pytorch-Module-API"><a href="#Part-3-Pytorch-Module-API" class="headerlink" title="Part 3: Pytorch Module API"></a>Part 3: Pytorch Module API</h2><p>ä¸Šé¢çš„ Barebone è¦æ±‚æˆ‘ä»¬æ‰‹åŠ¨è·Ÿè¸ªæ‰€æœ‰å‚æ•°å¼ é‡ï¼Œéå¸¸ä¸æ–¹ä¾¿ï¼ŒPytorch æä¾›äº† <code>nn.Module</code> API èƒ½å¤Ÿè®©æˆ‘ä»¬å®šä¹‰ä»»æ„çš„ç½‘ç»œç»“æ„ï¼ŒåŒæ—¶è¿½è¸ªæ‰€æœ‰ç½‘ç»œä¸­çš„å‚æ•°</p><p>è¿˜æœ‰ä¼˜åŒ–ç­–ç•¥çš„é€‰æ‹© <code>torch.optim</code> </p><p>ä½¿ç”¨æ­¥éª¤ï¼š</p><ol><li><p><code>nn.Module</code> ä½œä¸ºå­ç±»ç»§æ‰¿</p><p>Q: è¿™ä¸ªç±»æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿå¦‚æœä¸å®šä¹‰è¿™ä¸ªç±»ï¼Œç›´æ¥ç»„åˆè¿™ä¸ªç±»</p></li><li><p>åœ¨ constructor <code>__init__()</code> ä¸­å®šä¹‰å¥½éœ€è¦çš„ç½‘ç»œå±‚ä½œä¸ºç±»çš„å±æ€§ï¼Œ<strong>æ³¨æ„ï¼Œä¸€å®šè¦è¿è¡Œ </strong><code>super().__init__()</code></p><p>è¿˜å¯ä»¥ç”¨ <code>nn.init</code> å¯¹ç½‘ç»œå‚æ•°è¿›è¡Œä¸åŒçš„åˆå§‹åŒ–</p></li><li><p>åœ¨ <code>forward()</code> æ–¹æ³•ä¸­å®šä¹‰ç½‘ç»œçš„è¿æ¥</p></li></ol><p>ä¼˜åŒ–çš„æ—¶å€™è¦å…ˆæ¸…é›¶æ¢¯åº¦ <code>optimizer.zero_grad()</code></p><h2 id="Part-4-Pytorch-Sequential-API"><a href="#Part-4-Pytorch-Sequential-API" class="headerlink" title="Part 4: Pytorch Sequential API"></a>Part 4: Pytorch Sequential API</h2><p>Pytorch å®šä¹‰äº†ä¸€ä¸ªæ›´æ–¹ä¾¿çš„ Module: <code>nn.Sequential</code>ï¼Œæ¥å®ç°é¡ºåºè¿æ¥ç½‘ç»œï¼Œä¸éœ€è¦åƒ <code>nn.Module</code> ä¸€æ ·åšä¸‰ä¸ªæ­¥éª¤</p><p><code>nn.Sequential</code> è‡ªèº«ä¹Ÿæ˜¯å¯ä»¥åµŒå¥—çš„</p><h2 id="Part-5-CIFAR-10-open-ended-challenge"><a href="#Part-5-CIFAR-10-open-ended-challenge" class="headerlink" title="Part 5: CIFAR-10 open-ended challenge"></a>Part 5: CIFAR-10 open-ended challenge</h2><h3 id="Things-you-might-try"><a href="#Things-you-might-try" class="headerlink" title="Things you might try:"></a>Things you might try:</h3><ul><li><strong>Filter size</strong>: Above we used 5x5; would smaller filters be more efficient?</li><li><strong>Number of filters</strong>: Above we used 32 filters. Do more or fewer do better?</li><li><strong>Pooling vs Strided Convolution</strong>: Do you use max pooling or just stride convolutions?</li><li><strong>Batch normalization</strong>: Try adding spatial batch normalization after convolution layers and vanilla batch normalization after affine layers. Do your networks train faster?</li><li><strong>Network architecture</strong>: The network above has two layers of trainable parameters. Can you do better with a deep network? Good architectures to try include:<ul><li>[conv-relu-pool]xN -&gt; [affine]xM -&gt; [softmax or SVM]</li><li>[conv-relu-conv-relu-pool]xN -&gt; [affine]xM -&gt; [softmax or SVM]</li><li>[batchnorm-relu-conv]xN -&gt; [affine]xM -&gt; [softmax or SVM]</li></ul></li><li><strong>Global Average Pooling</strong>: Instead of flattening and then having multiple affine layers, perform convolutions until your image gets small (7x7 or so) and then perform an average pooling operation to get to a 1x1 image picture (1, 1 , Filter#), which is then reshaped into a (Filter#) vector. This is used in <a href="https://arxiv.org/abs/1512.00567">Googleâ€™s Inception Network</a> (See Table 1 for their architecture).</li><li><strong>Regularization</strong>: Add l2 weight regularization, or perhaps use Dropout.</li></ul><p>ä¸Šé¢çš„è¿™äº›é€‰æ‹©éƒ½éå¸¸æœ‰æ„ä¹‰ï¼Œæˆ‘éœ€è¦èƒ½å¤Ÿé€ä¸ªå›ç­”ä»–ä»¬</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Pytorch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pytorch </tag>
            
            <tag> CS231N </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MMDetection é¡¹ç›®</title>
      <link href="/archives/acef3112.html"/>
      <url>/archives/acef3112.html</url>
      
        <content type="html"><![CDATA[<h1 id="MMDetection-é¡¹ç›®"><a href="#MMDetection-é¡¹ç›®" class="headerlink" title="MMDetection é¡¹ç›®"></a>MMDetection é¡¹ç›®</h1><p>ç°åœ¨æ­£å¼å¼€å§‹ MMDetection é¡¹ç›®ï¼ä¹‹å‰æœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç”¨ MMDetection æ¥æ£€æµ‹ç½‘çƒæ¯”èµ›ä¸­çš„ç½‘çƒçƒé€Ÿï¼Œä½¿ç”¨äº† Faster-RCNN æ¨¡å‹è¯•äº†ä¸‹ç›®æ ‡æ£€æµ‹ï¼Œå‘ç°å¯¹äºç½‘çƒè¿™ç§å°ç‰©ä½“æ ¹æœ¬æ£€æµ‹ä¸å‡ºæ¥ï¼Œåœ¨è§†é¢‘ä¸­å°±æ˜¯éå¸¸å°çš„ä¸€ä¸ªåƒç´ ç‚¹ã€‚é‚£ä¹ˆèƒ½ä¸èƒ½ä½¿ç”¨è‡ªå·±æ ‡æ³¨çš„æ•°æ®é›†æ¥è®­ç»ƒä¸€ä¸ªå°ç›®æ ‡æ£€æµ‹ï¼ˆä»…ç½‘çƒï¼‰çš„ç½‘ç»œï¼Œæ¥å¯¹ç½‘çƒè§†é¢‘è¿›è¡Œæ£€æµ‹ï¼Ÿç°åœ¨æ¥è¿›è¡Œå…·ä½“çš„è¯•éªŒ</p><h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><p>ä½¿ç”¨ Labelme è¿›è¡Œæ ‡æ³¨ï¼Œå¹¶è½¬åŒ–ä¸º COCO æ•°æ®é›†ã€‚å°†æ•°æ®é›†æŒ‰ç…§å¦‚ä¸‹ç»“æ„æ’åˆ—</p><pre class="line-numbers language-none"><code class="language-none">mmdetectionâ”œâ”€â”€ dataâ”‚   â”œâ”€â”€ cocoâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”œâ”€â”€ train2017â”‚   â”‚   â”œâ”€â”€ val2017â”‚   â”‚   â”œâ”€â”€ test2017<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ annotations æ”¾ç½® coco format json æ–‡ä»¶ï¼Œå…¶ä»–æ–‡ä»¶å¤¹æ”¾ç½®å›¾ç‰‡æ•°æ®é›†</p><h2 id="å‡†å¤‡-config-æ–‡ä»¶"><a href="#å‡†å¤‡-config-æ–‡ä»¶" class="headerlink" title="å‡†å¤‡ config æ–‡ä»¶"></a>å‡†å¤‡ config æ–‡ä»¶</h2><p>ç”±äºæ ‡æ³¨æ–‡ä»¶æ˜¯æœ‰åš segmentation çš„ï¼Œé€‰æ‹© Mask-RCNN ä½œä¸ºæ¨¡å‹</p><ol><li><p>base config: <a href="https://github.com/open-mmlab/mmdetection/blob/master/configs/mask_rcnn/mask_rcnn_r101_fpn_mstrain-poly_3x_coco.py">Mask-RCNN-R101-FPN</a> </p></li><li><p>checkpoint: <a href="https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r101_fpn_mstrain-poly_3x_coco/mask_rcnn_r101_fpn_mstrain-poly_3x_coco_20210524_200244-5675c317.pth">model</a></p></li></ol><p>æ”¾ç½®åœ¨ <code>/mmdet/config/mask_rcnn</code> ä¸‹ï¼Œå…·ä½“ config æ–‡ä»¶æ”¾åœ¨æ–‡æœ«</p><h2 id="è®­ç»ƒ"><a href="#è®­ç»ƒ" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h2><p>ç›®å‰è¿˜æ˜¯ä¸èƒ½è·‘èµ·æ¥ï¼Œé¢„è®¡æ˜¯ config æ–‡ä»¶å’Œæ•°æ®é›† CLASSES çš„åŸå› ï¼Œè¿˜æœ‰è¦æ³¨æ„ config çš„ç»§æ‰¿å…³ç³»ï¼</p><ol><li><p>ç”±äºç»§æ‰¿æœºåˆ¶ï¼Œä½¿ç”¨äº† <code>RepeatDataset</code> ä¸å¯¹åŸæ•°æ®é›†ç±»å‹è¿›è¡Œä¿®æ”¹ï¼Œä¸ç„¶æŠ¥é”™</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">TypeError<span class="token punctuation">:</span> CocoDataset<span class="token punctuation">:</span> __init__<span class="token punctuation">(</span><span class="token punctuation">)</span> got an unexpected keyword argument <span class="token string">'times'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>é‡åˆ°æŠ¥é”™</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">AssertionError<span class="token punctuation">:</span> The `num_classes` <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">in</span> Shared2FCBBoxHead of MMDataParallel does <span class="token keyword">not</span> matches the length of `CLASSES` <span class="token number">80</span><span class="token punctuation">)</span> <span class="token keyword">in</span> RepeatDataset<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¾æ—§æ˜¯ç”±äº <code>ReapeatDataset</code> é€ æˆçš„ï¼Œç”±äºå¯¹è¿™ä¸ªç±»ä¸å¤Ÿäº†è§£ï¼Œæ‰€ä»¥é¢‘ç¹æŠ¥é”™ğŸ˜…è¿™é‡Œçš„é€»è¾‘æ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®š <code>classes</code>ï¼Œç”±äºåŸ coco æ•°æ®é›†æœ‰80ä¸ªç±»ï¼Œè‡ªå·±çš„ç±»åˆ«ä¸ä¸€å®šæ˜¯åŸ COCO æ•°æ®é›†ç›¸åŒã€‚æ—¢ç„¶æ˜¯ <code>RepeatDataset</code> é‚£ä¹ˆä¸€å®šæ˜¯é‡å¤äº†è‡ªå·±å®šä¹‰çš„æ•°æ®é›†ï¼Œé‚£å°±çœ‹çœ‹å®šä¹‰çš„æ•°æ®é›†ä¸­æ˜¯å¦æŒ‡å®šäº† <code>classes</code>ã€‚ç»“æœä¸€çœ‹ï¼Œæœç„¶æ²¡æœ‰æŒ‡å®šï¼ŒåŠ ä¸Šå°±è§£å†³äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    samples_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    workers_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RepeatDataset'</span><span class="token punctuation">,</span>        times<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>        dataset<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>            ann_file<span class="token operator">=</span><span class="token string">'/home/chenhongkun/mmdetection/data/coco/annotations/train.json'</span><span class="token punctuation">,</span>            img_prefix<span class="token operator">=</span><span class="token string">'/home/chenhongkun/mmdetection/data/coco/train2017'</span><span class="token punctuation">,</span>            <span class="token comment"># classes=('tennis', ),</span>            pipeline<span class="token operator">=</span><span class="token punctuation">[</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>                    with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                    with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                    poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>                    img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    multiscale_mode<span class="token operator">=</span><span class="token string">'range'</span><span class="token punctuation">,</span>                    keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>                    keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'tennis'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/chenhongkun/mmdetection/data/coco/annotations/train.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/chenhongkun/mmdetection/data/coco/train2017'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>    test<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p>è®­ç»ƒäº†ä¸€ä¸ª epoch æ¥çœ‹çœ‹ç»“æœï¼Œå‘ç°å¾ˆéš¾æ£€æµ‹åˆ°å°çš„ç‰©ä½“ã€‚è€Œä¸”ç»è¿‡äº†70ä¸ª epoch çš„è®­ç»ƒï¼Œæœ€å Loss æ²¡æœ‰æŒç»­ä¸‹é™ï¼Œæ„Ÿè§‰ä¼˜åŒ–åœæ­¢äº†ã€‚ç°åœ¨å°è¯•å¢åŠ  batch æ•°é‡ï¼Œä¸‹ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯å‡å°‘å­¦ä¹ ç‡ã€‚æˆ‘ä¹Ÿåœ¨æ€è€ƒä¼šä¸ä¼šæ˜¯ anchor çš„é—®é¢˜ï¼Œå› ä¸º anchor å¤ªå¤§äº†æ ¹æœ¬æ£€æµ‹ä¸åˆ°è¿™ä¹ˆå°çš„ç‰©ä½“</p><p>ç°åœ¨ä¿®æ”¹äº† anchor å¤§å°æ•ˆæœä¸é”™ï¼Œç»§ç»­è®­ç»ƒâ€¦æœ€åå¯è§†åŒ–ç»“æœæ¥çœ‹æœ‰è®¸å¤šé‡å¤çš„ç»“æœï¼ŒNMS çš„é˜ˆå€¼éœ€è¦å†è°ƒä¸€ä¸‹ï¼Œè€Œä¸”ç°åœ¨çš„é¢„æµ‹å€¼éå¸¸ä½ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä¸è¿‡ä½ç½®è¿˜æ˜¯å¯ä»¥æ¥å—</p><p><img src="/archives/acef3112/image-20210920231709443.png" style="zoom:50%;"></p><h2 id="å·¥å…·ç®±"><a href="#å·¥å…·ç®±" class="headerlink" title="å·¥å…·ç®±"></a>å·¥å…·ç®±</h2><ol><li><p><code>print_config.py</code>ï¼Œæ‰“å°å®Œæ•´ config æ–‡ä»¶</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">python tools<span class="token operator">/</span>misc<span class="token operator">/</span>print_config<span class="token punctuation">.</span>py $<span class="token punctuation">{</span>CONFIG<span class="token punctuation">}</span> <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>options $<span class="token punctuation">{</span>OPTIONS <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><code>analyze_logs.py</code>ï¼Œå¯ä»¥å°†æ—¥å¿—ä¸­çš„è®°å½•å€¼ç»˜åˆ¶æˆæ›²çº¿å›¾</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">python tools<span class="token operator">/</span>analysis_tools<span class="token operator">/</span>analyze_logs<span class="token punctuation">.</span>py plot_curve <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>keys $<span class="token punctuation">{</span>KEYS<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>title $<span class="token punctuation">{</span>TITLE<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>legend $<span class="token punctuation">{</span>LEGEND<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>backend $<span class="token punctuation">{</span>BACKEND<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>style $<span class="token punctuation">{</span>STYLE<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>out $<span class="token punctuation">{</span>OUT_FILE<span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>tools/analysis_tools/analyze_results.py</code> calculates single image mAP and saves or shows the topk images with the highest and lowest scores based on prediction results. <a href="https://mmdetection.readthedocs.io/en/latest/useful_tools.html#result-analysis">link</a></p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">python tools<span class="token operator">/</span>analysis_tools<span class="token operator">/</span>analyze_results<span class="token punctuation">.</span>py \      $<span class="token punctuation">{</span>CONFIG<span class="token punctuation">}</span> \      $<span class="token punctuation">{</span>PREDICTION_PATH<span class="token punctuation">}</span> \      $<span class="token punctuation">{</span>SHOW_DIR<span class="token punctuation">}</span> \      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>show<span class="token punctuation">]</span> \      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>wait<span class="token operator">-</span>time $<span class="token punctuation">{</span>WAIT_TIME<span class="token punctuation">}</span><span class="token punctuation">]</span> \      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>topk $<span class="token punctuation">{</span>TOPK<span class="token punctuation">}</span><span class="token punctuation">]</span> \      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>show<span class="token operator">-</span>score<span class="token operator">-</span>thr $<span class="token punctuation">{</span>SHOW_SCORE_THR<span class="token punctuation">}</span><span class="token punctuation">]</span> \      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>cfg<span class="token operator">-</span>options $<span class="token punctuation">{</span>CFG_OPTIONS<span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><code>dataset_converters</code> å·¥å…·ç®±èƒ½å¤Ÿå°†ä¸åŒçš„æ•°æ®é›†æ ¼å¼è½¬ä¸º coco formatï¼Œæ¯”å¦‚ä½¿ç”¨ <code>image2coco.py</code> èƒ½å¤Ÿå°†å›¾ç‰‡ç”Ÿæˆæ²¡æœ‰æ ‡ç­¾çš„ coco format json æ–‡ä»¶</p></li><li><p><a href="https://github.com/Chien-Hung/DetVisGUI/tree/mmdetection">DetVisGUI project</a>ï¼Œä¸ºä¸€ä¸ªå¯è§†åŒ–é¡¹ç›®ï¼Œèƒ½å¤Ÿå°†æ£€æµ‹ç»“æœ <code>result.pkl</code> å¯è§†åŒ–</p></li></ol><h2 id="å®Œæ•´-config-æ–‡ä»¶"><a href="#å®Œæ•´-config-æ–‡ä»¶" class="headerlink" title="å®Œæ•´ config æ–‡ä»¶"></a>å®Œæ•´ config æ–‡ä»¶</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">checkpoint_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    <span class="token comment"># mark</span>log_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> hooks<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># mark</span>custom_hooks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'NumClassCheckHook'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>dist_params <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'nccl'</span><span class="token punctuation">)</span>log_level <span class="token operator">=</span> <span class="token string">'INFO'</span>load_from <span class="token operator">=</span> <span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/checkpoints/mask_rcnn_r101_fpn_mstrain-poly_3x_coco_20210524_200244-5675c317.pth'</span>resume_from <span class="token operator">=</span> <span class="token boolean">None</span>workflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>dataset_type <span class="token operator">=</span> <span class="token string">'CocoDataset'</span>data_root <span class="token operator">=</span> <span class="token string">'data/coco/'</span>img_norm_cfg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>train_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>        with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        multiscale_mode<span class="token operator">=</span><span class="token string">'range'</span><span class="token punctuation">,</span>        keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>test_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>        transforms<span class="token operator">=</span><span class="token punctuation">[</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    samples_per_gpu<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>  <span class="token comment"># mark</span>    workers_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RepeatDataset'</span><span class="token punctuation">,</span>        times<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>        dataset<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>            ann_file<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/annotations/train.json'</span><span class="token punctuation">,</span>            img_prefix<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/train2017'</span><span class="token punctuation">,</span>            classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'tennis'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>            pipeline<span class="token operator">=</span><span class="token punctuation">[</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>                    with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                    with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                    poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>                    img_scale<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    multiscale_mode<span class="token operator">=</span><span class="token string">'range'</span><span class="token punctuation">,</span>                    keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token builtin">dict</span><span class="token punctuation">(</span>                    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>                    keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'tennis'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/annotations/train.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/train2017'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/annotations/val.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/val2017'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span>                        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'tennis'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/annotations/test2017.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'/home/declan/vscode/mmlab_test/mmdetection/data/coco/test2017'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span>                        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'tennis'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>evaluation <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> metric<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">,</span> <span class="token string">'segm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>optimizer <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.00125</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>optimizer_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>grad_clip<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>lr_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># mark try 70 epoch</span>runner <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'EpochBasedRunner'</span><span class="token punctuation">,</span> max_epochs<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>model <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaskRCNN'</span><span class="token punctuation">,</span>    backbone<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ResNet'</span><span class="token punctuation">,</span>        depth<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">,</span>        num_stages<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>        out_indices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        frozen_stages<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>        norm_cfg<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'BN'</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        norm_eval<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        style<span class="token operator">=</span><span class="token string">'pytorch'</span><span class="token punctuation">,</span>        init_cfg<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pretrained'</span><span class="token punctuation">,</span>                      checkpoint<span class="token operator">=</span><span class="token string">'torchvision://resnet101'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    neck<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FPN'</span><span class="token punctuation">,</span>        in_channels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        num_outs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    rpn_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RPNHead'</span><span class="token punctuation">,</span>        in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        feat_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>        anchor_generator<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'AnchorGenerator'</span><span class="token punctuation">,</span>            scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># mark important</span>            ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_coder<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>            target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        loss_cls<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        loss_bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    roi_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span>        bbox_roi_extractor<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        bbox_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            fc_out_channels<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span>            roi_feat_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            bbox_coder<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>                target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            reg_class_agnostic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>            loss_cls<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_sigmoid<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            loss_bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_roi_extractor<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>            roi_layer<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>            num_convs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            conv_out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>            num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>            loss_mask<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> use_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    train_cfg<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        rpn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            assigner<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rpn_proposal<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            assigner<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            sampler<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test_cfg<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        rpn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        rcnn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>            nms<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span> iou_threshold<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'tennis'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>work_dir <span class="token operator">=</span> <span class="token string">'./work_dirs/mask_rcnn'</span>gpu_ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MMDetection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Labelme æ ‡æ³¨å·¥å…·</title>
      <link href="/archives/be6c9228.html"/>
      <url>/archives/be6c9228.html</url>
      
        <content type="html"><![CDATA[<h1 id="Labelme-æ ‡æ³¨å·¥å…·"><a href="#Labelme-æ ‡æ³¨å·¥å…·" class="headerlink" title="Labelme æ ‡æ³¨å·¥å…·"></a>Labelme æ ‡æ³¨å·¥å…·</h1><p><a href="https://github.com/wkentaro/labelme">labelme github</a></p><p>ä¸‹è½½ç›´æ¥ <code>pip install labelme</code></p><p>å‚è€ƒ <a href="https://www.bilibili.com/video/BV1jV411U7zb">bilibili</a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="ç®€å•è®¾ç½®"><a href="#ç®€å•è®¾ç½®" class="headerlink" title="ç®€å•è®¾ç½®"></a>ç®€å•è®¾ç½®</h3><p><img src="/archives/be6c9228/å±å¹•æˆªå›¾ 2021-09-17 115035.png" style="zoom: 50%;"></p><ol><li>æ‰“å¼€ Save Automatically</li><li>Change Output Dirï¼Œé€‰å®šè¾“å‡ºæ–‡ä»¶å¤¹</li><li>Save With Image Data</li></ol><h3 id="å¼€å§‹æ ‡æ³¨"><a href="#å¼€å§‹æ ‡æ³¨" class="headerlink" title="å¼€å§‹æ ‡æ³¨"></a>å¼€å§‹æ ‡æ³¨</h3><p>é€‰æ‹©å›¾ç‰‡æ‰€åœ¨æ–‡ä»¶å¤¹å³å¯å¼€å§‹æ ‡æ³¨ï¼Œå¯ä»¥ä½¿ç”¨å¤šè¾¹å½¢é€æ­¥å°†ç‰©ä½“åŒ…å›´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›ç®€å•çš„é›†åˆå›¾å½¢è¿›è¡Œæ ‡æ³¨ã€‚æ ‡æ³¨å®Œæˆååœ¨å½“å‰æ–‡ä»¶å¤¹å³å¯å‘ç° json æ–‡ä»¶</p><h3 id="æ–‡ä»¶æ•´ç†"><a href="#æ–‡ä»¶æ•´ç†" class="headerlink" title="æ–‡ä»¶æ•´ç†"></a>æ–‡ä»¶æ•´ç†</h3><ol><li>å¯¹æœªæ ‡æ³¨çš„æ–‡ä»¶è¿›è¡Œæ¸…ç†ï¼Œå› ä¸ºè‡ªå·±æ²¡æŠŠæ‰€æœ‰å›¾ç‰‡éƒ½æ ‡æ³¨ã€‚å¯¹å·²æ ‡æ³¨çš„æ–‡ä»¶é‡æ–°å‘½åï¼Œä½¿å¾—æ•°æ®é›†åˆ—è¡¨æ›´è¿è´¯</li><li>ä¿®æ”¹ json æ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼Œä»¥åŒ¹é…ä¿®æ”¹çš„æ–‡ä»¶åï¼Œå³ä¿®æ”¹ <code>imagePath</code> å­—æ®µ</li></ol><h3 id="æ•°æ®è½¬åŒ–"><a href="#æ•°æ®è½¬åŒ–" class="headerlink" title="æ•°æ®è½¬åŒ–"></a>æ•°æ®è½¬åŒ–</h3><p>ä½¿ç”¨ <a href="https://github.com/Tony607">Tony607</a>/<strong><a href="https://github.com/Tony607/labelme2coco">labelme2coco</a></strong> ä¸­çš„è„šæœ¬è¿›è¡Œè½¬åŒ–ï¼Œå°†æ‰€æœ‰çš„ json æ–‡ä»¶è½¬åŒ–ä¸ºä¸€ä¸ª coco format json æ–‡ä»¶ï¼Œéå¸¸æ–¹ä¾¿</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">python labelme2coco.py image_dir<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>image_dir</code> ä¸ºä¹‹å‰æ ‡æ³¨æ‰€åœ¨çš„æ–‡ä»¶å¤¹ã€‚è€Œä¸”ä½œè€…è¿˜æä¾›äº†ä¸€ä¸ª <code>COCO_Image_Viewer.ipynb</code> å¯ä»¥å°†ç»“æœå¯è§†åŒ–æ˜¾ç¤ºå‡ºæ¥ï¼Œåªéœ€è¦ç®€å•ä¿®æ”¹ä¸€ä¸‹å…¶ä¸­çš„æ–‡ä»¶å¤¹è·¯å¾„å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">annotation_path <span class="token operator">=</span> <span class="token string">"trainval.json"</span>image_dir <span class="token operator">=</span> <span class="token string">"your_image_dir"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>COCO api å­¦ä¹ </p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Labelme </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MMCV tutorial</title>
      <link href="/archives/81012a8b.html"/>
      <url>/archives/81012a8b.html</url>
      
        <content type="html"><![CDATA[<h1 id="Understand-MMCV"><a href="#Understand-MMCV" class="headerlink" title="Understand MMCV"></a>Understand MMCV</h1><p>ç°åœ¨æƒ³è¦æ›´æ·±ä¸€æ­¥å­¦ä¹  mmdetectionï¼Œäºæ˜¯å¿…ä¸å¯å°‘åœ°è¦æ¥äº†è§£ä¸€ä¸‹ MMCV è¿™ä¸ªåŸºç¡€åº“ã€‚ä»ä¹‹å‰çš„å­¦ä¹ è¿‡ç¨‹æ¥çœ‹ï¼Œä¸€ä¸ªæ€æƒ³å°±æ˜¯ä¸€åˆ‡çš†ä¸º classã€‚é…ç½®æ–‡ä»¶æœ‰ Config classï¼Œç®¡ç†æ¨¡å—æœ‰ Registry classï¼Œè¿è¡Œæ¨¡å‹æœ‰ Runner classâ€¦ä¸‹é¢æ¥å…·ä½“çœ‹çœ‹è¿™äº›ç±»çš„ä¸€äº›åŸºç¡€æ¡†æ¶</p><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><blockquote><p><code>Config</code> class is used for manipulating config and config files. It supports loading configs from multiple file formats including <strong>python</strong>, <strong>json</strong> and <strong>yaml</strong>. It provides dict-like apis to get and set values.</p></blockquote><p>ä» mmdetection ä»£ç æ¥çœ‹ï¼Œä¸»è¦æ˜¯ä» python æ–‡ä»¶åˆ›å»º config class</p><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>æ–‡æ¡£ä¸¾äº†ä¸€ä¸ªä¾‹å­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># test.py</span>a <span class="token operator">=</span> <span class="token number">1</span>b <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>b1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b2<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token string">'string'</span>pre_defined <span class="token operator">=</span> <span class="token string">'{{ fileDirname }}'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä» <code>test.py</code> åˆ›å»º config class</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>config <span class="token keyword">import</span> Configcfg <span class="token operator">=</span> Config<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span><span class="token string">'test.py'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token comment"># print result</span><span class="token comment"># Config (path: a.py): {'a': 1, 'b': {'b1': [0, 1, 2], 'b2': None}, 'c': (1, 2), 'd': 'string',</span><span class="token comment"># 'pre_defined': '/home/hongkun/mmdetection'}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>config class ä¹Ÿæ”¯æŒ4ä¸ªé¢„å…ˆå®šä¹‰çš„å˜é‡ <code>{{ var }}</code></p><p><code>{{ fileDirname }}</code> : å½“å‰æ–‡ä»¶è·¯å¾„</p><p><code>{{ fileBasename }}</code>: å½“å‰æ–‡ä»¶åï¼Œå¦‚ <code>test.py</code></p><p><code>{{ fileBasenameNoExtension }}</code>:  å½“å‰æ–‡ä»¶åï¼Œæ— æ‰©å±•åï¼Œå¦‚ <code>test</code></p><p><code>{{ fileExtname }}</code>: å½“å‰æ–‡ä»¶æ‰©å±•åï¼Œå¦‚ <code>.py</code></p><h3 id="ç»§æ‰¿-inheritance"><a href="#ç»§æ‰¿-inheritance" class="headerlink" title="ç»§æ‰¿ inheritance"></a>ç»§æ‰¿ inheritance</h3><p>æƒ³è¦ä½¿ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œåªéœ€è¦æ·»åŠ ç»§æ‰¿å…³é”®å­— <code>_base_ = file or list_of_file</code> å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># inheritance.py</span>_base_ <span class="token operator">=</span> <span class="token string">'test.py'</span> <span class="token comment"># or a list like, ['config_1.py', 'config_2.py']</span>b <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>b2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># b = dict(b3=1, _delete_=True)</span>e <span class="token operator">=</span> <span class="token string">'new config'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»§æ‰¿ä¹‹åï¼Œ<code>inheritance.py</code> é™¤äº†è‡ªèº«çš„é…ç½®ï¼Œè¿˜ä¼šåŒ…å« <code>test.py</code> ä¸­çš„æ‰€æœ‰é…ç½®</p><p>å½“é‡åˆ°é‡å¤çš„å…³é”®å­—æ—¶ï¼Œä¾‹å¦‚ä¸¤ä¸ªé…ç½®æ–‡ä»¶ä¸­éƒ½æœ‰ <code>b</code> å…³é”®å­—ï¼Œconfig class ä¹Ÿæ”¯æŒä¿®æ”¹ï¼Œæ­¤æ—¶æƒ…å†µåˆ†ä¸ºï¼š</p><ol><li>key å¯¹åº”çš„ value ä¸ºå­—å…¸ï¼Œé‚£ä¹ˆä¼šå°†è¿™ä¸ªå­—å…¸ä¸éœ€è¦ç»§æ‰¿çš„å­—å…¸è¿›è¡Œèåˆï¼Œå¦‚æœæƒ³è¦å¿½ç•¥ç»§æ‰¿æ–‡ä»¶å¤¹ä¸­çš„åŒåé…ç½®ï¼Œåˆ™éœ€è¦æ·»åŠ  <code>_delete_=True</code> é”®å€¼</li><li>key å¯¹åº”çš„ value ä¸ºä¸ºå…¶ä»–ç±»å‹ï¼Œåˆ™å°†ä½¿ç”¨å½“å‰çš„ value</li></ol><h2 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h2><p>registry class æ˜¯æ•´ä¸ª MMCV çš„å¤§ç®¡å®¶ï¼Œè´Ÿè´£å°†<strong>ç±»</strong>è¿›è¡Œæ³¨å†Œå¹¶é…åˆ config ä¸­çš„ä¿¡æ¯å°†ç±»å®ä¾‹åŒ–ï¼Œè¿™ä¸ªç±»å¯ä»¥æ˜¯ä»»ä½•å·²å®ç°çš„ç±»ï¼šå¯ä»¥æ˜¯æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç±»æ¯”å¦‚ Runner, Datasetsâ€¦æœ¬è´¨ä¸Š registry å®Œæˆçš„æ˜¯ä¸€ä¸ªæ˜ å°„ï¼š string â€”&gt; classï¼Œè¿™é‡Œçš„ string é€šå¸¸åœ¨ config ä¸­å¯¹åº”ç€ <code>type</code> å­—æ®µã€‚ä½ åœ¨ config æ–‡ä»¶ä¸­åªè¦çœ‹åˆ°äº† <code>type='CLASS_NAME'</code> é‚£ä¹ˆå°±ä¸€å®šå¯ä»¥åœ¨é¡¹ç›®ä»£ç ä¸­æ‰¾åˆ°å¯¹åº”çš„ç±»çš„å®ç°ï¼Œè€Œ <code>type</code> ä¹‹åå¡«å†™çš„å…¶ä»–å…³é”®å­—ï¼Œæ­£æ˜¯è¿™äº›ç±»éœ€è¦çš„åˆå§‹åŒ–å‚æ•°ã€‚æ‰€ä»¥å¤§å¯ä»¥æŠŠ registry çœ‹ä½œæ˜¯ä¸€ä¸ªé«˜çº§çš„å­—å…¸</p><p>ä½¿ç”¨ registry ç®¡ç†ç±»éœ€è¦3ä¸ªæ­¥éª¤ï¼ˆä¸€èˆ¬åªè¦2ä¸ªï¼‰ï¼š</p><ol><li>åˆ›å»º build function (ä¸€èˆ¬ä¸ç”¨è‡ªå·±åˆ›å»ºï¼ŒRegistry æœ‰è‡ªå¸¦ build_from_cfg å‡½æ•°)</li><li>åˆ›å»º registry ç±»</li><li>æŠŠå¾…ç®¡ç†çš„ç±»æ³¨å†Œåˆ° registry ä¸­ï¼Œå³å¯ä½¿ç”¨ registry ç®¡ç†æ¨¡å—</li></ol><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>å‡è®¾è¦ç®¡ç†ä¸€ä¸ª <code>Converter class</code>ï¼Œå‡†å¤‡åœ¨ <code>Converters</code> æ–‡ä»¶å¤¹ä¸­å®ç°ã€‚å…ˆå°è¯•ç”¨ä¸€ä¸ª python æ–‡ä»¶ï¼š <code>builder.py</code> å®ç° registry çš„ç®¡ç†åŠŸèƒ½ï¼Œå¹¶é€šè¿‡ registry å®ä¾‹åŒ– Converter</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Converters/builder.py</span><span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>utils <span class="token keyword">import</span> Registry<span class="token comment"># 1. create a build function</span><span class="token keyword">def</span> <span class="token function">build_converter</span><span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> registry<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    cfg_ <span class="token operator">=</span> cfg<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>    converter_type <span class="token operator">=</span> cfg_<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> converter_type <span class="token keyword">not</span> <span class="token keyword">in</span> registry<span class="token punctuation">:</span>        <span class="token keyword">raise</span> KeyError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Unrecognized converter type </span><span class="token interpolation"><span class="token punctuation">{</span>converter_type<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        converter_cls <span class="token operator">=</span> registry<span class="token punctuation">.</span>get<span class="token punctuation">(</span>converter_type<span class="token punctuation">)</span>    converter <span class="token operator">=</span> converter_cls<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">,</span> <span class="token operator">**</span>cfg_<span class="token punctuation">)</span>    <span class="token keyword">return</span> converter<span class="token comment"># 2. create a registry for converters</span>CONVERTERS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'Converter'</span><span class="token punctuation">,</span> build_func<span class="token operator">=</span>build_converter<span class="token punctuation">)</span><span class="token comment"># if use default build_func: CONVERTERS = Registry('Converter')</span><span class="token comment"># 3. use the registry to manage the module</span><span class="token decorator annotation punctuation">@CONVERTERS<span class="token punctuation">.</span>register_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Converter1</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b <span class="token comment"># use this converter through configs</span>converter_cfg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Converter1'</span><span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token string">'a_value'</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token string">'b_value'</span><span class="token punctuation">)</span>converter <span class="token operator">=</span> CONVERTERS<span class="token punctuation">.</span>build<span class="token punctuation">(</span>converter_cfg<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'converter attribute:'</span><span class="token punctuation">,</span> converter<span class="token punctuation">.</span>a<span class="token punctuation">,</span> converter<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢å°±æ˜¯ registry çš„å·¥ä½œé€»è¾‘ï¼šå…ˆå»ºé€  registry ç±»ï¼Œå†å°†å¾…ç®¡ç†çš„ç±»é€šè¿‡è£…é¥°å™¨æ³¨å†Œåˆ° registry ç±»ä¸­ï¼Œæœ€åä½¿ç”¨ cfg å»ºé€ å®ä¾‹</p><p>å¦‚æœå»çœ‹ mmdetection çš„ä»£ç ä¼šå‘ç°ï¼Œå…¶ <code>builder.py</code> æ˜¯å†™å¾—éå¸¸ç®€å•çš„ï¼Œå¹¶æ²¡æœ‰åŒ…å« <code>build_func</code> ä»¥åŠå…·ä½“ç®¡ç†çš„ç±»ã€‚æ˜¯å› ä¸ºå…¶ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ <code>build_func=build_from_cfg</code> å¹¶ä¸”å°†å…¶ä»–ç±»ç”¨å•ç‹¬æ–‡ä»¶ä¿å­˜ï¼Œä¹‹åé€šè¿‡ <code>__init__.py</code> ï¼Œå°†æ‰€æœ‰çš„ç±»æ³¨å†Œåˆ° builder ä¸­çš„ registry ç±»ä¸­</p><h3 id="å±‚çº§æ³¨å†Œ-Hierarchy-Registry"><a href="#å±‚çº§æ³¨å†Œ-Hierarchy-Registry" class="headerlink" title="å±‚çº§æ³¨å†Œ Hierarchy Registry"></a>å±‚çº§æ³¨å†Œ Hierarchy Registry</h3><p>è¿™é‡Œæˆ‘æ›´æƒ³å«å®ƒç»§æ‰¿æ³¨å†Œã€‚åœ¨ registry ç±»ä¸­æä¾›äº† parent å‚æ•°ï¼Œparent å¿…é¡»ä¹Ÿæ˜¯ registry ç±»ã€‚è¿™æ ·å­ registry å°±èƒ½å¤Ÿç»§æ‰¿ parent registry çš„ build_func æ¥è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªç±»æ—¢èƒ½å¤Ÿä½¿ç”¨æ³¨å†Œåœ¨è‡ªå·±åä¸‹çš„ç±»ï¼Œé€šè¿‡æŒ‡å®šâ€æ—è°±â€œä¹Ÿèƒ½å¤Ÿä¹Ÿä½¿ç”¨å…¶ä»– registry ç®¡ç†çš„ç±»ã€‚ä½†è¿™ä¸ªâ€æ—è°±â€œæ˜¯æŒ‰ç…§ OpenMMLab é¡¹ç›®åˆ’åˆ†çš„ï¼Œä¸æ˜¯æˆ‘ä»¬èƒ½ä¿®æ”¹çš„ï¼Œæ‰€ä»¥ä¸ªè¿™ç»§æ‰¿æ³¨å†Œçš„æ„ä¹‰æ˜¯åœ¨äº OpenMMLab ä¸åŒé¡¹ç›®ä¹‹é—´çš„æ¨¡å‹éƒ½å¯ä»¥è°ƒç”¨ï¼Œä¾‹å¦‚ mmdetection å¯ä»¥è°ƒç”¨ mmclassification ä¸­çš„æ¨¡å‹ã€‚è¯·å‰å¾€æ–‡æ¡£å‚è€ƒ <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/registry.html#hierarchy-registry">æ›´å¤š</a></p><h2 id="Runner"><a href="#Runner" class="headerlink" title="Runner"></a>Runner</h2><p>Runner æ˜¯ç®¡ç†è®­ç»ƒè¿‡ç¨‹çš„ç±»ï¼Œæœ‰ä¸¤ä¸ªå­ç±» <code>EpochBasedRunner</code> and <code>IterBasedRunner</code>ã€‚Runner ä¹Ÿèƒ½å¤Ÿåœ¨ train å’Œ val ä¸¤ç§æ¨¡å¼ä¸­åˆ‡æ¢ï¼Œå’Œ hook ç»“åˆå¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æœ‰æ›´å¤šæ‹“å±•åŠŸèƒ½</p><h3 id="EpochBasedRunner"><a href="#EpochBasedRunner" class="headerlink" title="EpochBasedRunner"></a>EpochBasedRunner</h3><p>è¯¥ runner çš„å·¥ä½œæµæ˜¯åŸºäº epoch çš„ï¼Œæ¯ä¸€ä¸ª epoch å°†åŒ…å«å¤šä¸ª iterationsã€‚æ¯”å¦‚å½“ <code>workflow = [('train', 2), ('val', 1)]</code> è¯¥ runner å°±ä¼šè¿è¡Œ2æ¬¡è®­ç»ƒé›†1æ¬¡éªŒè¯é›†ã€‚ä¸‹é¢çœ‹çœ‹å…¶è¿è¡Œçš„åŸºæœ¬é€»è¾‘</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># the condition to stop training</span><span class="token keyword">while</span> curr_epoch <span class="token operator">&lt;</span> max_epochs<span class="token punctuation">:</span>    <span class="token comment"># traverse the workflow.</span>    <span class="token comment"># e.g. workflow = [('train', 2), ('val', 1)]</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> flow <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>workflow<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># mode(e.g. train) determines which function to run</span>        mode<span class="token punctuation">,</span> epochs <span class="token operator">=</span> flow        <span class="token comment"># epoch_runner will be either self.train() or self.val()</span>        epoch_runner <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mode<span class="token punctuation">)</span>        <span class="token comment"># execute the corresponding function</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>            epoch_runner<span class="token punctuation">(</span>data_loaders<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæ˜¯ train æ¨¡å¼ï¼Œé‚£ä¹ˆå°†è°ƒç”¨ç±»ä¼¼å¦‚ä¸‹å‡½æ•°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Currently, epoch_runner could be either train or val</span><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_loader<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># traverse the dataset and get batch data for 1 epoch</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> data_batch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>data_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># it will execute all before_train_iter function in the hooks registered. You may want to watch out for the order.</span>        self<span class="token punctuation">.</span>call_hook<span class="token punctuation">(</span><span class="token string">'before_train_iter'</span><span class="token punctuation">)</span>        <span class="token comment"># set train_mode as False in val function</span>        self<span class="token punctuation">.</span>run_iter<span class="token punctuation">(</span>data_batch<span class="token punctuation">,</span> train_mode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>call_hook<span class="token punctuation">(</span><span class="token string">'after_train_iter'</span><span class="token punctuation">)</span>   self<span class="token punctuation">.</span>call_hook<span class="token punctuation">(</span><span class="token string">'after_train_epoch'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šä¸¤æ®µä»£ç å°±å±•ç¤ºäº† runner çš„åŸºæœ¬é€»è¾‘ï¼šéå†æ•´ä¸ªè®­ç»ƒé›†ï¼Œå¹¶åœ¨æ¯æ¬¡éå†å‰åè¿è¡Œ hook è¿›è¡Œæ‹“å±•æ“ä½œ</p><h3 id="IterBasedRunner"><a href="#IterBasedRunner" class="headerlink" title="IterBasedRunner"></a>IterBasedRunner</h3><p>ä¸ <code>EpochBasedRunner</code> ç±»ä¼¼ï¼Œä½†æ˜¯æ˜¯åŸºäº iteration çš„ runner å®ç°ï¼Œä¸€ä¸ª iteration å°†åŒ…å«ä¸€ä¸ª batchsizeã€‚å¦‚æœå®šä¹‰äº† <code>workflow = [('train', 2), ('val', 1)]</code> é‚£ä¹ˆå°†ä¼šå¾ªç¯è¿è¡Œ2ä¸ªè®­ç»ƒé›† iterations å’Œ1ä¸ªéªŒè¯æœº iterationã€‚ä¸‹é¢ä¹Ÿçœ‹çœ‹å…¶è¿è¡Œé€»è¾‘</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Although we set workflow by iters here, we might also need info on the epochs in some using cases. That can be provided by IterLoader.</span>iter_loaders <span class="token operator">=</span> <span class="token punctuation">[</span>IterLoader<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data_loaders<span class="token punctuation">]</span><span class="token comment"># the condition to stop training</span><span class="token keyword">while</span> curr_iter <span class="token operator">&lt;</span> max_iters<span class="token punctuation">:</span>    <span class="token comment"># traverse the workflow.</span>    <span class="token comment"># e.g. workflow = [('train', 2), ('val', 1)]</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> flow <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>workflow<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># mode(e.g. train) determines which function to run</span>        mode<span class="token punctuation">,</span> iters <span class="token operator">=</span> flow        <span class="token comment"># iter_runner will be either self.train() or self.val()</span>        iter_runner <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mode<span class="token punctuation">)</span>        <span class="token comment"># execute the corresponding function</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iters<span class="token punctuation">)</span><span class="token punctuation">:</span>            iter_runner<span class="token punctuation">(</span>iter_loaders<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨-Runner"><a href="#ä½¿ç”¨-Runner" class="headerlink" title="ä½¿ç”¨ Runner"></a>ä½¿ç”¨ Runner</h3><p>ä¸€èˆ¬æ¥è®²ä½¿ç”¨ runner æ¥è¿›è¡Œè®­ç»ƒæœ‰4ä¸ªåŸºæœ¬æ­¥éª¤ï¼š</p><ol><li>åˆå§‹åŒ– dataloader, model, optimizer, etc.</li><li>åˆå§‹åŒ– runnerï¼šå°† config, model, optimizer, etc. ä¼ å…¥ Runner ä¸­è¿›è¡Œå®ä¾‹åŒ–</li><li>æ³¨å†Œ training hooks &amp; customized hooks</li><li>å¼€å§‹è®­ç»ƒï¼š<code>runner.run(data_loaders, cfg.workflow)</code></li></ol><p>å…·ä½“ç¤ºä¾‹ä»£ç è¯·ç§»æ­¥ <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/runner.html#a-simple-example">MMCV Runner</a></p><h2 id="File-IO"><a href="#File-IO" class="headerlink" title="File IO"></a>File IO</h2><p>mmcv ç»™å¯¼å…¥å’Œè¾“å…¥æ–‡æ¡£è®¾æœ‰ APIï¼Œå¯ä»¥å¯¼å…¥ä¸åŒæ ¼å¼çš„æ–‡æ¡£ï¼Œä¾‹å¦‚ json, yaml, pklã€‚ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•å¯¼å…¥ä¸€ä¸ª json æ–‡ä»¶ä¸ºå­—å…¸</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// file.json</span><span class="token punctuation">{</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>    <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Python: Current File"</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"python"</span><span class="token punctuation">,</span>            <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>            <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"${file}"</span><span class="token punctuation">,</span>            <span class="token property">"console"</span><span class="token operator">:</span> <span class="token string">"integratedTerminal"</span><span class="token punctuation">,</span>            <span class="token property">"justMyCode"</span><span class="token operator">:</span> <span class="token boolean">false</span>        <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mmcv<span class="token builtin">file</span> <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'file.json'</span><span class="token punctuation">)</span><span class="token comment"># load data from a file-like object</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'file.json'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    data <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">,</span> file_format<span class="token operator">=</span><span class="token string">'json'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token comment"># &lt;class 'dict'&gt;</span><span class="token comment"># {'version': '0.2.0', 'configurations': [{'name': 'Python: Current File', 'type': 'python', 'request': 'launch', 'program': '${file}', 'console': 'integratedTerminal', 'justMyCode': False}]}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>mmcv.dump</code> æ¥è½¬åŒ–æ–‡ä»¶æˆ–è€…è¾“å‡ºæ–‡ä»¶</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mmcv<span class="token comment"># å°†å­—å…¸è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span>info <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Declan'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span>dump_info <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>info<span class="token punctuation">,</span> file_format<span class="token operator">=</span><span class="token string">'yaml'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dump_info<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>dump_info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># age: 23</span><span class="token comment"># name: Declan</span><span class="token comment"># &lt;class 'str'&gt;</span><span class="token comment"># å°†æ–‡ä»¶ä¿å­˜ä¸º info.yaml</span>mmcv<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>info<span class="token punctuation">,</span> <span class="token string">'info.yaml'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯ä»¥ä¸Šçš„ API ä¸èƒ½å¯¼å…¥ txt æ ¼å¼æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨ <code>mmcv.list_from_txt</code> or <code>mmcv.dict_from_txt</code> å°† txt æ–‡ä»¶å¯¼å…¥ä¸ºåˆ—è¡¨æˆ–è€…å­—å…¸</p><pre class="line-numbers language-a.txt" data-language="a.txt"><code class="language-a.txt">1 cat2 dog cow3 panda<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mmcv<span class="token punctuation">.</span>dict_from_file<span class="token punctuation">(</span><span class="token string">'a.txt'</span><span class="token punctuation">)</span><span class="token comment"># {'1': 'cat', '2': ['dog', 'cow'], '3': 'panda'}</span>mmcv<span class="token punctuation">.</span>list_from_file<span class="token punctuation">(</span><span class="token string">'a.txt'</span><span class="token punctuation">)</span><span class="token comment"># ['1 cat', '2 dog cow', '3 panda']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Data-Process"><a href="#Data-Process" class="headerlink" title="Data Process"></a>Data Process</h2><blockquote><p>This module provides some image processing methods, which requires <code>opencv</code> to be installed.</p></blockquote><h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><h4 id="Read-Write-Show"><a href="#Read-Write-Show" class="headerlink" title="Read/Write/Show"></a>Read/Write/Show</h4><p>å¯¹äºå›¾ç‰‡çš„åŸºæœ¬æ“ä½œï¼šè¯»ã€å†™ã€å±•ç¤ºï¼Œåˆ†åˆ«ä½¿ç”¨ <code>imread</code>ï¼Œ<code>imwrite</code>ï¼Œ<code>imshow</code> ä¸‰ä¸ª API</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mmcv<span class="token comment"># Read &amp; Write</span>img <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'test.jpg'</span><span class="token punctuation">)</span>mmcv<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'out.jpg'</span><span class="token punctuation">)</span><span class="token comment"># Show</span>mmcv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'tests/data/color.jpg'</span><span class="token punctuation">)</span><span class="token comment"># Show with bboxes</span>bboxes <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>mmcv<span class="token punctuation">.</span>imshow_bboxes<span class="token punctuation">(</span>img<span class="token punctuation">,</span> bboxes<span class="token punctuation">)</span><span class="token comment"># Show with ndarray</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    img <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>    mmcv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">,</span> win_name<span class="token operator">=</span><span class="token string">'test image'</span><span class="token punctuation">,</span> wait_time<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="More"><a href="#More" class="headerlink" title="More"></a>More</h4><p>å¯¹äºå›¾ç‰‡è¿˜æœ‰æ›´å¤šçš„æ“ä½œå°±ä¸åœ¨è¿™é‡Œåˆ—ä¸¾äº†ï¼Œä¾‹å¦‚è‰²åŸŸè½¬æ¢ã€å‰ªè£ã€æ—‹è½¬ç­‰ï¼Œå‚è€ƒ <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/data_process.html#data-process">MMCV æ–‡æ¡£</a></p><h3 id="Video"><a href="#Video" class="headerlink" title="Video"></a>Video</h3><p>å…³äºè§†é¢‘æ¨¡å—ä¸»è¦å®ç°3ä¸ªåŠŸèƒ½ï¼š</p><ol><li>è¯»å–è§†é¢‘</li><li>ç¼–è¾‘è§†é¢‘</li><li>å¤„ç†å…‰æµæ–‡ä»¶</li></ol><h4 id="VideoReader"><a href="#VideoReader" class="headerlink" title="VideoReader"></a>VideoReader</h4><p>è¯¥ API èƒ½å¤Ÿè¿‡å¾—è§†é¢‘çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶èƒ½å¤Ÿè§†é¢‘ä¸­çš„æ¯ä¸€å¸§è¿›è¡Œç´¢å¼•æˆ–éå†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">video <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>VideoReader<span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">)</span><span class="token comment"># obtain basic information</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>video<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>width<span class="token punctuation">,</span> video<span class="token punctuation">.</span>height<span class="token punctuation">,</span> video<span class="token punctuation">.</span>resolution<span class="token punctuation">,</span> video<span class="token punctuation">.</span>fps<span class="token punctuation">)</span><span class="token comment"># iterate over all frames</span><span class="token keyword">for</span> frame <span class="token keyword">in</span> video<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment"># read the next frame</span>img <span class="token operator">=</span> video<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># read a frame by index</span>img <span class="token operator">=</span> video<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token comment"># read some frames</span>img <span class="token operator">=</span> video<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥æ¨¡å—å†…ç½®æ–¹æ³• <code>cvt2frames</code> å¯ä»¥å°† video è½¬åŒ–ä¸º imagesï¼ŒåŒæ—¶ <code>mmcv.frames2video</code> ä¹Ÿå¯ä»¥å°† images è½¬åŒ–ä¸º video</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># split a video into frames and save to a folder</span>video <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>VideoReader<span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">)</span><span class="token comment"># convert a video to frame images</span>video<span class="token punctuation">.</span>cvt2frames<span class="token punctuation">(</span><span class="token string">'out_dir'</span><span class="token punctuation">)</span><span class="token comment"># generate video from frames</span>mmcv<span class="token punctuation">.</span>frames2video<span class="token punctuation">(</span><span class="token string">'out_dir'</span><span class="token punctuation">,</span> <span class="token string">'test.avi'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœç†Ÿæ‚‰ ffmpeg çš„è¯ï¼Œé€šè¿‡ ffmpeg èƒ½å¤Ÿå®ç°æ›´å¤šæ ¼å¼çš„è½¬åŒ–ï¼Œå¯ä»¥ä½¿ç”¨ python ä¸­çš„ <code>os.system</code> æ‰§è¡Œå‘½ä»¤è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> osos<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'ffmpeg -version'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>mmcv ä¸­ä¹Ÿæœ‰ä¸€äº›æ¥å£å€Ÿç”¨äº† ffmpeg ä»¥å®ç°å¯¹è§†é¢‘çš„æ›´å¤šæ“ä½œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># cut a video clip</span>mmcv<span class="token punctuation">.</span>cut_video<span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">,</span> <span class="token string">'clip1.mp4'</span><span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> vcodec<span class="token operator">=</span><span class="token string">'h264'</span><span class="token punctuation">)</span><span class="token comment"># join a list of video clips</span>mmcv<span class="token punctuation">.</span>concat_video<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'clip1.mp4'</span><span class="token punctuation">,</span> <span class="token string">'clip2.mp4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'joined.mp4'</span><span class="token punctuation">,</span> log_level<span class="token operator">=</span><span class="token string">'quiet'</span><span class="token punctuation">)</span><span class="token comment"># resize a video with the specified size</span>mmcv<span class="token punctuation">.</span>resize_video<span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">,</span> <span class="token string">'resized1.mp4'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># resize a video with a scaling ratio of 2</span>mmcv<span class="token punctuation">.</span>resize_video<span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">,</span> <span class="token string">'resized2.mp4'</span><span class="token punctuation">,</span> ratio<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Optical-flow"><a href="#Optical-flow" class="headerlink" title="Optical flow"></a>Optical flow</h4><p>mmcv ä¹Ÿå¯¹å…‰æµæ–‡ä»¶çš„å¤„ç†æä¾›æ”¯æŒï¼Œä½†æˆ‘å¯¹äºå…¶äº†è§£ä¸å¤šï¼Œæš‚æ—¶ä¸ä½œæ•´ç†ã€‚è¿™é‡Œè´´ä¸€ä¸ªé“¾æ¥ <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/data_process.html#optical-flow">MMCV Optical flow</a></p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><h3 id="KITTI-æ•°æ®é›†"><a href="#KITTI-æ•°æ®é›†" class="headerlink" title="KITTI æ•°æ®é›†"></a>KITTI æ•°æ®é›†</h3><p>KITTIæ•°æ®é›†æœ‰40å¤šä¸ªGï¼Œç›¸æ¯”èµ·æ¥æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°æ®é›†</p><p>å¯¹äºæ•°æ®é›†çš„è®²è§£å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/u013086672/article/details/103913361">CSDN</a></p><p>ä¸‹è½½æ•°æ®é›†å¯ä»¥åœ¨ <a href="https://gas.graviti.cn/dataset/data-decorators/KITTIObject">GRAVITI</a> ä¸‹è½½ï¼Œéœ€è¦æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œä½†æ˜¯é€Ÿåº¦å¾ˆå¿«</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MMCV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MMDetection tutorial note</title>
      <link href="/archives/71f4e62.html"/>
      <url>/archives/71f4e62.html</url>
      
        <content type="html"><![CDATA[<h1 id="MMDetection-tutorial-note"><a href="#MMDetection-tutorial-note" class="headerlink" title="MMDetection tutorial note"></a>MMDetection tutorial note</h1><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><p>ç”±äº config æ˜¯æœ‰ç»§æ‰¿æœºåˆ¶çš„ï¼Œæ‰€ä»¥æƒ³è¦æŸ¥çœ‹å®Œæ•´çš„ configï¼Œå¯ä»¥ç”¨å®˜æ–¹æä¾›çš„ <code>print_config.py</code> å‡½æ•°æ¥æŸ¥çœ‹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python tools/misc/print_config.py /<span class="token environment constant">PATH</span>/TO/CONFIG<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ä¿®æ”¹-config"><a href="#ä¿®æ”¹-config" class="headerlink" title="ä¿®æ”¹ config"></a>ä¿®æ”¹ config</h3><p>åœ¨ä½¿ç”¨ <code>tools/train.py</code> or <code>tools/test.py</code> æ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>--cfg-options</code> æ¥ä¿®æ”¹æ­¤æ¬¡è¿è¡Œçš„ config è€Œä¸ä¿®æ”¹ config æ–‡ä»¶</p><p>æ›´æ”¹å­—å…¸ï¼Œåˆ—è¡¨ï¼Œå…ƒç»„éƒ½å¯ä»¥ï¼Œåªéœ€è¦æŒ‰ç…§è§„èŒƒä¼ å…¥å‚æ•°å³å¯ï¼Œä¸‹é¢ç»™å‡ ä¸ªä¾‹å­</p><ol><li><p>æ›´æ”¹å­—å…¸ <code>--cfg-options model.backbone.norm_eval=False</code></p></li><li><p>æ›´æ”¹åˆ—è¡¨ä¸­çš„å­—å…¸ <code>[dict(type='LoadImageFromFile'), ...]</code> </p><p><code>--cfg-options data.train.pipeline.0.type=LoadImageFromWebcam</code></p></li><li><p>æ›´æ”¹åˆ—è¡¨ï¼Œå…ƒç»„ <code>workflow=[('train', 1)]</code></p><p><code>--cfg-options workflow="[(train,1),(val,1)]"</code> æ³¨æ„å¿…é¡»è¦åŠ å¼•å·ï¼Œä¸”å†…éƒ¨ä¸èƒ½æœ‰ç©ºæ ¼</p></li></ol><h3 id="config-ç»“æ„"><a href="#config-ç»“æ„" class="headerlink" title="config ç»“æ„"></a>config ç»“æ„</h3><p>åœ¨ <code>config/_base_</code> ä¸­æœ‰4ä¸ªåŸºæœ¬çš„ç»„æˆéƒ¨åˆ†</p><ol><li>dataset</li><li>models: backbone, neck æ˜¯å¿…é¡»æœ‰çš„</li><li>schedule</li><li>default_runtime</li></ol><p>æ›´è¯¦ç»†çš„è¦æ±‚å’Œä¾‹å­è¯·ç›´æ¥æŸ¥çœ‹ <a href="https://mmdetection.readthedocs.io/en/latest/tutorials/config.html#config-name-style">æ–‡æ¡£</a></p><p>config çš„ç»“æ„å…¶å®å°±ç»™å­¦ä¹  MMDetection æœ‰ä¸€ä¸ªæ˜ç¡®çš„æŒ‡å¯¼ï¼Œé‡ç‚¹å°±æ˜¯è¿™å››ä¸ªéƒ¨åˆ†ï¼Œæ€ä¹ˆå»ºç«‹æ•°æ®é›†ã€æ¨¡å‹ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­çš„ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­éœ€ä¸éœ€è¦åšäº›å…¶ä»–è®°å½•å’Œå¤„ç†â€¦</p><h2 id="Customize-Datasets"><a href="#Customize-Datasets" class="headerlink" title="Customize Datasets"></a>Customize Datasets</h2><p>æ•°æ®å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†å¤„ç†ï¼Œä¸€ä¸ªæ˜¯æ•°æ®æœ¬èº«ï¼Œå¦ä¸€ä¸ªæ˜¯æ•°æ®çš„æ ‡ç­¾ä¿¡æ¯ <code>annotation_file</code>ï¼Œæ‰€ä»¥æƒ³è¦å»ºç«‹ä¸ªæ€§åŒ–çš„æ•°æ®é›†ï¼Œå¤„ç†å¥½è¿™ä¸¤ä¸ªéƒ¨åˆ†å³å¯</p><p>å¯¹äºæ•°æ®æœ¬èº«ï¼Œæ¯”å¦‚å›¾ç‰‡æ•°æ®ã€ç‚¹äº‘æ•°æ®â€¦å…¶å®èƒ½å¤Ÿåšçš„å¤„ç†æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œæ›´å¤šçš„æ˜¯åšé¢„å¤„ç†æ¯”å¦‚ data augmentationï¼Œä½†è¿™äº›æ“ä½œå°±ä¸åœ¨è¿™ä¸€éƒ¨åˆ†è¿›è¡Œï¼Œè€Œæ˜¯åˆ°ä¸‹ä¸€èŠ‚ Data Piplines ä¸­è¿›è¡Œ</p><h3 id="è§„èŒƒ-annotation-file"><a href="#è§„èŒƒ-annotation-file" class="headerlink" title="è§„èŒƒ annotation_file"></a>è§„èŒƒ annotation_file</h3><p>ç°åœ¨é‡å¿ƒæ”¾åœ¨å¤„ç†æ•°æ®çš„æ ‡ç­¾ä¿¡æ¯ä¸Šï¼Œæ ¸å¿ƒå°±æ˜¯æŠŠæ ‡ç­¾ä¿¡æ¯å¤„ç†æˆä¸ºä¸€ç§è§„èŒƒçš„æ ¼å¼å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œåœ¨ MMDetection ä¸­ COCO format æ˜¯ä¸€ç§æ¨èçš„æ ¼å¼ã€‚COCO format æ˜¯ä¸€ä¸ª json æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­åŒ…å«äº†æ•´ä¸ªæ•°æ®é›†æ¯ä¸€ä¸ªæ ·æœ¬çš„æ ‡ç­¾ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰3ä¸ªå¤§çš„å…³é”®å­—ï¼š</p><ul><li><code>images</code>: contains a list of images with their informations like <code>file_name</code>, <code>height</code>, <code>width</code>, and <code>id</code>.</li><li><code>annotations</code>: contains the list of instance annotations.</li><li><code>categories</code>: contains the list of categories names and their ID.</li></ul><p>å½¢å¦‚ä¸‹é¢çš„å†…å®¹</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">'images'<span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>        'file_name'<span class="token operator">:</span> 'COCO_val2014_000000001268.jpg'<span class="token punctuation">,</span>        'height'<span class="token operator">:</span> <span class="token number">427</span><span class="token punctuation">,</span>        'width'<span class="token operator">:</span> <span class="token number">640</span><span class="token punctuation">,</span>        'id'<span class="token operator">:</span> <span class="token number">1268</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    ...<span class="token punctuation">]</span><span class="token punctuation">,</span>'annotations'<span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>        'segmentation'<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">192.81</span><span class="token punctuation">,</span>            <span class="token number">247.09</span><span class="token punctuation">,</span>            ...            <span class="token number">219.03</span><span class="token punctuation">,</span>            <span class="token number">249.06</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  # if you have mask labels        'area'<span class="token operator">:</span> <span class="token number">1035.749</span><span class="token punctuation">,</span>        'iscrowd'<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        'image_id'<span class="token operator">:</span> <span class="token number">1268</span><span class="token punctuation">,</span>        'bbox'<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">192.81</span><span class="token punctuation">,</span> <span class="token number">224.8</span><span class="token punctuation">,</span> <span class="token number">74.73</span><span class="token punctuation">,</span> <span class="token number">33.43</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        'category_id'<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>        'id'<span class="token operator">:</span> <span class="token number">42986</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    ...<span class="token punctuation">]</span><span class="token punctuation">,</span>'categories'<span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>'id'<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 'name'<span class="token operator">:</span> 'car'<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ›´æ”¹-config-file-ä»¥åŒ¹é…"><a href="#æ›´æ”¹-config-file-ä»¥åŒ¹é…" class="headerlink" title="æ›´æ”¹ config file ä»¥åŒ¹é…"></a>æ›´æ”¹ config file ä»¥åŒ¹é…</h3><p>æ›´æ”¹ config file ä¸­çš„ dataset/data é…ç½®æ¥åŒ¹é… <code>annotation_file</code>ï¼Œéœ€è¦æ˜ç¡®çš„æ˜¯ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><code>annotation_file_path</code> &amp; <code>image_path</code></li><li><code>classes</code> æ•°æ®é›†æœ‰å“ªäº›ç±»åˆ«</li><li><code>num_classes</code> æ•°æ®é›†ç±»åˆ«æœ‰å¤šå°‘</li></ol><p>è¿™ä¸‰ä¸ªéƒ¨åˆ†åœ¨ config ä¸­çš„ train, val, test å­—æ®µä¸­å‡æœ‰å‡ºç°ï¼Œå…·ä½“æ›´æ”¹å“ªäº›éƒ¨åˆ†ï¼Œå‚è€ƒä¸‹é¢çš„ä»£ç ï¼Œå‡è®¾æ–°æ•°æ®é›†æœ‰5ä¸ªç±»åˆ«ï¼Œç”¨å­—æ¯ a~e æ¥è¡¨ç¤º</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># the new config inherits the base configs to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'./cascade_mask_rcnn_r50_fpn_1x_coco.py'</span><span class="token comment"># 1. dataset settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'CocoDataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    samples_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    workers_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span>dataset_type<span class="token punctuation">,</span>        <span class="token comment"># explicitly add your class names to the field `classes`</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'path/to/your/train/annotation_data'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'path/to/your/train/image_data'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span>dataset_type<span class="token punctuation">,</span>        <span class="token comment"># explicitly add your class names to the field `classes`</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'path/to/your/val/annotation_data'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'path/to/your/val/image_data'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span>dataset_type<span class="token punctuation">,</span>        <span class="token comment"># explicitly add your class names to the field `classes`</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'path/to/your/test/annotation_data'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'path/to/your/test/image_data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 2. model settings</span><span class="token comment"># explicitly over-write all the `num_classes` field from default 80 to 5.</span>model <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    roi_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span><span class="token punctuation">[</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>                <span class="token comment"># explicitly over-write all the `num_classes` field from default 80 to 5.</span>                num_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>                <span class="token comment"># explicitly over-write all the `num_classes` field from default 80 to 5.</span>                num_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>                <span class="token comment"># explicitly over-write all the `num_classes` field from default 80 to 5.</span>                num_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment"># explicitly over-write all the `num_classes` field from default 80 to 5.</span>    mask_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ¨è <a href="https://www.bilibili.com/video/BV1Jb4y1r7ir?p=1">bilibili æ•™ç¨‹</a>ï¼Œæœ‰å®ä¾‹è®²è§£äº†å¦‚ä½•å¤„ç†ä¸ªæ€§åŒ–æ•°æ®é›†</p><p>æ–‡æ¡£ä¸­è¿˜æåˆ°äº†å¯ä»¥<a href="https://mmdetection.readthedocs.io/en/latest/tutorials/customize_dataset.html#reorganize-new-data-format-to-middle-format"> å»ºç«‹è‡ªå·±çš„ Dataset ç±»</a>ï¼Œæ¥å®ŒæˆåŸæœ¬çš„ <code>CocoDataset</code> ç±»çš„åŠŸèƒ½ã€‚åªéœ€è¦ç»§æ‰¿ <code>CustomDataset</code> åŸºç±»ç„¶åé‡å†™ <code>load_annotations(self, ann_file)</code> and <code>get_ann_info(self, idx)</code> ä¸¤ä¸ªæ–¹æ³•</p><h2 id="Customize-Data-Pipelines"><a href="#Customize-Data-Pipelines" class="headerlink" title="Customize Data Pipelines"></a>Customize Data Pipelines</h2><p>æ¥ä¸‹æ¥å°±è¦å…·ä½“åœ°å¯¹æ•°æ®é›†è¿›è¡Œå¤„ç†äº†ï¼Œéœ€è¦æ·±å…¥åˆ° <code>mmdet/datasets</code> å½“ä¸­çœ‹çœ‹ï¼Œä» <code>builder.py</code> å¤§è‡´å¯ä»¥çœ‹å‡ºï¼Œç±»ä¼¼äº pytorchï¼Œmmdetection ä¹Ÿå°†æ•°æ®å¤„ç†åˆ†ä¸º <code>Dataset</code> å’Œ <code>Dataloader</code> ä¸¤ä¸ªç±»æ¥åˆ›å»ºå’ŒåŠ è½½æ•°æ®é›†ã€‚è¿™ä¸€èŠ‚çš„é‡ç‚¹æ˜¯åœ¨ <code>Dataset</code> ç±»ä¸­ï¼Œä¸Šä¸€èŠ‚æåˆ°çš„ <code>CocoDataset</code>  ç±»å°±æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚åœ¨ä¸Šä¸€èŠ‚ï¼Œå¤„ç†äº†æ•°æ®é›†çš„ annotation è§„èŒƒé—®é¢˜ï¼Œè¿™ä¸€èŠ‚éœ€è¦ä½¿ç”¨ <code>Dataset</code> ç±»å»ºç«‹ä¸€ä¸ª piplines å¯¹æ•°æ®é›†è¿›è¡Œä¸€ç³»åˆ—å˜æ¢æ“ä½œ</p><h3 id="å˜æ¢æ“ä½œ"><a href="#å˜æ¢æ“ä½œ" class="headerlink" title="å˜æ¢æ“ä½œ"></a>å˜æ¢æ“ä½œ</h3><p>åœ¨ <code>mmdet/datasets/piplines</code> ä¸­æœ‰è®¸å¤šçš„æ–¹æ³•ï¼Œç”¨äºå¯¹æ•°æ®çš„å¤„ç†ã€‚å¦‚æœæƒ³è¦åˆ›å»ºè‡ªå·±çš„ç±»ï¼Œæ­¥éª¤ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼š</p><ol><li>åˆ›å»º <code>MyTransform</code> ç±»</li><li>å¯¼å…¥è¿™ä¸ªç±»</li><li>å°†è¯¥ç±»åŠ å…¥åˆ° config ä¸­ï¼Œæ–‡æ¡£ä¸­çš„ <a href="https://mmdetection.readthedocs.io/en/latest/tutorials/data_pipeline.html#extend-and-use-custom-pipelines">ç¤ºä¾‹ä»£ç </a></li></ol><p>ä¸‹é¢æ˜¯ Faster R-CNN config æ–‡ä»¶ä¸­ pipeline éƒ¨åˆ†çš„ä¸€ä¸ªä¾‹å­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">img_norm_cfg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span> to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>train_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span> with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span> <span class="token operator">**</span>img_norm_cfg<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span>test_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>        img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>        transforms<span class="token operator">=</span><span class="token punctuation">[</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span> <span class="token operator">**</span>img_norm_cfg<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Dataset-å®ç°å˜æ¢æ“ä½œ"><a href="#Dataset-å®ç°å˜æ¢æ“ä½œ" class="headerlink" title="Dataset å®ç°å˜æ¢æ“ä½œ"></a>Dataset å®ç°å˜æ¢æ“ä½œ</h3><p>ä»¥ <code>CocoDataset</code> ä¸ºä¾‹ï¼ŒæŸ¥çœ‹è¯¥ç±»çš„ä»£ç ï¼Œå¹¶æ²¡æœ‰å‘ç°åœ¨ <code>mmdet/datasets/coco.py</code> ä¸­æœ‰å®ç° pipelinesã€‚å®é™…ä¸Šï¼Œ<code>CocoDataset</code> è´Ÿè´£å®ç°çš„æ˜¯å¯¹ <code>annotation_file</code> çš„å¤„ç†ï¼Œè€Œå¯¹äº pipelines çš„å®ç°ï¼Œåœ¨å…¶ç»§æ‰¿çš„ <code>CustomDataset</code> ä¸­å®ç°çš„ï¼Œå…·ä½“å®ç°é€»è¾‘å¦‚ä¸‹ï¼š</p><ol><li>ä½¿ç”¨ <code>Compose</code> ç±»å°† config æ–‡ä»¶ä¸­çš„æ‰€æœ‰å˜æ¢æ“ä½œç±»å®ä¾‹åŒ–ï¼Œå¹¶å°†æ‰€æœ‰çš„ç±»å­˜å‚¨åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­</li><li>å¯¹éœ€è¦å¤„ç†çš„ data ä¾æ¬¡ä½¿ç”¨åˆ—è¡¨ä¸­çš„å˜åŒ–æ“ä½œï¼Œå…·ä½“å‚è€ƒä»£ç  <a href="https://github.com/open-mmlab/mmdetection/blob/master/mmdet/datasets/custom.py">CustomDataset</a> <a href="https://github.com/open-mmlab/mmdetection/blob/master/mmdet/datasets/pipelines/compose.py">Compose</a></li></ol><h2 id="Customize-Models"><a href="#Customize-Models" class="headerlink" title="Customize Models"></a>Customize Models</h2><p>åœ¨ mmdetection ä¸­æ˜¯é€šè¿‡ registry æ¥ç®¡ç†å„ç§æ¨¡å—çš„ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬æ¨¡å‹ä¸­çš„æ¨¡å—ã€‚è€Œå¦‚æœæƒ³è¦é€šè¿‡ registry æ·»åŠ æ¨¡å—çš„é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä»¥æ·»åŠ ä¸€ä¸ªæ–°çš„ backbone, <code>MobileNet</code> ä¸ºä¾‹</p><ol><li><p>å®šä¹‰ä¸€ä¸ªæ–°çš„ backbone, <code>mmdet/models/backbones/mobilenet.py</code></p></li><li><p>å¯¼å…¥è¿™ä¸ªæ¨¡å—ï¼Œæœ‰ä¸¤ç§æ–¹æ³•</p><ul><li><p>åœ¨ <code>__init__.py</code> ä¸­ import è¿™ä¸ªæ¨¡å—ï¼Œ<code>from .mobilenet import MobileNet</code></p></li><li><p>åœ¨ config ä¸­æ·»åŠ  <code>custom_imports</code> å­—å…¸</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">custom_imports <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    imports<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'mmdet.models.backbones.mobilenet'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    allow_failed_imports<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>åœ¨ config ä¸­ä½¿ç”¨è¿™ä¸ªæ¨¡å—</p></li></ol><p>åœ¨ <code>mmdet/tools/train.py</code> ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ <code>build_detector()</code> å°† config ä¸­æ¨¡å‹çš„å…·ä½“å‚æ•°å®ä¾‹åŒ– registry ä¸­çš„ç±»ã€‚ä¸‹é¢çœ‹ä¸€ä¸ªç®€åŒ–çš„ <code>build_detector()</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>cnn <span class="token keyword">import</span> MODELS <span class="token keyword">as</span> MMCV_MODELS<span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>utils <span class="token keyword">import</span> RegistryMODELS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'models'</span><span class="token punctuation">,</span> parent<span class="token operator">=</span>MMCV_MODELS<span class="token punctuation">)</span>DETECTORS <span class="token operator">=</span> MODELS<span class="token keyword">def</span> <span class="token function">build_detector</span><span class="token punctuation">(</span>cfg<span class="token punctuation">,</span> train_cfg<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> test_cfg<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Build detector."""</span><span class="token keyword">return</span> DETECTORS<span class="token punctuation">.</span>build<span class="token punctuation">(</span>        cfg<span class="token punctuation">,</span> default_args<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>train_cfg<span class="token operator">=</span>train_cfg<span class="token punctuation">,</span> test_cfg<span class="token operator">=</span>test_cfg<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Customize-Runtime-Settings"><a href="#Customize-Runtime-Settings" class="headerlink" title="Customize Runtime Settings"></a>Customize Runtime Settings</h2><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦è®²æ€ä¹ˆé…ç½® optimizer ä»¥åŠè®­ç»ƒæµç¨‹</p><h3 id="Customize-optimization-settings"><a href="#Customize-optimization-settings" class="headerlink" title="Customize optimization settings"></a>Customize optimization settings</h3><p>mmdetection é€‚é…äº†æ‰€æœ‰ pytorch ä¸­çš„ä¼˜åŒ–å™¨ï¼Œåªéœ€è¦ä¿®æ”¹ optimizer çš„ <code>type</code> å…³é”®å­—å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># use Adam optimizer</span>optimizer <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Adam'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.0003</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Optimizer çš„å®ç°ä¸æ˜¯åœ¨ mmdetection é¡¹ç›®ä¸­ï¼Œè€Œæ˜¯åœ¨ mmcv é¡¹ç›®ä¸­ï¼Œæ‰€ä»¥æƒ³è¦ä¸ªæ€§åŒ–çš„ optimizer åˆ™éœ€è¦è‡ªå·±æ–°å»ºæ–‡ä»¶å¤¹è¿›è¡Œå®ç°ã€‚ç°åœ¨æ–°å»º <code>mmdet/core/optimizer</code> æ–‡ä»¶å¤¹ï¼Œæ–°å»º <code>my_optimizer.py</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>runner<span class="token punctuation">.</span>optimizer <span class="token keyword">import</span> OPTIMIZERS<span class="token keyword">from</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">import</span> Optimizer<span class="token decorator annotation punctuation">@OPTIMIZERS<span class="token punctuation">.</span>register_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">MyOptimizer</span><span class="token punctuation">(</span>Optimizer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> ç„¶åä¿®æ”¹ config æ–‡ä»¶ï¼Œå¹¶ import è¯¥æ¨¡å—</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">optimizer <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MyOptimizer'</span><span class="token punctuation">,</span> a<span class="token operator">=</span>a_value<span class="token punctuation">,</span> b<span class="token operator">=</span>b_value<span class="token punctuation">,</span> c<span class="token operator">=</span>c_value<span class="token punctuation">)</span>custom_imports <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>imports<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'mmdet.core.optimizer.my_optimizer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                       allow_failed_imports<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæƒ³è¦å¯¹ optimizer æœ‰æ›´åŠ ç²¾ç»†åŒ–çš„æ“ä½œï¼Œéœ€è¦æ„å»ºæ–°çš„ OPTIMIZER_CONSTRUCTORSï¼Œæ„å»ºé€»è¾‘éƒ½æ˜¯å·®ä¸å¤šçš„ã€‚è¿™é‡Œå°±ä¸å±•å¼€äº†ï¼Œå› ä¸ºå¾ˆå¤šä¼˜åŒ–æ“ä½œå¹¶ä¸ç†Ÿæ‚‰ï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆç”¨ï¼Œç­‰æœ‰å…·ä½“çš„ä¾‹å­å†è¿›ä¸€æ­¥äº†è§£</p><h3 id="Customize-training-schedules"><a href="#Customize-training-schedules" class="headerlink" title="Customize training schedules"></a>Customize training schedules</h3><p>åœ¨è®­ç»ƒä¼˜åŒ–çš„è¿‡ç¨‹å½“ä¸­ï¼Œéœ€è¦å¯¹è®­ç»ƒè¿‡ç¨‹è¿›è¡Œä¸€äº›å¾®è°ƒï¼Œä¾‹å¦‚å¯¹ learning rate è¿›è¡Œè¡°å‡ï¼Œmmdetection ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ hook åšåˆ°ï¼Œæ‰€è°“çš„ Hook å°±æ˜¯åœ¨æ¯ä¸ª epoch or iteration ä¹‹å‰ã€ä¹‹åè¿›è¡Œçš„ä¸€äº›æ“ä½œã€‚å…·ä½“æ›´æ”¹ training schedule çš„æ“ä½œä¸ºï¼šåœ¨ config æ–‡ä»¶ä¸­é…ç½® <code>lr_config</code> ç­‰å­—æ®µã€‚ä¾‹å¦‚é»˜è®¤çš„é˜¶æ¢¯ç­–ç•¥ <code>StepLR</code> å¯ä»¥åœ¨æŒ‡å®šçš„ epoch è°ƒæ•´å­¦ä¹ ç‡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">lr_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Customize-workflow"><a href="#Customize-workflow" class="headerlink" title="Customize workflow"></a>Customize workflow</h3><p>è¿™éƒ¨åˆ†åŸºæœ¬ä¸Šå°±ä½¿ç”¨é»˜è®¤çš„ workflow å°±å¥½ï¼Œå³ <code>workflow = [('train',1)]</code> ï¼Œè¿™å°†ä¼šä¸€æ¬¡ä¸€æ¬¡åœ°å¾ªç¯è®­ç»ƒé›†ï¼Œç›´åˆ°è¾¾åˆ° <code>total_epochs/max_epochs</code> å¦‚æœæƒ³è¦è®­ç»ƒå¤šä¸ª epoch è¿‡åå¯¹æ¨¡å‹è¿›è¡Œ evaluation åˆ™æ˜¯è°ƒç”¨ <code>EvalHook</code>ï¼Œè€Œè¿™åœ¨ config æ–‡ä»¶ä¸­å¯¹åº”çš„æ˜¯ <code>evaluation</code> å­—æ®µ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">workflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># æ¯é—´éš”ä¸€æ¬¡è¿›è¡Œè¯„ä¼°</span>evaluation <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> metric<span class="token operator">=</span><span class="token string">'bbox'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Customize-hooks"><a href="#Customize-hooks" class="headerlink" title="Customize hooks"></a>Customize hooks</h3><p>åœ¨ä¹‹å‰å·²ç»æåˆ°äº† hooks çš„ä½œç”¨ï¼Œmmdetection ä¸­å·²ç»å®ç°äº†ä¸€äº› hooksï¼š</p><ul><li>og_config</li><li>checkpoint_config</li><li>evaluation</li><li>lr_config</li><li>optimizer_config</li><li>momentum_config</li></ul><p>è¿™äº› hooks èƒ½å¤Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å»æä¾›å¾®è°ƒã€è¯„ä¼°ã€è®°å½•ç­‰åŠŸèƒ½ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„2ä¸ª</p><ol><li><p>Checkpoint configï¼Œç”¨äºä¿å­˜è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ¨¡å‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">checkpoint_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>Log configï¼Œç”¨äºè®°å½•è®­ç»ƒè¿‡ç¨‹ä¸­çš„å…³é”®æ•°æ®ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ª logger</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">log_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    interval<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>    hooks<span class="token operator">=</span><span class="token punctuation">[</span>        <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'TensorboardLoggerHook'</span><span class="token punctuation">)</span>    <span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p>å¦‚æœæƒ³è¦ä½¿ç”¨ä¸ªæ€§åŒ–çš„ hookï¼Œå‡†å¤‡è¿‡ç¨‹ä¹Ÿæ˜¯è€3æ­¥äº†</p><ol><li><p>å®šä¹‰æ–°çš„ hook</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>runner <span class="token keyword">import</span> HOOKS<span class="token punctuation">,</span> Hook<span class="token decorator annotation punctuation">@HOOKS<span class="token punctuation">.</span>register_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">MyHook</span><span class="token punctuation">(</span>Hook<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">before_run</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> runner<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">after_run</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> runner<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">before_epoch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> runner<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">after_epoch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> runner<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">before_iter</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> runner<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">after_iter</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> runner<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯¼å…¥æ–°çš„ hook</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">custom_imports <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>imports<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'mmdet.core.utils.my_hook'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> allow_failed_imports<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ä½¿ç”¨æ–°çš„ hook</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">custom_hooks <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MyHook'</span><span class="token punctuation">,</span> a<span class="token operator">=</span>a_value<span class="token punctuation">,</span> b<span class="token operator">=</span>b_value<span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ol><p>å¯¹äº hook çš„è°ƒç”¨ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥äº†è§£ <code>Runner</code> ç±»ã€‚mmdetection æ˜¯å°†è¿™äº› hook config ä¼ å…¥åˆ°äº† <code>runner</code> å®ä¾‹ä¸­ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»º hook å®ä¾‹ã€‚æ›´å¤šæœ‰å…³ <code>Runner</code> çš„å†…å®¹éœ€è¦åœ¨ <a href="https://mmcv.readthedocs.io/en/latest/understand_mmcv/runner.html#">mmcv</a> é‡Œå»æŸ¥çœ‹</p><h2 id="Customize-Losses"><a href="#Customize-Losses" class="headerlink" title="Customize Losses"></a>Customize Losses</h2><p>mmdetction ä¸­æŸå¤±å‡½æ•°æ˜¯ç›´æ¥åœ¨æ¨¡å‹ä¸­å„ä¸ª prediction head ä¸­ä½¿ç”¨ï¼Œè€Œä¸æ˜¯åœ¨ forward pass ä¹‹åå•ç‹¬ä½¿ç”¨ï¼Œæ‰€ä»¥å…¶å…³é”®å­—æ˜¯ä»€ä¹ˆï¼Œå–å†³äºæ¨¡å‹ä¹‹ä¸­å„ä¸ª prediction head æ€ä¹ˆæ¥æ”¶æŸå¤±å‡½æ•°ã€‚ä»¥ <code>loss_cls</code> å­—æ®µä¸ºä¾‹ä½¿ç”¨ <code>FocalLoss</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">loss_cls<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FocalLoss'</span><span class="token punctuation">,</span>    use_sigmoid<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    gamma<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">,</span>    alpha<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>    loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Finetuning-Models"><a href="#Finetuning-Models" class="headerlink" title="Finetuning Models"></a>Finetuning Models</h2><p>å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹å‚æ•°å·²ç»æœ‰è¾ƒå¥½çš„ç‰¹å¾æå–èƒ½åŠ›ï¼Œæ‰€ä»¥å°†è¿™äº›å‚æ•°ç”¨äºæ–°çš„æ•°æ®é›†åªéœ€è¦ä¸€äº›å¾®è°ƒã€‚é™¤äº†è¦å‡†å¤‡å¥½è‡ªå·±æ•°æ®é›†å’Œ config ä¹‹å¤–ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯è°ƒæ•´ training scheduleã€‚ç”±äºæ˜¯ä»…å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œæ‰€ä»¥å­¦ä¹ ç‡åº”è¯¥è®¾ç½®å¾—ç›¸å¯¹å°ä¸€äº›ï¼Œå¹¶ä¸” epoch ä¹Ÿåº”å½“å°‘ä¸€äº›ä»¥é¿å…è¿‡æ‹Ÿåˆã€‚æ–‡æ¡£ç»™å‡ºäº†ä¸€ä¸ªå‚è€ƒçš„ä¾‹å­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># optimizer</span><span class="token comment"># lr is set for a batch size of 8</span>optimizer <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>optimizer_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>grad_clip<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token comment"># learning policy</span>lr_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>    warmup_ratio<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># the max_epochs and step in lr_config need specifically tuned for the customized dataset</span>runner <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>max_epochs<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>log_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>interval<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token comment"># We can use the pre-trained Mask RCNN model to obtain higher performance</span>load_from <span class="token operator">=</span> <span class="token string">'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¯ä»¥æŠŠ mmdetection çš„ä½¿ç”¨åˆ†ä¸ºä¸¤ä¸ªå¤§å—æ¥è¿›è¡Œç†è§£ï¼š</p><ol><li>æ¨¡å‹çš„å»ºç«‹</li><li>æ¨¡å‹çš„è®­ç»ƒ</li></ol><p>é¦–å…ˆæ˜¯æ¨¡å‹çš„å»ºç«‹ï¼Œå…¶æ ¸å¿ƒä¸º config &amp; registryï¼Œè¦ç†è§£è¿™ä¸¤ä¸ªç±»çš„ä½œç”¨ã€‚é€šè¿‡ config å°†æ¨¡å‹çš„æ‰€æœ‰æ„é€ ç»†èŠ‚éƒ½ä»¥å­—å…¸çš„å½¢å¼åŒ…å«è¿›æ¥äº†ï¼Œå°†è¿™äº› config ä¼ å…¥åˆ° registry ä¸­æ³¨å†Œå¥½çš„æ¨¡å‹ç±»ä¸­ä»è€Œå®ç°æ¨¡å‹çš„å®ä¾‹åŒ–ã€‚ä»ä¸­å¯ä»¥çœ‹åˆ°æ³¨å†Œå’Œä½¿ç”¨ä»»ä½•æ–°æ¨¡å—çš„ä¸‰ä¸ªä¸»è¦æ­¥éª¤ï¼šå®šä¹‰æ¨¡å‹ã€å¯¼å…¥æ¨¡å‹ã€ä¿®æ”¹ config æ–‡ä»¶</p><p>æ¥ç€æ˜¯æ¨¡å‹çš„è®­ç»ƒï¼Œéƒ¨åˆ†çš„æ ¸å¿ƒä¸º optimizer &amp; runnerã€‚å…¶ä¸­ runner åŒ…å«äº†ä¸åŒçš„ hook ä»¥åœ¨æ¯ä¸€ä¸ª epoch/iter ä¹‹å‰/ä¹‹åè¿›è¡Œéœ€è¦çš„æ“ä½œï¼Œä¾‹å¦‚ï¼šè°ƒæ•´å­¦ä¹ ç‡ã€ä¿å­˜æ¨¡å‹ã€è®°å½•æ•°æ®ç­‰ç­‰ã€‚å½“ç„¶è¿™äº›åŠŸèƒ½ä¹Ÿæ˜¯é€šè¿‡ config &amp; registry æ¥è¿›è¡Œç®¡ç†çš„</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ config æ–‡ä»¶åŠå…¶ç®€è¦æ³¨é‡Šè¯´æ˜ï¼Œä¸º ResNet50 å’Œ FPN çš„ Mask R-CNN çš„é…ç½®æ–‡ä»¶ã€‚é…åˆä¹‹å‰çš„ tutorialï¼Œå¯ä»¥å…·ä½“çœ‹çœ‹æ¯ä¸ªå­—æ®µåœ¨ config æ–‡ä»¶ä¸­çš„ä»€ä¹ˆä½ç½®ã€æœ‰ä»€ä¹ˆåŠŸèƒ½ï¼Œå¸®åŠ©æ•´ä½“æŠŠæ¡ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ mmdetection github é¡¹ç›®ä¸Šè¿›è¡Œæœç´¢ï¼ŒæŸ¥æ‰¾æºç ä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaskRCNN'</span><span class="token punctuation">,</span>  <span class="token comment"># æ£€æµ‹å™¨(detector)åç§°</span>    backbone<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ä¸»å¹²ç½‘ç»œçš„é…ç½®æ–‡ä»¶</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ResNet'</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸»å¹²ç½‘ç»œçš„ç±»åˆ«ï¼Œå¯ç”¨é€‰é¡¹è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/backbones/resnet.py#L308</span>        depth<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸»å¹²ç½‘ç»œçš„æ·±åº¦ï¼Œå¯¹äº ResNet å’Œ ResNext é€šå¸¸è®¾ç½®ä¸º 50 æˆ– 101ã€‚</span>        num_stages<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸»å¹²ç½‘ç»œçŠ¶æ€(stages)çš„æ•°ç›®ï¼Œè¿™äº›çŠ¶æ€äº§ç”Ÿçš„ç‰¹å¾å›¾ä½œä¸ºåç»­çš„ head çš„è¾“å…¥ã€‚</span>        out_indices<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ¯ä¸ªçŠ¶æ€äº§ç”Ÿçš„ç‰¹å¾å›¾è¾“å‡ºçš„ç´¢å¼•ã€‚</span>        frozen_stages<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># ç¬¬ä¸€ä¸ªçŠ¶æ€çš„æƒé‡è¢«å†»ç»“</span>        norm_cfg<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># å½’ä¸€åŒ–å±‚(norm layer)çš„é…ç½®é¡¹ã€‚</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'BN'</span><span class="token punctuation">,</span>  <span class="token comment"># å½’ä¸€åŒ–å±‚çš„ç±»åˆ«ï¼Œé€šå¸¸æ˜¯ BN æˆ– GNã€‚</span>            requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦è®­ç»ƒå½’ä¸€åŒ–é‡Œçš„ gamma å’Œ betaã€‚</span>        norm_eval<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦å†»ç»“ BN é‡Œçš„ç»Ÿè®¡é¡¹ã€‚</span>        style<span class="token operator">=</span><span class="token string">'pytorch'</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸»å¹²ç½‘ç»œçš„é£æ ¼ï¼Œ'pytorch' æ„æ€æ˜¯æ­¥é•¿ä¸º2çš„å±‚ä¸º 3x3 å·ç§¯ï¼Œ 'caffe' æ„æ€æ˜¯æ­¥é•¿ä¸º2çš„å±‚ä¸º 1x1 å·ç§¯ã€‚</span>       init_cfg<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pretrained'</span><span class="token punctuation">,</span> checkpoint<span class="token operator">=</span><span class="token string">'torchvision://resnet50'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># åŠ è½½é€šè¿‡ ImageNet ä¸è®­ç»ƒçš„æ¨¡å‹</span>    neck<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FPN'</span><span class="token punctuation">,</span>  <span class="token comment"># æ£€æµ‹å™¨çš„ neck æ˜¯ FPNï¼Œæˆ‘ä»¬åŒæ ·æ”¯æŒ 'NASFPN', 'PAFPN' ç­‰ï¼Œæ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/necks/fpn.py#L10ã€‚</span>        in_channels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># è¾“å…¥é€šé“æ•°ï¼Œè¿™ä¸ä¸»å¹²ç½‘ç»œçš„è¾“å‡ºé€šé“ä¸€è‡´</span>        out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># é‡‘å­—å¡”ç‰¹å¾å›¾æ¯ä¸€å±‚çš„è¾“å‡ºé€šé“</span>        num_outs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># è¾“å‡ºçš„èŒƒå›´(scales)</span>    rpn_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RPNHead'</span><span class="token punctuation">,</span>  <span class="token comment"># RPN_head çš„ç±»å‹æ˜¯ 'RPNHead', æˆ‘ä»¬ä¹Ÿæ”¯æŒ 'GARPNHead' ç­‰ï¼Œæ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/dense_heads/rpn_head.py#L12ã€‚</span>        in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># æ¯ä¸ªè¾“å…¥ç‰¹å¾å›¾çš„è¾“å…¥é€šé“ï¼Œè¿™ä¸ neck çš„è¾“å‡ºé€šé“ä¸€è‡´ã€‚</span>        feat_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># head å·ç§¯å±‚çš„ç‰¹å¾é€šé“ã€‚</span>        anchor_generator<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># é”šç‚¹(Anchor)ç”Ÿæˆå™¨çš„é…ç½®ã€‚</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'AnchorGenerator'</span><span class="token punctuation">,</span>  <span class="token comment"># å¤§å¤šæ˜¯æ–¹æ³•ä½¿ç”¨ AnchorGenerator ä½œä¸ºé”šç‚¹ç”Ÿæˆå™¨, SSD æ£€æµ‹å™¨ä½¿ç”¨ `SSDAnchorGenerator`ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/anchor/anchor_generator.py#L10ã€‚</span>            scales<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># é”šç‚¹çš„åŸºæœ¬æ¯”ä¾‹ï¼Œç‰¹å¾å›¾æŸä¸€ä½ç½®çš„é”šç‚¹é¢ç§¯ä¸º scale * base_sizes</span>            ratios<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># é«˜åº¦å’Œå®½åº¦ä¹‹é—´çš„æ¯”ç‡ã€‚</span>            strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># é”šç”Ÿæˆå™¨çš„æ­¥å¹…ã€‚è¿™ä¸ FPN ç‰¹å¾æ­¥å¹…ä¸€è‡´ã€‚ å¦‚æœæœªè®¾ç½® base_sizesï¼Œåˆ™å½“å‰æ­¥å¹…å€¼å°†è¢«è§†ä¸º base_sizesã€‚</span>        bbox_coder<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># åœ¨è®­ç»ƒå’Œæµ‹è¯•æœŸé—´å¯¹æ¡†è¿›è¡Œç¼–ç å’Œè§£ç ã€‚</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>  <span class="token comment"># æ¡†ç¼–ç å™¨çš„ç±»åˆ«ï¼Œ'DeltaXYWHBBoxCoder' æ˜¯æœ€å¸¸ç”¨çš„ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/bbox/coder/delta_xywh_bbox_coder.py#L9ã€‚</span>            target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># ç”¨äºç¼–ç å’Œè§£ç æ¡†çš„ç›®æ ‡å‡å€¼</span>            target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç”¨äºç¼–ç å’Œè§£ç æ¡†çš„æ ‡å‡†æ–¹å·®</span>        loss_cls<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># åˆ†ç±»åˆ†æ”¯çš„æŸå¤±å‡½æ•°é…ç½®</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†ç±»åˆ†æ”¯çš„æŸå¤±ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿæ”¯æŒ FocalLoss ç­‰ã€‚</span>            use_sigmoid<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># RPNé€šå¸¸è¿›è¡ŒäºŒåˆ†ç±»ï¼Œæ‰€ä»¥é€šå¸¸ä½¿ç”¨sigmoidå‡½æ•°ã€‚</span>            los_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†ç±»åˆ†æ”¯çš„æŸå¤±æƒé‡ã€‚</span>        loss_bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># å›å½’åˆ†æ”¯çš„æŸå¤±å‡½æ•°é…ç½®ã€‚</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span>  <span class="token comment"># æŸå¤±ç±»å‹ï¼Œæˆ‘ä»¬è¿˜æ”¯æŒè®¸å¤š IoU Losses å’Œ Smooth L1-loss ç­‰ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/losses/smooth_l1_loss.py#L56ã€‚</span>            loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å›å½’åˆ†æ”¯çš„æŸå¤±æƒé‡ã€‚</span>    roi_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># RoIHead å°è£…äº†ä¸¤æ­¥(two-stage)/çº§è”(cascade)æ£€æµ‹å™¨çš„ç¬¬äºŒæ­¥ã€‚</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'StandardRoIHead'</span><span class="token punctuation">,</span>  <span class="token comment"># RoI head çš„ç±»å‹ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/roi_heads/standard_roi_head.py#L10ã€‚</span>        bbox_roi_extractor<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç”¨äº bbox å›å½’çš„ RoI ç‰¹å¾æå–å™¨ã€‚</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>  <span class="token comment"># RoI ç‰¹å¾æå–å™¨çš„ç±»å‹ï¼Œå¤§å¤šæ•°æ–¹æ³•ä½¿ç”¨  SingleRoIExtractorï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/roi_heads/roi_extractors/single_level.py#L10ã€‚</span>            roi_layer<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># RoI å±‚çš„é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span>  <span class="token comment"># RoI å±‚çš„ç±»åˆ«, ä¹Ÿæ”¯æŒ DeformRoIPoolingPack å’Œ ModulatedDeformRoIPoolingPackï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/ops/roi_align/roi_align.py#L79ã€‚</span>                output_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>  <span class="token comment"># ç‰¹å¾å›¾çš„è¾“å‡ºå¤§å°ã€‚</span>                sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æå– RoI ç‰¹å¾æ—¶çš„é‡‡æ ·ç‡ã€‚0 è¡¨ç¤ºè‡ªé€‚åº”æ¯”ç‡ã€‚</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># æå–ç‰¹å¾çš„è¾“å‡ºé€šé“ã€‚</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å¤šå°ºåº¦ç‰¹å¾å›¾çš„æ­¥å¹…ï¼Œåº”è¯¥ä¸ä¸»å¹²çš„æ¶æ„ä¿æŒä¸€è‡´ã€‚</span>        bbox_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># RoIHead ä¸­ box head çš„é…ç½®.</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Shared2FCBBoxHead'</span><span class="token punctuation">,</span>  <span class="token comment"># bbox head çš„ç±»åˆ«ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/roi_heads/bbox_heads/convfc_bbox_head.py#L177ã€‚</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># bbox head çš„è¾“å…¥é€šé“ã€‚ è¿™ä¸ roi_extractor ä¸­çš„ out_channels ä¸€è‡´ã€‚</span>            fc_out_channels<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span>  <span class="token comment"># FC å±‚çš„è¾“å‡ºç‰¹å¾é€šé“ã€‚</span>            roi_feat_size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>  <span class="token comment"># å€™é€‰åŒºåŸŸ(Region of Interest)ç‰¹å¾çš„å¤§å°ã€‚</span>            num_classes<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†ç±»çš„ç±»åˆ«æ•°é‡ã€‚</span>            bbox_coder<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç¬¬äºŒé˜¶æ®µä½¿ç”¨çš„æ¡†ç¼–ç å™¨ã€‚</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DeltaXYWHBBoxCoder'</span><span class="token punctuation">,</span>  <span class="token comment"># æ¡†ç¼–ç å™¨çš„ç±»åˆ«ï¼Œå¤§å¤šæ•°æƒ…å†µä½¿ç”¨ 'DeltaXYWHBBoxCoder'ã€‚</span>                target_means<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># ç”¨äºç¼–ç å’Œè§£ç æ¡†çš„å‡å€¼</span>                target_stds<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç¼–ç å’Œè§£ç çš„æ ‡å‡†æ–¹å·®ã€‚å› ä¸ºæ¡†æ›´å‡†ç¡®ï¼Œæ‰€ä»¥å€¼æ›´å°ï¼Œå¸¸è§„è®¾ç½®æ—¶ [0.1, 0.1, 0.2, 0.2]ã€‚</span>            reg_class_agnostic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># å›å½’æ˜¯å¦ä¸ç±»åˆ«æ— å…³ã€‚</span>            loss_cls<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># åˆ†ç±»åˆ†æ”¯çš„æŸå¤±å‡½æ•°é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†ç±»åˆ†æ”¯çš„æŸå¤±ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿæ”¯æŒ FocalLoss ç­‰ã€‚</span>                use_sigmoid<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦ä½¿ç”¨ sigmoidã€‚</span>                loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†ç±»åˆ†æ”¯çš„æŸå¤±æƒé‡ã€‚</span>            loss_bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># å›å½’åˆ†æ”¯çš„æŸå¤±å‡½æ•°é…ç½®ã€‚</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span>  <span class="token comment"># æŸå¤±ç±»å‹ï¼Œæˆ‘ä»¬è¿˜æ”¯æŒè®¸å¤š IoU Losses å’Œ Smooth L1-loss ç­‰ã€‚</span>                loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å›å½’åˆ†æ”¯çš„æŸå¤±æƒé‡ã€‚</span>        mask_roi_extractor<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç”¨äº mask ç”Ÿæˆçš„ RoI ç‰¹å¾æå–å™¨ã€‚</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SingleRoIExtractor'</span><span class="token punctuation">,</span>  <span class="token comment"># RoI ç‰¹å¾æå–å™¨çš„ç±»å‹ï¼Œå¤§å¤šæ•°æ–¹æ³•ä½¿ç”¨ SingleRoIExtractorã€‚</span>            roi_layer<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># æå–å®ä¾‹åˆ†å‰²ç‰¹å¾çš„ RoI å±‚é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RoIAlign'</span><span class="token punctuation">,</span>  <span class="token comment"># RoI å±‚çš„ç±»å‹ï¼Œä¹Ÿæ”¯æŒ DeformRoIPoolingPack å’Œ ModulatedDeformRoIPoolingPackã€‚</span>                output_size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span>  <span class="token comment"># ç‰¹å¾å›¾çš„è¾“å‡ºå¤§å°ã€‚</span>                sampling_ratio<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æå– RoI ç‰¹å¾æ—¶çš„é‡‡æ ·ç‡ã€‚</span>            out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># æå–ç‰¹å¾çš„è¾“å‡ºé€šé“ã€‚</span>            featmap_strides<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å¤šå°ºåº¦ç‰¹å¾å›¾çš„æ­¥å¹…ã€‚</span>        mask_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># mask é¢„æµ‹ head æ¨¡å‹</span>            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>  <span class="token comment"># mask head çš„ç±»å‹ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/roi_heads/mask_heads/fcn_mask_head.py#L21ã€‚</span>            num_convs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>  <span class="token comment"># mask head ä¸­çš„å·ç§¯å±‚æ•°</span>            in_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># è¾“å…¥é€šé“ï¼Œåº”ä¸ mask roi extractor çš„è¾“å‡ºé€šé“ä¸€è‡´ã€‚</span>            conv_out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># å·ç§¯å±‚çš„è¾“å‡ºé€šé“ã€‚</span>            num_classes<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>  <span class="token comment"># è¦åˆ†å‰²çš„ç±»åˆ«æ•°ã€‚</span>            loss_mask<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># mask åˆ†æ”¯çš„æŸå¤±å‡½æ•°é…ç½®ã€‚</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span>  <span class="token comment"># ç”¨äºåˆ†å‰²çš„æŸå¤±ç±»å‹ã€‚</span>                use_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦åªåœ¨æ­£ç¡®çš„ç±»ä¸­è®­ç»ƒ maskã€‚</span>                loss_weight<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># mask åˆ†æ”¯çš„æŸå¤±æƒé‡.</span>    train_cfg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># rpn å’Œ rcnn è®­ç»ƒè¶…å‚æ•°çš„é…ç½®</span>        rpn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># rpn çš„è®­ç»ƒé…ç½®</span>            assigner<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># åˆ†é…å™¨(assigner)çš„é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†é…å™¨çš„ç±»å‹ï¼ŒMaxIoUAssigner ç”¨äºè®¸å¤šå¸¸è§çš„æ£€æµ‹å™¨ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/bbox/assigners/max_iou_assigner.py#L10ã€‚</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>  <span class="token comment"># IoU &gt;= 0.7(é˜ˆå€¼) è¢«è§†ä¸ºæ­£æ ·æœ¬ã€‚</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>  <span class="token comment"># IoU &lt; 0.3(é˜ˆå€¼) è¢«è§†ä¸ºè´Ÿæ ·æœ¬ã€‚</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>  <span class="token comment"># å°†æ¡†ä½œä¸ºæ­£æ ·æœ¬çš„æœ€å° IoU é˜ˆå€¼ã€‚</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦åŒ¹é…ä½è´¨é‡çš„æ¡†(æ›´å¤šç»†èŠ‚è§ API æ–‡æ¡£).</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å¿½ç•¥ bbox çš„ IoF é˜ˆå€¼ã€‚</span>            sampler<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># æ­£/è´Ÿé‡‡æ ·å™¨(sampler)çš„é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>  <span class="token comment"># é‡‡æ ·å™¨ç±»å‹ï¼Œè¿˜æ”¯æŒ PseudoSampler å’Œå…¶ä»–é‡‡æ ·å™¨ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/bbox/samplers/random_sampler.py#L8ã€‚</span>                num<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>  <span class="token comment"># æ ·æœ¬æ•°é‡ã€‚</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># æ­£æ ·æœ¬å æ€»æ ·æœ¬çš„æ¯”ä¾‹ã€‚</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># åŸºäºæ­£æ ·æœ¬æ•°é‡çš„è´Ÿæ ·æœ¬ä¸Šé™ã€‚</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># é‡‡æ ·åæ˜¯å¦æ·»åŠ  GT ä½œä¸º proposalã€‚</span>            allowed_border<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># å¡«å……æœ‰æ•ˆé”šç‚¹åå…è®¸çš„è¾¹æ¡†ã€‚</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># è®­ç»ƒæœŸé—´æ­£æ ·æœ¬çš„æƒé‡ã€‚</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦è®¾ç½®è°ƒè¯•(debug)æ¨¡å¼</span>        rpn_proposal<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># åœ¨è®­ç»ƒæœŸé—´ç”Ÿæˆ proposals çš„é…ç½®</span>            nms_across_levels<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦å¯¹è·¨å±‚çš„ box åš NMSã€‚ä»…é€‚ç”¨äº `GARPNHead` ï¼Œnaive rpn ä¸æ”¯æŒ nms cross levelsã€‚</span>            nms_pre<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>  <span class="token comment"># NMS å‰çš„ box æ•°</span>            nms_post<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>  <span class="token comment"># NMS è¦ä¿ç•™çš„ box çš„æ•°é‡ï¼Œåªåœ¨ GARPNHHead ä¸­èµ·ä½œç”¨ã€‚</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>  <span class="token comment"># NMS åè¦ä¿ç•™çš„ box æ•°é‡ã€‚</span>            nms<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span> <span class="token comment"># NMS çš„é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span>  <span class="token comment"># NMS çš„ç±»åˆ«</span>                iou_threshold<span class="token operator">=</span><span class="token number">0.7</span> <span class="token comment"># NMS çš„é˜ˆå€¼</span>                <span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å…è®¸çš„æœ€å° box å°ºå¯¸</span>        rcnn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># roi head çš„é…ç½®ã€‚</span>            assigner<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç¬¬äºŒé˜¶æ®µåˆ†é…å™¨çš„é…ç½®ï¼Œè¿™ä¸ rpn ä¸­çš„ä¸åŒ</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaxIoUAssigner'</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†é…å™¨çš„ç±»å‹ï¼ŒMaxIoUAssigner ç›®å‰ç”¨äºæ‰€æœ‰ roi_headsã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/bbox/assigners/max_iou_assigner.py#L10ã€‚</span>                pos_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># IoU &gt;= 0.5(é˜ˆå€¼)è¢«è®¤ä¸ºæ˜¯æ­£æ ·æœ¬ã€‚</span>                neg_iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># IoU &lt; 0.5(é˜ˆå€¼)è¢«è®¤ä¸ºæ˜¯è´Ÿæ ·æœ¬ã€‚</span>                min_pos_iou<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># å°† box ä½œä¸ºæ­£æ ·æœ¬çš„æœ€å° IoU é˜ˆå€¼</span>                match_low_quality<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦åŒ¹é…ä½è´¨é‡ä¸‹çš„ box(æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… API æ–‡æ¡£)ã€‚</span>                ignore_iof_thr<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å¿½ç•¥ bbox çš„ IoF é˜ˆå€¼</span>            sampler<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomSampler'</span><span class="token punctuation">,</span>  <span class="token comment">#é‡‡æ ·å™¨çš„ç±»å‹ï¼Œè¿˜æ”¯æŒ PseudoSampler å’Œå…¶ä»–é‡‡æ ·å™¨ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/bbox/samplers/random_sampler.py#L8ã€‚</span>                num<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>  <span class="token comment"># æ ·æœ¬æ•°é‡</span>                pos_fraction<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>  <span class="token comment"># æ­£æ ·æœ¬å æ€»æ ·æœ¬çš„æ¯”ä¾‹ã€‚.</span>                neg_pos_ub<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># åŸºäºæ­£æ ·æœ¬æ•°é‡çš„è´Ÿæ ·æœ¬ä¸Šé™ã€‚.</span>                add_gt_as_proposals<span class="token operator">=</span><span class="token boolean">True</span>            <span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># é‡‡æ ·åæ˜¯å¦æ·»åŠ  GT ä½œä¸º proposalã€‚</span>            mask_size<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span>  <span class="token comment"># mask çš„å¤§å°</span>            pos_weight<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># è®­ç»ƒæœŸé—´æ­£æ ·æœ¬çš„æƒé‡ã€‚</span>            debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ˜¯å¦è®¾ç½®è°ƒè¯•æ¨¡å¼ã€‚</span>    test_cfg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç”¨äºæµ‹è¯• rnn å’Œ rnn è¶…å‚æ•°çš„é…ç½®</span>        rpn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># æµ‹è¯•é˜¶æ®µç”Ÿæˆ proposals çš„é…ç½®</span>            nms_across_levels<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦å¯¹è·¨å±‚çš„ box åš NMSã€‚ä»…é€‚ç”¨äº`GARPNHead`ï¼Œnaive rpn ä¸æ”¯æŒåš NMS cross levelsã€‚</span>            nms_pre<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>  <span class="token comment"># NMS å‰çš„ box æ•°</span>            nms_post<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>  <span class="token comment"># NMS è¦ä¿ç•™çš„ box çš„æ•°é‡ï¼Œåªåœ¨`GARPNHHead`ä¸­èµ·ä½œç”¨ã€‚</span>            max_per_img<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>  <span class="token comment"># NMS åè¦ä¿ç•™çš„ box æ•°é‡</span>            nms<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span> <span class="token comment"># NMS çš„é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span>  <span class="token comment"># NMS çš„ç±»å‹</span>                iou_threshold<span class="token operator">=</span><span class="token number">0.7</span> <span class="token comment"># NMS é˜ˆå€¼</span>                <span class="token punctuation">)</span><span class="token punctuation">,</span>            min_bbox_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># box å…è®¸çš„æœ€å°å°ºå¯¸</span>        rcnn<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># roi heads çš„é…ç½®</span>            score_thr<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span>  <span class="token comment"># bbox çš„åˆ†æ•°é˜ˆå€¼</span>            nms<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç¬¬äºŒæ­¥çš„ NMS é…ç½®</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'nms'</span><span class="token punctuation">,</span>  <span class="token comment"># NMS çš„ç±»å‹</span>                iou_thr<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># NMS çš„é˜ˆå€¼</span>            max_per_img<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># æ¯å¼ å›¾åƒçš„æœ€å¤§æ£€æµ‹æ¬¡æ•°</span>            mask_thr_binary<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># mask é¢„å¤„çš„é˜ˆå€¼</span>dataset_type <span class="token operator">=</span> <span class="token string">'CocoDataset'</span>  <span class="token comment"># æ•°æ®é›†ç±»å‹ï¼Œè¿™å°†è¢«ç”¨æ¥å®šä¹‰æ•°æ®é›†ã€‚</span>data_root <span class="token operator">=</span> <span class="token string">'data/coco/'</span>  <span class="token comment"># æ•°æ®çš„æ ¹è·¯å¾„ã€‚</span>img_norm_cfg <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment">#å›¾åƒå½’ä¸€åŒ–é…ç½®ï¼Œç”¨æ¥å½’ä¸€åŒ–è¾“å…¥çš„å›¾åƒã€‚</span>    mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># é¢„è®­ç»ƒé‡Œç”¨äºé¢„è®­ç»ƒä¸»å¹²ç½‘ç»œæ¨¡å‹çš„å¹³å‡å€¼ã€‚</span>    std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># é¢„è®­ç»ƒé‡Œç”¨äºé¢„è®­ç»ƒä¸»å¹²ç½‘ç»œæ¨¡å‹çš„æ ‡å‡†å·®ã€‚</span>    to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment">#  é¢„è®­ç»ƒé‡Œç”¨äºé¢„è®­ç»ƒä¸»å¹²ç½‘ç»œçš„å›¾åƒçš„é€šé“é¡ºåºã€‚</span>train_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token comment"># è®­ç»ƒæµç¨‹</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç¬¬ 1 ä¸ªæµç¨‹ï¼Œä»æ–‡ä»¶è·¯å¾„é‡ŒåŠ è½½å›¾åƒã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>  <span class="token comment"># ç¬¬ 2 ä¸ªæµç¨‹ï¼Œå¯¹äºå½“å‰å›¾åƒï¼ŒåŠ è½½å®ƒçš„æ³¨é‡Šä¿¡æ¯ã€‚</span>        with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦ä½¿ç”¨æ ‡æ³¨æ¡†(bounding box)ï¼Œ ç›®æ ‡æ£€æµ‹éœ€è¦è®¾ç½®ä¸º Trueã€‚</span>        with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦ä½¿ç”¨ instance maskï¼Œå®ä¾‹åˆ†å‰²éœ€è¦è®¾ç½®ä¸º Trueã€‚</span>        poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦å°† polygon mask è½¬åŒ–ä¸º instance mask, è®¾ç½®ä¸º False ä»¥åŠ é€Ÿå’ŒèŠ‚çœå†…å­˜ã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>  <span class="token comment"># å˜åŒ–å›¾åƒå’Œå…¶æ³¨é‡Šå¤§å°çš„æ•°æ®å¢å¹¿çš„æµç¨‹ã€‚</span>        img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å›¾åƒçš„æœ€å¤§è§„æ¨¡ã€‚</span>        keep_ratio<span class="token operator">=</span><span class="token boolean">True</span>    <span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦ä¿æŒå›¾åƒçš„é•¿å®½æ¯”ã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span>  <span class="token comment">#  ç¿»è½¬å›¾åƒå’Œå…¶æ³¨é‡Šå¤§å°çš„æ•°æ®å¢å¹¿çš„æµç¨‹ã€‚</span>        flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç¿»è½¬å›¾åƒçš„æ¦‚ç‡ã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>  <span class="token comment"># å½’ä¸€åŒ–å½“å‰å›¾åƒçš„æ•°æ®å¢å¹¿çš„æµç¨‹ã€‚</span>        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># è¿™äº›é”®ä¸ img_norm_cfg ä¸€è‡´ï¼Œå› ä¸º img_norm_cfg è¢«</span>        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     <span class="token comment"># ç”¨ä½œå‚æ•°ã€‚</span>        to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span>  <span class="token comment"># å¡«å……å½“å‰å›¾åƒåˆ°æŒ‡å®šå¤§å°çš„æ•°æ®å¢å¹¿çš„æµç¨‹ã€‚</span>        size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å¡«å……å›¾åƒå¯ä»¥è¢«å½“å‰å€¼æ•´é™¤ã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æµç¨‹é‡Œæ”¶é›†æ•°æ®çš„é»˜è®¤æ ¼å¼æ†ã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>  <span class="token comment"># å†³å®šæ•°æ®ä¸­å“ªäº›é”®åº”è¯¥ä¼ é€’ç»™æ£€æµ‹å™¨çš„æµç¨‹</span>        keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>test_pipeline <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç¬¬ 1 ä¸ªæµç¨‹ï¼Œä»æ–‡ä»¶è·¯å¾„é‡ŒåŠ è½½å›¾åƒã€‚</span>    <span class="token builtin">dict</span><span class="token punctuation">(</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>  <span class="token comment"># å°è£…æµ‹è¯•æ—¶æ•°æ®å¢å¹¿(test time augmentations)ã€‚</span>        img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å†³å®šæµ‹è¯•æ—¶å¯æ”¹å˜å›¾åƒçš„æœ€å¤§è§„æ¨¡ã€‚ç”¨äºæ”¹å˜å›¾åƒå¤§å°çš„æµç¨‹ã€‚</span>        flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># æµ‹è¯•æ—¶æ˜¯å¦ç¿»è½¬å›¾åƒã€‚</span>        transforms<span class="token operator">=</span><span class="token punctuation">[</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨æ”¹å˜å›¾åƒå¤§å°çš„æ•°æ®å¢å¹¿ã€‚</span>                 keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ˜¯å¦ä¿æŒå®½å’Œé«˜çš„æ¯”ä¾‹ï¼Œè¿™é‡Œçš„å›¾åƒæ¯”ä¾‹è®¾ç½®å°†è¦†ç›–ä¸Šé¢çš„å›¾åƒè§„æ¨¡å¤§å°çš„è®¾ç½®ã€‚</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># è€ƒè™‘åˆ° RandomFlip å·²ç»è¢«æ·»åŠ åˆ°æµç¨‹é‡Œï¼Œå½“ flip=False æ—¶å®ƒå°†ä¸è¢«ä½¿ç”¨ã€‚</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>  <span class="token comment">#  å½’ä¸€åŒ–é…ç½®é¡¹ï¼Œå€¼æ¥è‡ª img_norm_cfgã€‚</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span>  <span class="token comment"># å°†é…ç½®ä¼ é€’ç»™å¯è¢« 32 æ•´é™¤çš„å›¾åƒã€‚</span>                size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span>  <span class="token comment"># å°†å›¾åƒè½¬ä¸ºå¼ é‡</span>                keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>  <span class="token comment"># æ”¶é›†æµ‹è¯•æ—¶å¿…é¡»çš„é”®çš„æ”¶é›†æµç¨‹ã€‚</span>                keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    samples_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment"># å•ä¸ª GPU çš„ Batch size</span>    workers_per_gpu<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment"># å•ä¸ª GPU åˆ†é…çš„æ•°æ®åŠ è½½çº¿ç¨‹æ•°</span>    train<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># è®­ç»ƒæ•°æ®é›†é…ç½®</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>  <span class="token comment"># æ•°æ®é›†çš„ç±»åˆ«, æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/datasets/coco.py#L19ã€‚</span>        ann_file<span class="token operator">=</span><span class="token string">'data/coco/annotations/instances_train2017.json'</span><span class="token punctuation">,</span>  <span class="token comment"># æ³¨é‡Šæ–‡ä»¶è·¯å¾„</span>        img_prefix<span class="token operator">=</span><span class="token string">'data/coco/train2017/'</span><span class="token punctuation">,</span>  <span class="token comment"># å›¾ç‰‡è·¯å¾„å‰ç¼€</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>  <span class="token comment"># æµç¨‹, è¿™æ˜¯ç”±ä¹‹å‰åˆ›å»ºçš„ train_pipeline ä¼ é€’çš„ã€‚</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadAnnotations'</span><span class="token punctuation">,</span>                with_bbox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                with_mask<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                poly2mask<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">,</span> flip_ratio<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'DefaultFormatBundle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span>                keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token string">'gt_bboxes'</span><span class="token punctuation">,</span> <span class="token string">'gt_labels'</span><span class="token punctuation">,</span> <span class="token string">'gt_masks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># éªŒè¯æ•°æ®é›†çš„é…ç½®</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'data/coco/annotations/instances_val2017.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'data/coco/val2017/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>  <span class="token comment"># ç”±ä¹‹å‰åˆ›å»ºçš„ test_pipeline ä¼ é€’çš„æµç¨‹ã€‚</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span>                        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># æµ‹è¯•æ•°æ®é›†é…ç½®ï¼Œä¿®æ”¹æµ‹è¯•å¼€å‘/æµ‹è¯•(test-dev/test)æäº¤çš„ ann_file</span>        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CocoDataset'</span><span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'data/coco/annotations/instances_val2017.json'</span><span class="token punctuation">,</span>        img_prefix<span class="token operator">=</span><span class="token string">'data/coco/val2017/'</span><span class="token punctuation">,</span>        pipeline<span class="token operator">=</span><span class="token punctuation">[</span>  <span class="token comment"># ç”±ä¹‹å‰åˆ›å»ºçš„ test_pipeline ä¼ é€’çš„æµç¨‹ã€‚</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'LoadImageFromFile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token builtin">dict</span><span class="token punctuation">(</span>                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MultiScaleFlipAug'</span><span class="token punctuation">,</span>                img_scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                flip<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>                transforms<span class="token operator">=</span><span class="token punctuation">[</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Resize'</span><span class="token punctuation">,</span> keep_ratio<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RandomFlip'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span>                        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Normalize'</span><span class="token punctuation">,</span>                        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">123.675</span><span class="token punctuation">,</span> <span class="token number">116.28</span><span class="token punctuation">,</span> <span class="token number">103.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">58.395</span><span class="token punctuation">,</span> <span class="token number">57.12</span><span class="token punctuation">,</span> <span class="token number">57.375</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        to_rgb<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Pad'</span><span class="token punctuation">,</span> size_divisor<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ImageToTensor'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'Collect'</span><span class="token punctuation">,</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        samples_per_gpu<span class="token operator">=</span><span class="token number">2</span>  <span class="token comment"># å•ä¸ª GPU æµ‹è¯•æ—¶çš„ Batch size</span>        <span class="token punctuation">)</span><span class="token punctuation">)</span>evaluation <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># evaluation hook çš„é…ç½®ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/evaluation/eval_hooks.py#L7ã€‚</span>    interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># éªŒè¯çš„é—´éš”ã€‚</span>    metric<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bbox'</span><span class="token punctuation">,</span> <span class="token string">'segm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># éªŒè¯æœŸé—´ä½¿ç”¨çš„æŒ‡æ ‡ã€‚</span>optimizer <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># ç”¨äºæ„å»ºä¼˜åŒ–å™¨çš„é…ç½®æ–‡ä»¶ã€‚æ”¯æŒ PyTorch ä¸­çš„æ‰€æœ‰ä¼˜åŒ–å™¨ï¼ŒåŒæ—¶å®ƒä»¬çš„å‚æ•°ä¸ PyTorch é‡Œçš„ä¼˜åŒ–å™¨å‚æ•°ä¸€è‡´ã€‚</span>    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'SGD'</span><span class="token punctuation">,</span>  <span class="token comment"># ä¼˜åŒ–å™¨ç§ç±»ï¼Œæ›´å¤šç»†èŠ‚å¯å‚è€ƒ https://github.com/open-mmlab/mmdetection/blob/master/mmdet/core/optimizer/default_constructor.py#L13ã€‚</span>    lr<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span>  <span class="token comment"># ä¼˜åŒ–å™¨çš„å­¦ä¹ ç‡ï¼Œå‚æ•°çš„ä½¿ç”¨ç»†èŠ‚è¯·å‚ç…§å¯¹åº”çš„ PyTorch æ–‡æ¡£ã€‚</span>    momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>  <span class="token comment"># åŠ¨é‡(Momentum)</span>    weight_decay<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>  <span class="token comment"># SGD çš„è¡°å‡æƒé‡(weight decay)ã€‚</span>optimizer_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># optimizer hook çš„é…ç½®æ–‡ä»¶ï¼Œæ‰§è¡Œç»†èŠ‚è¯·å‚è€ƒ https://github.com/open-mmlab/mmcv/blob/master/mmcv/runner/hooks/optimizer.py#L8ã€‚</span>    grad_clip<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># å¤§å¤šæ•°æ–¹æ³•ä¸ä½¿ç”¨æ¢¯åº¦é™åˆ¶(grad_clip)ã€‚</span>lr_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># å­¦ä¹ ç‡è°ƒæ•´é…ç½®ï¼Œç”¨äºæ³¨å†Œ LrUpdater hookã€‚</span>    policy<span class="token operator">=</span><span class="token string">'step'</span><span class="token punctuation">,</span>  <span class="token comment"># è°ƒåº¦æµç¨‹(scheduler)çš„ç­–ç•¥ï¼Œä¹Ÿæ”¯æŒ CosineAnnealing, Cyclic, ç­‰ã€‚è¯·ä» https://github.com/open-mmlab/mmcv/blob/master/mmcv/runner/hooks/lr_updater.py#L9 å‚è€ƒ LrUpdater çš„ç»†èŠ‚ã€‚</span>    warmup<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span>  <span class="token comment"># é¢„çƒ­(warmup)ç­–ç•¥ï¼Œä¹Ÿæ”¯æŒ `exp` å’Œ `constant`ã€‚</span>    warmup_iters<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>  <span class="token comment"># é¢„çƒ­çš„è¿­ä»£æ¬¡æ•°</span>    warmup_ratio<span class="token operator">=</span>    <span class="token number">0.001</span><span class="token punctuation">,</span>  <span class="token comment"># ç”¨äºçƒ­èº«çš„èµ·å§‹å­¦ä¹ ç‡çš„æ¯”ç‡</span>    step<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># è¡°å‡å­¦ä¹ ç‡çš„èµ·æ­¢å›åˆæ•°</span>runner <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'EpochBasedRunner'</span><span class="token punctuation">,</span>  <span class="token comment"># å°†ä½¿ç”¨çš„ runner çš„ç±»åˆ« (ä¾‹å¦‚ IterBasedRunner æˆ– EpochBasedRunner)ã€‚</span>    max_epochs<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment"># runner æ€»å›åˆæ•°ï¼Œ å¯¹äº IterBasedRunner ä½¿ç”¨ `max_iters`</span>checkpoint_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># Checkpoint hook çš„é…ç½®æ–‡ä»¶ã€‚æ‰§è¡Œæ—¶è¯·å‚è€ƒ https://github.com/open-mmlab/mmcv/blob/master/mmcv/runner/hooks/checkpoint.pyã€‚</span>    interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># ä¿å­˜çš„é—´éš”æ˜¯ 1ã€‚</span>log_config <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>  <span class="token comment"># register logger hook çš„é…ç½®æ–‡ä»¶ã€‚</span>    interval<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>  <span class="token comment"># æ‰“å°æ—¥å¿—çš„é—´éš”</span>    hooks<span class="token operator">=</span><span class="token punctuation">[</span>        <span class="token comment"># dict(type='TensorboardLoggerHook')  # åŒæ ·æ”¯æŒ Tensorboard æ—¥å¿—</span>        <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'TextLoggerHook'</span><span class="token punctuation">)</span>    <span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># ç”¨äºè®°å½•è®­ç»ƒè¿‡ç¨‹çš„è®°å½•å™¨(logger)ã€‚</span>dist_params <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'nccl'</span><span class="token punctuation">)</span>  <span class="token comment"># ç”¨äºè®¾ç½®åˆ†å¸ƒå¼è®­ç»ƒçš„å‚æ•°ï¼Œç«¯å£ä¹ŸåŒæ ·å¯è¢«è®¾ç½®ã€‚</span>log_level <span class="token operator">=</span> <span class="token string">'INFO'</span>  <span class="token comment"># æ—¥å¿—çš„çº§åˆ«ã€‚</span>load_from <span class="token operator">=</span> <span class="token boolean">None</span>  <span class="token comment"># ä»ä¸€ä¸ªç»™å®šè·¯å¾„é‡ŒåŠ è½½æ¨¡å‹ä½œä¸ºé¢„è®­ç»ƒæ¨¡å‹ï¼Œå®ƒå¹¶ä¸ä¼šæ¶ˆè€—è®­ç»ƒæ—¶é—´ã€‚</span>resume_from <span class="token operator">=</span> <span class="token boolean">None</span>  <span class="token comment"># ä»ç»™å®šè·¯å¾„é‡Œæ¢å¤æ£€æŸ¥ç‚¹(checkpoints)ï¼Œè®­ç»ƒæ¨¡å¼å°†ä»æ£€æŸ¥ç‚¹ä¿å­˜çš„è½®æ¬¡å¼€å§‹æ¢å¤è®­ç»ƒã€‚</span>workflow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># runner çš„å·¥ä½œæµç¨‹ï¼Œ[('train', 1)] è¡¨ç¤ºåªæœ‰ä¸€ä¸ªå·¥ä½œæµä¸”å·¥ä½œæµä»…æ‰§è¡Œä¸€æ¬¡ã€‚æ ¹æ® total_epochs å·¥ä½œæµè®­ç»ƒ 12ä¸ªå›åˆã€‚</span>work_dir <span class="token operator">=</span> <span class="token string">'work_dir'</span>  <span class="token comment"># ç”¨äºä¿å­˜å½“å‰å®éªŒçš„æ¨¡å‹æ£€æŸ¥ç‚¹å’Œæ—¥å¿—çš„ç›®å½•æ–‡ä»¶åœ°å€ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ol><li>å­¦ä¹  mmdetection å·¥å…·ç®±</li><li>å®ç°ä¸€ä¸ªé¡¹ç›®</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MMDetection </tag>
            
            <tag> MMLab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FFMPEG note</title>
      <link href="/archives/97736837.html"/>
      <url>/archives/97736837.html</url>
      
        <content type="html"><![CDATA[<h1 id="FFMPEG"><a href="#FFMPEG" class="headerlink" title="FFMPEG"></a>FFMPEG</h1><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><h3 id="01-ä¸‹è½½ï¼Œé…ç½®"><a href="#01-ä¸‹è½½ï¼Œé…ç½®" class="headerlink" title="01.ä¸‹è½½ï¼Œé…ç½®"></a>01.ä¸‹è½½ï¼Œé…ç½®</h3><p>ç”¨çš„ç³»ç»Ÿæ˜¯ Ubuntu å¯ä»¥ç›´æ¥ apt-get</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ffmpeg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>windows å¯ä»¥å»å®˜ç½‘ä¸‹è½½ <a href="https://www.gyan.dev/ffmpeg/builds/">windows build</a></p><h3 id="02-ç®€ä»‹ï¼Œä¸Šæ‰‹-FFmpeg-FFprobe-FFplay"><a href="#02-ç®€ä»‹ï¼Œä¸Šæ‰‹-FFmpeg-FFprobe-FFplay" class="headerlink" title="02.ç®€ä»‹ï¼Œä¸Šæ‰‹(FFmpeg FFprobe FFplay)"></a>02.ç®€ä»‹ï¼Œä¸Šæ‰‹(FFmpeg FFprobe FFplay)</h3><p>(1) æŸ¥çœ‹ ffmpeg çš„å¸®åŠ©è¯´æ˜ï¼Œæä¾›çš„æŒ‡ä»¤ã€‚å»ºè®®å°†å…¶ä¸­çš„å‘½ä»¤å¤§è‡´çœ‹çœ‹ï¼Œåœ¨æœ¬ç¬”è®°æœ€åé™„æœ‰è¯¥å¸®åŠ©è¯´æ˜</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -h<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(2) æ’­æ”¾åª’ä½“çš„æŒ‡ä»¤</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffplay video.mp4ffplay music.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>(3) å¸¸ç”¨å¿«æ·é”®</p><p>æŒ‰é”®â€Qâ€æˆ–â€Escâ€ï¼šé€€å‡ºåª’ä½“æ’­æ”¾<br>é”®ç›˜æ–¹å‘é”®ï¼šåª’ä½“æ’­æ”¾çš„å‰è¿›åé€€<br>ç‚¹å‡»é¼ æ ‡å³é”®ï¼šæ‹–åŠ¨åˆ°è¯¥æ’­æ”¾ä½ç½®<br>æŒ‰é”®â€Fâ€ï¼šå…¨å±<br>æŒ‰é”®â€Pâ€æˆ–ç©ºæ ¼é”®ï¼šæš‚åœ<br>æŒ‰é”®â€Wâ€:åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼</p><p>(4) æŸ¥çœ‹åª’ä½“å‚æ•°ä¿¡æ¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffprobe video.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºå½¢å¦‚ä¸‹é¢çš„å†…å®¹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Stream <span class="token comment">#0:0[0x1](und): Video: h264 (High) (avc1 / 0x31637661), yuv420p(tv, bt709), 1440x720, 163 kb/s, 30 fps, 30 tbr, 16k tbn (default)</span>    Metadata:      handler_name    <span class="token builtin class-name">:</span> VideoHandler      vendor_id       <span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>Stream <span class="token comment">#0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 128 kb/s (default)</span>    Metadata:      handler_name    <span class="token builtin class-name">:</span> SoundHandler      vendor_id       <span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°è§†é¢‘ä¸º h264 ç¼–ç ï¼Œåˆ†è¾¨ç‡ 1440x720ã€æ¯”ç‰¹ç‡(ç ç‡) 163 kb/sã€å¸§ç‡ 30 fpsã€‚éŸ³é¢‘ä¸º acc ç¼–ç ï¼ŒéŸ³é¢‘é‡‡æ ·ç‡ 44100 Hzï¼Œæ¯”ç‰¹ç‡ 128 kb/s</p><h3 id="03-è½¬æ¢æ ¼å¼-æ–‡ä»¶æ ¼å¼-å°è£…æ ¼å¼"><a href="#03-è½¬æ¢æ ¼å¼-æ–‡ä»¶æ ¼å¼-å°è£…æ ¼å¼" class="headerlink" title="03.è½¬æ¢æ ¼å¼(æ–‡ä»¶æ ¼å¼,å°è£…æ ¼å¼)"></a>03.è½¬æ¢æ ¼å¼(æ–‡ä»¶æ ¼å¼,å°è£…æ ¼å¼)</h3><p>(1) æ–‡ä»¶åå¯ä»¥æ˜¯ä¸­è‹±æ–‡ï¼Œä½†ä¸èƒ½æœ‰ç©ºæ ¼</p><p>(2) <strong>è½¬æ¢æ ¼å¼</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 video_avi.avi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ffmpeg ä½¿ç”¨ -i å‚æ•°æ¥è¡¨ç¤ºè¾“å…¥æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç”¨ -f å‚æ•°æŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œä½†ä¸ºäº†çœäº‹å„¿å¥½åƒä¹Ÿå¯ä»¥ä¸ç”¨æŒ‡å®šï¼Œffmpeg ä¼šæ ¹æ®è¾“å‡ºæ–‡ä»¶åçš„åç¼€è‡ªåŠ¨è¯†åˆ«</p><h3 id="04-æå–éŸ³è§†é¢‘"><a href="#04-æå–éŸ³è§†é¢‘" class="headerlink" title="04.æå–éŸ³è§†é¢‘"></a>04.æå–éŸ³è§†é¢‘</h3><p>(1) å•ç‹¬æå–è§†é¢‘ï¼ˆä¸å«éŸ³é¢‘æµï¼‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 -vcodec copy -an video_silent.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(2) å•ç‹¬æå–éŸ³é¢‘ï¼ˆä¸å«è§†é¢‘æµï¼‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 -vn -acodec copy video_novideo.m4a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…·å¤‡å¤šä¸ªéŸ³é¢‘æµçš„ï¼Œå¦‚</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Stream <span class="token comment">#0:2[0x81]:Audio:ac3,48000Hz,5.1,s16,384kb/s</span>Stream <span class="token comment">#0:3[0x82]:Audio:ac3,48000Hz,5.1,s16,384kb/s</span>Stream <span class="token comment">#0:4[0x80]:Audio:ac3,48000Hz,5.1,s16,448kb/s</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>é’ˆå¯¹æ€§çš„å•ä¸€çš„æå–ï¼Œä¾‹å¦‚æå–ç¬¬2æ¡ï¼Œç”¨æŒ‡ä»¤ï¼š -map 0:3</p><p>(3) åˆå¹¶éŸ³è§†é¢‘</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video_novideo.m4a -i video_silent.mp4 -c copy video_merge.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>-c ä¸º -codec çš„ç¼©å†™ï¼Œä¼ å…¥å‚æ•° copy å³ä½¿ç”¨åŸè§†é¢‘/éŸ³é¢‘ç¼–ç å™¨ï¼Œè¿™æ ·ä¼šå¤§å¤§åŠ å¿«å¤„ç†æ—¶é—´è€Œä¸ç”¨é‡æ–°è½¬ç ã€‚ä¸€èˆ¬åœ¨ codec å‰/åæœ‰ a/v å³ä»£è¡¨éŸ³é¢‘/è§†é¢‘</p><h3 id="05-æˆªå–ï¼Œè¿æ¥éŸ³è§†é¢‘"><a href="#05-æˆªå–ï¼Œè¿æ¥éŸ³è§†é¢‘" class="headerlink" title="05.æˆªå–ï¼Œè¿æ¥éŸ³è§†é¢‘"></a>05.æˆªå–ï¼Œè¿æ¥éŸ³è§†é¢‘</h3><p>(1) æˆªå–</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i music.mp3 -ss 00:00:30 -to 00:02:00 -acodec copy music_cutout.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å…¥æ—¶é—´å¯ä»¥æ˜¯å¦‚ä¸Šçš„ <code>æ—¶:åˆ†:ç§’</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>åˆ†:ç§’</code>ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥å¤šå°‘ç§’ï¼Œç§’å¯ä»¥æ˜¯æµ®ç‚¹æ•°ã€‚è¿˜å¯ä»¥æˆªå–æŒ‡å®šé•¿åº¦çš„éŸ³è§†é¢‘ï¼Œå¦‚æˆªå–60ç§’</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i music.mp3 -ss 00:00:30 -t <span class="token number">60</span> -acodec copy music_cutout60s.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>-sseof time_offset: å¼€å§‹æ—¶é—´ä»åª’ä½“æœ«å°¾å¼€å§‹è®¡ç®—ï¼Œä¼ å…¥å‚æ•°ä¸ºå¤æ•°</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i in.mp4 -ss 00:01:00 -to 00:01:10 -c copy out.mp4ffmpeg -ss 00:01:00 -i in.mp4 -to 00:01:10 -c copy out.mp4ffmpeg -ss 00:01:00 -i in.mp4 -to 00:01:10 -c copy -copyts out.mp4<span class="token comment"># ä»æœ«å°¾å¾€å‰ 10s æˆªå– 5s</span>ffmpeg -sseof -10 -t <span class="token number">5</span> -i in.mp4 -c copy out.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠŠ-ssæ”¾åˆ°-iä¹‹å‰ï¼Œå¯ç”¨äº†å…³é”®å¸§æŠ€æœ¯ï¼ŒåŠ é€Ÿæ“ä½œã€‚ä½†æˆªå–çš„æ—¶é—´æ®µä¸ä¸€å®šå‡†ç¡®ã€‚å¯ç”¨æœ€åä¸€æ¡æŒ‡ä»¤ï¼Œä¿ç•™æ—¶é—´æˆ³ï¼Œä¿è¯æ—¶é—´å‡†ç¡®ã€‚</p><p>(2) è¿æ¥éŸ³è§†é¢‘</p><p>æˆ‘æ¨èä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•</p><ol><li><p>æ–°å»ºä¸€ä¸ª list.txt æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†éœ€è¦è¿æ¥çš„éŸ³è§†é¢‘ã€‚æ ¼å¼å¦‚ä¸‹</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">file '/path/to/file1'file '/path/to/file2'file '/path/to/file3'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>å¯ä»¥ä½¿ç”¨ -f concatï¼Œæ¥åˆå¹¶éŸ³è§†é¢‘</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -f concat -i mylist.txt -c copy output.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><p>å¯¹äºç²¾ç»†çš„éŸ³è§†é¢‘è¿æ¥å¹¶ä¸æ¨èä½¿ç”¨ ffmeg</p><h3 id="06-æˆªå›¾ï¼Œæ°´å°ï¼ŒåŠ¨å›¾-gif"><a href="#06-æˆªå›¾ï¼Œæ°´å°ï¼ŒåŠ¨å›¾-gif" class="headerlink" title="06.æˆªå›¾ï¼Œæ°´å°ï¼ŒåŠ¨å›¾ gif"></a>06.æˆªå›¾ï¼Œæ°´å°ï¼ŒåŠ¨å›¾ gif</h3><p>(1) æˆªå›¾.</p><p>æˆªå–ç¬¬7ç§’ç¬¬1å¸§çš„ç”»é¢</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 -ss <span class="token number">7</span> -vframes <span class="token number">1</span> video_image.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§†é¢‘åˆ†ç¦»æˆå›¾ç‰‡</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i input_test.mp4 -r <span class="token number">1</span> -f image2 output_image-%03d.png<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å›¾ç‰‡ä¹Ÿèƒ½åˆæˆä¸ºè§†é¢‘</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -f image2 -i output_image-%03d.png output_test.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„ï¼Œè¿™é‡Œé€‰æ‹© png æ ¼å¼è€Œä¸æ˜¯ jpg æ ¼å¼æ˜¯å› ä¸º png ä¸ºæ— æŸå‹ç¼©å›¾ï¼Œè¿™æ ·åœ¨è§†é¢‘å’Œå›¾ç‰‡çš„è½¬æ¢å½“ä¸­ï¼Œå°±ä¸ä¼šæœ‰æŸå¤±</p><p>(2) æ°´å°</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 -i qt.png -filter_complex <span class="token string">"overlay=20:80"</span> video_watermark.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(3) æˆªå–åŠ¨å›¾</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 -ss <span class="token number">7.5</span> -to <span class="token number">8.5</span> -s 640x320 -r <span class="token number">15</span> video_gif.gif<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è¡¥å……ï¼šè§†é¢‘ç¼–ç "><a href="#è¡¥å……ï¼šè§†é¢‘ç¼–ç " class="headerlink" title="è¡¥å……ï¼šè§†é¢‘ç¼–ç "></a>è¡¥å……ï¼šè§†é¢‘ç¼–ç </h2><h3 id="01-æ”¹å˜ç¼–ç -ä¸Š-ç¼–ç -éŸ³é¢‘è½¬ç "><a href="#01-æ”¹å˜ç¼–ç -ä¸Š-ç¼–ç -éŸ³é¢‘è½¬ç " class="headerlink" title="01.æ”¹å˜ç¼–ç  ä¸Š(ç¼–ç ,éŸ³é¢‘è½¬ç )"></a>01.æ”¹å˜ç¼–ç  ä¸Š(ç¼–ç ,éŸ³é¢‘è½¬ç )</h3><p>(1)æŸ¥çœ‹ç¼–è§£ç å™¨</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -codecs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(2)<strong>ç½‘ç«™å¸¸ç”¨ç¼–ç </strong></p><p>MP4å°è£…ï¼šH264è§†é¢‘ç¼–ç +ACCéŸ³é¢‘ç¼–ç <br>WebMå°è£…ï¼šVP8è§†é¢‘ç¼–ç +VorbiséŸ³é¢‘ç¼–ç <br>OGGå°è£…ï¼šTheoraè§†é¢‘ç¼–ç +VorbiséŸ³é¢‘ç¼–ç </p><p>(3)<strong>æ— æŸç¼–ç æ ¼å¼.flacè½¬æ¢ç¼–ç </strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i music_flac.flac -acodec libmp3lame -ar <span class="token number">44100</span> -ab 320k -ac <span class="token number">2</span> music_flac_mp3.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è¯´æ˜ï¼š</strong></p><ul><li>acodec:audio Coder Decoder éŸ³é¢‘ç¼–ç è§£ç å™¨</li><li>libmp3lame:mp3è§£ç å™¨</li><li>ar:audio rateï¼šéŸ³é¢‘é‡‡æ ·ç‡</li><li><strong>44100:è®¾ç½®éŸ³é¢‘çš„é‡‡æ ·ç‡44100ã€‚è‹¥ä¸è¾“å…¥ï¼Œé»˜è®¤ç”¨åŸéŸ³é¢‘çš„é‡‡æ ·ç‡</strong></li><li>ab:audio bit rate éŸ³é¢‘æ¯”ç‰¹ç‡</li><li><strong>320kï¼šè®¾ç½®éŸ³é¢‘çš„æ¯”ç‰¹ç‡ã€‚è‹¥ä¸è¾“å…¥ï¼Œé»˜è®¤128K</strong></li><li>ac: aduio channels éŸ³é¢‘å£°é“</li><li>2:å£°é“æ•°ã€‚è‹¥ä¸è¾“å…¥ï¼Œé»˜è®¤é‡‡ç”¨æºéŸ³é¢‘çš„å£°é“æ•°</li></ul><p>æ¦‚æ‹¬ï¼šè®¾ç½®æ ¼å¼çš„åŸºæœ¬å¥—è·¯-å…ˆæ˜¯æŒ‡åå±æ€§ï¼Œç„¶åè·Ÿç€æ–°çš„å±æ€§å€¼</p><p>(4)æŸ¥çœ‹ç»“æœå±æ€§</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffprobe music_flac_mp3.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="02-æ”¹å˜ç¼–ç -ä¸­-è§†é¢‘å‹åˆ¶"><a href="#02-æ”¹å˜ç¼–ç -ä¸­-è§†é¢‘å‹åˆ¶" class="headerlink" title="02.æ”¹å˜ç¼–ç  ä¸­(è§†é¢‘å‹åˆ¶)"></a>02.æ”¹å˜ç¼–ç  ä¸­(è§†é¢‘å‹åˆ¶)</h3><p>(1)è§†é¢‘è½¬ç </p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i video.mp4 -s 1920x1080 -pix_fmt yuv420p -vcodec libx264 -preset medium -profile:v high -level:v <span class="token number">4.1</span> -crf <span class="token number">23</span> -acodec aac -ar <span class="token number">44100</span> -ac <span class="token number">2</span> -b:a 128k video_avi.avi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è¯´æ˜:</strong></p><ul><li><strong>-s 1920x1080ï¼šç¼©æ”¾è§†é¢‘æ–°å°ºå¯¸(size)</strong></li><li>-pix_fmt yuv420pï¼špixel format,ç”¨æ¥è®¾ç½®è§†é¢‘é¢œè‰²ç©ºé—´ã€‚å‚æ•°æŸ¥è¯¢ï¼šffmpeg -pix_fmts</li><li>-vcodec libx264ï¼švideo Coder Decoderï¼Œè§†é¢‘ç¼–ç è§£ç å™¨</li><li>-preset medium: ç¼–ç å™¨é¢„è®¾ã€‚å‚æ•°ï¼šultrafast,superfast,veryfast,faster,fast,medium,slow,slower,veryslow,placebo</li><li>-profile:v high :ç¼–ç å™¨é…ç½®ï¼Œä¸å‹ç¼©æ¯”æœ‰å…³ã€‚å®æ—¶é€šè®¯-baseline,æµåª’ä½“-main,è¶…æ¸…è§†é¢‘-high</li><li>-level:v 4.1 ï¼šå¯¹ç¼–ç å™¨è®¾ç½®çš„å…·ä½“è§„èŒƒå’Œé™åˆ¶ï¼Œæƒè¡¡å‹ç¼©æ¯”å’Œç”»è´¨ã€‚</li><li>-crf 23 ï¼šè®¾ç½®ç ç‡æ§åˆ¶æ¨¡å¼ã€‚constant rate factor-æ’å®šé€Ÿç‡å› å­æ¨¡å¼ã€‚èŒƒå›´0~51,é»˜è®¤23ã€‚æ•°å€¼è¶Šå°ï¼Œç”»è´¨è¶Šé«˜ã€‚ä¸€èˆ¬åœ¨8~28åšå‡ºé€‰æ‹©ã€‚</li><li><strong>-r 30 :è®¾ç½®è§†é¢‘å¸§ç‡</strong></li><li>-acodec aac :audio Coder Decoder-éŸ³é¢‘ç¼–ç è§£ç å™¨</li><li>-b:a 128k :éŸ³é¢‘æ¯”ç‰¹ç‡.å¤§å¤šæ•°ç½‘ç«™é™åˆ¶éŸ³é¢‘æ¯”ç‰¹ç‡128k,129k<br>å…¶ä»–å‚è€ƒä¸Šä¸€ä¸ªæ•™ç¨‹</li></ul><h3 id="03-æ”¹å˜ç¼–ç -ä¸‹-ç ç‡æ§åˆ¶æ¨¡å¼"><a href="#03-æ”¹å˜ç¼–ç -ä¸‹-ç ç‡æ§åˆ¶æ¨¡å¼" class="headerlink" title="03.æ”¹å˜ç¼–ç  ä¸‹(ç ç‡æ§åˆ¶æ¨¡å¼)"></a>03.æ”¹å˜ç¼–ç  ä¸‹(ç ç‡æ§åˆ¶æ¨¡å¼)</h3><p>ffmpegæ”¯æŒçš„ç ç‡æ§åˆ¶æ¨¡å¼ï¼š-qp -crf -b</p><p>(1)  -qp :constant quantizer,æ’å®šé‡åŒ–å™¨æ¨¡å¼ </p><p>æ— æŸå‹ç¼©çš„ä¾‹å­ï¼ˆå¿«é€Ÿç¼–ç ï¼‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i input -vcodec libx264 -preset ultrafast -qp <span class="token number">0</span> output.mkv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ— æŸå‹ç¼©çš„ä¾‹å­ï¼ˆé«˜å‹ç¼©æ¯”ï¼‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i input -vcodec libx264 -preset veryslow -qp <span class="token number">0</span> output.mkv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(2) -crf :constant rate factor,æ’å®šé€Ÿç‡å› å­æ¨¡å¼</p><p>(3) -b ï¼šbitrate,å›ºå®šç›®æ ‡ç ç‡æ¨¡å¼ã€‚ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨</p><p>3ç§æ¨¡å¼é»˜è®¤å•éç¼–ç </p><p>VBR(Variable Bit Rate/åŠ¨æ€æ¯”ç‰¹ç‡) ä¾‹å­</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i input -vcodec libx264 -preset veryslow output<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ABR(Average Bit Rate/å¹³å‡æ¯”ç‰¹ç‡) ä¾‹å­</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg -i input -vcodec libx264 -preset veryslow -b:v 3000k output<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>CBR(Constant Bit Rate/æ’å®šæ¯”ç‰¹ç‡) ä¾‹å­</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">..</span>. -b:v 4000k -minrate 4000k -maxrate 4000k -bufsize 1835k <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p>ç¬”è®°æ¥æºï¼š<a href="https://www.bilibili.com/video/av40146374">https://www.bilibili.com/video/av40146374</a></p><p>å®˜æ–¹æ•™ç¨‹ï¼š <a href="http://ffmpeg.org/ffmpeg-all.html">http://ffmpeg.org/ffmpeg-all.html</a></p><p>åšå®¢ï¼š<a href="https://www.jianshu.com/p/f07f0be088d0">https://www.jianshu.com/p/f07f0be088d0</a></p><h2 id="å¸®åŠ©æ–‡æ¡£ï¼Œç”¨äºæŸ¥è¯¢"><a href="#å¸®åŠ©æ–‡æ¡£ï¼Œç”¨äºæŸ¥è¯¢" class="headerlink" title="å¸®åŠ©æ–‡æ¡£ï¼Œç”¨äºæŸ¥è¯¢"></a>å¸®åŠ©æ–‡æ¡£ï¼Œç”¨äºæŸ¥è¯¢</h2><p>ä¸‹é¢æ˜¯ ffmpeg çš„å¸®åŠ©æ–‡æ¡£ï¼Œç”¨äºæŸ¥è¯¢</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffmpeg version <span class="token number">2021</span>-09-08-git-5e7e2e5031-full_build-www.gyan.dev Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>-2021 the FFmpeg developers  built with gcc <span class="token number">10.3</span>.0 <span class="token punctuation">(</span>Rev5, Built by MSYS2 project<span class="token punctuation">)</span>  configuration: --enable-gpl --enable-version3 --enable-static --disable-w32threads --disable-autodetect --enable-fontconfig --enable-iconv --enable-gnutls --enable-libxml2 --enable-gmp --enable-lzma --enable-libsnappy --enable-zlib --enable-librist --enable-libsrt --enable-libssh --enable-libzmq --enable-avisynth --enable-libbluray --enable-libcaca --enable-sdl2 --enable-libdav1d --enable-libzvbi --enable-librav1e --enable-libsvtav1 --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxvid --enable-libaom --enable-libopenjpeg --enable-libvpx --enable-libass --enable-frei0r --enable-libfreetype --enable-libfribidi --enable-libvidstab --enable-libvmaf --enable-libzimg --enable-amf --enable-cuda-llvm --enable-cuvid --enable-ffnvcodec --enable-nvdec --enable-nvenc --enable-d3d11va --enable-dxva2 --enable-libmfx --enable-libglslang --enable-vulkan --enable-opencl --enable-libcdio --enable-libgme --enable-libmodplug --enable-libopenmpt --enable-libopencore-amrwb --enable-libmp3lame --enable-libshine --enable-libtheora --enable-libtwolame --enable-libvo-amrwbenc --enable-libilbc --enable-libgsm --enable-libopencore-amrnb --enable-libopus --enable-libspeex --enable-libvorbis --enable-ladspa --enable-libbs2b --enable-libflite --enable-libmysofa --enable-librubberband --enable-libsoxr --enable-chromaprint  libavutil      <span class="token number">57</span>.  <span class="token number">4.101</span> / <span class="token number">57</span>.  <span class="token number">4.101</span>  libavcodec     <span class="token number">59</span>.  <span class="token number">7.102</span> / <span class="token number">59</span>.  <span class="token number">7.102</span>  libavformat    <span class="token number">59</span>.  <span class="token number">5.100</span> / <span class="token number">59</span>.  <span class="token number">5.100</span>  libavdevice    <span class="token number">59</span>.  <span class="token number">0.101</span> / <span class="token number">59</span>.  <span class="token number">0.101</span>  libavfilter     <span class="token number">8</span>.  <span class="token number">7.101</span> /  <span class="token number">8</span>.  <span class="token number">7.101</span>  libswscale      <span class="token number">6</span>.  <span class="token number">1.100</span> /  <span class="token number">6</span>.  <span class="token number">1.100</span>  libswresample   <span class="token number">4</span>.  <span class="token number">0.100</span> /  <span class="token number">4</span>.  <span class="token number">0.100</span>  libpostproc    <span class="token number">56</span>.  <span class="token number">0.100</span> / <span class="token number">56</span>.  <span class="token number">0.100</span>Hyper fast Audio and Video encoderusage: ffmpeg <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>infile options<span class="token punctuation">]</span> -i infile<span class="token punctuation">]</span><span class="token punctuation">..</span>. <span class="token punctuation">{</span><span class="token punctuation">[</span>outfile options<span class="token punctuation">]</span> outfile<span class="token punctuation">}</span><span class="token punctuation">..</span>.Getting help:    -h      -- print basic options    -h long -- print <span class="token function">more</span> options    -h full -- print all options <span class="token punctuation">(</span>including all <span class="token function">format</span> and codec specific options, very long<span class="token punctuation">)</span>    -h <span class="token assign-left variable">type</span><span class="token operator">=</span>name -- print all options <span class="token keyword">for</span> the named decoder/encoder/demuxer/muxer/filter/bsf/protocol    See <span class="token function">man</span> ffmpeg <span class="token keyword">for</span> detailed description of the options.Print <span class="token builtin class-name">help</span> / information / capabilities:-L                  show license-h topic            show <span class="token builtin class-name">help</span>-? topic            show <span class="token builtin class-name">help</span>-help topic         show <span class="token builtin class-name">help</span>--help topic        show <span class="token builtin class-name">help</span>-version            show version-buildconf          show build configuration-formats            show available formats-muxers             show available muxers-demuxers           show available demuxers-devices            show available devices-codecs             show available codecs-decoders           show available decoders-encoders           show available encoders-bsfs               show available bit stream filters-protocols          show available protocols-filters            show available filters-pix_fmts           show available pixel formats-layouts            show standard channel layouts-sample_fmts        show available audio sample formats-colors             show available color names-sources device     list sources of the input device-sinks device       list sinks of the output device-hwaccels           show available HW acceleration methodsGlobal options <span class="token punctuation">(</span>affect whole program instead of just one <span class="token function">file</span><span class="token punctuation">)</span>:-loglevel loglevel  <span class="token builtin class-name">set</span> logging level-v loglevel         <span class="token builtin class-name">set</span> logging level-report             generate a report-max_alloc bytes    <span class="token builtin class-name">set</span> maximum size of a single allocated block-y                  overwrite output files-n                  never overwrite output files-ignore_unknown     Ignore unknown stream types-filter_threads     number of non-complex filter threads-filter_complex_threads  number of threads <span class="token keyword">for</span> -filter_complex-stats              print progress report during encoding-max_error_rate maximum error rate  ratio of decoding errors <span class="token punctuation">(</span><span class="token number">0.0</span>: no errors, <span class="token number">1.0</span>: <span class="token number">100</span>% errors<span class="token punctuation">)</span> above <span class="token function">which</span> ffmpeg returns an error instead of success.-bits_per_raw_sample number  <span class="token builtin class-name">set</span> the number of bits per raw sample-vol volume         change audio volume <span class="token punctuation">(</span><span class="token number">256</span><span class="token operator">=</span>normal<span class="token punctuation">)</span>Per-file main options:-f <span class="token function">fmt</span>              force <span class="token function">format</span>-c codec            codec name-codec codec        codec name-pre preset         preset name-map_metadata outfile<span class="token punctuation">[</span>,metadata<span class="token punctuation">]</span>:infile<span class="token punctuation">[</span>,metadata<span class="token punctuation">]</span>  <span class="token builtin class-name">set</span> metadata information of outfile from infile-t duration         record or transcode <span class="token string">"duration"</span> seconds of audio/video-to time_stop       record or transcode stop <span class="token function">time</span>-fs limit_size      <span class="token builtin class-name">set</span> the limit <span class="token function">file</span> size <span class="token keyword">in</span> bytes-ss time_off        <span class="token builtin class-name">set</span> the start <span class="token function">time</span> offset-sseof time_off     <span class="token builtin class-name">set</span> the start <span class="token function">time</span> offset relative to EOF-seek_timestamp     enable/disable seeking by timestamp with -ss-timestamp <span class="token function">time</span>     <span class="token builtin class-name">set</span> the recording timestamp <span class="token punctuation">(</span><span class="token string">'now'</span> to <span class="token builtin class-name">set</span> the current <span class="token function">time</span><span class="token punctuation">)</span>-metadata <span class="token assign-left variable">string</span><span class="token operator">=</span>string  <span class="token function">add</span> metadata-program <span class="token assign-left variable">title</span><span class="token operator">=</span>string:st<span class="token operator">=</span>number<span class="token punctuation">..</span>.  <span class="token function">add</span> program with specified streams-target <span class="token builtin class-name">type</span>        specify target <span class="token function">file</span> <span class="token builtin class-name">type</span> <span class="token punctuation">(</span><span class="token string">"vcd"</span>, <span class="token string">"svcd"</span>, <span class="token string">"dvd"</span>, <span class="token string">"dv"</span> or <span class="token string">"dv50"</span> with optional prefixes <span class="token string">"pal-"</span>, <span class="token string">"ntsc-"</span> or <span class="token string">"film-"</span><span class="token punctuation">)</span>-apad               audio pad-frames number      <span class="token builtin class-name">set</span> the number of frames to output-filter filter_graph  <span class="token builtin class-name">set</span> stream filtergraph-filter_script filename  <span class="token builtin class-name">read</span> stream filtergraph description from a <span class="token function">file</span>-reinit_filter      reinit filtergraph on input parameter changes-discard            discard-disposition        dispositionVideo options:-vframes number     <span class="token builtin class-name">set</span> the number of video frames to output-r rate             <span class="token builtin class-name">set</span> frame rate <span class="token punctuation">(</span>Hz value, fraction or abbreviation<span class="token punctuation">)</span>-fpsmax rate        <span class="token builtin class-name">set</span> max frame rate <span class="token punctuation">(</span>Hz value, fraction or abbreviation<span class="token punctuation">)</span>-s size             <span class="token builtin class-name">set</span> frame size <span class="token punctuation">(</span>WxH or abbreviation<span class="token punctuation">)</span>-aspect aspect      <span class="token builtin class-name">set</span> aspect ratio <span class="token punctuation">(</span><span class="token number">4</span>:3, <span class="token number">16</span>:9 or <span class="token number">1.3333</span>, <span class="token number">1.7777</span><span class="token punctuation">)</span>-bits_per_raw_sample number  <span class="token builtin class-name">set</span> the number of bits per raw sample-vn                 disable video-vcodec codec       force video codec <span class="token punctuation">(</span><span class="token string">'copy'</span> to copy stream<span class="token punctuation">)</span>-timecode hh:mm:ss<span class="token punctuation">[</span>:<span class="token punctuation">;</span>.<span class="token punctuation">]</span>ff  <span class="token builtin class-name">set</span> initial TimeCode value.-pass n             <span class="token keyword">select</span> the pass number <span class="token punctuation">(</span><span class="token number">1</span> to <span class="token number">3</span><span class="token punctuation">)</span>-vf filter_graph    <span class="token builtin class-name">set</span> video filters-ab bitrate         audio bitrate <span class="token punctuation">(</span>please use -b:a<span class="token punctuation">)</span>-b bitrate          video bitrate <span class="token punctuation">(</span>please use -b:v<span class="token punctuation">)</span>-dn                 disable dataAudio options:-aframes number     <span class="token builtin class-name">set</span> the number of audio frames to output-aq quality         <span class="token builtin class-name">set</span> audio quality <span class="token punctuation">(</span>codec-specific<span class="token punctuation">)</span>-ar rate            <span class="token builtin class-name">set</span> audio sampling rate <span class="token punctuation">(</span>in Hz<span class="token punctuation">)</span>-ac channels        <span class="token builtin class-name">set</span> number of audio channels-an                 disable audio-acodec codec       force audio codec <span class="token punctuation">(</span><span class="token string">'copy'</span> to copy stream<span class="token punctuation">)</span>-vol volume         change audio volume <span class="token punctuation">(</span><span class="token number">256</span><span class="token operator">=</span>normal<span class="token punctuation">)</span>-af filter_graph    <span class="token builtin class-name">set</span> audio filtersSubtitle options:-s size             <span class="token builtin class-name">set</span> frame size <span class="token punctuation">(</span>WxH or abbreviation<span class="token punctuation">)</span>-sn                 disable subtitle-scodec codec       force subtitle codec <span class="token punctuation">(</span><span class="token string">'copy'</span> to copy stream<span class="token punctuation">)</span>-stag fourcc/tag    force subtitle tag/fourcc-fix_sub_duration   fix subtitles duration-canvas_size size   <span class="token builtin class-name">set</span> canvas size <span class="token punctuation">(</span>WxH or abbreviation<span class="token punctuation">)</span>-spre preset        <span class="token builtin class-name">set</span> the subtitle options to the indicated preset<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
          <category> FFMPEG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FFMPEG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pr note</title>
      <link href="/archives/d76b900f.html"/>
      <url>/archives/d76b900f.html</url>
      
        <content type="html"><![CDATA[<h1 id="Premiere-note"><a href="#Premiere-note" class="headerlink" title="Premiere note"></a>Premiere note</h1><p>æ•™ç¨‹èµ„æºï¼š<a href="https://www.bilibili.com/video/BV1K64y1r7pp?p=1">åŸºç¡€æ•™ç¨‹ bilibili</a> </p><h2 id="ä»ç•Œé¢å¼€å§‹"><a href="#ä»ç•Œé¢å¼€å§‹" class="headerlink" title="ä»ç•Œé¢å¼€å§‹"></a>ä»ç•Œé¢å¼€å§‹</h2><p>å…³äºç¼–ç ï¼šH.264 ç¼–ç å°±æ˜¯å¯¹åº” mp4 æ ¼å¼è§†é¢‘</p><h3 id="ç•Œé¢"><a href="#ç•Œé¢" class="headerlink" title="ç•Œé¢"></a>ç•Œé¢</h3><ol><li><strong>ç´ æç®±</strong></li><li>å·¥å…·æ </li><li><strong>åºåˆ—</strong></li><li>é¢„è§ˆçª—å£</li><li>æ•ˆæœçª—å£</li><li><strong>å‚æ•°çª—å£</strong></li><li><strong>é¢æ¿</strong>ï¼šä¸åŒçš„é¢æ¿ä¸“æ³¨å¤„ç†è§†é¢‘çš„ä¸åŒéƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼šç»„ä»¶é¢æ¿å®Œæˆçš„æ˜¯å¯¹è§†é¢‘çš„ç²—å‰ª</li></ol><h2 id="è¿‡ç¨‹ä¸­çš„å°æŠ€å·§"><a href="#è¿‡ç¨‹ä¸­çš„å°æŠ€å·§" class="headerlink" title="è¿‡ç¨‹ä¸­çš„å°æŠ€å·§"></a>è¿‡ç¨‹ä¸­çš„å°æŠ€å·§</h2><ol><li>é€šè¿‡æ•ˆæœé¢æ¿ -&gt; ç‰¹æ•ˆå‚æ•°å¯ä»¥è¿›è¡Œç¼©æ”¾ï¼Œæˆ–è€…å³é”®é€‰æ‹©ç¼©æ”¾ä¸ºå¸§å¤§å°</li><li>å³é”®é€‰æ‹©å€é€Ÿ</li><li>å³é”®å–æ¶ˆè§†é¢‘éŸ³é¢‘é“¾æ¥</li><li>å³é”®æ³¢çº¹åˆ é™¤ï¼Œæˆ–é€‰ä¸­ç©ºéš™ç›´æ¥åˆ é™¤</li><li>å³é”®å‡å°‘éŸ³é¢‘å¢ç›Š</li><li>shift + left/right arrow èƒ½å¤Ÿä»¥5å¸§ç§»ï¼Œä¸æŒ‰ shift ç§»åŠ¨1å¸§</li><li>æŒ‰ä½ shift å†æ‹‰åŠ¨æ—¶é—´è½´ä¼šæœ‰å¸é™„æ•ˆæœ</li><li>ctrl + k å¿«é€Ÿå‰ªè£</li><li>ä½¿ç”¨åµŒå¥—ï¼Œèåˆç´ æ</li><li>æŒ‰ä½ ctrl æ‹–åŠ¨è§†é¢‘ï¼Œèƒ½å¤Ÿä¸è¦†ç›–åœ°ç§»åŠ¨è§†é¢‘ç‰‡æ®µ</li><li>å•å‡»é¡¶éƒ¨åºåˆ—èœå• -&gt; å°é—­é—´éš™</li><li>ctrl + D æˆ–è€… shift + D è¿›è¡Œå¿«é€Ÿè§†é¢‘è¿‡æ¸¡</li></ol><h3 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h3><p>cut </p><h2 id="æ ‡è®°å‡ºå…¥ç‚¹"><a href="#æ ‡è®°å‡ºå…¥ç‚¹" class="headerlink" title="æ ‡è®°å‡ºå…¥ç‚¹"></a>æ ‡è®°å‡ºå…¥ç‚¹</h2><ol><li>é¢„è§ˆå·¥å…·æ </li></ol><p><img src="/archives/d76b900f/image-20210713213300154.png"></p><ol><li><strong>å‡ºå…¥ç‚¹</strong>åœ¨ pr ä¸­ä»¥ bracket {} å½¢å¼å‡ºç°</li></ol><p>â€‹    åŒå‡»ç´ æï¼Œå¯¹ç´ æè¿›è¡Œå‡ºå…¥ç‚¹æ ‡è®°ï¼Œå†å°†ç´ ææ‹–å…¥åºåˆ—å°±èƒ½å¾—åˆ°å‰ªè£åçš„    ç´ æ</p><ol><li>æ·»åŠ æ ‡è®°ç‚¹ï¼Œå°±æ˜¯å·¥å…·æ ç¬¬ä¸€ä¸ªæ ‡å¿—ã€‚å¯ä»¥æ ‡è®°è§†é¢‘ä¸­çš„é‡è¦æ—¶åˆ»</li></ol><h2 id="æŠ½å¸§å¡ç‚¹"><a href="#æŠ½å¸§å¡ç‚¹" class="headerlink" title="æŠ½å¸§å¡ç‚¹"></a>æŠ½å¸§å¡ç‚¹</h2><p>æ ¹æ®éŸ³é¢‘çš„èŠ‚å¥å»å¡ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°éŸ³é¢‘ä¸Šçš„èŠ‚å¥ç‚¹ä¸Šæ˜¯æ˜æ˜¾çš„æ³¢å³°ï¼ŒæŠŠè¿™äº›ç‚¹æ ‡è®°å‡ºæ¥ï¼Œå¯¹åŸè§†é¢‘å‰ªè£å¡è¿™ä¸ªç‚¹å³å¯</p><p>å¯ä»¥ä½¿ç”¨æ’ä»¶ beat edit æ¥å¸®æˆ‘ä»¬è‡ªåŠ¨æ‰¾åˆ°èŠ‚å¥ç‚¹</p><h2 id="åŠ è½½å­—å¹•"><a href="#åŠ è½½å­—å¹•" class="headerlink" title="åŠ è½½å­—å¹•"></a>åŠ è½½å­—å¹•</h2><p>å¦‚æœæ˜¯æƒ³è¦åŠ å¤§é‡å­—å¹•ï¼Œæ¨èä½¿ç”¨è½¯ä»¶ arctime pro</p><p>TODO: å¦‚ä½•è‡ªåŠ¨è¯†åˆ«å¯¹è¯ï¼Œå½¢æˆå­—å¹•</p><h2 id="é¬¼ç•œ"><a href="#é¬¼ç•œ" class="headerlink" title="é¬¼ç•œ"></a>é¬¼ç•œ</h2><ol><li><p>é¬¼ç•œç´ æï¼Œé¬¼ç•œç´ æï¼Œé¬¼ç•œç´ æï¼</p></li><li><p>æŒ‰ä½ alt æ‹–æ‹½è§†é¢‘å°±èƒ½å¤Ÿå¤åˆ¶</p></li><li>å³é”®é€‰æ‹©å¸§é€Ÿåº¦æ›´æ”¹é€Ÿåº¦ï¼Œè¿˜å¯ä»¥å€’æ”¾</li></ol><h2 id="è½¬åœº"><a href="#è½¬åœº" class="headerlink" title="è½¬åœº"></a>è½¬åœº</h2><ol><li>åŸºç¡€çš„è½¬åœºï¼Œæ·¡å…¥æ·¡å‡º</li><li>ä½¿ç”¨ç‰¹æ•ˆçš„è½¬åœºï¼Œå°†ç‰¹æ•ˆåŠ åœ¨è°ƒæ•´å›¾å±‚ä¸Šï¼Œä¸ç”¨ä¿®æ”¹åŸå›¾å±‚</li><li>å¯ä»¥ä½¿ç”¨ preset è½¬åœºèµ„æºï¼š<a href="https://www.bilibili.com/video/BV1ab411E7EA">é¢„è®¾ bilibili</a> (æ›´å¤šèµ„æºè¯·ç§»æ­¥ bilibili)</li></ol><h2 id="å­—ä½“"><a href="#å­—ä½“" class="headerlink" title="å­—ä½“"></a>å­—ä½“</h2><p>æ¨èçš„å­—ä½“ï¼Œæ¨èå­—ä½“ç½‘ç«™ <a href="https://www.fonts.net.cn/">å­—ä½“å¤©ä¸‹</a></p><ol><li>æ€æºé»‘ä½“</li><li>å°åŒ—é»‘ä½“ï¼Œé€‚ç”¨äºç¹ä½“å­—</li><li>èŠ±å›­æ˜æœä½“</li><li>åˆ»çŸ³å½•æ˜ä½“ï¼Œä»¤ä¸œé½ä¼‹å¤åˆ»ä½“</li><li>OPPO/HarmonyOS SANS</li><li>æ‰‹ä¹¦ä½“ä¸­æ–‡ç®€ä½“</li><li>good hood, maria ä»¥ä¸Šå­—ä½“å‡å…è´¹å¯å•†ç”¨</li><li>gloss and boom</li><li>againts å­—ä½“</li><li>Futura, Baskerville(æ­£è§„),  Trajan(æ ‡é¢˜)</li></ol><h2 id="è°ƒè‰²"><a href="#è°ƒè‰²" class="headerlink" title="è°ƒè‰²"></a>è°ƒè‰²</h2><p>ä½¿ç”¨ LUT è°ƒè‰²ï¼Œé…åˆä¸Šä¾§è½®è¿›è¡Œå¾®è°ƒ</p><p>æ•™ç¨‹ï¼š<a href="https://www.bilibili.com/video/BV1qE411d7BS">è°ƒè‰² bilibili</a></p><h2 id="åŠ¨ç”»"><a href="#åŠ¨ç”»" class="headerlink" title="åŠ¨ç”»"></a>åŠ¨ç”»</h2><p><strong>æœ€åŸºç¡€ä¹Ÿæœ€å¸¸ç”¨çš„å°±æ˜¯ä½¿ç”¨å…³é”®å¸§å®ç°åŠ¨ç”»ï¼ŒPr èƒ½å¤Ÿé€šè¿‡å…³é”®å¸§è‡ªåŠ¨å®ç°ç®€å•åŠ¨ç”»</strong></p><p>ä¸‹é¢æ˜¯ä¸€äº›æ‡’äººæ•™ç¨‹ï¼Œèƒ½å¤Ÿé€šè¿‡æ¨¡æ¿æˆ–è€…é¢„è®¾å®ŒæˆåŠ¨ç”»</p><p><a href="https://www.bilibili.com/video/BV1JK4y1o712?from=search&amp;seid=15809921384211472980">æ–‡å­—å‡ºå…¥åŠ¨ç”»é¢„è®¾</a>ï¼šæ¨èä½¿ç”¨ glitch smooth</p><p><a href="https://www.bilibili.com/video/BV1QJ411578F?from=search&amp;seid=1184998685891370931">å¿«é€Ÿæ·»åŠ  emoji è¡¨æƒ…</a></p><h2 id="å¸¸ç”¨æ•ˆæœï¼Œè¿›é˜¶å®æˆ˜"><a href="#å¸¸ç”¨æ•ˆæœï¼Œè¿›é˜¶å®æˆ˜" class="headerlink" title="å¸¸ç”¨æ•ˆæœï¼Œè¿›é˜¶å®æˆ˜"></a>å¸¸ç”¨æ•ˆæœï¼Œè¿›é˜¶å®æˆ˜</h2><p><a href="https://www.bilibili.com/video/BV1h7411M7pH?from=search&amp;seid=1594445263778267172">ç®€å•è§†é¢‘è¿‡æ¸¡</a></p><p><a href="https://www.bilibili.com/video/BV1tt411w75b?from=search&amp;seid=14224780402575780190">è£å‰ªï¼Œæ—‹è½¬</a></p><p><a href="https://www.bilibili.com/video/BV1Kb411M7QD?from=search&amp;seid=14224780402575780190">è½¨é“é®ç½©æ•™ç¨‹</a></p><p><a href="https://www.bilibili.com/video/BV1T441177Rz/">ä¸é€æ˜åº¦ï¼Œè’™æ¿é®ç½©è½¬åœº</a></p><p><a href="https://www.bilibili.com/medialist/play/ml1093412053/BV1CX4y1373V">ç»¿å¹•ç´ ææ•™ç¨‹ è¶…çº§é”®</a></p><p><a href="https://www.bilibili.com/video/BV1Kb411M7QD?from=search&amp;seid=14224780402575780190">åŸºç¡€å›¾å½¢å˜æ¢ï¼Œç»ç’ƒåˆ’è¿‡æ•ˆæœ</a></p><p><a href="https://www.bilibili.com/video/BV1Vb411J7q3?from=search&amp;seid=11560949388583323453">æ–‡å­—ä¹¦å†™</a></p><h2 id="vlog-ç´ æåº“"><a href="#vlog-ç´ æåº“" class="headerlink" title="vlog ç´ æåº“"></a>vlog ç´ æåº“</h2><ol><li><p><a href="https://dongmanhuayuan.myheartsite.com/">åŠ¨æ¼«èŠ±å›­é•œåƒç«™</a></p></li><li><p><a href="https://mixkit.co/">mixkit</a></p><p>è§†é¢‘ï¼ŒéŸ³é¢‘ï¼ŒPræ¨¡æ¿èµ„æº</p></li><li><p><a href="https://pixabay.com/zh/">pixabay</a></p><p>è§†é¢‘ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡èµ„æº</p></li><li><p><a href="https://www.iconfont.cn/">iconfont</a></p></li><li><p>vlog éŸ³ä¹èµ„æºï¼šå‚è€ƒ <a href="https://www.bilibili.com/video/BV1uX4y1G7M8?from=search&amp;seid=14857001846860959682">vlog bgm bilibili</a>ï¼Œè¿˜å¯ä»¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•å¤„ç† bgm ä¸äººå£°æ··åˆ</p><p><a href="https://soundcloud.com/lakeyinspired">sound cloud: lakey inspired</a></p><p>å¦‚æœæƒ³è¦ä½¿ç”¨ off vocal music åªéœ€è¦æœç´¢ æ­Œå + instrumental å³å¯</p></li></ol><p>è§†é¢‘ã€éŸ³æ•ˆç´ æå¸Œæœ›è‡ªå·±è¦æœ‰ç›®çš„åœ°å»å¯»æ‰¾ï¼Œä¸ç„¶èµ„æºå†å¤šä¹Ÿæ²¡ç”¨</p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
          <category> Adobe </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Manim Kindergarten æ•™ç¨‹</title>
      <link href="/archives/84b26b6c.html"/>
      <url>/archives/84b26b6c.html</url>
      
        <content type="html"><![CDATA[<h1 id="Manim-æ‹“å±•å­¦ä¹ "><a href="#Manim-æ‹“å±•å­¦ä¹ " class="headerlink" title="Manim æ‹“å±•å­¦ä¹ "></a>Manim æ‹“å±•å­¦ä¹ </h1><p>ç”±äº Manim-Kindergarten çš„ <a href="https://www.bilibili.com/video/BV1p54y197cC?from=search&amp;seid=1264961070490764259">è§†é¢‘æ•™ç¨‹</a> éå¸¸å‹å¥½ï¼Œæ‰€ä»¥æ ¹æ®ä»–ä»¬çš„è§†é¢‘è¿›è¡Œæ•´ç†å’Œå­¦ä¹ ã€‚ä½†æ˜¯ç”±äºæ•™ç¨‹ä¸­ä½¿ç”¨çš„ manim ç‰ˆæœ¬å¹¶ä¸æ˜¯ç¤¾åŒºç‰ˆæœ¬ï¼Œæ‰€æœ‰æ•´ç†çš„å†…å®¹å’ŒåŸæ•™ç¨‹æœ‰æ‰€å‡ºå…¥</p><h2 id="ç¬¬ä¸€è®²-ç‰©ä½“çš„ä½ç½®ä¸åæ ‡å˜æ¢"><a href="#ç¬¬ä¸€è®²-ç‰©ä½“çš„ä½ç½®ä¸åæ ‡å˜æ¢" class="headerlink" title="ç¬¬ä¸€è®² ç‰©ä½“çš„ä½ç½®ä¸åæ ‡å˜æ¢"></a>ç¬¬ä¸€è®² ç‰©ä½“çš„ä½ç½®ä¸åæ ‡å˜æ¢</h2><p>æ€æ ·ç¡®å®šç‰©ä½“çš„åæ ‡ï¼Ÿé¦–å…ˆè¦ç†è§£ manim çš„åæ ‡ä½“ç³»ã€‚</p><ol><li>åœ¨ manim ä¸­ï¼Œä½¿ç”¨ä¸‰ç»´ ndarray è¡¨ç¤ºä¸€ä¸ªç‚¹çš„åæ ‡ <code>np.array([x, y, z])</code>ï¼ŒäºŒç»´åœºæ™¯ä¸­è®¾ <code>z = 0</code></li><li>å•ä½é•¿åº¦å–å†³äº constants.py ä¸­çš„ FRAME_HEIGHTï¼Œç”»é¢çš„å®½åº¦ç”±é«˜åº¦å’Œé•¿å®½æ¯”åŒæ—¶å†³å®šã€‚FRAME_HEIGHT é»˜è®¤å€¼ä¸º8ï¼Œy çš„å˜åŒ–èŒƒå›´åªèƒ½æ˜¯ [-4, 4]</li><li>åœ¨ manim ä¸­ï¼ŒäºŒç»´ç”»é¢ä»¥ä¸­å¿ƒä¸ºåæ ‡åŸç‚¹ï¼Œå‘å³ä¸º x è½´æ­£æ–¹å‘ï¼Œå‘ä¸Šä¸º y è½´æ­£æ–¹å‘</li></ol><p>manim ä¸­å®šä¹‰äº†ä¸€äº›å¸¸ç”¨çš„å•ä½æ–¹å‘å¸¸é‡æ¯”å¦‚ï¼š</p><p>LEFT = <code>np.array([-1, 0, 0])</code></p><p>RIGHT = <code>np.array([1, 0, 0])</code> </p><p>UP = <code>np.array([0, 1, 0])</code></p><p>DOWN = <code>np.array([0, -1, 0])</code></p><h3 id="shift-move-to"><a href="#shift-move-to" class="headerlink" title="shift+move_to"></a>shift+move_to</h3><p>ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æ ¹æ®ä¼ å…¥çš„ vector ç§»åŠ¨ç‰©ä½“ï¼Œshift æ˜¯ç›¸å¯¹ç§»åŠ¨ï¼Œmove_to æ˜¯ç§»åŠ¨åˆ°åæ ‡ç³»ä¸­çš„ç‚¹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># create a mobject 'mob' first</span>mob<span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token operator">*</span>vectors<span class="token punctuation">)</span>mob<span class="token punctuation">.</span>move_to<span class="token punctuation">(</span><span class="token operator">*</span>vectors<span class="token punctuation">,</span> aligned_egde<span class="token punctuation">,</span> coor_mask<span class="token punctuation">)</span><span class="token comment"># corr_mask å¯ä»¥å±è”½æŒ‡å®šæ–¹å‘çš„ç§»åŠ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="scale-amp-stretch-amp-set-width-height"><a href="#scale-amp-stretch-amp-set-width-height" class="headerlink" title="scale &amp; stretch &amp; set_width/height"></a>scale &amp; stretch &amp; set_width/height</h3><p>å¯¹ç‰©ä½“è¿›è¡Œæ”¾å¤§</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">mob<span class="token punctuation">.</span>scale<span class="token punctuation">(</span>factor<span class="token punctuation">,</span> about_egde<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> about_point<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹ç‰©ä½“è¿›è¡Œæ‹‰ä¼¸</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">mob<span class="token punctuation">.</span>stretch<span class="token punctuation">(</span>factor<span class="token punctuation">,</span> dim<span class="token punctuation">)</span>mob<span class="token punctuation">.</span>set_width<span class="token punctuation">(</span>width<span class="token punctuation">,</span> stretch<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>mob<span class="token punctuation">.</span>set_height<span class="token punctuation">(</span>height<span class="token punctuation">,</span> stretch<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="rotate"><a href="#rotate" class="headerlink" title="rotate"></a>rotate</h3><p>æ ¹æ®å³æ‰‹å®šå¾‹è¿›è¡Œæ—‹è½¬ </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># angle éœ€è¦ç”¨ manim ä¸­å®šä¹‰çš„ DEGREES or PI è¿›è¡Œè®¡ç®—</span>mob<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>angle<span class="token punctuation">,</span> axis<span class="token operator">=</span>OUT<span class="token punctuation">,</span> about_point<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="flip"><a href="#flip" class="headerlink" title="flip"></a>flip</h3><p>èƒ½å¤ŸæŒ‡å®šå¯¹ç§°è½´è¿›è¡Œé•œåƒç¿»è½¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">mob<span class="token punctuation">.</span>flip<span class="token punctuation">(</span><span class="token punctuation">)</span>mob<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>axis<span class="token operator">=</span>vector<span class="token punctuation">,</span> about_point<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="align-to-amp-next-to"><a href="#align-to-amp-next-to" class="headerlink" title="align_to &amp; next_to"></a>align_to &amp; next_to</h3><p>åæ ‡å’ŒæŸä¸ªç‰©ä½“å¯¹é½ï¼Œæˆ–è€…åœ¨æŸä¸ªç‰©ä½“çš„ç›¸é‚»ä½ç½®</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># direction is a vector like LEFT, RIGHT, UL</span>mob<span class="token punctuation">.</span>align_to<span class="token punctuation">(</span>mob_or_point<span class="token punctuation">,</span> direction<span class="token punctuation">)</span>mob<span class="token punctuation">.</span>next_to<span class="token punctuation">(</span>mob_or_point<span class="token punctuation">,</span> direction<span class="token punctuation">,</span> aligned_edge<span class="token punctuation">,</span> buff<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç¬¬äºŒè®²-manimå¸¸ç”¨å‡ ä½•ç±»"><a href="#ç¬¬äºŒè®²-manimå¸¸ç”¨å‡ ä½•ç±»" class="headerlink" title="ç¬¬äºŒè®² manimå¸¸ç”¨å‡ ä½•ç±»"></a>ç¬¬äºŒè®² manimå¸¸ç”¨å‡ ä½•ç±»</h2><h3 id="line-amp-arrow"><a href="#line-amp-arrow" class="headerlink" title="line &amp; arrow"></a>line &amp; arrow</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">line <span class="token operator">=</span> Line<span class="token punctuation">(</span>start_point<span class="token punctuation">,</span> end_point<span class="token punctuation">,</span> buff<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>arrow <span class="token operator">=</span> Aroow<span class="token punctuation">(</span>start_point<span class="token punctuation">,</span> end_point<span class="token punctuation">,</span> buff<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> tip_length<span class="token punctuation">)</span><span class="token comment"># buff è°ƒæ•´çš„æ˜¯åˆ°ç›®æ ‡ç‚¹çš„è·ç¦»</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿˜æœ‰å…¶ä»–æ›´å¤šçš„å˜åŒ–ï¼Œæ¯”å¦‚ Dashline Vector</p><h3 id="arc"><a href="#arc" class="headerlink" title="arc"></a>arc</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">arc <span class="token operator">=</span> Arc<span class="token punctuation">(</span>arc_center<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> start_angle<span class="token punctuation">,</span> angle<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="circle-amp-dot-amp-ellipse"><a href="#circle-amp-dot-amp-ellipse" class="headerlink" title="circle &amp; dot &amp; ellipse"></a>circle &amp; dot &amp; ellipse</h3><p>è¿™ä¸‰ç±»å‡ ä½•å›¾å½¢éƒ½æ˜¯ç»§æ‰¿äº arc ç±»ï¼Œæ‰€æœ‰å‚æ•°éƒ½æœ‰ç›¸ä¼¼ä¹‹å¤„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">circle <span class="token operator">=</span> Circle<span class="token punctuation">(</span>arc_center<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> stroke_width<span class="token punctuation">)</span>dot <span class="token operator">=</span> Dot<span class="token punctuation">(</span>arc_center<span class="token punctuation">,</span> radius<span class="token punctuation">)</span>ellipse <span class="token operator">=</span> Ellipse<span class="token punctuation">(</span>arc_center<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="annulus-amp-sector"><a href="#annulus-amp-sector" class="headerlink" title="annulus &amp; sector"></a>annulus &amp; sector</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">annulus <span class="token operator">=</span> Annulus<span class="token punctuation">(</span>outer_radis<span class="token punctuation">,</span> inner_radius<span class="token punctuation">)</span>sector <span class="token operator">=</span> Sector<span class="token punctuation">(</span>outer_radius<span class="token punctuation">,</span> inner_radius<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="polygon-amp-triangle"><a href="#polygon-amp-triangle" class="headerlink" title="polygon &amp; triangle"></a>polygon &amp; triangle</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">triangle <span class="token operator">=</span> Polygon<span class="token punctuation">(</span>point_1<span class="token punctuation">,</span> point_2<span class="token punctuation">,</span> point_3<span class="token punctuation">)</span>triangle <span class="token operator">=</span> Triangle<span class="token punctuation">(</span><span class="token punctuation">)</span>Hexagon <span class="token operator">=</span> RegularPolygon<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯¹äºå¤šè¾¹å½¢è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«çš„æ–¹æ³•ï¼Œå°†é¡¶ç‚¹å˜ä¸ºåœ†å¼§</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># mob is a polygon mobject instance</span>mob<span class="token punctuation">.</span>round_corners<span class="token punctuation">(</span>radius<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="rectangle-amp-square"><a href="#rectangle-amp-square" class="headerlink" title="rectangle &amp; square"></a>rectangle &amp; square</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">rectangle <span class="token operator">=</span> Rectangle<span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>square <span class="token operator">=</span> Square<span class="token punctuation">(</span>side_length<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="VGroup"><a href="#VGroup" class="headerlink" title="VGroup"></a>VGroup</h3><p>è¯¥æ–¹æ³•èƒ½å¤Ÿå°†å¤šä¸ª mobject æ”¾åˆ°ä¸€ä¸ªç»„ä¸­ï¼Œèƒ½å¤Ÿå®ç°ç±»ä¼¼ list çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ç®¡ç†æˆå‘˜ã€åµŒå¥—ï¼ŒåŒæ—¶è¿˜èƒ½ä½¿ç”¨ mobject é€šç”¨æ–¹æ³•</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">vgroup <span class="token operator">=</span> VGroup<span class="token punctuation">(</span>mob0<span class="token punctuation">,</span> mob1<span class="token punctuation">,</span> mob2<span class="token punctuation">)</span>vgroup<span class="token punctuation">.</span>add<span class="token punctuation">(</span>mob3<span class="token punctuation">)</span>vgroup<span class="token punctuation">.</span>add_to_back<span class="token punctuation">(</span>mob4<span class="token punctuation">)</span>vgroup<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>mob2<span class="token punctuation">)</span>vgroup<span class="token punctuation">.</span>shift<span class="token punctuation">(</span>UP<span class="token punctuation">)</span><span class="token comment"># å°†æˆå‘˜æŒ‰ç…§æŸä¸€æ–¹å‘å¯¹é½ï¼Œæœ¬è´¨ä¸Šæ˜¯å®ç°äº† next_to æ–¹æ³•</span>vg<span class="token punctuation">.</span>arrange<span class="token punctuation">(</span>DOWN<span class="token punctuation">,</span> aligned_edge<span class="token operator">=</span>LEFT<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¬¬ä¸‰è®²-é¢œè‰²çš„è¡¨ç¤ºã€è¿ç®—ä¸è®¾ç½®"><a href="#ç¬¬ä¸‰è®²-é¢œè‰²çš„è¡¨ç¤ºã€è¿ç®—ä¸è®¾ç½®" class="headerlink" title="ç¬¬ä¸‰è®² é¢œè‰²çš„è¡¨ç¤ºã€è¿ç®—ä¸è®¾ç½®"></a>ç¬¬ä¸‰è®² é¢œè‰²çš„è¡¨ç¤ºã€è¿ç®—ä¸è®¾ç½®</h2><h3 id="é¢œè‰²çš„è¡¨ç¤º"><a href="#é¢œè‰²çš„è¡¨ç¤º" class="headerlink" title="é¢œè‰²çš„è¡¨ç¤º"></a>é¢œè‰²çš„è¡¨ç¤º</h3><p>æœ‰ä¸‰ç§è¡¨ç¤ºæ–¹æ³•</p><ol><li><p>å®šä¹‰çš„å¸¸é‡ï¼Œå¦‚ä¸‹å›¾</p></li><li><p>åå…­è¿›åˆ¶ï¼Œå½¢å¦‚ #66CCFF</p></li><li><p>RGBæ•°ç»„ï¼Œå½¢å¦‚ np.array([255, 104, 100])</p></li></ol><p><img src="/archives/84b26b6c/image-20210729201211734.png" style="zoom: 20%;"></p><p>ä½†æ‰€æœ‰çš„è¡¨ç¤ºæ–¹æ³•ï¼Œåœ¨ manim ä¸­æœ€ç»ˆéƒ½ä¼šè½¬åŒ–ä¸º Color ç±»</p><p><strong>æ¨èä½¿ç”¨å¸¸é‡æˆ–è€…åå…­è¿›åˆ¶æ¥è¡¨ç¤ºé¢œè‰²</strong></p><h3 id="é¢œè‰²çš„è¿ç®—"><a href="#é¢œè‰²çš„è¿ç®—" class="headerlink" title="é¢œè‰²çš„è¿ç®—"></a>é¢œè‰²çš„è¿ç®—</h3><p>åˆ—å‡ ä¸ªå¸¸è§çš„è¿ç®—</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åè‰²</span>invert_color<span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token comment"># æ’å€¼</span>interpolate_color<span class="token punctuation">(</span>color_1<span class="token punctuation">,</span> color_2<span class="token punctuation">,</span> ratio<span class="token punctuation">)</span><span class="token comment"># å¹³å‡</span>average_color<span class="token punctuation">(</span><span class="token operator">*</span>colors<span class="token punctuation">)</span><span class="token comment"># æ¢¯åº¦</span>color_gradient<span class="token punctuation">(</span><span class="token punctuation">[</span>color_1<span class="token punctuation">,</span> color_2<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token comment"># éšæœº</span>random_color<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/archives/84b26b6c/image-20210729203331953.png" alt="color_gradient" style="zoom:25%;"></p><h3 id="ç‰©ä½“é¢œè‰²è®¾ç½®"><a href="#ç‰©ä½“é¢œè‰²è®¾ç½®" class="headerlink" title="ç‰©ä½“é¢œè‰²è®¾ç½®"></a>ç‰©ä½“é¢œè‰²è®¾ç½®</h3><p>stroke ä»£è¡¨è¾¹æ¡†ç€è‰²ï¼Œfill ä»£è¡¨å†…éƒ¨ç€è‰²</p><div class="table-container"><table><thead><tr><th>stroke</th><th>fill</th></tr></thead><tbody><tr><td>stroke_color</td><td>fill_color</td></tr><tr><td>stroke_opacity</td><td>fill_opacity</td></tr></tbody></table></div><p>ä¸Šé¢çš„å±æ€§éƒ½å¯ä»¥é€šè¿‡ set_stroke/fill æ¥æ›´æ”¹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">mob<span class="token punctuation">.</span>set_stroke<span class="token punctuation">(</span>color<span class="token punctuation">,</span> width<span class="token punctuation">)</span>mob<span class="token punctuation">.</span>set_fill<span class="token punctuation">(</span>color<span class="token punctuation">,</span> opacity<span class="token punctuation">)</span>mob<span class="token punctuation">.</span>set_fill<span class="token punctuation">(</span><span class="token punctuation">[</span>color_1<span class="token punctuation">,</span> color_2<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> opacity<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ç»™-VGroup-å­ç‰©ä½“ä¸Šè‰²"><a href="#ç»™-VGroup-å­ç‰©ä½“ä¸Šè‰²" class="headerlink" title="ç»™ VGroup å­ç‰©ä½“ä¸Šè‰²"></a>ç»™ VGroup å­ç‰©ä½“ä¸Šè‰²</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># vg is a VGroup instance</span>vg<span class="token punctuation">.</span>set_color<span class="token punctuation">(</span>color<span class="token punctuation">)</span>vg<span class="token punctuation">.</span>set_color_by_gradient<span class="token punctuation">(</span><span class="token operator">*</span>colors<span class="token punctuation">)</span>vg<span class="token punctuation">.</span>set_colors_by_radial_gradient<span class="token punctuation">(</span>radius<span class="token punctuation">,</span> inner_color<span class="token punctuation">,</span> outer_color<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™äº›æ“ä½œéƒ½æ˜¯ <code>VMobject</code> çš„å†…ç½®æ–¹æ³•ï¼Œæ˜¯ä¸€ç§é€šç”¨çš„æ–¹æ³•ï¼Œè€Œä¸”è¿™äº›æ–¹æ³•ä¸ä»…ä»…å¯ä»¥è®¾ç½® <code>stroke</code> çš„é¢œè‰²ï¼Œä¹Ÿå¯ä»¥è®¾ç½® <code>width, opacity...</code></p><h2 id="ç¬¬å››è®²-æ’å…¥SVGã€å›¾ç‰‡ä¸æ–‡å­—"><a href="#ç¬¬å››è®²-æ’å…¥SVGã€å›¾ç‰‡ä¸æ–‡å­—" class="headerlink" title="ç¬¬å››è®² æ’å…¥SVGã€å›¾ç‰‡ä¸æ–‡å­—"></a>ç¬¬å››è®² æ’å…¥SVGã€å›¾ç‰‡ä¸æ–‡å­—</h2><h3 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h3><p>åœ¨ manim æ’å…¥å›¾ç‰‡éœ€è¦å…ˆå°†å›¾ç‰‡æ”¾åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹ï¼Œæˆ–è€…ä½¿ç”¨ <code>config.assets_dir</code> æŒ‡å®šç´ ææ–‡ä»¶å¤¹ã€‚ä¸åŒçš„å›¾ç‰‡ç±»å‹åˆ™ä½¿ç”¨ä¸åŒçš„å¯¹è±¡è¿›è¡Œå­˜å‚¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># SVG</span>mob <span class="token operator">=</span> SVGMobject<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token comment"># image: jpg, png, gif</span>mob <span class="token operator">=</span> ImageMobject<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>SVGMobject</code> æ˜¯ <code>VMobject</code> çš„å­ç±»ï¼Œå¯ä»¥ä½¿ç”¨å…¶æ‰€æœ‰åŠ¨ç”»ï¼Œä½† <code>ImageMobject</code> ä»…èƒ½ä½¿ç”¨éƒ¨åˆ†åŠ¨ç”»ï¼Œå¦‚ï¼šFadeIn</p><h3 id="æ–‡å­—ä¸å…¬å¼"><a href="#æ–‡å­—ä¸å…¬å¼" class="headerlink" title="æ–‡å­—ä¸å…¬å¼"></a>æ–‡å­—ä¸å…¬å¼</h3><p>åœ¨ manim ä¸­å¯ä»¥ä½¿ç”¨ <code>Text</code> åˆ›å»ºæ™®é€šæ–‡å­—å¯¹è±¡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">text <span class="token operator">=</span> Text<span class="token punctuation">(</span><span class="token operator">*</span>strings<span class="token punctuation">,</span> color<span class="token punctuation">,</span> font<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥ä¼ å…¥å¤šä¸ªå­—ç¬¦ä¸²ï¼ŒåŒæ · <code>Text</code> ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰€æœ‰åŠ¨ç”»ã€‚å¦‚æœæƒ³è¦ä½¿ç”¨ LaTeX è¯­æ³•ä¹¦å†™æ–‡å­—å’Œå…¬å¼ï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>Tex, MathTex</code> ç±»</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">text <span class="token operator">=</span> Tex<span class="token punctuation">(</span><span class="token operator">*</span>raw_strings<span class="token punctuation">)</span>formula <span class="token operator">=</span> MathTex<span class="token punctuation">(</span><span class="token operator">*</span>raw_strings<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€æœ‰çš„æ–‡å­—å’Œå…¬å¼éƒ½æ˜¯ä¸€ä¸ª <code>VGroup</code>ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•æ¥å¯¹æ¯ä¸ªå­—ç¬¦å•ç‹¬æ“ä½œ</p><h2 id="ç¬¬äº”è®²-åæ ‡ç³»ç»Ÿä¸æ–¹ç¨‹"><a href="#ç¬¬äº”è®²-åæ ‡ç³»ç»Ÿä¸æ–¹ç¨‹" class="headerlink" title="ç¬¬äº”è®² åæ ‡ç³»ç»Ÿä¸æ–¹ç¨‹"></a>ç¬¬äº”è®² åæ ‡ç³»ç»Ÿä¸æ–¹ç¨‹</h2><h3 id="åæ ‡è½´"><a href="#åæ ‡è½´" class="headerlink" title="åæ ‡è½´"></a>åæ ‡è½´</h3><p>åœ¨ manim ä¸­å¯ä»¥æ’å…¥åæ ‡è½´</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># NumberLine</span><span class="token comment"># x_range æ ‡æ˜æ•°å‘¨çš„èŒƒå›´ä»¥åŠæ­¥é•¿</span>line <span class="token operator">=</span> NumberLine<span class="token punctuation">(</span>        numberline <span class="token operator">=</span> NumberLine<span class="token punctuation">(</span>            x_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            length<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>            include_numbers<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>            include_ticks<span class="token operator">=</span><span class="token boolean">False</span>        <span class="token punctuation">)</span><span class="token comment"># Axes</span><span class="token comment"># åˆ†åˆ«è®¾ç½® x, y åæ ‡è½´ï¼Œå…·ä½“å‚æ•°æ‰“åŒ…ä¸ºå­—å…¸ï¼Œå…³é”®å­—åŒ NumberLine</span>axes <span class="token operator">=</span> Axes<span class="token punctuation">(</span>            x_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            y_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            axis_config<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>                include_numbers<span class="token operator">=</span><span class="token boolean">True</span>            <span class="token punctuation">)</span>        <span class="token punctuation">)</span><span class="token comment"># NumberPlane</span><span class="token comment"># æ³¨æ„è¿™é‡Œçš„æ­¥é•¿æ˜¯æŒ‡æ•°è½´çš„æ•°é‡</span>number_plane <span class="token operator">=</span> NumberPlane<span class="token punctuation">(</span>            x_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            y_range<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            background_line_style<span class="token operator">=</span><span class="token punctuation">{</span>                <span class="token string">"stroke_color"</span><span class="token punctuation">:</span> TEAL<span class="token punctuation">,</span>                <span class="token string">"stroke_width"</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>                <span class="token string">"stroke_opacity"</span><span class="token punctuation">:</span> <span class="token number">0.6</span>            <span class="token punctuation">}</span>        <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–¹ç¨‹"><a href="#æ–¹ç¨‹" class="headerlink" title="æ–¹ç¨‹"></a>æ–¹ç¨‹</h3><p>ä½¿ç”¨ <code>ParametricFunction</code> å¯ä»¥æ˜¾ç¤ºå‡½æ•°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å•å˜é‡æ–¹ç¨‹ï¼Œè¿”å›ä¸‰ç»´ ndarray</span><span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    func <span class="token operator">=</span> ParametricFunction<span class="token punctuation">(</span>self<span class="token punctuation">.</span>func<span class="token punctuation">,</span> t_range <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> TAU<span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span>RED<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>func<span class="token punctuation">.</span>scale<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p>ManimCE æ–‡æ¡£æœ‰ä¸€ä¸ª <a href="https://docs.manim.community/en/stable/reference.html">reference manual</a>ï¼Œå®˜æ–¹æè¿°è¿™ä¸ªæ‰‹å†Œçš„åŠŸèƒ½ï¼š</p><blockquote><p>This reference manual details modules, functions, and variables included in Manim, describing what they are and what they do. </p></blockquote><p>é‡Œé¢åŒ…å«äº†å„ç§æ¨¡å—å’Œå‡½æ•°ï¼Œæ›´å¤šçš„ <code>VMobject</code> å’Œæ›´å¤šçš„åŠ¨ç”»æ“ä½œï¼Œæ–‡æ¡£ä¸­è¿˜æœ‰ <a href="https://docs.manim.community/en/stable/examples.html">Example Gallery</a> æä¾›å‚è€ƒ</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Manim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Manim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pytorch tutorial</title>
      <link href="/archives/6c437432.html"/>
      <url>/archives/6c437432.html</url>
      
        <content type="html"><![CDATA[<h1 id="Pytorch-Tutorial"><a href="#Pytorch-Tutorial" class="headerlink" title="Pytorch Tutorial"></a>Pytorch Tutorial</h1><p><a href="https://pytorch.org/tutorials/">å®˜æ–¹ tutorial</a> <a href="https://pytorch.org/tutorials/beginner/ptcheat.html#">å®˜æ–¹ Cheat Sheet</a></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><p>è¿™éƒ¨åˆ†å¯ä»¥çœ‹åˆ°æ•´ä¸ª pytorch çš„ workflow</p><ol><li><p>Working with Data</p><p>pytorch æä¾›ä¸€äº›å°çš„æ•°æ®é›†ç”¨äºè®­ç»ƒå’Œæµ‹è¯•ã€‚å¯¹äºè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„æ¨¡å— <code>TorchVision</code> åŒ…å«äº†ä¸€äº›å¸¸ç”¨æ•°æ®é›†ã€æ¨¡å‹å’Œè½¬æ¢å‡½æ•°ç­‰ç­‰ã€‚è£…è½½æ•°æ®é›†åˆ™ä½¿ç”¨ dataset, dataloader ç±»</p></li><li><p>Creating Models</p><p>ç»§æ‰¿ nn.Module ç±»ï¼Œåˆå§‹åŒ–ç›¸å…³æ¨¡å—ï¼Œå†™å¥½å‘å‰æ–¹ç¨‹</p></li><li><p>Optimizing</p><p>å®šä¹‰æŸå¤±å‡½æ•°ï¼Œå†ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œä¼˜åŒ–</p></li><li><p>Saving &amp; Loading Models</p><p>ä¿å­˜æ¨¡å‹ï¼Œä»¥åŠè®­ç»ƒå¥½çš„å‚æ•°ï¼Œæ–¹ä¾¿ä¹‹åæµ‹è¯•å’ŒåŠ è½½</p></li></ol><h2 id="Tensor"><a href="#Tensor" class="headerlink" title="Tensor"></a>Tensor</h2><blockquote><p>Tensors are similar to <a href="https://numpy.org/">NumPyâ€™s</a> ndarrays, except that tensors can run on GPUs or other hardware accelerators. In fact, tensors and NumPy arrays can often share the same underlying memory, eliminating the need to copy data (see <a href="https://pytorch.org/tutorials/beginner/blitz/tensor_tutorial.html#bridge-to-np-label">Bridge with NumPy</a>). Tensors are also optimized for automatic differentiation</p></blockquote><p>ä»ä»¥ä¸Šçš„æè¿°æ¥çœ‹ Tensor æ•°æ®ç±»å‹æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p><ol><li>èƒ½å¤Ÿåœ¨ GPU ä¸Šè¿›è¡Œè®¡ç®—</li><li>èƒ½å¤Ÿè‡ªåŠ¨å¾®åˆ†</li></ol><p>å¦‚æœç†Ÿæ‚‰ Numpy çš„è¯ï¼Œå­¦ä¹  Tensor å°†ä¼šå˜å¾—æ›´åŠ è½»æ¾ã€‚è®¡åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†å­¦ä¹  Tensorï¼š</p><ol><li>åˆ›å»º Tensor</li><li>Tensor çš„å±æ€§</li><li>Tensor å†…ç½®æ–¹æ³•</li></ol><h3 id="åˆ›å»º-Tensor"><a href="#åˆ›å»º-Tensor" class="headerlink" title="åˆ›å»º Tensor"></a>åˆ›å»º Tensor</h3><p>å‚è€ƒ Cheat Sheet </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch <span class="token keyword">import</span> numpy <span class="token keyword">as</span> npx <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token operator">*</span>size<span class="token punctuation">)</span>              <span class="token comment"># tensor with independent N(0,1) entries</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span><span class="token punctuation">[</span>ones<span class="token operator">|</span>zeros<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">*</span>size<span class="token punctuation">)</span>       <span class="token comment"># tensor with all 1's [or 0's]</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>L<span class="token punctuation">)</span>                 <span class="token comment"># create tensor from [nested] list or ndarray L</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>                       <span class="token comment"># clone of x</span><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment"># code wrap that stops autograd from tracking tensor history</span>requires_grad<span class="token operator">=</span><span class="token boolean">True</span>                  <span class="token comment"># arg, when set to True, tracks computation</span>                                    <span class="token comment"># history for future derivative calculations</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»º tensor å’Œåˆ›å»º ndarray æ˜¯ç›¸ä¼¼çš„ã€‚æ—¢å¯ä»¥ç”ŸæˆæŒ‡å®šåˆ†å¸ƒçš„ tensorï¼Œä¹Ÿå¯ä»¥ä» ndarray ä¸­åˆ›å»ºã€‚ç”±äº tensor å’Œ ndarray å…³ç³»å¯†åˆ‡ï¼Œå®ƒä»¬ä¹‹é—´çš„è½¬æ¢ä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚åŒæ—¶ tensor å’Œ numpy ä¹Ÿæ˜¯å…±ç”¨å†…å­˜çš„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># tensor è½¬åŒ–ä¸º ndarray</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>n <span class="token operator">=</span> x<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token comment"># è¯¥æ“ä½œä¼šæ”¹å˜ x</span><span class="token comment"># ndarray è½¬åŒ–ä¸º tensor</span>n <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Tensor-çš„å±æ€§"><a href="#Tensor-çš„å±æ€§" class="headerlink" title="Tensor çš„å±æ€§"></a>Tensor çš„å±æ€§</h3><p>ä¸»è¦ç”¨3ä¸ªå±æ€§ï¼šshape, dtype, deviece</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token comment"># f"string" ä»£è¡¨æ ¼å¼åŒ–ï¼Œç±»ä¼¼ str.format()</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Shape of tensor: </span><span class="token interpolation"><span class="token punctuation">{</span>tensor<span class="token punctuation">.</span>shape<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Datatype of tensor: </span><span class="token interpolation"><span class="token punctuation">{</span>tensor<span class="token punctuation">.</span>dtype<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Device tensor is stored on: </span><span class="token interpolation"><span class="token punctuation">{</span>tensor<span class="token punctuation">.</span>device<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Tensor-å†…ç½®æ–¹æ³•"><a href="#Tensor-å†…ç½®æ–¹æ³•" class="headerlink" title="Tensor å†…ç½®æ–¹æ³•"></a>Tensor å†…ç½®æ–¹æ³•</h3><blockquote><p>Over 100 tensor operations, including arithmetic, linear algebra, matrix manipulation (transposing, indexing, slicing), sampling and more are comprehensively described <a href="https://pytorch.org/docs/stable/torch.html">here</a>.</p></blockquote><p>è¿˜æ˜¯åˆ†æ¨¡å—æ¥æ¥æ‹›è¿™äº›å†…ç½®æ–¹æ³•</p><h4 id="Standard-numpy-like-indexing-and-slicing"><a href="#Standard-numpy-like-indexing-and-slicing" class="headerlink" title="Standard numpy-like indexing and slicing"></a>Standard numpy-like indexing and slicing</h4><p>tensor çš„ç´¢å¼•å’Œ ndarray çš„ç´¢å¼•æ˜¯ç›¸åŒçš„ï¼ŒåŒ…æ‹¬å¤šå…ƒç´¢å¼•ã€å¸ƒå°”ç´¢å¼•ã€èŠ±å¼ç´¢å¼•ï¼Œå‚è€ƒæ•´ç†çš„ numpy cheat sheet</p><h4 id="Move-tensors-to-GPU"><a href="#Move-tensors-to-GPU" class="headerlink" title="Move tensors to GPU"></a>Move tensors to GPU</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># We move our tensor to the GPU if available</span><span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tensor <span class="token operator">=</span> tensor<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">'cuda'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="Dimensionality"><a href="#Dimensionality" class="headerlink" title="Dimensionality"></a>Dimensionality</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>                                  <span class="token comment"># return tuple-like object of dimensions</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>tensor_seq<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>          <span class="token comment"># concatenates tensors along dim</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>                       <span class="token comment"># reshapes x into size (a,b,...)</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>                          <span class="token comment"># reshapes x into size (b,a) for some b</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>                      <span class="token comment"># swaps dimensions a and b</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token operator">*</span>dims<span class="token punctuation">)</span>                      <span class="token comment"># permutes dimensions</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>dim<span class="token punctuation">)</span>                      <span class="token comment"># tensor with added axis</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>                    <span class="token comment"># (a,b,c) tensor -&gt; (a,b,1,c) tensor</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span>                           <span class="token comment"># removes all dimensions of size 1 (a,1,b,1) -&gt; (a,b)</span>y <span class="token operator">=</span> x<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>                      <span class="token comment"># removes specified dimension of size 1 (a,1,b,1) -&gt; (a,b,1)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Algebra"><a href="#Algebra" class="headerlink" title="Algebra"></a>Algebra</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">ret <span class="token operator">=</span> A<span class="token punctuation">.</span>mm<span class="token punctuation">(</span>B<span class="token punctuation">)</span>       <span class="token comment"># matrix multiplication</span>ret <span class="token operator">=</span> A<span class="token punctuation">.</span>mv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>       <span class="token comment"># matrix-vector multiplication</span>ret <span class="token operator">=</span> y<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x<span class="token punctuation">)</span>      <span class="token comment"># Computes the dot product of two 1D tensors</span>x <span class="token operator">=</span> x<span class="token punctuation">.</span>t<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment"># matrix transpose</span><span class="token comment"># This computes the element-wise product</span>z1 <span class="token operator">=</span> tensor_1 <span class="token operator">*</span> tensor_2<span class="token comment"># convert one element tensor to a Python numerical value</span>x<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="GPU-Usage"><a href="#GPU-Usage" class="headerlink" title="GPU Usage"></a>GPU Usage</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token comment"># check for cuda</span>torch<span class="token punctuation">.</span>version<span class="token punctuation">.</span>cuda<span class="token comment"># check version</span>torch<span class="token punctuation">.</span>__version__<span class="token comment"># check torch version</span>x <span class="token operator">=</span> x<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># move x's data from CPU to GPU and return new object</span>x <span class="token operator">=</span> x<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># move x's data from GPU to CPU and return new object</span><span class="token keyword">if</span> <span class="token keyword">not</span> args<span class="token punctuation">.</span>disable_cuda <span class="token keyword">and</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token comment"># device agnostic code and modularity</span>    args<span class="token punctuation">.</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cuda'</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>                                                           args<span class="token punctuation">.</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">)</span>                       net<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token comment"># recursively convert their parameters and buffers to device specific tensors</span>x <span class="token operator">=</span> x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token comment"># copy your tensors to a device (gpu, cpu)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Datasets-amp-DataLoader"><a href="#Datasets-amp-DataLoader" class="headerlink" title="Datasets &amp; DataLoader"></a>Datasets &amp; DataLoader</h2><blockquote><p>Code for processing data samples can get messy and hard to maintain; we ideally want our dataset code to be decoupled from our model training code for better readability and modularity. PyTorch provides two data primitives: <code>torch.utils.data.DataLoader</code> and <code>torch.utils.data.Dataset</code> that allow you to use pre-loaded datasets as well as your own data. </p></blockquote><p>Dataset ç±»å­˜å‚¨äº†æ•°æ®é›†çš„è·¯å¾„ï¼Œå¹¶ä¸”å®šä¹‰äº† <code>__getitem__</code> æ–¹æ³•æ¥è·å–å•ä¸ªæ•°æ®é›†åŠå…¶å¯¹åº”æ ‡ç­¾ã€‚è€Œ DataLoder åˆ™å°†æ•°æ®é›†æ‰“åŒ…å½¢æˆä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæ–¹ä¾¿ä¸åŒæ–¹å¼çš„éå†</p><h3 id="è½½å…¥-torchvision-ä¸­çš„æ•°æ®é›†"><a href="#è½½å…¥-torchvision-ä¸­çš„æ•°æ®é›†" class="headerlink" title="è½½å…¥ torchvision ä¸­çš„æ•°æ®é›†"></a>è½½å…¥ torchvision ä¸­çš„æ•°æ®é›†</h3><p>å…ˆä»‹ç»å¦‚ä½•ä» <code>torchvision</code> ä¸­è½½å…¥å®˜æ–¹æ•°æ®é›† <code>Fashion-MNIST</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> torchvision <span class="token keyword">import</span> datasets<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensortraining_data <span class="token operator">=</span> datasets<span class="token punctuation">.</span>FashionMNIST<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">"data"</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_data <span class="token operator">=</span> datasets<span class="token punctuation">.</span>FashionMNIST<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">"data"</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚æ•°çš„è¯´æ˜å¦‚ä¸‹ï¼š</p><ul><li><code>root</code> is the path where the train/test data is stored,</li><li><code>train</code> specifies training or test dataset,</li><li><code>download=True</code> downloads the data from the internet if itâ€™s not available at <code>root</code>.</li><li><code>transform</code> and <code>target_transform</code> specify the feature and label transformations</li></ul><p>ç”¨ <code>matplotlib</code> æ¥å±•ç¤ºæ•°æ®é›†ä¸­çš„éƒ¨åˆ†å›¾åƒï¼Œçœ‹èƒ½ä¸èƒ½æ­£å¸¸å·¥ä½œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltlabels_map <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"T-Shirt"</span><span class="token punctuation">,</span>    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"Trouser"</span><span class="token punctuation">,</span>    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"Pullover"</span><span class="token punctuation">,</span>    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"Dress"</span><span class="token punctuation">,</span>    <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"Coat"</span><span class="token punctuation">,</span>    <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"Sandal"</span><span class="token punctuation">,</span>    <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"Shirt"</span><span class="token punctuation">,</span>    <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"Sneaker"</span><span class="token punctuation">,</span>    <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"Bag"</span><span class="token punctuation">,</span>    <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"Ankle Boot"</span><span class="token punctuation">,</span><span class="token punctuation">}</span>figure <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cols<span class="token punctuation">,</span> rows <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> cols <span class="token operator">*</span> rows <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sample_idx <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>training_data<span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>    img<span class="token punctuation">,</span> label <span class="token operator">=</span> training_data<span class="token punctuation">[</span>sample_idx<span class="token punctuation">]</span>    figure<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span>rows<span class="token punctuation">,</span> cols<span class="token punctuation">,</span> i<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>labels_map<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"gray"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœå½¢å¦‚ä¸‹é¢çš„å›¾ç‰‡</p><p><img src="/archives/6c437432/sphx_glr_data_tutorial_001.png" style="zoom: 50%;"></p><h3 id="è½½å…¥è‡ªå®šä¹‰æ•°æ®é›†"><a href="#è½½å…¥è‡ªå®šä¹‰æ•°æ®é›†" class="headerlink" title="è½½å…¥è‡ªå®šä¹‰æ•°æ®é›†"></a>è½½å…¥è‡ªå®šä¹‰æ•°æ®é›†</h3><blockquote><p>A custom Dataset class must implement three functions: <code>__init__</code>, <code>__len__</code>, and <code>__getitem__</code>. </p></blockquote><ol><li><p><code>__init__</code></p><p>åˆå§‹åŒ–åŒ…å«å›¾åƒã€æ³¨é‡Šæ–‡ä»¶çš„ç›®å½•ï¼Œä»¥åŠå¯¹æ•°æ®é›†çš„ transform </p></li><li><p><code>__len__</code></p><p>è¿”å›æ•°æ®é›†æ ·æœ¬ä¸ªæ•°</p></li><li><p><code>__getitem__</code></p><p>è¯¥å‡½æ•°è¿”å›æ•°æ®é›†ä¸­ç´¢å¼•ä¸º idx çš„æ ·æœ¬åŠå…¶å¯¹åº”æ ‡ç­¾</p></li></ol><p>ä¸‹é¢é€šè¿‡ä¸€æ®µä»£ç æ¥å…·ä½“çœ‹çœ‹è¿™äº›å‡½æ•°çš„å®ç°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>io <span class="token keyword">import</span> read_image<span class="token keyword">class</span> <span class="token class-name">CustomImageDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> annotations_file<span class="token punctuation">,</span> img_dir<span class="token punctuation">,</span> transform<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> target_transform<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>img_labels <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>annotations_file<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>img_dir <span class="token operator">=</span> img_dir        self<span class="token punctuation">.</span>transform <span class="token operator">=</span> transform        self<span class="token punctuation">.</span>target_transform <span class="token operator">=</span> target_transform    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_labels<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>        img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_dir<span class="token punctuation">,</span> self<span class="token punctuation">.</span>img_labels<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>idx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        image <span class="token operator">=</span> read_image<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span>        label <span class="token operator">=</span> self<span class="token punctuation">.</span>img_labels<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>idx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>transform<span class="token punctuation">:</span>            image <span class="token operator">=</span> self<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>image<span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>target_transform<span class="token punctuation">:</span>            label <span class="token operator">=</span> self<span class="token punctuation">.</span>target_transform<span class="token punctuation">(</span>label<span class="token punctuation">)</span>        <span class="token keyword">return</span> image<span class="token punctuation">,</span> label<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºä¸»è¦æ€è·¯å°±æ˜¯ç»§æ‰¿åŸ <code>Dataset</code> ç±»ï¼Œç„¶åæ”¹å†™äº†ä¸Šé¢æåˆ°çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œè¿™ä¹Ÿä½“ç°äº†é¢å‘å¯¹è±¡çš„å¤šæ€æ€§</p><h3 id="Transforms"><a href="#Transforms" class="headerlink" title="Transforms"></a>Transforms</h3><blockquote><p> We use <strong>transforms</strong> to perform some manipulation of the data and make it suitable for training. The <a href="https://pytorch.org/vision/stable/transforms.html">torchvision.transforms</a> module offers several commonly-used transforms out of the box.</p></blockquote><p>æ•°æ®å¢å¼ºæ˜¯æå‡è¡¨ç°çš„å¸¸ç”¨æ‰‹æ®µï¼Œå¯ä»¥é€šè¿‡å¯¹æ•°æ®é›†è¿›è¡Œ transform å®Œæˆã€‚æ–‡æ¡£ä¸¾äº†ä¸¤ä¸ªéå¸¸ç®€å•çš„ transform ä¾‹å­ï¼Œæ›´å¤šçš„åº”ç”¨è¿˜æ˜¯éœ€è¦ç»“åˆå…·ä½“è®ºæ–‡å…·ä½“å®è·µï¼š</p><ol><li><a href="https://pytorch.org/vision/stable/transforms.html#torchvision.transforms.ToTensor">ToTensor</a> converts a PIL image or NumPy <code>ndarray</code> into a <code>FloatTensor</code>. and scales the imageâ€™s pixel intensity values in the range [0., 1.]</li><li>Lambda transforms apply any user-defined lambda function. Here, we define a function to turn the integer into a one-hot encoded tensor. </li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> datasets<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensor<span class="token punctuation">,</span> Lambdads <span class="token operator">=</span> datasets<span class="token punctuation">.</span>FashionMNIST<span class="token punctuation">(</span>    root<span class="token operator">=</span><span class="token string">"data"</span><span class="token punctuation">,</span>    train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    transform<span class="token operator">=</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    target_transform<span class="token operator">=</span>Lambda<span class="token punctuation">(</span><span class="token keyword">lambda</span> y<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">.</span>scatter_<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨-DataLoader-è¿›è¡Œè¿­ä»£"><a href="#ä½¿ç”¨-DataLoader-è¿›è¡Œè¿­ä»£" class="headerlink" title="ä½¿ç”¨ DataLoader è¿›è¡Œè¿­ä»£"></a>ä½¿ç”¨ DataLoader è¿›è¡Œè¿­ä»£</h3><p>å°† dataset ä¼ å…¥ DataLoader å½“ä¸­ï¼Œå½¢æˆå¯è¿­ä»£å¯¹è±¡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoadertrain_dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>training_data<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœéœ€è¦æ›´å¤æ‚çš„å–æ ·ï¼Œåˆ™éœ€è¦ <a href="https://pytorch.org/docs/stable/data.html#data-loading-order-and-sampler">Samplers</a>ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ª sampler çš„å­ç±»è¿›è¡Œè¯´æ˜</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>sampler <span class="token keyword">import</span> SubsetRandomSamplerNUM_TRAIN <span class="token operator">=</span> <span class="token number">5000</span>sampler <span class="token operator">=</span> SubsetRandomSampler<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>NUM_TRAIN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ä»…é‡‡æ ·å‰ 5000 ä¸ªæ ·æœ¬ä½œä¸ºè®­ç»ƒé›†</span>train_dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>training_data<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> sampler<span class="token operator">=</span>sampler<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨åˆ›å»ºå¥½ dataloader å®ä¾‹è¿‡åï¼Œç”±äºå…¶æ˜¯è¿­ä»£å™¨å¯¹è±¡ï¼Œä»¥é€šè¿‡å¾ªç¯è¿›è¡Œè¿­ä»£ã€‚è¿­ä»£å™¨è¿”å›å¯¹è±¡ä¸ºä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„æˆå‘˜ä¸ºæ•°æ®é›†åˆ—è¡¨å’Œå…¶å¯¹åº”çš„æ ‡ç­¾åˆ—è¡¨ã€‚ä¸‹é¢ç”¨ <code>next &amp; iter</code> æŸ¥çœ‹è¿­ä»£å™¨è¿”å›çš„ç¬¬ä¸€ä¸ªå¯¹è±¡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_features<span class="token punctuation">,</span> train_labels <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>train_dataloader<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Feature batch shape: </span><span class="token interpolation"><span class="token punctuation">{</span>train_features<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Labels batch shape: </span><span class="token interpolation"><span class="token punctuation">{</span>train_labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>img <span class="token operator">=</span> train_features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span>label <span class="token operator">=</span> train_labels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"gray"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Label: </span><span class="token interpolation"><span class="token punctuation">{</span>label<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token comment"># Output</span><span class="token comment"># Feature batch shape: torch.Size([64, 1, 28, 28])</span><span class="token comment"># Labels batch shape: torch.Size([64])</span><span class="token comment"># Label: 9</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/archives/6c437432/sphx_glr_data_tutorial_002.png" style="zoom:72%;"></p><h2 id="Build-Models"><a href="#Build-Models" class="headerlink" title="Build Models"></a>Build Models</h2><blockquote><p>Neural networks comprise of layers/modules that perform operations on data. The <a href="https://pytorch.org/docs/stable/nn.html">torch.nn</a> namespace provides all the building blocks you need to build your own neural network. </p><p>Every module in PyTorch subclasses the <a href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html">nn.Module</a>. A neural network is a module itself that consists of other modules (layers). This nested structure allows for building and managing complex architectures easily.</p></blockquote><p>å»ºé€ ç½‘ç»œæ¨¡å‹çš„é€»è¾‘ä¸»è¦ä¸ºï¼š</p><ol><li>ç»§æ‰¿ <code>nn.Module</code> ç±»ï¼Œè¿™æ˜¯æ‰€æœ‰ç½‘ç»œçš„åŸºç±»ã€‚è®©è‡ªå®šä¹‰çš„æ¨¡å‹èƒ½å¤Ÿä½¿ç”¨åŸºç±»çš„æ–¹æ³•ï¼Œä¾¿äºç®¡ç†æ¨¡å‹æ¡†æ¶ï¼Œä¾‹å¦‚ï¼šæ‰§è¡Œå‘å‰è·¯å¾„ã€ç®¡ç†æ¨¡å‹å‚æ•°åŠæ¢¯åº¦ã€æ‰“å°æ¨¡å‹æ¨¡å—ã€æ¨¡å‹åµŒå¥—ç­‰ç­‰</li><li>é‡å†™ <code>__init__</code> æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­å®šä¹‰éœ€è¦çš„æ¨¡å—</li><li>é‡å†™ <code>forward</code> æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­å®šä¹‰å‘å‰è®¡ç®—çš„è·¯å¾„</li></ol><p>ä¸‹é¢ä¸¾ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œçœ‹çœ‹å…·ä½“å®ç°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token keyword">from</span> torch <span class="token keyword">import</span> nndevice <span class="token operator">=</span> <span class="token string">'cuda'</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">'cpu'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Using {} device'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># å®šä¹‰ç½‘ç»œæ¨¡å‹</span><span class="token keyword">class</span> <span class="token class-name">NeuralNetwork</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>flatten <span class="token operator">=</span> nn<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>linear_relu_stack <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>         x <span class="token operator">=</span> self<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>        logits <span class="token operator">=</span> self<span class="token punctuation">.</span>linear_relu_stack<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> logits<span class="token comment"># å°†æ¨¡å‹æ”¾åˆ° GPU ä¸Š </span>model <span class="token operator">=</span> NeuralNetwork<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token comment"># æ‰“å°æ¨¡å‹æ¨¡å—</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Model structure: "</span><span class="token punctuation">,</span> model<span class="token punctuation">,</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> param <span class="token keyword">in</span> model<span class="token punctuation">.</span>named_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Layer: </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> | Size: </span><span class="token interpolation"><span class="token punctuation">{</span>param<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | Values : </span><span class="token interpolation"><span class="token punctuation">{</span>param<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">2]</span><span class="token punctuation">}</span></span><span class="token string"> \n"</span></span><span class="token punctuation">)</span><span class="token comment"># ç®€å•æµ‹è¯•</span>X <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>logits <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'logits: </span><span class="token interpolation"><span class="token punctuation">{</span>logits<span class="token punctuation">.</span>shape<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>pred_probab <span class="token operator">=</span> nn<span class="token punctuation">.</span>Softmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>logits<span class="token punctuation">)</span>y_pred <span class="token operator">=</span> pred_probab<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Predicted class: </span><span class="token interpolation"><span class="token punctuation">{</span>y_pred<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ä¸€äº›æ¨¡å—çš„åŠŸèƒ½å°±ä¸å†è¿™é‡Œé‡Œæè¿°äº†ï¼Œä¾‹å¦‚ï¼š<code>nn.Sequential, nn.Flatten</code>ï¼Œè¯·ç›´æ¥å‚è€ƒ <a href="https://pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html#build-the-neural-network">æ–‡æ¡£</a></p><h2 id="Automatic-Differentiation"><a href="#Automatic-Differentiation" class="headerlink" title="Automatic Differentiation"></a>Automatic Differentiation</h2><blockquote><p>To compute those gradients, PyTorch has a built-in differentiation engine called <code>torch.autograd</code>. It supports automatic computation of gradient for any computational graph.</p></blockquote><p>å®é™…ä¸Šåœ¨è‡ªå·±å†™ä»£ç æ—¶ï¼Œå¹¶æ²¡æœ‰æ˜¾å¼åœ°è°ƒç”¨ <code>torch.autograd</code>ï¼Œè¿™ä¸ªæ¨¡å—æ›´å¤šåœ°æ˜¯åšèƒŒååŠŸè‡£ã€‚åœ¨äº†è§£è‡ªåŠ¨å¾®åˆ†ä¹‹å‰ï¼Œéœ€è¦äº†è§£å¦‚ä½•ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•æ¥ç³»ç»Ÿåœ°è®¡ç®—å‚æ•°çš„æ¢¯åº¦ã€‚åå‘ä¼ æ’­ç®—æ³•çš„æ ¸å¿ƒå°±åœ¨äºï¼šé€šè¿‡è®¡ç®—å›¾å’Œå‘å‰è®¡ç®—æ—¶å­˜å‚¨çš„ä¸­é—´ç»“æœï¼Œä» root (æ ¹èŠ‚ç‚¹) è®¡ç®—åˆ° leaf (å¶èŠ‚ç‚¹)ï¼Œåå‘é€å±‚å¾—åˆ°å„ä¸ªèŠ‚ç‚¹çš„æ¢¯åº¦ã€‚äº†è§£åå‘ä¼ æ’­ç®—æ³•ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿæ¨èäº† <a href="https://www.bilibili.com/video/BV16x411V7Qg?from=search&amp;seid=15593528008565591695&amp;spm_id_from=333.337.0.0">3Blue1Brown è§†é¢‘</a>ï¼Œ3b1b nbï¼</p><h3 id="è‡ªåŠ¨å¾®åˆ†"><a href="#è‡ªåŠ¨å¾®åˆ†" class="headerlink" title="è‡ªåŠ¨å¾®åˆ†"></a>è‡ªåŠ¨å¾®åˆ†</h3><p>ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­æ¥å®ç°ç®€å•çš„è‡ªåŠ¨å¾®åˆ†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token comment"># ä½¿ç”¨éšæœºç§å­</span>torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">1998</span><span class="token punctuation">)</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># input tensor</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># expected output</span>w <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>b <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>z <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token operator">+</span>bloss <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>binary_cross_entropy_with_logits<span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šæ„å»ºäº†ä¸€ä¸ªç®€å•çš„è®¡ç®—æµç¨‹ï¼Œå°†éœ€è¦è®¡ç®—çš„æ¢¯åº¦çš„å‚æ•°è®¾ä¸º <code>requires_grad=True</code>ï¼Œæˆ–è€…ç”¨ <code>x.requires_grad_(True)</code>ï¼Œè¯´æ˜ä¸€ä¸‹ï¼šæ–¹æ³•ååç¼€å¸¦ä¸‹åˆ’çº¿ <code>_</code> åˆ™ä»£è¡¨è¯¥æ–¹æ³•ä¸º <code>in place</code> æ–¹æ³•ï¼Œä¼šç›´æ¥ä¿®æ”¹å˜é‡ </p><p>ç”¨å…¬å¼æ¥è¡¨ç¤ºä»¥ä¸Šçš„è®¡ç®—è¿‡ç¨‹</p><script type="math/tex; mode=display">z = x * w + b \\loss = -\frac{1}{N}\sum{y_i*ln(\sigma(z_i)) + (1-y_i)*ln(1 - \sigma(z_i))}</script><p>ç”¨è®¡ç®—å›¾è¡¨ç¤ºä»¥ä¸Šçš„è®¡ç®—è¿‡ç¨‹</p><p><img src="/archives/6c437432/comp-graph.png" style="zoom: 50%;"></p><p>å¯ä»¥çœ‹åˆ° tensor åœ¨è®¡ç®—è¿‡ç¨‹ä¸­åœ¨ä¸æ–­ç”Ÿæˆè®¡ç®—å›¾</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment"># tensor([1., 1., 1., 1., 1.])</span><span class="token keyword">print</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token comment"># tensor([-2.9086,  0.8690,  1.4758], grad_fn=&lt;AddBackward0&gt;)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸º z æ˜¯è®¡ç®—å¾—åˆ°çš„ tensorï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­è¿˜åŒ…å«ä¸€ä¸ª <code>grad_fn</code>ï¼Œè¿™æ˜¯ pytorch ä¸­ <code>Function</code> ç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥æŠŠå…¶çœ‹ä½œè®¡ç®—å›¾çš„å…·ä½“å®ç°ã€‚æ¥ä¸‹æ¥åªéœ€è¦ä¸€è¡Œä»£ç ï¼Œå°±å¯ä»¥è®¡ç®—è®¡ç®—å›¾ä¸­æ‰€æœ‰éœ€è¦çš„æ¢¯åº¦</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>grad<span class="token punctuation">)</span><span class="token comment"># tensor([0.0172, 0.2348, 0.2713])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><ol><li><p>æ¯ä¸ªè®¡ç®—å›¾åªèƒ½è®¡ç®—ä¸€æ¬¡ï¼Œä¹‹åæ‰€æœ‰çš„ä¸­é—´ç»“æœå°†ä¼šè¢«æ¸…é™¤ï¼Œä½†å¯ä»¥ä½¿ç”¨ <code>loss.backward(retain_graph=True)</code> ä¿ç•™ä¸­é—´ç»“æœï¼Œä¸¾ä¸ªç®€å•ä¾‹å­è¯´æ˜ï¼ˆä»¥ä¸‹ä¾‹å­å‡æ²¿ç”¨ä¹‹å‰è‡ªåŠ¨å¾®åˆ†ä¾‹å­ä¸­çš„å˜é‡ï¼‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ç¬¬ä¸€æ¬¡ loss åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</span>loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># åŸºäº loss åˆ›å»ºä¸€ä¸ªæ–°çš„ loss_2</span>loss_2  <span class="token operator">=</span> loss <span class="token operator">**</span> <span class="token number">2</span>loss_2<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># åœ¨ç¬¬äºŒæ¬¡åå‘ä¼ æ’­è®¡ç®—ä¸­ï¼Œæ˜¾ç„¶ä¼šé‡æ–°è¿›è¡Œç¬¬ä¸€æ¬¡çš„åå‘ä¼ æ’­çš„è®¡ç®—æµç¨‹</span><span class="token comment"># RuntimeError: Trying to backward through the graph a second time, but the buffers have already been freed. Specify retain_graph=True when calling backward the first time.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä¸€èˆ¬åªå¯¹æ ‡é‡è¿›è¡Œ <code>backward</code> æ“ä½œã€‚å¯¹çŸ¢é‡è¿›è¡Œ <code>backward</code> æ“ä½œï¼Œå³å¯¹çŸ¢é‡è¿›è¡Œæ±‚å¯¼ï¼Œä¼šå¾—åˆ°é›…å¯æ¯”çŸ©é˜µ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># w.shape=(5, 3) w.requires_grad=True</span>z <span class="token operator">=</span> w <span class="token operator">**</span> <span class="token number">2</span>z<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># RuntimeError: grad can be implicitly created only for scalar outputs</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯¹äºä¸­é—´å˜é‡ï¼ˆå³éå¶èŠ‚ç‚¹å˜é‡ï¼‰ï¼Œç”±äºåœ¨åå‘ä¼ æ’­æ—¶éœ€è¦è®¡ç®—å…¶æ¢¯åº¦ï¼Œåœ¨è‡ªåŠ¨å¾®åˆ†æ—¶ä¼šæ ‡è®°å…¶ <code>requires_grad=True</code>ï¼Œä½†ä¸€èˆ¬åœ¨åå‘ä¼ æ’­è®¡ç®—å®Œæˆä¹‹åï¼Œä¸ä¿ç•™è¿™äº›ä¸­é—´ç»“æœçš„æ¢¯åº¦ï¼Œå¦‚éœ€è¦åˆ™è¦è°ƒç”¨æ–¹æ³• <code>x.retain_grad()</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># z.retain_grad()</span>loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span>grad<span class="token punctuation">)</span><span class="token comment"># warnings.warn("The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad "</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h3 id="ç¦ç”¨è‡ªåŠ¨å¾®åˆ†"><a href="#ç¦ç”¨è‡ªåŠ¨å¾®åˆ†" class="headerlink" title="ç¦ç”¨è‡ªåŠ¨å¾®åˆ†"></a>ç¦ç”¨è‡ªåŠ¨å¾®åˆ†</h3><p>ç¦ç”¨è‡ªåŠ¨å¾®åˆ†ä¸»è¦åº”ç”¨åœ¨ä¸¤ä¸ªåœºæ™¯ï¼š</p><ol><li>Freeze parametersï¼Œå°†å‚æ•°ä»è®¡ç®—å›¾ä¸­å‰”é™¤ï¼Œgradient flow ä¸ä¼šç»è¿‡è¯¥å‚æ•°</li><li>ä»…è®¡ç®—å‘å‰è·¯å¾„ï¼Œä¸è·Ÿè¸ªæ‰€æœ‰æ¢¯åº¦ï¼ŒåŠ å¿«è®¡ç®—</li></ol><p>é’ˆå¯¹ä»¥ä¸Šçš„åœºæ™¯ï¼Œæœ‰ä¸¤ç§æ–¹æ³•èƒ½å¤Ÿç¦ç”¨è‡ªåŠ¨å¾®åˆ†ï¼š</p><ol><li><code>x.detach_()</code>ï¼šå°† x å˜é‡ <code>requires_grad=False</code></li><li><code>with torch.no_grad()</code>ï¼šåœ¨è¯¥æ¨¡å—å†…çš„æ‰€æœ‰è¿ç®—ï¼Œéƒ½ä¸ä¼šè·Ÿè¸ªè®¡ç®—å›¾ï¼Œå³æ‰€æœ‰å˜é‡ <code>requires_grad=False</code></li></ol><p>ä¸‹é¢ä»…å¯¹ <code>detach</code> æ–¹æ³•è¿›è¡Œé‡ç‚¹è¯´æ˜</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># detach</span><span class="token keyword">import</span> torchmode <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'no_detach'</span><span class="token punctuation">,</span> <span class="token string">'detach'</span><span class="token punctuation">]</span><span class="token keyword">for</span> mode_ <span class="token keyword">in</span> mode<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'MODE: </span><span class="token interpolation"><span class="token punctuation">{</span>mode_<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    x <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    y <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">2</span>    z <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">3</span>    <span class="token keyword">if</span> mode_ <span class="token operator">==</span> <span class="token string">'detach'</span><span class="token punctuation">:</span>        z<span class="token punctuation">.</span>detach_<span class="token punctuation">(</span><span class="token punctuation">)</span>    loss <span class="token operator">=</span> <span class="token punctuation">(</span>y<span class="token operator">+</span>z<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'parameter z:\n</span><span class="token interpolation"><span class="token punctuation">{</span>z<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'x_grad:\n</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">.</span>grad<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' resultMODE: no_detachparameter z:tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], grad_fn=&lt;PowBackward0&gt;)x_grad:tensor([5., 5., 5., 5., 5., 5., 5., 5., 5., 5.]) MODE: detachparameter z:tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])x_grad:tensor([2., 2., 2., 2., 2., 2., 2., 2., 2., 2.])  '''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å°† b èŠ‚ç‚¹ä»è®¡ç®—å›¾ä¸­å‰”é™¤ä¹‹åï¼Œx çš„æ¢¯åº¦å‡å°‘äº†ï¼Œå› ä¸º gradient flow ä¸ä» b èŠ‚ç‚¹æµè¿‡ï¼Œå‰åè®¡ç®—å›¾å¦‚ä¸‹</p><p><img src="/archives/6c437432/attached.png" alt="attached graph" style="zoom: 67%;"></p><p><img src="/archives/6c437432/detached.png" alt="detached graph" style="zoom:67%;"></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨è®¡ç®—å›¾å»ºç«‹ä¹‹åï¼Œå¯¹å˜é‡è¿›è¡Œ detach å¹¶ä¸ä¼šå½±å“åå‘ä¼ æ’­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torchx <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>y <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">2</span>z <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">3</span>loss <span class="token operator">=</span> <span class="token punctuation">(</span>y<span class="token operator">+</span>z<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'parameter z:\n</span><span class="token interpolation"><span class="token punctuation">{</span>z<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token comment"># tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], grad_fn=&lt;PowBackward0&gt;)</span>z<span class="token punctuation">.</span>detach_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'parameter z_detached:\n</span><span class="token interpolation"><span class="token punctuation">{</span>z<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token comment">#tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])</span>loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'x_grad:\n</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">.</span>grad<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token comment"># tensor([5., 5., 5., 5., 5., 5., 5., 5., 5., 5.]) </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘çš„ç†è§£æ˜¯è®¡ç®—å›¾åœ¨æ„å»ºå®Œæˆä¹‹åï¼Œä»…è¿›è¡Œ detach ä¸ä¼šå¯¹å·²ç»ç”Ÿæˆçš„è®¡ç®—å›¾è¿›è¡Œä¿®æ”¹ï¼Œä¸” tensor æœ¬èº«çš„å€¼æ²¡æœ‰å‘ç”Ÿæ”¹ï¼Œè®¡ç®—å›¾å°±å¯ä»¥ä½¿ç”¨è¯¥å€¼è¿›è¡Œæ¢¯åº¦è®¡ç®—ã€‚è€Œä¹‹å‰çš„ for å¾ªç¯æ¯ä¸€æ¬¡å¾ªç¯éƒ½é‡æ–°åˆ›å»ºäº†è®¡ç®—å›¾</p><h2 id="Optimization"><a href="#Optimization" class="headerlink" title="Optimization"></a>Optimization</h2><p>è¿™é‡Œå°†æ˜¯æ•´ä¸ªæ·±åº¦å­¦ä¹ è€—æ—¶æœ€é•¿çš„éƒ¨åˆ†ï¼Œéœ€è¦å°†ä¹‹å‰çš„æ•°æ®é›†é€å…¥åˆ°æ¨¡å‹ä¹‹ä¸­ï¼Œä½¿ç”¨ä¼˜åŒ–ç®—æ³•æ”¹è¿›æ¨¡å‹ã€‚è¿™ä¸€éƒ¨åˆ†æ²¿ç”¨ä¹‹å‰çš„ <code>Fashion-MNIST</code> æ•°æ®é›†å’Œç¥ç»ç½‘ç»œï¼Œå®Œæ•´ä»£ç å‚è€ƒ <a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html#prerequisite-codehttps://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html#prerequisite-code">prerequisite code</a></p><h3 id="ä¼˜åŒ–å¾ªç¯"><a href="#ä¼˜åŒ–å¾ªç¯" class="headerlink" title="ä¼˜åŒ–å¾ªç¯"></a>ä¼˜åŒ–å¾ªç¯</h3><p>åœ¨æ•´ä¸ªå¾ªç¯è¿‡ç¨‹ä¸­ï¼Œé™¤äº†ä¹‹å‰æåˆ°çš„æ•°æ®é›†å’Œæ¨¡å‹ï¼Œè¿˜æœ‰ä¸¤ä¸ªé‡è¦å…ƒç´ ï¼šæŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨ã€‚Pytorch ä¸­çš„æŸå¤±å‡½æ•°åœ¨ <code>nn</code> æ¨¡å—ä¸‹ï¼Œä¼˜åŒ–å™¨åœ¨ <code>optim</code> æ¨¡å—ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optimloss_fn <span class="token operator">=</span> nn<span class="token punctuation">.</span>X<span class="token punctuation">(</span><span class="token punctuation">)</span>                            <span class="token comment"># where X is L1Loss, MSELoss, CrossEntropyLoss...</span>opt <span class="token operator">=</span> optim<span class="token punctuation">.</span>X<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>      <span class="token comment"># where X is SGD, Adadelta, Adagrad, Adam...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•´ä½“çš„ä¼˜åŒ–é€»è¾‘åˆ†ä¸ºä¸¤æ­¥ï¼Œé¦–å…ˆä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•è®¡ç®—å‡ºå‚æ•°çš„æ¢¯åº¦ï¼Œç„¶åæ ¹æ®è¿™äº›æ¢¯åº¦é‡‡ç”¨ä¸åŒçš„ä¼˜åŒ–ç®—æ³•è¿›è¡Œè¿­ä»£ä¼˜åŒ– <code>opt.step()</code> ã€‚ä¸‹é¢çš„ä»£ç å®ç°äº† <code>train_loop</code> å’Œ <code>teat_loop</code> åˆ†åˆ«å®ç°è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">train_loop</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span><span class="token punctuation">:</span>    size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>    <span class="token keyword">for</span> batch<span class="token punctuation">,</span> <span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># Compute prediction and loss</span>        pred <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span>        loss <span class="token operator">=</span> loss_fn<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span>        <span class="token comment"># Backpropagation</span>        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> batch <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            loss<span class="token punctuation">,</span> current <span class="token operator">=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> batch <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"loss: </span><span class="token interpolation"><span class="token punctuation">{</span>loss<span class="token punctuation">:</span><span class="token format-spec">&gt;7f</span><span class="token punctuation">}</span></span><span class="token string">  [</span><span class="token interpolation"><span class="token punctuation">{</span>current<span class="token punctuation">:</span><span class="token format-spec">&gt;5d</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>size<span class="token punctuation">:</span><span class="token format-spec">&gt;5d</span><span class="token punctuation">}</span></span><span class="token string">]"</span></span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test_loop</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">)</span><span class="token punctuation">:</span>    size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>    num_batches <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span>    test_loss<span class="token punctuation">,</span> correct <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>    <span class="token comment"># Will not build computational graph</span>    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> X<span class="token punctuation">,</span> y <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span>            pred <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span>            test_loss <span class="token operator">+=</span> loss_fn<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>pred<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>    test_loss <span class="token operator">/=</span> num_batches    correct <span class="token operator">/=</span> size    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Test Error: \n Accuracy: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>correct<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">&gt;0.1f</span><span class="token punctuation">}</span></span><span class="token string">%, Avg loss: </span><span class="token interpolation"><span class="token punctuation">{</span>test_loss<span class="token punctuation">:</span><span class="token format-spec">&gt;8f</span><span class="token punctuation">}</span></span><span class="token string"> \n"</span></span><span class="token punctuation">)</span>model <span class="token operator">=</span> NeuralNetwork<span class="token punctuation">(</span><span class="token punctuation">)</span>    loss_fn <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>learning_rate <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span>optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span>learning_rate<span class="token punctuation">)</span>epochs <span class="token operator">=</span> <span class="token number">10</span><span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Epoch </span><span class="token interpolation"><span class="token punctuation">{</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">\n-------------------------------"</span></span><span class="token punctuation">)</span>    train_loop<span class="token punctuation">(</span>train_dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span>    test_loop<span class="token punctuation">(</span>test_dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ç»ˆç»“æœä¹Ÿè¯·ç›´æ¥æŸ¥çœ‹ <a href="https://pytorch.org/tutorials/beginner/basics/optimization_tutorial.html#optimization-loop">optimization loop</a></p><h2 id="Save-and-Load-the-Model"><a href="#Save-and-Load-the-Model" class="headerlink" title="Save and Load the Model"></a>Save and Load the Model</h2><h3 id="ä¿å­˜æ¨¡å‹å‚æ•°"><a href="#ä¿å­˜æ¨¡å‹å‚æ•°" class="headerlink" title="ä¿å­˜æ¨¡å‹å‚æ•°"></a>ä¿å­˜æ¨¡å‹å‚æ•°</h3><p>æ¨¡å‹çš„å‚æ•°å­˜å‚¨åœ¨å…¶å†…éƒ¨çš„ä¸€ä¸ªå­—å…¸å½“ä¸­ï¼Œä½¿ç”¨ <code>model.state_dict()</code> æ–¹æ³•å¯ä»¥è¿”å›è¯¥å­—å…¸ã€‚ä½¿ç”¨ <code>torch.save</code> æ–¹æ³•å³å¯å­˜å‚¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>models <span class="token keyword">as</span> modelsmodel <span class="token operator">=</span> models<span class="token punctuation">.</span>vgg16<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'model_weights.pth'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±å°†æ¨¡å‹å‚æ•°ä¿å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹ä¸‹ï¼Œå¦‚æœéœ€è¦åŠ è½½æ¨¡å‹å‚æ•°ï¼Œåˆ™å¿…é¡»è¦å…ˆåˆ›å»ºä¸€ä¸ªæ¨¡å‹å®ä¾‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> models<span class="token punctuation">.</span>vgg16<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># we do not specify pretrained=True, i.e. do not load default weights</span>model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'model_weights.pth'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong>ä¸€å®šè¦åœ¨æ¨ç†ä¹‹å‰è°ƒç”¨ <code>model.eval()</code> æ–¹æ³•ï¼Œä»¥å°† dropout å’Œ batch_norm å±‚è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ã€‚ä¸è¿™æ ·åšä¼šäº§ç”Ÿä¸ä¸€è‡´çš„æ¨ç†ç»“æœ</p><h3 id="ä¿å­˜æ¨¡å‹å‚æ•°åŠå…¶ç»“æ„"><a href="#ä¿å­˜æ¨¡å‹å‚æ•°åŠå…¶ç»“æ„" class="headerlink" title="ä¿å­˜æ¨¡å‹å‚æ•°åŠå…¶ç»“æ„"></a>ä¿å­˜æ¨¡å‹å‚æ•°åŠå…¶ç»“æ„</h3><p>å¦‚æœæƒ³è¦åŒæ—¶ä¿å­˜å…¶ç»“æ„ï¼Œåˆ™ç›´æ¥ä¼ å…¥æ¨¡å‹æœ¬èº«</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">'model.pth'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŠ è½½æ¨¡å‹è™½ç„¶ä¸éœ€è¦å…ˆå®ä¾‹åŒ–æ¨¡å‹ï¼Œä½†ä»éœ€è¦æœ‰æ¨¡å‹çš„å®šä¹‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Model class must be defined somewhere</span>model <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'model.pth'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æ¨¡å‹å¯¼å‡ºä¸º-ONNX"><a href="#æ¨¡å‹å¯¼å‡ºä¸º-ONNX" class="headerlink" title="æ¨¡å‹å¯¼å‡ºä¸º ONNX"></a>æ¨¡å‹å¯¼å‡ºä¸º ONNX</h3><blockquote><p><strong>ONNX is an open format built to represent machine learning models.</strong> ONNX defines a common set of operators - the building blocks of machine learning and deep learning models - and a common file format to enable AI developers to use models with a variety of frameworks, tools, runtimes, and compilers.</p></blockquote><p>Pytorch æ”¯æŒå°†æ¨¡å‹è½¬ä¸º ONNX æ ¼å¼ï¼Œæ›´å¤šä¿¡æ¯å°±ä¸æ‰“ç®—æ•´ç†äº† <a href="https://pytorch.org/tutorials/beginner/basics/saveloadrun_tutorial.html#exporting-model-to-onnx">Exporting Model to ONNX</a> <a href="https://github.com/onnx/tutorials">ONNX tutorial</a></p><h2 id="æ•´ä½“å¤ä¹ "><a href="#æ•´ä½“å¤ä¹ " class="headerlink" title="æ•´ä½“å¤ä¹ "></a>æ•´ä½“å¤ä¹ </h2><blockquote><p>Congratulations! You have completed the PyTorch beginner tutorial! Try <a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">revisting the first page</a> to see the tutorial in its entirety again. We hope this tutorial has helped you get started with deep learning on PyTorch. Good luck!</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Pytorch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Pytorch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿™æœ¬ä¹¦èƒ½è®©ä½ ç¡å¥½</title>
      <link href="/archives/dead6afd.html"/>
      <url>/archives/dead6afd.html</url>
      
        <content type="html"><![CDATA[<h1 id="è¿™æœ¬ä¹¦èƒ½è®©ä½ ç¡å¥½"><a href="#è¿™æœ¬ä¹¦èƒ½è®©ä½ ç¡å¥½" class="headerlink" title="è¿™æœ¬ä¹¦èƒ½è®©ä½ ç¡å¥½"></a>è¿™æœ¬ä¹¦èƒ½è®©ä½ ç¡å¥½</h1><p>æ€»ä½“æ¥è®²åˆ†ä¸ºå‡ ä¸ªå¤§æ–¹é¢ï¼šç¡çœ è§‚å¿µï¼Œç¡çœ å’Œé”»ç‚¼çš„æ—¶é—´ï¼Œå…‰çº¿å½±å“ï¼Œé¥®é£Ÿå½±å“ï¼Œæ¸©åº¦å½±å“ï¼Œèº«å¿ƒæ”¾æ¾æŠ€å·§</p><h2 id="ç¬¬ä¸€ç« -äº†è§£ç¡çœ çš„ä»·å€¼ï¼ˆè§‚å¿µï¼‰"><a href="#ç¬¬ä¸€ç« -äº†è§£ç¡çœ çš„ä»·å€¼ï¼ˆè§‚å¿µï¼‰" class="headerlink" title="ç¬¬ä¸€ç«  äº†è§£ç¡çœ çš„ä»·å€¼ï¼ˆè§‚å¿µï¼‰"></a>ç¬¬ä¸€ç«  äº†è§£ç¡çœ çš„ä»·å€¼ï¼ˆè§‚å¿µï¼‰</h2><p>æ°¸è¿œè®°ä½å¤±çœ çš„ä»·å€¼ã€‚å½“è·å¾—å¿…é¡»çš„ç¡çœ ï¼Œä½ ä¼šè¡¨ç°å¾—æ›´å‡ºè‰²ï¼Œåšå‡ºæ›´æ˜æ™ºçš„å†³å®šï¼Œæ‹¥æœ‰æ›´å¥åº·çš„èº«ä½“ã€‚ç¡çœ ä¸æ˜¯æˆ‘ä»¬éœ€è¦é€¾è¶Šçš„éšœç¢ï¼Œå®ƒæ˜¯ä¸€ç§èº«ä½“æ‰€éœ€çš„è‡ªç„¶çŠ¶æ€ï¼Œå¯ä»¥å¢å¼ºæ¿€ç´ ä½œç”¨ï¼Œæ²»æ„ˆè‚Œè‚‰ã€ç»„ç»‡å’Œå™¨å®˜ï¼Œè®©èº«ä½“å…å—ç–¾ç—…ä¾µå®³ï¼Œè®©ç†æ™ºè¾¾åˆ°æœ€ä¼˜æ°´å¹³ã€‚é‡æ–°è°ƒé…ä½ çš„ç¡çœ ï¼Œä¸è¦æŠŠç¡çœ è§†ä¸ºéœ€è¦å…‹æœçš„éšœç¢ï¼ŒæŠŠç¡çœ çœ‹æˆå¯¹è‡ªå·±çš„ç‰¹æ®Šæ¬¾å¾…ï¼</p><h2 id="ç¬¬äºŒç« -ç™½å¤©å¤šæ™’å¤ªé˜³ï¼ˆå…‰çº¿ï¼‰"><a href="#ç¬¬äºŒç« -ç™½å¤©å¤šæ™’å¤ªé˜³ï¼ˆå…‰çº¿ï¼‰" class="headerlink" title="ç¬¬äºŒç«  ç™½å¤©å¤šæ™’å¤ªé˜³ï¼ˆå…‰çº¿ï¼‰"></a>ç¬¬äºŒç«  ç™½å¤©å¤šæ™’å¤ªé˜³ï¼ˆå…‰çº¿ï¼‰</h2><p>æ™¨å…‰æ˜¯å¦‚ä½•æ”¹å–„ç¡çœ çš„å‘¢ï¼Ÿå…‰çº¤å…¶å®æ˜¯åœ¨å‘ä¿¡å·ç»™ä¸‹ä¸˜è„‘åŠæ‰€æœ‰ç›¸å…³å™¨å®˜å’Œè…ºä½“ï¼Œæé†’å®ƒä»¬è¯¥é†’äº†ã€‚æœ€è¿‘ï¼Œä¸€é¡¹ç ”ç©¶è€ƒå¯Ÿäº†æ—¥ç­åŠå…¬å®¤äººå‘˜çš„ç¡çœ è´¨é‡ï¼Œç›¸æ¯”ç›´æ¥é çª—çš„äººå‘˜ï¼Œä¸é çª—äººå‘˜æ¥æ”¶çš„è‡ªç„¶å…‰ä¼šå°‘173%ï¼Œå¹¶å› æ­¤å¹³å‡æ²¡æ™šå°‘ç¡46åˆ†é’Ÿã€‚æƒ³è¦è·å¾—å®Œç¾çš„ç¡çœ ï¼Œè¤ªé»‘ç´ çœŸå®æ‰®æ¼”è€…æ˜æ˜Ÿçº§çš„è§’è‰²ã€‚è¤ªé»‘ç´ æ˜¯ç”±äººä½“ä¸­çš„æ¾æœè…ºå’Œå…¶ä»–ç»„ç»‡ç”Ÿæˆçš„ï¼Œå½“å®¤å¤–å˜æš—æ—¶ï¼Œèº«ä½“å°±ä¼šè‡ªç„¶åˆ†æ³Œè¤ªé»‘ç´ ã€‚ä½†æ˜¯å¦‚æœä¸èƒ½åœ¨æ­£ç¡®çš„æ—¶é—´è·å¾—é€‚å½“çš„å…‰çº¿ï¼Œæˆ‘ä»¬çš„èº«ä½“å°±ä¼šå‡ºç°é—®é¢˜ã€‚çš®è´¨é†‡å’Œè¤ªé»‘ç´ ç®—æ˜¯å‘ˆä½ ç›¸å…³çš„ä¸€å¯¹æ¿€ç´ ã€‚ç™½å¤©æ¥æ”¶é˜³å…‰ç…§å°„ä¹‹æ‰€ä»¥é‡è¦ï¼Œè¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯å¯ä»¥åˆºæ¿€çš®è´¨é†‡çš„ç”Ÿæˆã€‚è·å¾—æ›´å¤šé˜³å…‰ç…§å°„ï¼Œå¯ä»¥ä¸ºæ­£å¸¸çš„çš®è´¨é†‡èŠ‚å¾‹å’Œè¤ªé»‘ç´ èŠ‚å¾‹æ§åˆ¶èŠ‚å¥ã€‚é˜³å…‰ä¸­å«æœ‰è®¸å¤šå½±å“èº«ä½“çš„æ³¢é•¿ï¼Œæˆ‘ä»¬æœ€éœ€è¦äº†è§£UVAå’ŒUVBï¼ŒUVä»£è¡¨ç´«å¤–çº¿ï¼Œå¯¹UVAçš„ä¸å¥åº·æ¥è§¦ä¹Ÿæ˜¯ä¸è¡Œçš„(ä¾‹å¦‚å¤ªé˜³æš´æ™’)ï¼ŒUVBå¯¹äººä½“å¥åº·çš„ä»·å€¼æœ€å¤§ï¼Œå› ä¸ºå®ƒæ˜¯å”¯ä¸€ä¼šåˆºæ¿€äººä½“ç”Ÿæˆç»´ç”Ÿç´ Dçš„æ³¢é•¿ã€‚</p><h2 id="ç¬¬ä¸‰ç« -ç¡å‰è¿œç¦»ç”µå­å±å¹•ï¼ˆå…‰çº¿ï¼‰"><a href="#ç¬¬ä¸‰ç« -ç¡å‰è¿œç¦»ç”µå­å±å¹•ï¼ˆå…‰çº¿ï¼‰" class="headerlink" title="ç¬¬ä¸‰ç«  ç¡å‰è¿œç¦»ç”µå­å±å¹•ï¼ˆå…‰çº¿ï¼‰"></a>ç¬¬ä¸‰ç«  ç¡å‰è¿œç¦»ç”µå­å±å¹•ï¼ˆå…‰çº¿ï¼‰</h2><p>æƒ³è¦ç«‹åˆ»æ”¹å–„ç¡çœ ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯å‡å°‘æ™šé—´çœ‹ç”µå­å±å¹•çš„æ—¶é—´ã€‚è“å…‰ä¼šä¸¥é‡å½±å“ç¡çœ ï¼Œå› ä¸ºä¼šåˆºæ¿€äººä½“ç”Ÿæˆæ›´å¤šçš„ç™½å¤©æ¿€ç´ ï¼Œè¯¯å¯¼åŸæœ¬å‡†å¤‡ç¡è§‰çš„äººã€‚æˆ‘ä»¬ä½¿ç”¨ç”µå­è®¾å¤‡çš„æ–‡åŒ–ä¼ ç»Ÿä¸è¿‡åˆšåˆšå‡ åå¹´ï¼Œåœ¨å‡ ç™¾ä¸‡å¹´çš„è¿›åŒ–å†ç¨‹ä¸å‡ åå¹´ç†¬å¤œä¹ æƒ¯çš„å¯¹æŠ—ä¸­ï¼Œæˆ‘ä»¬çš„èƒ½åŠ›ä¹Ÿæ²¡è¿›åŒ–å¾—å¿«é€‚åº”ã€‚å¦‚æœä½ æƒ³æ ¹æ®èº«ä½“éœ€æ±‚ï¼Œè¿›å…¥æ·±åº¦ç¡çœ ï¼Œåœ¨ç¡å‰90åˆ†é’Ÿï¼Œä½ è¦å…³é—­æ‰€æœ‰å±å¹•ï¼Œè®©è¤ªé»‘ç´ æ¿€ç´ å’Œçš®è´¨é†‡æ°´å¹³å›å¤æ­£å¸¸ã€‚</p><h2 id="ç¬¬å››ç« -å»ºç«‹å’–å•¡å› å®µç¦ï¼ˆé¥®é£Ÿï¼‰"><a href="#ç¬¬å››ç« -å»ºç«‹å’–å•¡å› å®µç¦ï¼ˆé¥®é£Ÿï¼‰" class="headerlink" title="ç¬¬å››ç«  å»ºç«‹å’–å•¡å› å®µç¦ï¼ˆé¥®é£Ÿï¼‰"></a>ç¬¬å››ç«  å»ºç«‹å’–å•¡å› å®µç¦ï¼ˆé¥®é£Ÿï¼‰</h2><p>å’–å•¡å› æ˜¯ä¸€ç§å¼ºå¤§çš„ç¥ç»å…´å¥‹å‰‚ã€‚ç”±äºå’–å•¡å› æ‘„å…¥å¯¼è‡´ç¡çœ ä¸è¶³ï¼Œå¿…ç„¶ä¼šè®©æˆ‘ä»¬æ„Ÿè§‰æ›´åŠ ç–²æƒ«ï¼Œç–²æƒ«ä¹‹åæˆ‘ä»¬ä¼šæœŸå¾…æ›´å¤šçš„å’–å•¡å› ï¼Œè¿™ä¼šè®©æˆ‘ä»¬çš„ç¡çœ é—®é¢˜é›ªä¸ŠåŠ éœœã€‚å’–å•¡å› çš„åŠè¡°æœŸä¸º5~8å°æ—¶ï¼ŒåŠè¡°æœŸæœ¬è´¨ä¸Šæ˜¯æŒ‡ï¼Œäººä½“ç³»ç»Ÿä¸­çš„ç‰©è´¨æœ€é«˜æµ“åº¦é™ä½ä¸€èˆ¬æ‰€éœ€çš„æ—¶é—´ã€‚è®¾å®šä¸€ä¸ªå¿…é¡»éµå®ˆçš„å’–å•¡å› å°é‡‘ï¼Œç¡®ä¿åœ¨ä½ ç¡è§‰å‰ï¼Œå¯ä»¥æ’é™¤ä½“ç³»ä¸­çš„å¤§éƒ¨åˆ†å’–å•¡å› ï¼Œå¯¹äºå¤§éƒ¨åˆ†äººæ¥è¯´ï¼Œé‚£ä¸ªæ—¶é—´é€šå¸¸æ˜¯ä¸‹åˆ2ï¼š00å‰ã€‚</p><h2 id="ç¬¬äº”ç« -è®©è‡ªå·±å‡‰å¿«ç‚¹ï¼ˆæ¸©åº¦ï¼‰"><a href="#ç¬¬äº”ç« -è®©è‡ªå·±å‡‰å¿«ç‚¹ï¼ˆæ¸©åº¦ï¼‰" class="headerlink" title="ç¬¬äº”ç«  è®©è‡ªå·±å‡‰å¿«ç‚¹ï¼ˆæ¸©åº¦ï¼‰"></a>ç¬¬äº”ç«  è®©è‡ªå·±å‡‰å¿«ç‚¹ï¼ˆæ¸©åº¦ï¼‰</h2><p>å½“èº«ä½“è¯¥ä¼‘æ¯æ—¶ï¼Œäººä½“æ ¸å¿ƒæ¸©åº¦ä¼šè‡ªåŠ¨ä¸‹é™ï¼Œå¸®åŠ©äººä»¬å¯åŠ¨ç¡çœ çŠ¶æ€ã€‚å¦‚æœå¤–ç•Œæ¸©åº¦è¿‡é«˜ï¼Œèº«ä½“æƒ³è¿›å…¥ç†æƒ³çš„èˆ’é€‚ç¡çœ ï¼Œå°±ä¼šé¢ä¸´ä¸€ç‚¹ç”Ÿç†ä¸Šçš„æŒ‘æˆ˜ã€‚ç ”ç©¶è¡¨æ˜ï¼Œæœ€ä½³çš„ç¡çœ æ¸©åº¦æ˜¯15Â°~20Â°ã€‚å¦‚æœä½ æœ‰ç¡çœ éšœç¢ï¼Œè¯•ç€ç¡å‰èŠ±1.5~2å°æ—¶ï¼Œæ´—ä¸ªçƒ­æ°´æ¾¡ã€‚</p><h2 id="ç¬¬å…­ç« -é€‰æ‹©æ­£ç¡®çš„å…¥ç¡æ—¶é—´ï¼ˆæ—¶é—´ï¼‰"><a href="#ç¬¬å…­ç« -é€‰æ‹©æ­£ç¡®çš„å…¥ç¡æ—¶é—´ï¼ˆæ—¶é—´ï¼‰" class="headerlink" title="ç¬¬å…­ç«  é€‰æ‹©æ­£ç¡®çš„å…¥ç¡æ—¶é—´ï¼ˆæ—¶é—´ï¼‰"></a>ç¬¬å…­ç«  é€‰æ‹©æ­£ç¡®çš„å…¥ç¡æ—¶é—´ï¼ˆæ—¶é—´ï¼‰</h2><p>äººç±»åœ¨æ™š10ç‚¹åˆ°å‡Œæ™¨2ç‚¹å¤„äºç¡çœ çŠ¶æ€ï¼Œå¯ä»¥è·å¾—æœ€ä½³çš„æ¿€ç´ åˆ†æ³Œå’Œæ¢å¤æ•ˆæœã€‚å¦‚æœæœ‰äººç†¬åˆ°æ™šä¸Š10ç‚¹æˆ–11ç‚¹ï¼Œè¿›å…¥ç²¾åŠ›æ¢å¤çŠ¶æ€åï¼Œé€šå¸¸è§‰å¾—æƒ³ç¡è§‰æ›´éš¾å…¥ç¡ã€‚ç²¾åŠ›æ¢å¤çŠ¶æ€è·Ÿé”»ç‚¼çš„è¿‡ç¨‹åŒºåˆ«ä¸å¤§ï¼Œåšè¿‡è€åŠ›è®­ç»ƒçš„äººéƒ½ç›´åˆ°ï¼Œåªè¦åšæŒä¸€æ®µæ—¶é—´ï¼Œå³ä¾¿ä½ æ„Ÿè§‰ç´¯äº†ï¼Œèº«ä½“ä¹Ÿä¼šè¿›å…¥æ¢å¤çŠ¶æ€ï¼Œå†æ¬¡æ„Ÿè§‰ç²¾åŠ›æ»¡æ»¡ï¼Œç»§ç»­åšæŒä¸‹å»ã€‚</p><h2 id="ç¬¬åç« -è°ƒæš—å…‰çº¿ï¼ˆæ—¶é—´ï¼‰"><a href="#ç¬¬åç« -è°ƒæš—å…‰çº¿ï¼ˆæ—¶é—´ï¼‰" class="headerlink" title="ç¬¬åç«  è°ƒæš—å…‰çº¿ï¼ˆæ—¶é—´ï¼‰"></a>ç¬¬åç«  è°ƒæš—å…‰çº¿ï¼ˆæ—¶é—´ï¼‰</h2><p>å§å®¤é‡Œä»»ä½•çš„å…‰æºéƒ½ä¼šæ‰“ä¹±ç¡çœ æ¨¡å¼ï¼Œå³ä½¿æˆ´ä¸Šçœ¼ç½©ä¹Ÿä¸æ˜¯100%æœ‰æ•ˆçš„ã€‚ä½ çŸ¥é“çš®è‚¤ä¸Šå…¶å®æœ‰å…‰æ„Ÿå™¨å—ï¼Ÿå¦‚æœå§å®¤é‡Œæœ‰å…‰æºï¼Œä½ çš„èº«ä½“ä¼šæ¥æ”¶å…‰çº¿ï¼Œå‘å¤§è„‘å’Œå™¨å®˜å‘é€ä¿¡æ¯ä»è€Œå¹²æ‰°ç¡çœ ã€‚</p><h2 id="ç¬¬åä¸€ç« -è®²ç©¶æ–¹æ³•ï¼Œå¥½å¥½é”»ç‚¼ï¼ˆæ—¶é—´ï¼‰"><a href="#ç¬¬åä¸€ç« -è®²ç©¶æ–¹æ³•ï¼Œå¥½å¥½é”»ç‚¼ï¼ˆæ—¶é—´ï¼‰" class="headerlink" title="ç¬¬åä¸€ç«  è®²ç©¶æ–¹æ³•ï¼Œå¥½å¥½é”»ç‚¼ï¼ˆæ—¶é—´ï¼‰"></a>ç¬¬åä¸€ç«  è®²ç©¶æ–¹æ³•ï¼Œå¥½å¥½é”»ç‚¼ï¼ˆæ—¶é—´ï¼‰</h2><p>å…³é”®é—®é¢˜ä¸åœ¨äºé”»ç‚¼æœ¬èº«ï¼Œè€Œåœ¨äºé”»ç‚¼çš„æ—¶é—´å’Œæ–¹å¼ã€‚ä¸ºäº†ä¼˜åŒ–ç¡çœ ï¼Œä½ æ´»åŠ¨æ—¶éœ€è¦éµå¾ªå‡ ä¸ªåŸåˆ™ï¼š1.æ™šä¸Šä¸é€‚åˆé”»ç‚¼ï¼Œæ—©æ™¨é”»ç‚¼çš„å¥½å¤„ä¸èƒ½å¿½è§†ï¼›2.é•¿è·‘ä¸åˆ©äºå¥½çš„ç¡çœ ï¼›3.ä¸ºäº†è·å¾—æœ€ä½³çš„æ¿€ç´ ååº”ï¼Œéœ€è¦åšäº›ä¸¾é‡ç»ƒä¹ </p><h2 id="ç¬¬åå››ç« -å–é…’æ‚ ç€ç‚¹ï¼ˆé¥®é£Ÿï¼‰"><a href="#ç¬¬åå››ç« -å–é…’æ‚ ç€ç‚¹ï¼ˆé¥®é£Ÿï¼‰" class="headerlink" title="ç¬¬åå››ç«  å–é…’æ‚ ç€ç‚¹ï¼ˆé¥®é£Ÿï¼‰"></a>ç¬¬åå››ç«  å–é…’æ‚ ç€ç‚¹ï¼ˆé¥®é£Ÿï¼‰</h2><p>æ™šä¸Šå–é…’æœ‰åˆ©äºå¿«é€Ÿå…¥ç¡ï¼Œä½†æ˜¯å¿«é€Ÿçœ¼åŠ¨ç¡çœ ä¼šè¢«èº«ä½“ä¸­çš„é…’ç²¾ä¸¥é‡å¹²æ‰°ï¼Œä½ å°†æ— æ³•è¿›å…¥æ·±åº¦çš„ã€æŒç»­çš„å¿«é€Ÿçœ¼åŠ¨ç¡çœ ï¼Œå¤§è„‘å’Œèº«ä½“ä¹Ÿæ— æ³•å®Œå…¨æ¢å¤ã€‚</p><h2 id="ç¬¬åå…­ç« -è®©å¿ƒé‡Œè¯åœä¸‹æ¥-ï¼ˆå†¥æƒ³-è…¹å¼å‘¼å¸-æŠ€å·§ï¼‰"><a href="#ç¬¬åå…­ç« -è®©å¿ƒé‡Œè¯åœä¸‹æ¥-ï¼ˆå†¥æƒ³-è…¹å¼å‘¼å¸-æŠ€å·§ï¼‰" class="headerlink" title="ç¬¬åå…­ç«  è®©å¿ƒé‡Œè¯åœä¸‹æ¥ ï¼ˆå†¥æƒ³ è…¹å¼å‘¼å¸ æŠ€å·§ï¼‰"></a>ç¬¬åå…­ç«  è®©å¿ƒé‡Œè¯åœä¸‹æ¥ ï¼ˆå†¥æƒ³ è…¹å¼å‘¼å¸ æŠ€å·§ï¼‰</h2><h2 id="ç¬¬åå…«ç« -æ—©ç‚¹èµ·åºŠï¼ˆæ—¶é—´ï¼‰"><a href="#ç¬¬åå…«ç« -æ—©ç‚¹èµ·åºŠï¼ˆæ—¶é—´ï¼‰" class="headerlink" title="ç¬¬åå…«ç«  æ—©ç‚¹èµ·åºŠï¼ˆæ—¶é—´ï¼‰"></a>ç¬¬åå…«ç«  æ—©ç‚¹èµ·åºŠï¼ˆæ—¶é—´ï¼‰</h2><h2 id="ç¬¬åä¹ç« -é€‰æ‹©åˆé€‚çš„çº¤ä½“æ–¹æ³•-ï¼ˆæ¸è¿›å¼è‚Œè‚‰æ”¾æ¾-æŒ‰æ‘©-æŠ€å·§ï¼‰"><a href="#ç¬¬åä¹ç« -é€‰æ‹©åˆé€‚çš„çº¤ä½“æ–¹æ³•-ï¼ˆæ¸è¿›å¼è‚Œè‚‰æ”¾æ¾-æŒ‰æ‘©-æŠ€å·§ï¼‰" class="headerlink" title="ç¬¬åä¹ç«  é€‰æ‹©åˆé€‚çš„çº¤ä½“æ–¹æ³• ï¼ˆæ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ æŒ‰æ‘© æŠ€å·§ï¼‰"></a>ç¬¬åä¹ç«  é€‰æ‹©åˆé€‚çš„çº¤ä½“æ–¹æ³• ï¼ˆæ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ æŒ‰æ‘© æŠ€å·§ï¼‰</h2>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¡çœ  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 3 é¢å‘å¯¹è±¡</title>
      <link href="/archives/59bf225c.html"/>
      <url>/archives/59bf225c.html</url>
      
        <content type="html"><![CDATA[<h1 id="python-é¢å‘å¯¹è±¡"><a href="#python-é¢å‘å¯¹è±¡" class="headerlink" title="python é¢å‘å¯¹è±¡"></a>python é¢å‘å¯¹è±¡</h1><h2 id="é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>é¢å‘å¯¹è±¡ç¼–ç¨‹</h2><p>ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Ÿç”¨ä¸€æ®µè¯æè¿°é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼š</p><blockquote><p>æŠŠä¸€ç»„æ•°æ®ç»“æ„å’Œå¤„ç†å®ƒä»¬çš„æ–¹æ³•ç»„æˆå¯¹è±¡ï¼ˆobjectï¼‰ï¼ŒæŠŠç›¸åŒè¡Œä¸ºçš„å¯¹è±¡å½’çº³ä¸ºç±»ï¼ˆclassï¼‰ï¼Œé€šè¿‡ç±»çš„å°è£…ï¼ˆencapsulationï¼‰éšè—å†…éƒ¨ç»†èŠ‚ï¼Œé€šè¿‡ç»§æ‰¿ï¼ˆinheritanceï¼‰å®ç°ç±»çš„ç‰¹åŒ–ï¼ˆspecializationï¼‰å’Œæ³›åŒ–ï¼ˆgeneralizationï¼‰ï¼Œé€šè¿‡å¤šæ€ï¼ˆpolymorphismï¼‰å®ç°åŸºäºå¯¹è±¡ç±»å‹çš„åŠ¨æ€åˆ†æ´¾</p></blockquote><p>è¿™ä¸€æ®µè¯æˆ‘åœ¨ä¹‹å‰æ˜¯çœ‹å¾—äº‘é‡Œé›¾é‡Œï¼Œè¿™æ ·é«˜åº¦çš„æ¦‚æ‹¬è¿‡äºæŠ½è±¡ã€‚ç°åœ¨çœ‹è¿‡äº†ä¸€äº›ä»£ç è¿‡åï¼Œå†å›å¤´çœ‹è¿™æ®µè¯æ‰æ²¡é‚£ä¹ˆè¿·æƒ‘</p><h2 id="ç±»å’Œå¯¹è±¡"><a href="#ç±»å’Œå¯¹è±¡" class="headerlink" title="ç±»å’Œå¯¹è±¡"></a>ç±»å’Œå¯¹è±¡</h2><p>ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œå¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ã€‚åœ¨é¢å‘å¯¹è±¡çš„ä¸–ç•Œä¸­ï¼Œä¸€åˆ‡çš†ä¸ºå¯¹è±¡ã€‚ä¸‹é¢æ¥åˆ›å»ºä¸€ä¸ªç±»</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age        <span class="token keyword">def</span> <span class="token function">introduce</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My name is %s. I'm %d."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹‹å‰æåˆ°è¿‡ <code>__init__()</code> æ–¹æ³•åœ¨ç±»ä¸­å±äºç‰¹æ®Šæ–¹æ³•ï¼Œä¼šåœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥ç»™å¯¹è±¡ç»‘å®š <code>name</code> &amp; <code>age</code> ä¸¤ä¸ªå±æ€§ï¼Œè¿™æ ·åœ¨å…¶ä»–æ–¹æ³•é‡Œå°±èƒ½å¤Ÿéšæ„è°ƒç”¨è¿™äº›å±æ€§ï¼Œè€Œä¸éœ€è¦å†æ¬¡ä¼ å…¥è¿™äº›å‚æ•°ã€‚ä¸‹é¢æ¥åˆ›å»º <code>Student</code> ç±»çš„å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨å…¶å†…éƒ¨å‡½æ•°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">student_1 <span class="token operator">=</span> Student<span class="token punctuation">(</span><span class="token string">'Declan'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>student_1<span class="token punctuation">.</span>introduce<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># My name is Declan. I'm 23.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºå¯¹è±¡ï¼Œå°±æ˜¯å°†ç±»å®ä¾‹åŒ–ï¼Œå…·ä½“ä¸€ç‚¹æ¥è¯´ï¼šç»™ç±»ä¼ å…¥ä¸€äº›å‚æ•°ï¼Œè®©å…¶ä»æ¨¡æ¿ç§°ä¸ºäº†ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ã€‚å¯ä»¥çœ‹åˆ°åœ¨åˆ›å»ºçš„å¯¹è±¡çš„ä»£ç é‡Œï¼Œå¹¶æ²¡æœ‰æ˜¾å¼ä½¿ç”¨ï¼Œä¹Ÿä¸èƒ½æ˜¾å¼ä½¿ç”¨ç‰¹æ®Šæ–¹æ³• <code>__init__()</code> </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># try this</span>student_2 <span class="token operator">=</span> Student<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token string">'Declan'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·åšä¸€å®šæ˜¯ä¼šæŠ¥é”™çš„ã€‚æ‰€ä»¥æ­£ç¡®çš„ç†è§£æ˜¯ï¼Œ<code>Student(name, age)</code> ä¸­çš„å‚æ•° <code>name</code> &amp; <code>age</code> å°±æ˜¯ç»™ <code>__init__()</code> çš„å‚æ•°ï¼Œå¹¶åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™è‡ªåŠ¨è¿è¡Œ <code>__init__()</code> æ–¹æ³•</p><h3 id="è®¿é—®å¯è§æ€§é—®é¢˜"><a href="#è®¿é—®å¯è§æ€§é—®é¢˜" class="headerlink" title="è®¿é—®å¯è§æ€§é—®é¢˜"></a>è®¿é—®å¯è§æ€§é—®é¢˜</h3><p>åœ¨å¾ˆå¤šé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°†å¯¹è±¡çš„å±æ€§è®¾ç½®ä¸ºç§æœ‰çš„ï¼ˆprivateï¼‰æˆ–å—ä¿æŠ¤çš„ï¼ˆprotectedï¼‰ï¼Œç®€å•çš„è¯´å°±æ˜¯ä¸å…è®¸å¤–ç•Œè®¿é—®ï¼Œè€Œå¯¹è±¡çš„æ–¹æ³•é€šå¸¸éƒ½æ˜¯å…¬å¼€çš„ï¼ˆpublicï¼‰ï¼Œåœ¨ Python ä¸­ï¼Œå±æ€§å’Œæ–¹æ³•çš„è®¿é—®æƒé™åªæœ‰ä¸¤ç§ï¼Œä¹Ÿå°±æ˜¯å…¬å¼€çš„å’Œç§æœ‰çš„ï¼Œå¦‚æœå¸Œæœ›å±æ€§æ˜¯ç§æœ‰çš„ï¼Œåœ¨ç»™å±æ€§å‘½åæ—¶å¯ä»¥ç”¨ä¸¤ä¸ªä¸‹åˆ’çº¿ä½œä¸ºå¼€å¤´</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__private <span class="token operator">=</span> <span class="token string">'private'</span>        self<span class="token punctuation">.</span>__func<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token keyword">def</span> <span class="token function">__func</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>__private<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this function is private'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> Test<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># private</span><span class="token comment"># this function is private</span><span class="token keyword">print</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span>__private<span class="token punctuation">)</span><span class="token comment"># AttributeError: 'Test' object has no attribute '__private'</span><span class="token comment"># ç›´æ¥è®¿é—®è¢«é˜»æ‹¦ï¼Œä½†æ‹ä¸ªå¼¯è¿˜æ˜¯æœ‰æ–¹æ³•èƒ½å¤Ÿè®¿é—®</span><span class="token keyword">print</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span>_Test__private<span class="token punctuation">)</span><span class="token comment"># private</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åœ¨ç±»çš„å†…éƒ¨è°ƒç”¨è¿™äº›ç§æœ‰å˜é‡å’Œå‡½æ•°æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯æƒ³è¦åœ¨å‡½æ•°ä¹‹å¤–ç›´æ¥è®¿é—®è¿™äº›å˜é‡å’Œå‡½æ•°æ˜¯è¢«ç¦æ­¢çš„ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸å»ºè®®å°†å±æ€§è®¾ç½®ä¸ºç§æœ‰çš„ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´å­ç±»æ— æ³•è®¿é—®ï¼ˆåé¢ä¼šè®²åˆ°ï¼‰ã€‚æ‰€ä»¥å¤§å¤šæ•° Python ç¨‹åºå‘˜ä¼šéµå¾ªä¸€ç§å‘½åæƒ¯ä¾‹å°±æ˜¯è®©å±æ€§åä»¥å•ä¸‹åˆ’çº¿å¼€å¤´å¦‚ <code>_name</code>ï¼Œæ¥è¡¨ç¤ºå±æ€§æ˜¯å—ä¿æŠ¤çš„ï¼Œæœ¬ç±»ä¹‹å¤–çš„ä»£ç åœ¨è®¿é—®è¿™æ ·çš„å±æ€§æ—¶åº”è¯¥è¦ä¿æŒæ…é‡</p><h2 id="ç±»çš„æ–¹æ³•"><a href="#ç±»çš„æ–¹æ³•" class="headerlink" title="ç±»çš„æ–¹æ³•"></a>ç±»çš„æ–¹æ³•</h2><h3 id="self"><a href="#self" class="headerlink" title="self"></a>self</h3><p>ç±»çš„æ–¹æ³•ä¸æ™®é€šçš„å‡½æ•°åªæœ‰ä¸€ä¸ªç‰¹åˆ«çš„åŒºåˆ«â€”â€”å®ƒä»¬å¿…é¡»æœ‰ä¸€ä¸ªé¢å¤–çš„<strong>ç¬¬ä¸€ä¸ªå‚æ•°åç§°</strong>ï¼ŒæŒ‰ç…§æƒ¯ä¾‹å®ƒçš„åç§°æ˜¯ selfï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å«å…¶å®ƒåå­—ï¼Œä¸‹é¢çœ‹çœ‹è¿™ä¸ª self åˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">:</span><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>SELF<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>SELF<span class="token punctuation">.</span>__class__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pointer_self</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>test <span class="token operator">=</span> Test<span class="token punctuation">(</span><span class="token punctuation">)</span>test<span class="token punctuation">.</span>pointer_self<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># &lt;class '__main__.Test'&gt;</span><span class="token comment"># &lt;__main__.Test object at 0x000001B64F611040&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æ‰§è¡Œç»“æœå¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºï¼Œself ä»£è¡¨çš„æ˜¯ç±»çš„å®ä¾‹ï¼Œä»£è¡¨å½“å‰å¯¹è±¡çš„åœ°å€ï¼Œè€Œ self.class åˆ™æŒ‡å‘ç±»</p><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p>å¦‚æœä¸€ç§è¯­è¨€ä¸æ”¯æŒç»§æ‰¿ï¼Œç±»å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚å­ç±»ä¼šç»§æ‰¿çˆ¶ç±»ï¼ˆä¹Ÿå«åŸºç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸”è¿˜å¯ä»¥å®šä¹‰è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ‰€ä»¥å­ç±»æ¯”çˆ¶ç±»æ‹¥æœ‰æ›´å¤šçš„èƒ½åŠ›ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªç®€çŸ­çš„ä»£ç ï¼Œç†è§£ç»§æ‰¿æœºåˆ¶çš„é€»è¾‘</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># è¿™æ˜¯ä¹‹å‰å†™çš„å­¦ç”Ÿç±»</span><span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age        self<span class="token punctuation">.</span>log <span class="token operator">=</span> <span class="token string">'this is a student'</span>        <span class="token keyword">def</span> <span class="token function">introduce</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My name is %s. I'm %d."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># ç°åœ¨å»ºç«‹ä¸€ä¸ªæœ¬ç§‘ç”Ÿç±»</span><span class="token keyword">class</span> <span class="token class-name">Undergraduate</span><span class="token punctuation">(</span>Student<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> grade<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># åœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>grade <span class="token operator">=</span> grade    <span class="token keyword">def</span> <span class="token function">which_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'My grade is %d.'</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>grade<span class="token punctuation">)</span>        <span class="token comment"># åœ¨å¤šæ€çš„æ—¶å€™å–æ¶ˆæ³¨é‡Š</span>    <span class="token comment"># def introduce(self):</span>    <span class="token comment">#     print("Hello! My name is %s. I'm %d." % (self.name, self.age))</span>student_1 <span class="token operator">=</span> Undergraduate<span class="token punctuation">(</span><span class="token string">'Declan'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>student_1<span class="token punctuation">.</span>which_grade<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># My grade is 1.</span><span class="token comment"># å­ç±»å®ä¾‹ç›´æ¥ä½¿ç”¨çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</span><span class="token keyword">print</span><span class="token punctuation">(</span>student_1<span class="token punctuation">.</span>log<span class="token punctuation">)</span>student_1<span class="token punctuation">.</span>introduce<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># this is a student</span><span class="token comment"># My name is Declan. I'm 18.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡ç‚¹çš„å‡ ä¸ªé€»è¾‘ï¼š</p><ol><li>å£°æ˜çˆ¶ç±»ï¼Œåœ¨å®šä¹‰çš„ç±»ååä¼ å…¥çˆ¶ç±»åå³å¯ï¼Œå¦‚ <code>class Undergraduate(Student)</code></li><li>è°ƒç”¨çˆ¶ç±»ï¼Œé€šè¿‡ <code>super()</code> å‡½æ•°è°ƒç”¨çˆ¶ç±»ä¸­çš„å±æ€§ã€æ–¹æ³•ï¼Œå¦‚æœæ˜¯ python 2.x çš„è¯éœ€è¦ä½¿ç”¨ <code>super(å­ç±»å, self)</code> è°ƒç”¨</li><li>å®ä¾‹ä½¿ç”¨çˆ¶ç±»ï¼Œå­ç±»å®ä¾‹å¯ä»¥ç›´æ¥ä½¿ç”¨çˆ¶ç±»ä¸­çš„å±æ€§ã€æ–¹æ³•</li></ol><h2 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h2><p>å­ç±»åœ¨ç»§æ‰¿äº†çˆ¶ç±»çš„æ–¹æ³•åï¼Œå¯ä»¥å¯¹çˆ¶ç±»å·²æœ‰çš„æ–¹æ³•ç»™å‡ºæ–°çš„å®ç°ç‰ˆæœ¬ï¼Œè¿™ä¸ªåŠ¨ä½œç§°ä¹‹ä¸ºæ–¹æ³•é‡å†™ï¼ˆoverrideï¼‰ï¼Œçˆ¶ç±»çš„æ–¹æ³•å¯ä»¥è¢«å¤šä¸ªå­ç±»è¿›è¡Œé‡å†™å¾—åˆ°å¤šä¸ªä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼Œè¿™ä¸ªå°±æ˜¯å¤šæ€ï¼ˆpoly-morphismï¼‰</p><p>æŠŠä¸Šä¸€èŠ‚ä¸­å…³äºå¤šæ€çš„ä»£ç å–æ¶ˆæ³¨é‡Šï¼Œå†è°ƒç”¨ <code>introduce()</code> æ–¹æ³•</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">student_1<span class="token punctuation">.</span>introduce<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># Hello! My name is Declan. I'm 18.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å‘ç°æ¯”ä¹‹å‰çˆ¶ç±»çš„ <code>introduce()</code> å¤šæ‰“å°äº† <code>Hello!</code> é‡å†™æˆåŠŸï¼ </p><h2 id="è¡¥å……ï¼šç±»çš„ç‰¹æ®Šæ–¹æ³•"><a href="#è¡¥å……ï¼šç±»çš„ç‰¹æ®Šæ–¹æ³•" class="headerlink" title="è¡¥å……ï¼šç±»çš„ç‰¹æ®Šæ–¹æ³•"></a>è¡¥å……ï¼šç±»çš„ç‰¹æ®Šæ–¹æ³•</h2><p>è¿™äº›ç±»çš„ç‰¹æ®Šæ–¹æ³•ä¹Ÿå«é­”æœ¯æ–¹æ³•ï¼Œåœ¨ç‰¹æ®Šæ¡ä»¶ä¸‹è¢«è°ƒç”¨ï¼Œä¸‹é¢åˆ—ä¸¾ä¸€äº›</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span> <span class="token operator">**</span>__init__ <span class="token punctuation">:</span><span class="token operator">**</span> æ„é€ å‡½æ•°ï¼Œåœ¨ç”Ÿæˆå¯¹è±¡æ—¶è°ƒç”¨<span class="token operator">-</span> <span class="token operator">**</span>__del__ <span class="token punctuation">:</span><span class="token operator">**</span> ææ„å‡½æ•°ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä½¿ç”¨<span class="token operator">-</span> <span class="token operator">**</span>__repr__ <span class="token punctuation">:</span><span class="token operator">**</span> æ‰“å°å¯¹è±¡æ—¶è°ƒç”¨<span class="token operator">-</span> <span class="token operator">**</span>__setitem__ <span class="token punctuation">:</span><span class="token operator">**</span> æŒ‰ç…§ç´¢å¼•èµ‹å€¼<span class="token operator">-</span> <span class="token operator">**</span>__getitem__<span class="token punctuation">:</span><span class="token operator">**</span> æŒ‰ç…§ç´¢å¼•è·å–å€¼<span class="token operator">-</span> <span class="token operator">**</span>__len__<span class="token punctuation">:</span><span class="token operator">**</span> è·å¾—é•¿åº¦<span class="token operator">-</span> <span class="token operator">**</span>__cmp__<span class="token punctuation">:</span><span class="token operator">**</span> æ¯”è¾ƒè¿ç®—<span class="token operator">-</span> <span class="token operator">**</span>__call__<span class="token punctuation">:</span><span class="token operator">**</span> è®©å¯¹è±¡å˜ä¸ºå¯è°ƒç”¨å¯¹è±¡<span class="token comment"># ä¸‹é¢çš„é­”æœ¯æ–¹æ³•å¯ä»¥è¿›è¡Œç®—ç¬¦é‡è½½</span><span class="token operator">-</span> <span class="token operator">**</span>__add__<span class="token punctuation">:</span><span class="token operator">**</span> åŠ è¿ç®—<span class="token operator">-</span> <span class="token operator">**</span>__sub__<span class="token punctuation">:</span><span class="token operator">**</span> å‡è¿ç®—<span class="token operator">-</span> <span class="token operator">**</span>__mul__<span class="token punctuation">:</span><span class="token operator">**</span> ä¹˜è¿ç®—<span class="token operator">-</span> <span class="token operator">**</span>__truediv__<span class="token punctuation">:</span><span class="token operator">**</span> é™¤è¿ç®—<span class="token operator">-</span> <span class="token operator">**</span>__mod__<span class="token punctuation">:</span><span class="token operator">**</span> æ±‚ä½™è¿ç®—<span class="token operator">-</span> <span class="token operator">**</span>__pow__<span class="token punctuation">:</span><span class="token operator">**</span> ä¹˜æ–¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®éªŒä¸€ä¸‹ <code>__repr__, __call__</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"My name is {}. I'm {}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>age<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> grade<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">'grade {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>grade<span class="token punctuation">)</span>name <span class="token operator">=</span> <span class="token string">'Declan'</span>age <span class="token operator">=</span> <span class="token number">23</span>stu <span class="token operator">=</span> Student<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token comment"># My name is Declan. I'm 23.</span><span class="token keyword">print</span><span class="token punctuation">(</span>stu<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># grade 2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¡¥å……ï¼šè£…é¥°å™¨"><a href="#è¡¥å……ï¼šè£…é¥°å™¨" class="headerlink" title="è¡¥å……ï¼šè£…é¥°å™¨"></a>è¡¥å……ï¼šè£…é¥°å™¨</h2><p>å‚è€ƒ <a href="https://www.cnblogs.com/auguse/articles/9922257.html">åšå®¢</a> è¿›è¡Œæ•´ç†ã€‚è£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Python å‡½æ•°æˆ–ç±»ï¼Œå®ƒå¯ä»¥è®©å…¶ä»–å‡½æ•°æˆ–ç±»åœ¨ä¸éœ€è¦åšä»»ä½•ä»£ç ä¿®æ”¹çš„å‰æä¸‹å¢åŠ é¢å¤–åŠŸèƒ½ã€‚ç”±äºåœ¨å­¦ä¹  mmdetection ä¸­å‘ç° <code>registry</code> ç±»çš„å®ç°å°±éœ€è¦è£…é¥°å™¨çš„å¸®å¿™ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°†â€œèŠ±è´¹â€ä¸€äº›ç¯‡å¹…æ¥äº†è§£è£…é¥°å™¨çš„å†…éƒ¨é€»è¾‘</p><h3 id="è£…é¥°å™¨åŸºæœ¬åŸç†"><a href="#è£…é¥°å™¨åŸºæœ¬åŸç†" class="headerlink" title="è£…é¥°å™¨åŸºæœ¬åŸç†"></a>è£…é¥°å™¨åŸºæœ¬åŸç†</h3><p>ä¸‹é¢å…ˆçœ‹çœ‹ä¸ç”¨ python è£…é¥°å™¨ï¼Œæ€æ ·å®ç°å…¶ç±»ä¼¼çš„åŠŸèƒ½</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åŸå‡½æ•°</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My name is {}, and I'm {}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨æ¥åŒ…è£…åŸå‡½æ•°</span><span class="token keyword">def</span> <span class="token function">decorate</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'This is my introduction.'</span><span class="token punctuation">)</span>        func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>    <span class="token comment"># è¿”å›æ–°çš„å‡½æ•°å</span>    <span class="token keyword">return</span> wrap<span class="token comment"># å°†åŸå‡½æ•°åŒ…è£…ï¼Œå¹¶å°†åŸå‡½æ•°æŒ‡å‘è£…é¥°åçš„å‡½æ•°</span>test  <span class="token operator">=</span> decorate<span class="token punctuation">(</span>test<span class="token punctuation">)</span>name <span class="token operator">=</span> <span class="token string">'Declan'</span>age <span class="token operator">=</span> <span class="token number">23</span>test<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token comment"># This is my introduction.</span><span class="token comment"># My name is Declan, and I'm 23.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„è£…é¥°å™¨ï¼Œè¯¥è£…é¥°å™¨çš„åŠŸèƒ½å°±æ˜¯åœ¨åŸå‡½æ•°ä¹‹å‰æ‰“å°ä¸€å¥è¯ <code>This is my introduction</code></p><p>python ä½¿ç”¨ <code>@</code> å…³é”®å­—æ¥å®ç°è£…é¥°å™¨ï¼Œå…·ä½“æ¥è¯´ <code>@</code> å…³é”®å­—å®ç°çš„æ˜¯ä¸Šé¢ä»£ç ä¸­çš„æ³¨é‡Šâ€œå°†åŸå‡½æ•°åŒ…è£…ï¼Œå¹¶å°†åŸå‡½æ•°æŒ‡å‘è£…é¥°åçš„å‡½æ•°â€ã€‚å°†ä¹‹å‰çš„è£…é¥°å™¨ï¼Œç”¨ <code>@</code> é‡æ–°å®ç°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨æ¥åŒ…è£…åŸå‡½æ•°</span><span class="token keyword">def</span> <span class="token function">decorate</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'This is my introduction.'</span><span class="token punctuation">)</span>        func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>    <span class="token comment"># è¿”å›æ–°çš„å‡½æ•°å</span>    <span class="token keyword">return</span> wrap<span class="token comment"># åŸå‡½æ•°+è£…é¥°å™¨</span><span class="token decorator annotation punctuation">@decorate</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My name is {}, and I'm {}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># test  = decortate(test)</span>name <span class="token operator">=</span> <span class="token string">'Declan'</span>age <span class="token operator">=</span> <span class="token number">23</span>test<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token comment"># This is my introduction.</span><span class="token comment"># My name is Declan, and I'm 23</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># &lt;class 'function'&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå°±æ˜¯åœ¨åŸå‡½æ•°ä¹‹å‰åŠ ä¸Š <code>@decorate</code> å°±å®ç°äº†å¯¹åŸå‡½æ•°çš„è£…é¥°ï¼Œæ›¿ä»£äº† <code>test  = decorate(test)</code> è¿™ä¸€æ­¥ã€‚æ¢å¥è¯è¯´ <code>@</code> å…³é”®å­—å°†ä¸‹ä¸€è¡Œçš„å‡½æ•°/ç±»ï¼Œä½œä¸ºå‚æ•°ä¼ ç»™äº† <code>decorate</code> å‡½æ•°ï¼Œè¿™å°±æ˜¯è£…é¥°å™¨çš„å…³é”®ä¹‹ä¸€ã€‚ä¹‹å‰çš„è£…é¥°å™¨åªæ¥å—äº†åŸå‡½æ•° <code>test</code> ä½œä¸ºå‚æ•°ï¼Œé‚£å¦‚æœæƒ³è¦å®ç°ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œä¾‹å¦‚ <code>@decorate(*args)</code> åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæ¥ä¸‹æ¥å®ç°ä¸€ä¸ªå¸¦å‚æ•°çš„è£…é¥°å™¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">name <span class="token operator">=</span> <span class="token string">'Declan'</span>age <span class="token operator">=</span> <span class="token number">23</span><span class="token keyword">def</span> <span class="token function">param_decorate</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"It's running without test()"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">wrap</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'This is a introduction.'</span><span class="token punctuation">)</span>        func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">None</span>    <span class="token keyword">return</span> wrap<span class="token decorator annotation punctuation">@param_decorate</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My name is {}, and I'm {}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ä½¿æ²¡æœ‰è¿è¡Œ test() ä»¥ä¸Šä»£ç èƒ½å¤Ÿè¾“å‡ºå†…å®¹</span><span class="token comment"># It's running without test()</span><span class="token comment"># This is a introduction.</span><span class="token comment"># My name is Declan, and I'm 23</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># &lt;class 'NoneType'&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ä»¥ä¸Šä»£ç ä¼šå‘ç°ï¼Œå³ä½¿æ²¡æœ‰è¿è¡Œ <code>test</code> å‡½æ•°ä¹Ÿè¾“å‡ºäº†å†…å®¹ã€‚è¿™æ˜¯å› ä¸ºç»™è£…é¥°å™¨æ·»åŠ å‚æ•°è¿‡åï¼Œé‚£ä¹ˆ <code>@</code> åè·Ÿéšçš„å°±æ˜¯ä¸€ä¸ªæ‰§è¡Œå‡½æ•°ï¼Œpython å°±ä¼šçœŸå®åœ°æ‰§è¡Œè¯¥å‡½æ•°çš„å†…å®¹ã€‚æ‰§è¡Œ <code>param_decorate</code> å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°å <code>wrap</code>ï¼Œé‚£ä¹ˆæ­¤æ—¶ç›¸å½“äº <code>@wrap</code>ï¼Œä¹Ÿå³ <code>test</code> å‡½æ•°ä¼šè¢«ä½œä¸ºå‚æ•°ä¼ å…¥åˆ° <code>wrap()</code> å‡½æ•°å½“ä¸­ï¼Œæ­¤æ—¶ <code>test  = wrap(test)</code> çš„è¿”å›å¯¹è±¡æ˜¯ <code>NoneType</code>ï¼Œè€Œä¹‹å‰ <code>test = decorate(test)</code> è¿”å›å¯¹è±¡æ˜¯ä¸€ä¸ªå‡½æ•°å</p><p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•æ¥å­¦ä¹ è£…é¥°å™¨çš„å†…éƒ¨é€»è¾‘ï¼Œå°±æ˜¯ç›´æ¥å¯¹ä»£ç  debugï¼Œä¸€æ­¥æ­¥çœ‹ç¨‹åºæ˜¯å¦‚ä½•è¿è¡Œçš„</p><h3 id="python-å†…ç½®è£…é¥°å™¨"><a href="#python-å†…ç½®è£…é¥°å™¨" class="headerlink" title="python å†…ç½®è£…é¥°å™¨"></a>python å†…ç½®è£…é¥°å™¨</h3><p>å†…ç½®çš„è£…é¥°å™¨å’Œæ™®é€šçš„è£…é¥°å™¨åŸç†æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ä¸€èˆ¬ç”¨äºç±»çš„æ–¹æ³•å½“ä¸­ï¼Œè®©ç±»å˜å¾—æ›´çµæ´»</p><h4 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h4><p>å‚è€ƒ <a href="https://www.runoob.com/python/python-func-property.html">èœé¸Ÿæ•™ç¨‹</a> <a href="https://www.liaoxuefeng.com/wiki/897692888725344/923030547069856">å»–é›ªå³°æ•™ç¨‹ </a>è¿›è¡Œæ•´ç†ã€‚<code>@property</code> èƒ½å¤Ÿç”¨äºç®¡ç†ç±»çš„ç§æœ‰å±æ€§ï¼Œæ–¹ä¾¿è¯»å–å±æ€§ã€ä¿®æ”¹å±æ€§ã€‚ä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨è¯¥è£…é¥°å™¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">:</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">get_the_score</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""I'm the 'score' property."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_score     <span class="token decorator annotation punctuation">@get_the_score<span class="token punctuation">.</span>setter</span>    <span class="token keyword">def</span> <span class="token function">score</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_score <span class="token operator">=</span> value     <span class="token decorator annotation punctuation">@get_the_score<span class="token punctuation">.</span>deleter</span>    <span class="token keyword">def</span> <span class="token function">score</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">del</span> self<span class="token punctuation">.</span>_scorestudent <span class="token operator">=</span> Student<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># setterä¸ä»…å¯ä»¥æ›´æ”¹å±æ€§å€¼ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºè¯¥å±æ€§</span>student<span class="token punctuation">.</span>get_the_score <span class="token operator">=</span> <span class="token number">60</span><span class="token comment"># æŸ¥çœ‹å±æ€§</span><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>get_the_score<span class="token punctuation">)</span><span class="token comment"># 60</span><span class="token comment"># ä¹Ÿä½¿ç”¨åŸå±æ€§åç§°æ›´æ”¹å’Œè®¿é—®</span>student<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">100</span><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token comment"># 100</span><span class="token comment"># åˆ é™¤å±æ€§</span><span class="token comment"># del student.score</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>@property</code> çš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯çœŸæ²¡ç†è§£ï¼Œè¿™é‡Œç›´æ¥å¼•ç”¨ä¸€ä¸‹å»–é›ªå³°æ•™ç¨‹ä¸­çš„è¯ï¼š</p><blockquote><p>æŠŠä¸€ä¸ª <code>get_the_score</code> æ–¹æ³•å˜æˆå±æ€§ï¼Œåªéœ€è¦åŠ ä¸Š <code>@property</code> å°±å¯ä»¥äº†ã€‚æ­¤æ—¶ï¼Œ<code>@property</code>æœ¬èº«åˆåˆ›å»ºäº†å¦ä¸€ä¸ªè£…é¥°å™¨ <code>@get_the_score.setter</code>ï¼Œè´Ÿè´£æŠŠä¸€ä¸ª setter æ–¹æ³•å˜æˆå±æ€§èµ‹å€¼ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰ä¸€ä¸ªå¯æ§çš„å±æ€§æ“ä½œ</p></blockquote><p>æˆ‘è‡ªå·±ç†è§£ï¼Œå¦‚æœéœ€è¦åªè¯»å±æ€§ï¼Œåˆ™åªä½¿ç”¨ <code>@property</code> è£…é¥°å™¨å°±å¯ä»¥äº†ï¼Œå¦‚æœè¿˜éœ€è¦å¯¹å±æ€§è¿›è¡Œè¿›ä¸€æ­¥æ“æ§åˆ™åŠ ä¸Šå…¶ä»– <code>setter, deleter</code> è£…é¥°å™¨</p><p>è€Œä¸”ï¼Œå¦‚æœä½¿ç”¨äº† <code>property</code> è£…é¥°å™¨ï¼Œå¿…é¡»è¦ä½¿ç”¨å•ä¸‹åˆ’çº¿å˜é‡ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œå…·ä½“åŸå› å‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/53469919">çŸ¥ä¹é“¾æ¥</a></p><h4 id="classmethod"><a href="#classmethod" class="headerlink" title="@classmethod"></a>@classmethod</h4><p>å‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/35643573">çŸ¥ä¹é“¾æ¥</a> è¿›è¡Œæ•´ç†ï¼Œ<code>classmethod</code> åˆè¢«å«åšç±»æ–¹æ³•ã€‚<code>__init__()</code> ä½œä¸ºç±»çš„æ„é€ å‡½æ•°ï¼Œèƒ½å¤Ÿåœ¨ç”Ÿæˆå¯¹è±¡æ—¶è°ƒç”¨ï¼Œä½†å¦‚æœæƒ³è¦ä½¿ç”¨å…¶ä»–æ„é€ å‡½æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>@classmethod</code> å®ç°ï¼Œä¸‹é¢çœ‹å¦‚ä½•ä½¿ç”¨ç±»æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆä¸ºæ–¹ä¾¿ï¼ŒæŠŠé™æ€æ–¹æ³• <code>staticmethod</code> çš„ä»£ç ä¹Ÿå†™åœ¨è¿™å„¿ï¼‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>year <span class="token operator">=</span> year        self<span class="token punctuation">.</span>month <span class="token operator">=</span> month        self<span class="token punctuation">.</span>day <span class="token operator">=</span> day        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{}å¹´{}æœˆ{}æ—¥'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>year<span class="token punctuation">,</span> self<span class="token punctuation">.</span>month<span class="token punctuation">,</span> self<span class="token punctuation">.</span>day<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">create_from_string</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span>        year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span>string<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> cls<span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@staticmethod</span>    <span class="token keyword">def</span> <span class="token function">is_leap</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> year <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>        <span class="token keyword">elif</span> year <span class="token operator">%</span> <span class="token number">400</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token comment"># æ™®é€šæ„é€ </span>date <span class="token operator">=</span> Date<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token comment"># 2020å¹´7æœˆ31æ—¥</span><span class="token comment"># é€šè¿‡ç±»æ–¹æ³•æ„é€ </span>date <span class="token operator">=</span> Date<span class="token punctuation">.</span>create_from_string<span class="token punctuation">(</span><span class="token string">'2020-7-31'</span><span class="token punctuation">)</span><span class="token comment"># 2020å¹´7æœˆ31æ—¥</span><span class="token comment"># ä½¿ç”¨é™æ€æ–¹æ³•</span><span class="token keyword">print</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span>is_leap<span class="token punctuation">(</span><span class="token number">1900</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ç±»æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå…¶è¡¨ç¤ºè°ƒç”¨å½“å‰çš„ç±»åï¼Œé»˜è®¤åç§°ä¸º <code>cls</code>ï¼Œæœ‰ç‚¹ç±»ä¼¼äº <code>self</code> è¡¨ç¤ºç±»çš„å®ä¾‹ã€‚é‚£ä¹ˆç±»æ–¹æ³•æœ€åçš„è¿”å›å€¼ <code>return cls(year, month, day)</code> ä¹Ÿå°±ä¸éš¾ç†è§£äº†ï¼Œç›¸å½“äº <code>return Data(year, month, day)</code> é‡æ–°åˆ›å»ºäº†å¯¹è±¡</p><p>ç±»æ–¹æ³•èƒ½å¤Ÿåœ¨ä¸æ”¹å˜åŸæœ¬æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹ï¼Œç»™ç±»çš„æ„é€ æ–¹æ³•å¢åŠ ä¸€äº›é¢å¤–åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹äºä¼ å…¥å‚æ•°åšä¸€äº›ä¸åŒçš„å¤„ç†ç­‰ç­‰</p><h4 id="staticmethod"><a href="#staticmethod" class="headerlink" title="@staticmethod"></a>@staticmethod</h4><p>å‚è€ƒ <a href="https://www.cnblogs.com/Meanwey/p/9788713.html">åšå®¢</a> çš„è¯´æ³•ï¼š<code>@staticmethod</code> é™æ€æ–¹æ³•åªæ˜¯åä¹‰ä¸Šå½’å±ç±»ç®¡ç†ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨ç±»å˜é‡å’Œå®ä¾‹å˜é‡ï¼Œæ˜¯ç±»çš„å·¥å…·åŒ…ã€‚å› ä¸ºè¯¥å‡½æ•°ä¸ä¼ å…¥selfæˆ–è€…clsï¼Œæ‰€ä»¥ä¸èƒ½è®¿é—®ç±»å±æ€§å’Œå®ä¾‹å±æ€§ã€‚é™æ€æ–¹æ³•çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œä¸ç”¨åˆ›å»ºç±»çš„å®ä¾‹ä¹Ÿèƒ½å¤Ÿè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå…·ä½“è°ƒç”¨æ–¹æ³•å‚è€ƒä¸Šé¢ä»£ç </p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Python </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 4 æ‹“å±•</title>
      <link href="/archives/c19cb72c.html"/>
      <url>/archives/c19cb72c.html</url>
      
        <content type="html"><![CDATA[<h1 id="python-æ‹“å±•"><a href="#python-æ‹“å±•" class="headerlink" title="python æ‹“å±•"></a>python æ‹“å±•</h1><h2 id="formatè¾“å‡º"><a href="#formatè¾“å‡º" class="headerlink" title="formatè¾“å‡º"></a>formatè¾“å‡º</h2><p>è¿™é‡Œæ€»ç»“ä¸€ä¸‹ format è¾“å‡ºçš„å½¢å¼ï¼Œä¸»è¦ä»¥ <code>{position:format}</code> å½¢å¼å¯¹å˜é‡è¿›è¡Œå¼•ç”¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">name <span class="token operator">=</span> <span class="token string">'Declan'</span>age <span class="token operator">=</span> <span class="token number">23</span><span class="token comment"># æŒ‰ç…§é¡ºåºå¼•ç”¨</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{0} {1} {0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Declan 23 Declan</span><span class="token comment"># æŒ‰ç…§å…³é”®å­—å¼•ç”¨</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{name} {age}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">,</span> age<span class="token operator">=</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Declan 23</span><span class="token comment"># æ•°å­—æ ¼å¼åŒ–</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 23.00</span><span class="token comment"># è¾“å‡ºå·¦å³å¯¹é½</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{:0&gt;10d}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># å‘å³å¯¹é½ï¼Œé»˜è®¤å®½åº¦ä¸º10ï¼Œä¸å¤Ÿä»¥0è¡¥ä½</span><span class="token comment"># 0000000023</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{:x&lt;10b}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># å‘å·¦å¯¹é½ï¼Œé»˜è®¤å®½åº¦ä¸º10ï¼Œä¸å¤Ÿä»¥xè¡¥ä½</span><span class="token comment"># 10111xxxxx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¯»å†™æ–‡ä»¶"><a href="#è¯»å†™æ–‡ä»¶" class="headerlink" title="è¯»å†™æ–‡ä»¶"></a>è¯»å†™æ–‡ä»¶</h2><p>Python open() æ–¹æ³•ç”¨äºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è¿”å›æ–‡ä»¶å¯¹è±¡ï¼Œåœ¨å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†è¿‡ç¨‹éƒ½éœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯¥æ–‡ä»¶æ— æ³•è¢«æ‰“å¼€ï¼Œä¼šæŠ›å‡º OSErrorã€‚<strong>æ³¨æ„ï¼š</strong>ä½¿ç”¨ open() æ–¹æ³•ä¸€å®šè¦ä¿è¯å…³é—­æ–‡ä»¶å¯¹è±¡ï¼Œå³è°ƒç”¨ close() æ–¹æ³•</p><p>open() å‡½æ•°å¸¸ç”¨å½¢å¼æ˜¯æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šæ–‡ä»¶å(file)å’Œæ¨¡å¼(mode)ï¼Œæ›´å¤šå‚æ•°æŸ¥è¯¢  <a href="https://www.runoob.com/python/file-methods.html">èœé¸Ÿæ•™ç¨‹</a>ã€‚ç°åœ¨ä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„ <code>mode</code> å‚æ•°ï¼š</p><ol><li><code>r</code>ï¼Œåªè¯»æ¨¡å¼ï¼Œä¸ºé»˜è®¤è®¾ç½®</li><li><code>w</code>ï¼Œå†™å…¥æ¨¡å¼ï¼Œä¼šæ“¦é™¤æ–‡ä»¶ä¸­ä¹‹å‰çš„å†…å®¹ï¼Œé‡æ–°å†™å…¥ã€‚å¦‚æœæ²¡æœ‰æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»º</li><li><code>a</code>ï¼Œé™„åŠ æ¨¡å¼ï¼Œä¼šåœ¨æ–‡ä»¶æœ«å°¾åŠ å…¥æ–°å†…å®¹</li><li><code>r+</code>ï¼Œè¯»å†™æ¨¡å¼ï¼ŒæŒ‡é’ˆä½äºæ–‡ä»¶å¼€å¤´</li></ol><p>ä¸‹é¢ä»‹ç»æ“ä½œæ–‡ä»¶çš„åŸºæœ¬åŠŸèƒ½ï¼šè¯»å’Œå†™ã€‚æˆ‘ä»¬å…ˆåœ¨ python è„šæœ¬æ‰€åœ¨æ–‡ä»¶å¤¹æ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ <code>test.txt</code> å†…å®¹ä¸º <code>a, b, c</code></p><h3 id="è¯»æ–‡ä»¶"><a href="#è¯»æ–‡ä»¶" class="headerlink" title="è¯»æ–‡ä»¶"></a>è¯»æ–‡ä»¶</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.txt'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token comment"># ä½¿ç”¨ read(size) è¾“å‡º</span><span class="token comment"># å¦‚æœä¸ä¼ å…¥è¾“å‡ºå­—ç¬¦æ•°é‡ï¼Œåˆ™å…¨éƒ¨è¾“å‡º</span><span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># a, b, c</span><span class="token comment"># è¯»å®Œæ–‡ä»¶è¿‡åéœ€è¦ç§»åŠ¨æŒ‡é’ˆåˆ°æ–‡ä»¶å¼€å¤´æ‰èƒ½é‡æ–°å†è¯»ä¸€é</span><span class="token comment"># ä½¿ç”¨ seek(offset)ï¼Œé»˜è®¤0ä½ç½®ä»æ–‡ä»¶å¼€å¤´ç®—èµ·</span>f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># ä½¿ç”¨ readlines() é€è¡Œè¾“å‡º</span><span class="token comment"># è¯¥æ–¹æ³•è¿”å›å€¼æ˜¯ç”±æ¯ä¸€è¡Œå†…å®¹ç»„æˆçš„ä¸€ä¸ªåˆ—è¡¨</span><span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment"># a, b, c</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å†™æ–‡ä»¶"><a href="#å†™æ–‡ä»¶" class="headerlink" title="å†™æ–‡ä»¶"></a>å†™æ–‡ä»¶</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.txt'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token comment"># ä½¿ç”¨ write(str) åœ¨æŒ‡é’ˆå¤„å†™å…¥å†…å®¹</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\nadd something'</span><span class="token punctuation">)</span><span class="token comment"># a, b, c</span><span class="token comment"># add something</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœéœ€è¦å†™å…¥ä¸­æ–‡ï¼Œå»ºè®®è®¾ç½®ç¼–ç ä¸º utf-8ï¼Œ<code>open(filename, mode, encoding='utf-8')</code></p><h3 id="with-å…³é”®å­—"><a href="#with-å…³é”®å­—" class="headerlink" title="with å…³é”®å­—"></a>with å…³é”®å­—</h3><p>ä¸€äº›å¯¹è±¡å®šä¹‰äº†æ ‡å‡†çš„æ¸…ç†è¡Œä¸ºï¼Œæ— è®ºç³»ç»Ÿæ˜¯å¦æˆåŠŸçš„ä½¿ç”¨äº†å®ƒï¼Œä¸€æ—¦ä¸éœ€è¦å®ƒäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ ‡å‡†çš„æ¸…ç†è¡Œä¸ºå°±ä¼šæ‰§è¡Œã€‚åªéœ€è¦è¯¥å¯¹è±¡å®šä¹‰äº† <code>__enter__ &amp; __exit__</code> é­”æœ¯æ–¹æ³•ï¼Œå…³é”®å­— with å°±å¯ä»¥ä¿è¯è¯¸å¦‚æ–‡ä»¶ä¹‹ç±»çš„å¯¹è±¡åœ¨ä½¿ç”¨å®Œä¹‹åä¸€å®šä¼šæ­£ç¡®çš„æ‰§è¡Œä»–çš„æ¸…ç†æ–¹æ³•</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token comment"># statement</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="os-amp-sys-æ¨¡å—"><a href="#os-amp-sys-æ¨¡å—" class="headerlink" title="os &amp; sys æ¨¡å—"></a>os &amp; sys æ¨¡å—</h2><h3 id="os"><a href="#os" class="headerlink" title="os"></a>os</h3><p><strong>os</strong> æ¨¡å—æä¾›äº†éå¸¸ä¸°å¯Œçš„æ–¹æ³•ç”¨æ¥å¤„ç†æ–‡ä»¶å’Œç›®å½•ã€‚å…³äº os æ¨¡å—æ›´å¤šæ“ä½œå¯ä»¥æŸ¥è¯¢ <a href="https://www.runoob.com/python3/python3-os-file-methods.html">èœé¸Ÿæ•™ç¨‹</a>ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„éƒ¨åˆ†ã€‚ç”±äºè¿”å›çš„è¿™äº›è·¯å¾„å¤šä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²çš„æ“ä½œåœ¨è¿™é‡Œä¹Ÿä¼šç»å¸¸ä½¿ç”¨</p><h4 id="ç³»ç»Ÿç›¸å…³"><a href="#ç³»ç»Ÿç›¸å…³" class="headerlink" title="ç³»ç»Ÿç›¸å…³"></a>ç³»ç»Ÿç›¸å…³</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>name<span class="token punctuation">)</span>  <span class="token comment"># æ“ä½œç³»ç»Ÿåç§°</span><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">)</span>   <span class="token comment"># ç¯å¢ƒå˜é‡ï¼Œè¿”å›ä¸€ä¸ªâ€œå­—å…¸â€</span><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">,</span> os<span class="token punctuation">.</span>pathsep<span class="token punctuation">)</span>   <span class="token comment"># è·¯å¾„åˆ†å‰²ç¬¦å·ï¼Œwindows ä¸º \ ;</span><span class="token comment"># æŸ¥çœ‹ä¸€ä¸‹ PATH ç¯å¢ƒå˜é‡</span><span class="token comment"># PATHä¸€èˆ¬ä¸ºç³»ç»ŸæŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„æœç´¢è·¯å¾„</span>PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'PATH'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token keyword">for</span> path <span class="token keyword">in</span> PATH<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ–‡ä»¶å’Œç›®å½•"><a href="#æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ–‡ä»¶å’Œç›®å½•"></a>æ–‡ä»¶å’Œç›®å½•</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> ospath <span class="token operator">=</span> <span class="token string">'.'</span>  <span class="token comment"># å½“å‰æ–‡ä»¶å¤¹</span>os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'folder'</span><span class="token punctuation">)</span>os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">'folder\subfolder'</span><span class="token punctuation">)</span>os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>path<span class="token punctuation">)</span>   <span class="token comment"># åˆ é™¤æ–‡ä»¶</span>os<span class="token punctuation">.</span>removedirs<span class="token punctuation">(</span>path<span class="token punctuation">)</span>   <span class="token comment"># åˆ é™¤ç©ºæ–‡ä»¶å¤¹</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token comment"># è¿”å›æ–‡ä»¶åˆ—è¡¨</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›å½“å‰è·¯å¾„</span><span class="token comment"># os.path æ˜¯ä¸€ä¸ªå¸¸ç”¨æ¨¡å—ï¼Œé‡ç‚¹ä»‹ç»</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>path<span class="token punctuation">)</span>   <span class="token comment"># è¿”å›ç»å¯¹è·¯å¾„</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>path<span class="token punctuation">)</span>   <span class="token comment"># è¿”å›è·¯å¾„çš„ dirname</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>path<span class="token punctuation">)</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token comment"># æŠŠè·¯å¾„åˆ†å‰²æˆ dirname å’Œ basenameï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splittext<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token comment"># å°†è·¯å¾„çš„æ‰©å±•ååˆ†ç¦»å‡ºæ¥</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path<span class="token punctuation">)</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token operator">*</span>path<span class="token punctuation">)</span><span class="token comment"># å°†å¤šä¸ªåç§°åˆæˆä¸ºä¸€ä¸ªè·¯å¾„å</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h3><p>sys å³ systemï¼Œè¯¥æ¨¡å—æä¾›äº†ä¸€äº›æ¥å£ï¼Œç”¨äºè®¿é—® Python è§£é‡Šå™¨è‡ªèº«ä½¿ç”¨å’Œç»´æŠ¤çš„å˜é‡ã€‚ä¸‹é¢åˆ—ä¸¾ä¸€äº›å¸¸ç”¨æˆå‘˜</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> syssys<span class="token punctuation">.</span>version <span class="token comment"># ç‰ˆæœ¬å·</span>sys<span class="token punctuation">.</span>path    <span class="token comment"># python è§£é‡Šå™¨æœç´¢è·¯å¾„</span>sys<span class="token punctuation">.</span>argv    <span class="token comment"># ä¼ å…¥å½“å‰ python æ–‡ä»¶çš„å‚æ•°åˆ—è¡¨</span>sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># é€€å‡ºçŠ¶æ€ç </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é”™è¯¯å’Œå¼‚å¸¸"><a href="#é”™è¯¯å’Œå¼‚å¸¸" class="headerlink" title="é”™è¯¯å’Œå¼‚å¸¸"></a>é”™è¯¯å’Œå¼‚å¸¸</h2><p>å½“ Python è„šæœ¬å‘ç”Ÿå¼‚å¸¸æ—¶æˆ‘ä»¬éœ€è¦æ•è·å¤„ç†å®ƒï¼Œå¦åˆ™ç¨‹åºä¼šç»ˆæ­¢æ‰§è¡Œ</p><h3 id="tryç›¸å…³"><a href="#tryç›¸å…³" class="headerlink" title="tryç›¸å…³"></a>tryç›¸å…³</h3><p>å¼‚å¸¸å¤„ç†çš„æ–¹æ³•</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>    statement<span class="token keyword">except</span> Exception<span class="token punctuation">:</span>    <span class="token comment"># å‘ç”Ÿå¼‚å¸¸æ—¶æ‰§è¡Œçš„ä»£ç </span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Something Wrong!'</span><span class="token punctuation">)</span>    statement<span class="token comment"># å¯ä»¥æœ‰å¤šä¸ª exception è¡¨ç¤ºé¢å¯¹ä¸åŒå¼‚å¸¸çš„å¤„ç†</span><span class="token keyword">except</span> Excepthion_2<span class="token punctuation">:</span>    <span class="token comment"># å‘ç”Ÿå¼‚å¸¸æ—¶æ‰§è¡Œçš„ä»£ç </span>    statement<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token comment"># æ²¡æœ‰å¼‚å¸¸æ—¶æ‰§è¡Œçš„ä»£ç </span>    statement<span class="token keyword">finally</span><span class="token punctuation">:</span>    <span class="token comment"># æ— è®ºæœ‰æ²¡æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œçš„ä»£ç </span>    statement<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="raise"><a href="#raise" class="headerlink" title="raise"></a>raise</h3><p>Python ä½¿ç”¨ raise è¯­å¥æŠ›å‡ºä¸€ä¸ªæŒ‡å®šçš„å¼‚å¸¸ã€‚æ›´å¤š python å†…ç½®å¼‚å¸¸æŸ¥çœ‹ <a href="https://www.runoob.com/python/python-exceptions.html">èœé¸Ÿæ•™ç¨‹</a></p><h3 id="assert"><a href="#assert" class="headerlink" title="assert"></a>assert</h3><p>Python assertï¼ˆæ–­è¨€ï¼‰ç”¨äºåˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œåœ¨è¡¨è¾¾å¼æ¡ä»¶ä¸º false çš„æ—¶å€™è§¦å‘å¼‚å¸¸ã€‚å…¶åŸºæœ¬è¯­æ³•ä¸º</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">assert</span> expression <span class="token punctuation">[</span><span class="token punctuation">,</span> arguments<span class="token punctuation">]</span><span class="token comment"># ä¸ä»¥ä¸‹ä»£ç ç­‰ä»·</span><span class="token keyword">if</span> <span class="token keyword">not</span> expression<span class="token punctuation">:</span>    <span class="token keyword">raise</span> AssertionError<span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹‹åçš„å‚æ•°ä¸ºæŠ›å‡ºå¼‚å¸¸çš„è¡¥å……ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨åŠ ã€‚ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Somenthing Wrong!'</span><span class="token comment"># ä»¥ä¸‹ä¸ºå¼‚å¸¸</span>Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>  File <span class="token string">"d:/..."</span><span class="token punctuation">,</span> line <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>    <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Somenthing Wrong!'</span>AssertionError<span class="token punctuation">:</span> Somenthing Wrong!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="argparse-æ¨¡å—"><a href="#argparse-æ¨¡å—" class="headerlink" title="argparse æ¨¡å—"></a>argparse æ¨¡å—</h2><p>argsparse æ˜¯ python çš„å‘½ä»¤è¡Œè§£æçš„æ ‡å‡†æ¨¡å—ï¼Œå†…ç½®äºpythonï¼Œä¸éœ€è¦å®‰è£…ã€‚è¿™ä¸ªåº“å¯ä»¥è®©æˆ‘ä»¬<strong>ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­å°±å¯ä»¥å‘ç¨‹åºä¸­ä¼ å…¥å‚æ•°</strong>ï¼ŒåŒæ—¶argparseä¼šè‡ªåŠ¨ç”Ÿæˆå¸®åŠ©æ–‡æ¡£ï¼Œä¼ å…¥å‚æ•° <code>-h</code> æ˜¾ç¤ºã€‚ä¸‹é¢å†™ä¸€ä¸ª python è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># arg.py</span><span class="token keyword">import</span> argparse<span class="token comment"># åˆ›å»º parser å¹¶æ·»åŠ æè¿°ï¼Œé€šå¸¸ä¸ºè¯¥è„šæœ¬çš„ç”¨é€”</span>parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'this is a parser'</span><span class="token punctuation">)</span><span class="token comment"># æ·»åŠ å‚æ•°</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'params'</span><span class="token punctuation">)</span><span class="token comment"># è§£æå‚æ•°</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'show the params:'</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äº argparse æ¨¡å—æ˜¯ä»å‘½ä»¤è¡Œå‘æ–‡ä»¶ä¼ å…¥å‚æ•°ï¼Œæ‰€ä»¥ç°åœ¨åœ¨ cmd ä¸‹ç»™æ–‡ä»¶ååé¢ä¼ å…¥å‚æ•° 123 å¾—åˆ°ç»“æœå¦‚ä¸‹</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">(base) D:\VScodeProjects\LearnManim&gt;python arg.py 123show the params: 123# å‚æ•° 123 ä¼ å…¥åˆ°äº†æ–‡ä»¶ä¸­ parser çš„ä½ç½®å‚æ•° params ä¸­<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä» <code>arg.py</code> ä¸­çœ‹å‡ºä½¿ç”¨ argparse æ¨¡å—çš„æ­¥éª¤ï¼š</p><ol><li>åˆ›å»º <code>ArgumentParser</code> å¯¹è±¡</li><li>ç»™å¯¹è±¡ä¸­åŠ å…¥å‚æ•° <code>add_argument</code></li><li>è§£æå¯¹è±¡ï¼Œä¹Ÿå³å°†å‘½ä»¤è¡Œä¸­çš„å‚æ•°ä¼ ç»™ <code>args</code>ï¼Œä¹‹åèƒ½å¤Ÿåƒç±»çš„å±æ€§ä¸€æ ·è°ƒç”¨è¿™äº›å‚æ•° <code>args.params</code></li></ol><p>ä¸‹é¢æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹æ–¹æ³• <code>add_argument</code>ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ–¹ä¾¿æˆ‘ä»¬ä»å‘½ä»¤è¡Œè¾“å…¥å‚æ•°ã€‚å…ˆæ¥çœ‹çœ‹è¯¥å‡½æ•°è‡ªå·±çš„å‚æ•°</p><ol><li><p>ä½ç½®å‚æ•°ï¼šä¸å¸¦ <code>-</code> çš„å‚æ•°ã€‚ä»å‘½ä»¤è¡Œä¼ å…¥çš„å‚æ•°ä¼šæŒ‰ç…§é¡ºåºä¼ ç»™ parser æ·»åŠ çš„å‚æ•°ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º 123ï¼Œè€Œ parser ä¸­æ·»åŠ çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>params</code>ï¼Œæ‰€ä»¥ 123 ä¼ ç»™äº† <code>params</code>ã€‚æ­£å¦‚ python è‡ªèº«å‡½æ•°ä¼ å‚è§„åˆ™ä¸€æ ·ï¼Œä½ç½®å‚æ•°æ˜¯å¿…é¡»è¦ä¼ å…¥çš„å‚æ•°ï¼Œå¦‚æœä¸ä¼ å…¥åˆ™ä¼šæŠ¥é”™</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>base<span class="token punctuation">)</span> D<span class="token punctuation">:</span>\VScodeProjects\LearnManim<span class="token operator">&gt;</span>python arg<span class="token punctuation">.</span>py         usage<span class="token punctuation">:</span> arg<span class="token punctuation">.</span>py <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span> paramsarg<span class="token punctuation">.</span>py<span class="token punctuation">:</span> error<span class="token punctuation">:</span> the following arguments are required<span class="token punctuation">:</span> params<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>å¯é€‰å‚æ•°ï¼šå¸¦ <code>-</code> çš„å‚æ•°ã€‚å¯é€‰å‚æ•°æœ‰ä¸¤ç§æ–¹å¼ï¼Œ</p><ul><li><code>-</code> æŒ‡å®šçŸ­å‚æ•°ï¼Œå¦‚ <code>-h</code></li><li><code>--</code> æŒ‡å®šé•¿å‚æ•°ï¼Œå¦‚ <code>--help</code></li></ul><p>ä¸¤ç§å‚æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œå¯é€‰å‚æ•°å°±åƒ python å‡½æ•°ä¸­ä½¿ç”¨å…³é”®å­—ä¼ å‚ä¸€æ ·ã€‚ä¿®æ”¹ä¸€ä¸‹ä¸Šé¢çš„ python è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># arg.py</span><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'this is a parser'</span><span class="token punctuation">)</span>parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--params'</span><span class="token punctuation">,</span> <span class="token string">'-p'</span><span class="token punctuation">)</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'show the params:'</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨çŸ­å‚æ•°å’Œé•¿å‚æ•°éƒ½å¯ä»¥ï¼Œä¸ä¼ å…¥å‚æ•°ä¹Ÿä¸ä¼šæŠ¥é”™</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">(base) D:\VScodeProjects\LearnManim&gt;python arg.py -p 1show the params: 1(base) D:\VScodeProjects\LearnManim&gt;python arg.py --params 1show the params: 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç±»å‹ <code>type</code>ï¼šæŒ‡å®šè¾“å…¥å‚æ•°çš„ç±»å‹</p></li><li><p>é»˜è®¤å€¼ <code>default</code>ï¼šæŒ‡å®šé»˜è®¤å€¼</p></li><li><p>å¸®åŠ© <code>help</code>ï¼šæè¿°è¯¥å‚æ•°çš„åŠŸèƒ½</p></li><li><p>å¿…é¡»å‚æ•° <code>required</code>ï¼šè¯¥å‚æ•°æ˜¯å¦ä¸ºå¿…é¡»ä¼ å…¥çš„å‚æ•°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--params'</span><span class="token punctuation">,</span> <span class="token string">'-p'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'optional number'</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åŠ¨ä½œ <code>action</code>ï¼šä¸éœ€è¦åœ¨å‘½ä»¤è¡Œä¼ å…¥å‚æ•°ã€‚å¸¸ç”¨å€¼ä¸º <code>action='store_true'</code> ä¹Ÿå³å½“ä¼ å…¥å…³é”®å­—æ—¶ï¼Œè¯¥å‚æ•°å€¼ä¸º <code>True</code> </p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--params'</span><span class="token punctuation">,</span> <span class="token string">'-p'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">(base) D:\VScodeProjects\LearnManim&gt;python arg.py -p  show the params: True<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><p>å½“ç„¶è¿˜æœ‰æ›´å¤šçš„å‚æ•°ï¼Œå°±ä¸åˆ—ä¸¾äº†ï¼Œé‡åˆ°äº†å°±å»æŸ¥æ–‡æ¡£</p><h2 id="re-æ¨¡å—"><a href="#re-æ¨¡å—" class="headerlink" title="re æ¨¡å—"></a>re æ¨¡å—</h2><p>re ä¸ºæ­£åˆ™è¡¨è¾¾å¼çš„ç¼©å†™ï¼Œæ‰€ä»¥éœ€è¦äº†è§£æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥åŒ¹é…æŸäº›ç‰¹å®šæ¨¡å¼çš„æ•°æ®ï¼Œåœ¨ç¼–è¾‘æ–‡ä»¶ã€çˆ¬è™«ç­‰æ–¹é¢æœ‰ç€å¹¿æ³›åº”ç”¨ï¼Œä»¥ä¸‹å†…å®¹å‚è€ƒ <a href="https://www.bilibili.com/video/BV19t4y1y7qP/">bilibili</a> &amp; <a href="https://www.runoob.com/regexp/regexp-syntax.html">èœé¸Ÿæ•™ç¨‹</a> å­¦ä¹ ï¼Œè¿™é‡Œè®°å½•ä¸€äº›åŸºæœ¬çš„è¯­æ³•è§„åˆ™ï¼Œä»…ä¾›å¤ä¹ </p><h3 id="æ­£åˆ™åŒ–"><a href="#æ­£åˆ™åŒ–" class="headerlink" title="æ­£åˆ™åŒ–"></a>æ­£åˆ™åŒ–</h3><h4 id="å­—ç¬¦ç»„"><a href="#å­—ç¬¦ç»„" class="headerlink" title="å­—ç¬¦ç»„"></a>å­—ç¬¦ç»„</h4><p><code>[]</code>ï¼Œå­—ç¬¦ç»„ï¼ŒåŒ¹é…é›†åˆä¸­çš„ä»»æ„å­—ç¬¦ï¼Œå¦‚æœæƒ³è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦åˆ™éœ€è¦è½¬ä¹‰å­—ç¬¦ <code>\</code></p><p> <code>^</code>ï¼Œåœ¨å­—ç¬¦ç»„å†…è¡¨ç¤ºå–åï¼Œåœ¨å­—ç¬¦ç»„å¤–è¡¨ç¤ºåŒ¹é…å¼€å¤´ <code>$</code>ï¼ŒåŒ¹é…å­—ç¬¦ä¸²çš„æœ«å°¾</p><h4 id="å¿«æ·è¡¨ç¤º"><a href="#å¿«æ·è¡¨ç¤º" class="headerlink" title="å¿«æ·è¡¨ç¤º"></a>å¿«æ·è¡¨ç¤º</h4><p><code>\d</code>ï¼Œæ•°å­—</p><p><code>\s</code>ï¼Œç©ºæ ¼</p><p><code>\w</code>ï¼Œå­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼‰</p><p>å¤§å†™ä¸ºå…¶å–å <code>\D</code> <code>\S</code> <code>\W</code> è¡¨ç¤ºéæ•°å­—ã€éç©ºæ ¼ã€éå­—ç¬¦</p><p><code>.</code>ï¼Œä¸ºä»»æ„å•ä¸ªå­—ç¬¦ï¼Œæ¢è¡Œç¬¦é™¤å¤–</p><h4 id="é™å®šç¬¦ï¼ˆæ§åˆ¶é‡å¤æ¬¡æ•°ï¼‰"><a href="#é™å®šç¬¦ï¼ˆæ§åˆ¶é‡å¤æ¬¡æ•°ï¼‰" class="headerlink" title="é™å®šç¬¦ï¼ˆæ§åˆ¶é‡å¤æ¬¡æ•°ï¼‰"></a>é™å®šç¬¦ï¼ˆæ§åˆ¶é‡å¤æ¬¡æ•°ï¼‰</h4><p><code>{n}</code>ï¼Œ<code>{n,}</code>ï¼Œ<code>{n, m}</code> n, m ä¸ºéè´Ÿæ•´æ•°ï¼Œè¡¨ç¤ºåŒ¹é…é‡å¤æ¬¡æ•°æˆ–è€…é‡å¤åŒºé—´</p><p><code>+</code>ï¼ŒåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œç›¸å½“äº <code>{1,}</code></p><p><code>*</code>ï¼ŒåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œç›¸å½“äº <code>{0,}</code></p><p><code>?</code> å¯é€‰å­—ç¬¦ï¼ŒåŒ¹é…0æ¬¡æˆ–1æ¬¡ã€‚ä¹Ÿå¯è¡¨ç¤ºéè´ªå©ªæ¨¡å¼ï¼ˆæœ€å°åŒ¹é…ï¼‰ï¼Œå¸¸ç”¨äº <code>+ or *</code> ä¹‹åã€‚ä¾‹å¦‚éœ€è¦åŒ¹é… <code>&lt;mark&gt;.*&lt;mark&gt;</code> è¿™æ ·çš„æ¨¡å¼ï¼Œå¦‚æœé‡åˆ°å­—ç¬¦ä¸² <code>&lt;mark&gt;1&lt;mark&gt; &lt;mark&gt;2&lt;mark&gt;</code> å°†ä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸èƒ½åˆ† <code>&lt;mark&gt;1&lt;mark&gt;</code> å’Œ <code>&lt;mark&gt;2&lt;mark&gt;</code>ï¼Œè¿™æ—¶ä½¿ç”¨æœ€å°åŒ¹é…å³å¯å®Œæˆ <code>&lt;mark&gt;.*ï¼Ÿ&lt;mark&gt;</code></p><h4 id="å®šä½ç¬¦"><a href="#å®šä½ç¬¦" class="headerlink" title="å®šä½ç¬¦"></a>å®šä½ç¬¦</h4><p><code>$</code>ï¼ŒåŒ¹é…å­—ç¬¦ä¸²çš„æœ«å°¾</p><p><code>^</code>ï¼ŒåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ï¼Œä½†å½“ <code>^</code> å’Œ <script type="math/tex">` åŒæ—¶å‡ºç°æ—¶ä¸ä»£è¡¨å¼€å¤´å’Œæœ«å°¾åˆ†åˆ«åŒ¹é…ï¼Œè€Œæ˜¯ä»£è¡¨æ•´ä¸ªå­—ç¬¦ä¸²å¿…é¡»åŒ¹é…è¯¥è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ `^python</script> ä»…èƒ½åŒ¹é… python è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸èƒ½åŒ¹é…å¼€å¤´æœ«å°¾ä¸º python çš„å­—ç¬¦ä¸²ï¼Œåƒ python â€¦ python æ˜¯ä¸è¢«åŒ¹é…çš„</p><p><code>\b</code>ï¼ŒåŒ¹é…å•è¯è¾¹ç•Œï¼Œå³å­—ä¸ç©ºæ ¼çš„ä½ç½®</p><h4 id="åˆ†ç»„"><a href="#åˆ†ç»„" class="headerlink" title="åˆ†ç»„"></a>åˆ†ç»„</h4><p><code>()</code>ï¼Œè¡¨ç¤ºæ•è·åˆ†ç»„ï¼Œ<code>()</code> ä¼šæŠŠæ¯ä¸ªåˆ†ç»„é‡Œçš„åŒ¹é…çš„å€¼ä¿å­˜èµ·æ¥ï¼Œ å¤šä¸ªåŒ¹é…å€¼å¯ä»¥é€šè¿‡è½¬ä¹‰ç¬¦+æ•°å­— n æ¥æŸ¥çœ‹ï¼Œä¸¾ä¸ªä¾‹å­ <code>(expression_1)(expression_2)\2\1</code></p><p><code>(?:)</code>ï¼Œä¸æ•è·ï¼Œåªä½¿ç”¨åˆ†ç»„åŠŸèƒ½</p><p><code>(express_1|express_2|express_3)</code>ï¼Œé€‰æ‹©ï¼Œæ»¡è¶³ä»»ä¸€è¡¨è¾¾å¼å³åŒ¹é…</p><p><code>(?=express)</code>ï¼Œæ­£å‘å…ˆè¡Œæ–­è¨€ï¼Œé¡ºåºä»å·¦å¾€å³çœ‹ï¼Œåˆ¤æ–­åœ¨è¯¥ä½ç½®çš„å­—ç¬¦æ˜¯å¦åŒ¹é…è¡¨è¾¾å¼ï¼Œå¦‚æ»¡è¶³è¡¨è¾¾å¼åˆ™åŒ¹é…æ•´ä¸ªè¡¨è¾¾å¼ï¼Œå¦‚ <code>re(?=gular)</code> åªåŒ¹é… regular ä¸­çš„ re è€Œä¸åŒ¹é…å…¶ä»–å•è¯ä¸­çš„ re</p><p><code>(?&lt;=express)</code>ï¼Œæ­£å‘åè¡Œæ–­è¨€ï¼Œé¡ºåºä»å³å¾€å·¦ï¼Œå¦‚ <code>(?&lt;=re)open</code> åªåŒ¹é… reopen ä¸­çš„ openï¼Œä¸åŒ¹é…å…¶ä»–å•è¯ä¸­çš„ open</p><p><code>(?!express)</code>ï¼Œé€†å‘å…ˆè¡Œæ–­è¨€ï¼Œä¸æ»¡è¶³è¡¨è¾¾å¼åˆ™åŒ¹é…</p><p><code>(?&lt;!express)</code>ï¼Œé€†å‘åè¡Œæ–­è¨€</p><h3 id="æ¨¡å—æ–¹æ³•"><a href="#æ¨¡å—æ–¹æ³•" class="headerlink" title="æ¨¡å—æ–¹æ³•"></a>æ¨¡å—æ–¹æ³•</h3><ol><li><p><code>re.match(pattern, string, flags=0)</code>ï¼Œå°è¯•ä»å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®åŒ¹é…ä¸€ä¸ªæ¨¡å¼ï¼Œå¦‚æœä¸æ˜¯èµ·å§‹ä½ç½®åŒ¹é…æˆåŠŸçš„è¯ï¼Œmatch()å°±è¿”å›noneï¼ŒåŒ¹é…æˆåŠŸåˆ™è¿”å›åŒ¹é…å¯¹è±¡ MatchObject</p><p><code>flags</code> ä¸ºæ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ï¼Œå‚è€ƒ <a href="https://www.runoob.com/python/python-reg-expressions.html#flags">æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦ - å¯é€‰æ ‡å¿—</a></p><p>ä½¿ç”¨ group(num) æˆ– groups() åŒ¹é…å¯¹è±¡å‡½æ•°æ¥è·å–åŒ¹é…è¡¨è¾¾å¼ä¸­çš„åˆ†ç»„ï¼Œå³è¡¨è¾¾å¼ä¸­è¦æœ‰æ‹¬å·</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> reline <span class="token operator">=</span> <span class="token string">"Cats are smarter than dogs"</span> a <span class="token operator">=</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span> <span class="token string">r'(.*) are (.*?) .*'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Cats smarter</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>groups<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ('Cats', 'smarter')</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>group() ä¹Ÿå¯ä»¥ä¸€æ¬¡è¾“å…¥å¤šä¸ªç»„å·ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å®ƒå°†è¿”å›ä¸€ä¸ªåŒ…å«é‚£äº›ç»„æ‰€å¯¹åº”å€¼çš„å…ƒç»„</p><p>å¦‚æœæ²¡æœ‰åˆ†ç»„ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ group() è°ƒç”¨ï¼Œä¸ç”¨ä¼ å‚ï¼Œé»˜è®¤ä¼ å…¥0</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> reline <span class="token operator">=</span> <span class="token string">"Cats are smarter than dogs"</span> a <span class="token operator">=</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span> <span class="token string">r'.* are .*? .*'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># print(a.group(0)) is the same</span><span class="token comment"># Cats are smarter than dogs</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><code>re.search(pattern, string, flags=0)</code>ï¼Œæ‰«ææ•´ä¸ªå­—ç¬¦ä¸²å¹¶è¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸçš„åŒ¹é…å¯¹è±¡ MatchObject</p></li><li><p><code>re.findall(pattern, string, flags=0)</code>ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…çš„æ‰€æœ‰<strong>å­ä¸²</strong>ï¼Œå¹¶è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨</p></li><li><p><code>re.sub(pattern, repl, string, count=0, flags=0)</code> ç”¨äºæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„åŒ¹é…é¡¹</p></li><li><p><code>re.compile(pattern, flags=0)</code> ï¼Œæ ¹æ®ä¸€ä¸ªæ¨¡å¼å­—ç¬¦ä¸²å’Œå¯é€‰çš„æ ‡å¿—å‚æ•°ç”Ÿæˆä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œè¯¥å¯¹è±¡èƒ½å¤Ÿè°ƒç”¨ä¸€ç³»åˆ—çš„æ–¹æ³•ç”¨äºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å’Œæ›¿æ¢</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> reline <span class="token operator">=</span> <span class="token string">"re short for regular expression"</span> pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span> <span class="token string">r're'</span><span class="token punctuation">)</span>all_list <span class="token operator">=</span> pattern<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>line<span class="token punctuation">)</span>sub <span class="token operator">=</span> pattern<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'RE'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>all_list<span class="token punctuation">)</span><span class="token comment"># ['re', 're', 're']</span><span class="token keyword">print</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token comment"># RE short for REgular expREssion</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><h3 id="æ—¶é—´å’Œæ—¥æœŸ"><a href="#æ—¶é—´å’Œæ—¥æœŸ" class="headerlink" title="æ—¶é—´å’Œæ—¥æœŸ"></a>æ—¶é—´å’Œæ—¥æœŸ</h3><h3 id="è¿›ç¨‹ã€çº¿ç¨‹"><a href="#è¿›ç¨‹ã€çº¿ç¨‹" class="headerlink" title="è¿›ç¨‹ã€çº¿ç¨‹"></a>è¿›ç¨‹ã€çº¿ç¨‹</h3><h3 id="Python-çˆ¬è™«"><a href="#Python-çˆ¬è™«" class="headerlink" title="Python çˆ¬è™«"></a>Python çˆ¬è™«</h3>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Python </tag>
            
            <tag> æ‹“å±• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 2 æ•°æ®ç»“æ„</title>
      <link href="/archives/760ade0a.html"/>
      <url>/archives/760ade0a.html</url>
      
        <content type="html"><![CDATA[<h1 id="Python-String-amp-Data-Structure"><a href="#Python-String-amp-Data-Structure" class="headerlink" title="Python String &amp; Data Structure"></a>Python String &amp; Data Structure</h1><h2 id="String-å­—ç¬¦ä¸²"><a href="#String-å­—ç¬¦ä¸²" class="headerlink" title="String å­—ç¬¦ä¸²"></a>String å­—ç¬¦ä¸²</h2><p>python ç”¨å•å¼•å· <code>''</code> æˆ–è€…åŒå¼•å· <code>""</code> æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œä¸‰å¼•å· <code>'''</code> å…è®¸è·¨å¤šè¡Œçš„å­—ç¬¦ä¸²</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s1 <span class="token operator">=</span> <span class="token string">'hello, world!'</span>s2 <span class="token operator">=</span> <span class="token string">"hello, world!"</span><span class="token comment"># ä»¥ä¸‰ä¸ªåŒå¼•å·æˆ–å•å¼•å·å¼€å¤´çš„å­—ç¬¦ä¸²å¯ä»¥æŠ˜è¡Œ</span>s3 <span class="token operator">=</span> <span class="token triple-quoted-string string">"""hello, world!"""</span><span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­—ç¬¦ä¸²ä¸­å¯ä»¥ä½¿ç”¨åæ–œæ  <code>\</code> è¡¨ç¤ºè½¬ä¹‰ï¼Œå¦‚ <code>\n, \t</code> ç­‰è½¬ä¹‰å­—ç¬¦ï¼Œå¦‚æœå¸Œæœ›è¾“å…¥åŸå­—ç¬¦ä¸²å¯åœ¨å¼•å·å‰åŠ  r å­—æ¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s1 <span class="token operator">=</span> <span class="token string">'\n\\hello, world!\\\n'</span>s2 <span class="token operator">=</span> <span class="token string">r'\n\\hello, world!\\\n'</span><span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="å­—ç¬¦ä¸²è¿ç®—"><a href="#å­—ç¬¦ä¸²è¿ç®—" class="headerlink" title="å­—ç¬¦ä¸²è¿ç®—"></a>å­—ç¬¦ä¸²è¿ç®—</h3><p>å­—ç¬¦ä¸²æ¥å— <code>+, *, [:], in</code> ç­‰è¿ç®—ï¼Œå¯¹å­—ç¬¦ä¸²å†…å®¹è¿›è¡Œåˆå¹¶ã€é‡å¤ã€æˆªå–ã€æˆå‘˜è¿ç®—</p><h3 id="å­—ç¬¦ä¸²æ ¼å¼åŒ–"><a href="#å­—ç¬¦ä¸²æ ¼å¼åŒ–" class="headerlink" title="å­—ç¬¦ä¸²æ ¼å¼åŒ–"></a>å­—ç¬¦ä¸²æ ¼å¼åŒ–</h3><p>å½“å­—ç¬¦ä¸²ä¸­éœ€è¦è¡¨ç¤ºå˜é‡æ—¶ï¼Œæ ¼å¼åŒ–è¡¨ç¤ºå°†ä¼šéå¸¸æœ‰ç”¨ï¼ŒåŸºæœ¬ç”¨æ³•å¦‚ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">num<span class="token punctuation">,</span> pai <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3.1415926</span>s <span class="token operator">=</span> <span class="token string">'here is a number %d, and pai is %.2f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>num<span class="token punctuation">,</span> pai<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åŸºæœ¬é€»è¾‘å°±æ˜¯ï¼Œä¸€ä¸ªèåœä¸€ä¸ªå‘ï¼Œæƒ³è¦åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥å˜é‡ï¼Œå°±åœ¨éœ€è¦æ’å…¥çš„åœ°æ–¹ç”¨ç›¸åº”çš„ç¬¦å·æ›¿ä»£ï¼Œç„¶ååœ¨å­—ç¬¦ä¸²åç”¨ <code>%</code> æŒ‡æ˜å˜é‡</p><p>è¿™é‡Œåˆ—å‡ ä¸ªå¸¸ç”¨çš„æ›¿ä»£ç¬¦å·ï¼š<code>%d, %f, %s, %e</code>ï¼Œæœ€åä¸€ä¸ª <code>%e</code> è¡¨ç¤ºç§‘å­¦è®¡æ•°</p><h3 id="å­—ç¬¦ä¸²å†…å»ºå‡½æ•°"><a href="#å­—ç¬¦ä¸²å†…å»ºå‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²å†…å»ºå‡½æ•°"></a>å­—ç¬¦ä¸²å†…å»ºå‡½æ•°</h3><p>å­—ç¬¦ä¸²è‡ªå¸¦äº†å¾ˆå¤šæ–¹ä¾¿çš„æ–¹æ³•ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„ï¼Œstring ä»£è¡¨æŸä¸ªå­—ç¬¦ä¸²</p><ol><li><code>sting.count(str)</code>ï¼Œå­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸ª str</li><li><code>string.find(str)</code>ï¼Œstr åœ¨å­—ç¬¦ä¸²ä¸­çš„å“ªä¸ªä½ç½®ï¼Œå¦‚ä¸å­˜åœ¨è¿”å›-1</li><li><code>string.format(*args, **kwargs)</code>ï¼Œ<strong>å¢å¼ºç‰ˆæ ¼å¼åŒ–æ–¹æ³•ï¼Œéå¸¸æ¨èä½¿ç”¨è¯¥å‡½æ•°æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²</strong>ï¼Œå‚è€ƒ <a href="https://www.runoob.com/python/att-string-format.html">èœé¸Ÿæ•™ç¨‹</a></li><li><code>string.split(str)</code>ï¼Œ<strong>æŒ‰ç…§ str åˆ†éš”å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨</strong></li><li><code>string.join(Iterable)</code>ï¼Œå°†å¤šä¸ªå­—ç¬¦ä¸²ä½¿ç”¨ string è¿æ¥èµ·æ¥</li><li><code>string.replace(str1, str2)</code>ï¼Œå°† str1 æ›¿æ¢ä¸º str2</li></ol><h2 id="List-åˆ—è¡¨"><a href="#List-åˆ—è¡¨" class="headerlink" title="List åˆ—è¡¨"></a>List åˆ—è¡¨</h2><p>åˆ—è¡¨æ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥é¡ºåºå­˜å‚¨ä¸åŒçš„å¯¹è±¡ã€‚åœ¨ python ä¸­åˆ›å»ºåˆ—è¡¨ï¼š</p><ol><li>ç›´æ¥èµ‹å€¼ <code>LIST = []</code></li><li>ç±»å‹è½¬æ¢ <code>list(tuple)</code></li></ol><h3 id="åˆ—è¡¨è¿ç®—"><a href="#åˆ—è¡¨è¿ç®—" class="headerlink" title="åˆ—è¡¨è¿ç®—"></a>åˆ—è¡¨è¿ç®—</h3><p>åˆ—è¡¨ä¹Ÿæ¥å—ï¼š<code>+, *, [:], in</code> ç­‰è¿ç®—ç¬¦</p><h3 id="python-å†…ç½®å‡½æ•°æ“ä½œåˆ—è¡¨"><a href="#python-å†…ç½®å‡½æ•°æ“ä½œåˆ—è¡¨" class="headerlink" title="python å†…ç½®å‡½æ•°æ“ä½œåˆ—è¡¨"></a>python å†…ç½®å‡½æ•°æ“ä½œåˆ—è¡¨</h3><ol><li><code>len(list)</code></li><li><code>max(list)</code> &amp; <code>min(list)</code></li><li><code>for i in list</code> &amp; <code>for index, value in enumerate(list)</code>ï¼Œå¯¹åˆ—è¡¨è¿›è¡Œå¾ªç¯éå†</li></ol><h3 id="åˆ—è¡¨å†…å»ºå‡½æ•°"><a href="#åˆ—è¡¨å†…å»ºå‡½æ•°" class="headerlink" title="åˆ—è¡¨å†…å»ºå‡½æ•°"></a>åˆ—è¡¨å†…å»ºå‡½æ•°</h3><ol><li><code>list.append(obj)</code> &amp; <code>list.insert(index, obj)</code></li><li><code>list.remove(obj)</code> &amp; <code>list.pop()</code></li><li><code>list.sort(reverse=False)</code>ï¼Œå°†åˆ—è¡¨æŒ‰ç…§ä¸Šå‡å€¼æ’åˆ—ï¼Œè¿”å› None</li><li><code>list.copy()</code></li></ol><h2 id="Tuple-å…ƒç»„"><a href="#Tuple-å…ƒç»„" class="headerlink" title="Tuple å…ƒç»„"></a>Tuple å…ƒç»„</h2><p>å…ƒç»„å’Œåˆ—è¡¨ç±»ä¼¼ï¼Œä¹Ÿæ˜¯çº¿æ€§è¡¨çš„ä¸€ç§ï¼Œä¸è¿‡åœ¨å…ƒç»„å»ºç«‹è¿‡åï¼Œå…¶æˆå‘˜æ˜¯ä¸èƒ½å¤Ÿè¢«ä¿®æ”¹çš„ï¼Œå¢åŠ å’Œåˆ é™¤æˆå‘˜ä¹Ÿæ˜¯ä¸æ”¯æŒçš„ï¼Œåœ¨ python ä¸­åˆ›å»ºå…ƒç»„ï¼š</p><ol><li>ç›´æ¥èµ‹å€¼ <code>TUPLE = (1,)</code></li><li>ç±»å‹è½¬æ¢ <code>tuple(list)</code></li></ol><h3 id="å…ƒç»„è¿ç®—"><a href="#å…ƒç»„è¿ç®—" class="headerlink" title="å…ƒç»„è¿ç®—"></a>å…ƒç»„è¿ç®—</h3><p>å…ƒç»„æ”¯æŒ <code>+, *, [:], in</code> ç­‰è¿ç®—ç¬¦ï¼Œä½†æ³¨æ„ï¼Œç”±äºå…ƒç»„æˆå‘˜ä¸èƒ½è¢«ä¿®æ”¹çš„æ€§è´¨ï¼Œæ‰€ä»¥ä¸èƒ½å¤Ÿå¯¹ç´¢å¼•å€¼è¿›è¡Œæ–°çš„èµ‹å€¼ã€‚è™½ç„¶ä¸èƒ½å¢åŠ æˆå‘˜ï¼Œä½†æ˜¯ä»å¯ä»¥ä½¿ç”¨ <code>+</code> è¿ç®—ï¼Œå°†ä¸¤ä¸ªå…ƒç»„åˆå¹¶</p><h3 id="python-å†…ç½®å‡½æ•°æ“ä½œå…ƒç»„"><a href="#python-å†…ç½®å‡½æ•°æ“ä½œå…ƒç»„" class="headerlink" title="python å†…ç½®å‡½æ•°æ“ä½œå…ƒç»„"></a>python å†…ç½®å‡½æ•°æ“ä½œå…ƒç»„</h3><p>åœ¨åˆ—è¡¨å½“ä¸­èƒ½ç”¨çš„æ“ä½œä¹Ÿèƒ½ç”¨ä½œå…ƒç»„ï¼Œæ¯•ç«Ÿå…ƒç»„å¯ä»¥çœ‹ä½œä¸å¯ä¿®æ”¹æˆå‘˜çš„åˆ—è¡¨</p><h3 id="å…ƒç»„å†…å»ºå‡½æ•°"><a href="#å…ƒç»„å†…å»ºå‡½æ•°" class="headerlink" title="å…ƒç»„å†…å»ºå‡½æ•°"></a>å…ƒç»„å†…å»ºå‡½æ•°</h3><p>å…ƒç»„çš„å†…å»ºå‡½æ•°å°±ä¸å¦‚åˆ—è¡¨çš„ä¸°å¯Œäº†ï¼Œå¯ä»¥è¯´å…ƒç»„æœ‰çš„ï¼Œåˆ—è¡¨éƒ½æœ‰ã€‚ä¸‹é¢åˆ—ä¸¾ä¸¤ä¸ª</p><ol><li><p><code>tuple.count(obj)</code></p></li><li><p><code>tuple.index(obj)</code>ï¼Œè¿”å› obj åœ¨å…ƒç»„ä¸­çš„ç´¢å¼•æ•°ï¼Œè‹¥å…ƒç»„ä¸­ä¸å­˜åœ¨ obj åˆ™æŠ¥é”™</p></li></ol><p>æœ€åæä¸€å¥ï¼Œä¸ºä»€ä¹ˆæœ‰äº†åˆ—è¡¨è¿˜éœ€è¦æœ‰å…ƒç»„è¿™æ ·çš„æ•°æ®ç±»å‹å‘¢ï¼Ÿéƒ¨åˆ†åŸå› æ˜¯å…ƒç»„å¯ä»¥ç”¨äºä¿æŠ¤ä¸€äº›æ•°æ®ï¼Œè®©å…¶ä¸è¢«ä¿®æ”¹ï¼Œå¹¶ä¸”åˆ›å»ºå…ƒç»„åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šçš„ä»£ä»·æ›´å°</p><h2 id="Dict-å­—å…¸"><a href="#Dict-å­—å…¸" class="headerlink" title="Dict å­—å…¸"></a>Dict å­—å…¸</h2><p>å­—å…¸ä¹Ÿæ˜¯ä¸€ç§å¯å˜å®¹å™¨ï¼Œå…¶ä¸æ˜¯é€šè¿‡ index ç´¢å¼•è·å¾—å®¹å™¨å†…çš„å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ key: value å¯¹ï¼Œå°† key æ˜ å°„åˆ°å…¶å¯¹åº”çš„ valueã€‚æ¢å¥è¯è¯´å°±æ˜¯é€šè¿‡ key æ¥è·å¾—å®¹å™¨å†…çš„å¯¹è±¡ã€‚å¾ˆæ˜æ˜¾è¿™æ ·çš„æ˜ å°„æ€§è´¨éœ€è¦ key æ˜¯å”¯ä¸€çš„ï¼ŒåŒæ—¶ python ä¹Ÿè¦æ±‚ key æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå…ƒç»„ã€‚åˆ›å»ºå­—å…¸çš„æ–¹å¼ï¼š</p><ol><li><p>ç›´æ¥èµ‹å€¼ <code>DICT = {key_1ï¼švalue_1}</code></p></li><li><p>é€šè¿‡å†…ç½®å‡½æ•° <code>dict()</code> åˆ›å»ºï¼š</p><ul><li><p><code>dict(**kwargs)</code>ï¼Œä¼ å…¥ key=value å¯¹ï¼Œä¾‹å¦‚ <code>DICT = dict(a=1, b=2)</code>ï¼Œæ³¨æ„è¿™é‡Œ key ä¸ç”¨è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å½¢å¼</p></li><li><p><code>dict(iterable, **kwargs)</code>ï¼Œä¼ å…¥å¯è¿­ä»£å¯¹è±¡ï¼Œå…¶ä¸­å¯è¿­ä»£å¯¹è±¡ä¸­çš„æˆå‘˜å¿…é¡»ä¸ºäºŒå…ƒå…ƒç»„ï¼ŒåŒæ—¶ä¹Ÿå¯ä»»æ„ä¼ å…¥ key=value å¯¹ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">ITER <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># ITER ä¹Ÿå¯ä»¥é€šè¿‡ python å†…ç½®å‡½æ•° zip() ç”Ÿæˆ</span><span class="token comment"># ITER = zip(['a', 'b'], [1, 2])</span>DICT <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>ITER<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>dict.fromkeys(iterable, value)</code>ï¼Œä¼ å…¥å¯è¿­ä»£å¯¹è±¡ï¼Œæ¯”å¦‚åˆ—è¡¨ã€å…ƒç»„éƒ½å¯ä»¥ï¼Œå°†è¿™äº›é¡ºåºè¡¨çš„æˆå‘˜ä½œä¸º key åˆ›å»ºå­—å…¸ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ value éƒ½ç»Ÿä¸€åˆå§‹åŒ–</li></ul></li></ol><h3 id="å­—å…¸è¿ç®—"><a href="#å­—å…¸è¿ç®—" class="headerlink" title="å­—å…¸è¿ç®—"></a>å­—å…¸è¿ç®—</h3><p>å­—å…¸æ”¯æŒ <code>[], in</code> è¿ç®—ï¼Œæ˜¾ç„¶ <code>+, *</code> è¿ç®—å¯¹äºå­—å…¸æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚è€Œ <code>[]</code> è¿ç®—åŒºåˆ«äºåˆ—è¡¨å’Œå…ƒç»„ï¼Œç´¢å¼•å€¼ä¸æ˜¯æ•°å­—è€Œæ˜¯ key</p><h3 id="python-å†…ç½®å‡½æ•°æ“ä½œå­—å…¸"><a href="#python-å†…ç½®å‡½æ•°æ“ä½œå­—å…¸" class="headerlink" title="python å†…ç½®å‡½æ•°æ“ä½œå­—å…¸"></a>python å†…ç½®å‡½æ•°æ“ä½œå­—å…¸</h3><ol><li><p><code>len(dict)</code></p></li><li><p><code>for i in dict</code>ï¼Œæ³¨æ„è¿™æ ·å½¢å¼çš„å¾ªç¯åªä¼šå¯¹å­—å…¸ä¸­çš„ key è¿›è¡Œå¾ªç¯éå†ã€‚å¦‚æœæƒ³è¦åŒæ—¶å¯¹ key å’Œ value å¾ªç¯éå†åˆ™éœ€è¦è°ƒç”¨å­—å…¸å†…å»ºå‡½æ•° <code>dict.items()</code> è¿”å›å¯éå†çš„ (key, value) å…ƒç»„æ•°ç»„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">DICT <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> DICT<span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment"># result: a b</span><span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> DICT<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s:%d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># result: a:1 b:2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h3 id="å­—å…¸å†…å»ºå‡½æ•°"><a href="#å­—å…¸å†…å»ºå‡½æ•°" class="headerlink" title="å­—å…¸å†…å»ºå‡½æ•°"></a>å­—å…¸å†…å»ºå‡½æ•°</h3><ol><li><code>dict.get(key, default=None)</code>ï¼Œè¿”å›æŒ‡å®šé”®çš„å€¼ï¼Œå¦‚æœ key å€¼ä¸åœ¨å­—å…¸ä¸­åˆ™è¿”å› default å€¼ã€‚å¦‚æœå¸Œæœ›ä¸å­˜åœ¨ key å€¼æ—¶ï¼Œä¸ä»…è¿”å› default å€¼ï¼Œè¿˜åˆ›å»ºè¯¥ key å€¼ï¼Œåˆ™ä½¿ç”¨ <code>dict.setdefault(key, default=None)</code>ã€‚æ¯”è¾ƒç±»ä¼¼çš„ï¼Œå¦‚æœå­—å…¸ä¸­ä¸å­˜åœ¨æŸä¸ª keyï¼Œé‚£ä¹ˆä½¿ç”¨ <code>dict[key] = value</code> ä¹Ÿä¼šè‡ªåŠ¨åœ¨å­—å…¸ä¸­åˆ›å»º key, value å¯¹</li><li><code>dict.items()</code> è¿”å›å¯éå†çš„ (key, value) å…ƒç»„ç»„æˆçš„åˆ—è¡¨</li><li><p><code>dict.keys()</code> &amp; <code>dict.values()</code> è¿”å› key/value åˆ—è¡¨</p></li><li><p><code>dict.pop(key, default)</code> &amp; <code>dict.clear()</code> å‰è€…åˆ é™¤ key å€¼ï¼Œå¹¶è¿”å›è¯¥ key å¯¹åº” valueï¼Œè‹¥ä¸å­˜åœ¨è¯¥ key åˆ™è¿”å› defaultã€‚åè€…æ¸…ç©ºå­—å…¸æ‰€æœ‰å†…å®¹</p></li><li><code>dict.update(dict_new)</code> å°†æ–°å­—å…¸é‡Œçš„ (key, value) æ›´æ–°åˆ°æœ¬å­—å…¸ä¸­</li><li><code>dict.copy()</code></li></ol><h2 id="Set-é›†åˆ"><a href="#Set-é›†åˆ" class="headerlink" title="Set é›†åˆ"></a>Set é›†åˆ</h2><p>é›†åˆæ˜¯ä¸€ä¸ªæ— åºçš„ä¸é‡å¤å…ƒç´ åºåˆ—ï¼Œä¸”å…ƒç´ æ€§è´¨æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå…ƒç»„ã€‚åˆ›å»ºé›†åˆæœ‰å¦‚ä¸‹æ–¹æ³•ï¼š</p><ol><li><p>ç›´æ¥èµ‹å€¼ <code>SET = {1, 2, 3}</code> è¿™é‡Œå¿…é¡»æœ‰å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šåˆ›å»ºä¸€ä¸ªå­—å…¸</p></li><li><p>ç±»å‹è½¬æ¢ <code>set(iterable)</code>ï¼Œä¼ å…¥å¯è¿­ä»£å¯¹è±¡ï¼Œå¯ä»¥æ˜¯åˆ—è¡¨ã€å…ƒç»„ï¼Œä¹Ÿå¯ä»¥ä¸ä¼ å‚æ•°ä»¥åˆ›å»ºç©ºé›†åˆ</p></li></ol><h3 id="é›†åˆè¿ç®—"><a href="#é›†åˆè¿ç®—" class="headerlink" title="é›†åˆè¿ç®—"></a>é›†åˆè¿ç®—</h3><p>é›†åˆè¿ç®—ç›¸æ¯”äºå‰é¢çš„æ•°æ®ç»“æ„å°±è¦æ›´å¤šäº†ï¼Œé™¤äº†åŸºç¡€çš„ <code>[], in</code> è¿™æ ·çš„ç´¢å¼•å’Œæˆå‘˜è¿ç®—ï¼Œè¿˜æœ‰ <code>&amp;, |, -, ^</code> äº¤é›†ã€å¹¶é›†ã€å·®é›†ã€å¼‚æˆ–ï¼ˆå¯¹ç§°å·®é›†ï¼‰</p><h3 id="python-å†…ç½®å‡½æ•°æ“ä½œé›†åˆ"><a href="#python-å†…ç½®å‡½æ•°æ“ä½œé›†åˆ" class="headerlink" title="python å†…ç½®å‡½æ•°æ“ä½œé›†åˆ"></a>python å†…ç½®å‡½æ•°æ“ä½œé›†åˆ</h3><p>åœ¨åˆ—è¡¨å½“ä¸­èƒ½ç”¨çš„æ“ä½œä¹Ÿèƒ½ç”¨ä½œé›†åˆï¼Œæ¯•ç«Ÿé›†åˆå¯ä»¥ç²—ç•¥çœ‹ä½œè¦æ±‚å…ƒç´ å”¯ä¸€çš„åˆ—è¡¨</p><h3 id="é›†åˆå†…å»ºå‡½æ•°"><a href="#é›†åˆå†…å»ºå‡½æ•°" class="headerlink" title="é›†åˆå†…å»ºå‡½æ•°"></a>é›†åˆå†…å»ºå‡½æ•°</h3><ol><li><code>set.add()</code></li><li><code>set.remove(obj)</code> &amp; <code>set.clear()</code> å‰è€…åˆ é™¤æŒ‡å®šå…ƒç´ ï¼Œåè€…æ¸…ç©ºæ‰€æœ‰</li><li><code>set.issubset(set_new)</code> &amp; <code>set.issuperset(set_new)</code> &amp; <code>set.isdisjoint(set_new)</code> åˆ¤æ–­æ˜¯å¦æ˜¯é›†åˆçš„å­é›†ã€è¶…é›†ï¼Œä»¥åŠæ˜¯å¦æ˜¯ä¸ç›¸äº¤çš„</li></ol><h2 id="è¡¥å……ï¼šè¿­ä»£å™¨ï¼Œç”Ÿæˆå¼ï¼Œç”Ÿæˆå™¨"><a href="#è¡¥å……ï¼šè¿­ä»£å™¨ï¼Œç”Ÿæˆå¼ï¼Œç”Ÿæˆå™¨" class="headerlink" title="è¡¥å……ï¼šè¿­ä»£å™¨ï¼Œç”Ÿæˆå¼ï¼Œç”Ÿæˆå™¨"></a>è¡¥å……ï¼šè¿­ä»£å™¨ï¼Œç”Ÿæˆå¼ï¼Œç”Ÿæˆå™¨</h2><p>è¿™ä¸€éƒ¨åˆ†å°†ä¼šæ¶‰åŠåˆ°éƒ¨åˆ†é¢å‘å¯¹è±¡çš„å†…å®¹ï¼Œä»¥åŠ python çš„ç‰¹æ®Šæ–¹æ³•ã€‚ä¹‹å‰å°±æ˜¯å› ä¸ºç¼ºå°‘è¿™ä¸¤éƒ¨åˆ†çš„å†…å®¹çš„äº†è§£ï¼Œä¸€ç›´å¯¹è¿­ä»£å™¨ã€ç”Ÿæˆå™¨ä¸ç†è§£ï¼Œç°åœ¨è¿›è¡Œæ•´ç†ã€‚å‚è€ƒèµ„æ–™ï¼š<a href="https://www.runoob.com/python3/python3-iterator-generator.html">è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨</a> <a href="https://www.runoob.com/w3cnote/python-yield-used-analysis.html">æµ…æ yield</a> </p><h3 id="iterator-è¿­ä»£å™¨"><a href="#iterator-è¿­ä»£å™¨" class="headerlink" title="iterator è¿­ä»£å™¨"></a>iterator è¿­ä»£å™¨</h3><p>å…¶å®åœ¨ä¹‹å‰å°±å·²ç»è§åˆ°äº†è¿­ä»£å™¨äº†ï¼Œåˆ—è¡¨ã€å…ƒç»„ã€å­—å…¸è¿™äº›æ•°æ®ç»“æ„éƒ½èƒ½å¤Ÿåœ¨ for-in å¾ªç¯çš„æ—¶å€™è‡ªåŠ¨ç”Ÿæˆè¿­ä»£å™¨å¯¹è±¡ã€‚åœ¨ä¸€ä¸ªç±»ä¸­å¦‚ä½•å®ç°è¿­ä»£å™¨å¯¹è±¡ï¼Ÿpython æä¾›äº†ç‰¹æ®Šæ–¹æ³• <code>__iter__()</code> å’Œ <code>__next__()</code> å®ç°åˆ›é€ è¿­ä»£å™¨å¯¹è±¡ï¼Œå½“ç±»ä¸­æœ‰ <code>__iter__()</code> æ–¹æ³•æ—¶ï¼Œå°±æ„å‘³ç€è¿™ä¸ªç±»çš„å®ä¾‹ä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡</p><p>è¿™é‡Œæä¸€ä¸‹ python ç±»ä¸­ <code>__function__()</code> å½¢å¼çš„å‡½æ•°è¢«æˆä¸ºç§°ä¸ºç‰¹æ®Šå‡½æ•°ï¼Œåœ¨ç‰¹å®šæ¡ä»¶å‘ç”Ÿæ—¶è¿è¡Œï¼Œè€Œ <code>__iter__()</code> å’Œ <code>__next__()</code> åˆ™ä¼šåœ¨ for-in å¾ªç¯ä¸­è¢«è°ƒç”¨ã€‚ä¸‹é¢é€šè¿‡è¿­ä»£å™¨å®ç°ä¸€ä¸ªç®€å• <code>ListDemo</code> äº†è§£å…¶å†…éƒ¨é€»è¾‘</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ListDemo</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>args <span class="token operator">=</span> args        self<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># å‡½æ•°å†…å¯ä»¥åšä¸€äº›åˆå§‹åŒ–æ“ä½œ</span>        self<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token number">0</span>        <span class="token comment"># æœ€åå¿…é¡»è¿”å›è¿­ä»£å™¨å¯¹è±¡æœ¬èº«</span>        <span class="token keyword">return</span> self    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>index <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>count<span class="token punctuation">:</span>            result <span class="token operator">=</span> self<span class="token punctuation">.</span>args<span class="token punctuation">[</span>self<span class="token punctuation">.</span>index<span class="token punctuation">]</span>            self<span class="token punctuation">.</span>index <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">return</span> result        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment"># å¾ªç¯ç»“æŸçš„æ ‡å¿—</span>            <span class="token keyword">raise</span> StopIteration<span class="token comment"># è¿è¡Œä¸€ä¸‹</span>LIST <span class="token operator">=</span>  ListDemo<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> LIST<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•´ä¸ªè¿­ä»£å™¨åœ¨å¾ªç¯ä¸­åˆ°åº•åœ¨æ€ä¹ˆè¿è¡Œå‘¢ï¼Ÿé¦–å…ˆ <code>ListDemo</code> å…ˆè¿è¡Œäº† <code>__iter__()</code> è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œè¿”å›è¿­ä»£å™¨å¯¹è±¡æœ¬èº«ã€‚åœ¨å¾ªç¯å½“ä¸­ï¼Œ <code>ListDemo</code> ç±»åœ¨é‡å¤è°ƒç”¨ <code>__next__()</code> å‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœç»™ <code>i</code>ï¼Œæœ€åé‡åˆ° <code>StopIteration</code> ç»“æŸå¾ªç¯</p><p>python è¿˜æœ‰å†…ç½®å‡½æ•° <code>iter()</code>  &amp; <code>next()</code> ç”¨äºç›´æ¥è°ƒç”¨ <code>__iter__()</code> &amp; <code>__next__()</code> è€Œä¸éœ€è¦é‡åˆ°å¾ªç¯æ‰è§¦å‘</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">LIST <span class="token operator">=</span>  ListDemo<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>iterator <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>LIST<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>iterator<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> StopIteration<span class="token punctuation">:</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="generator-ç”Ÿæˆå™¨"><a href="#generator-ç”Ÿæˆå™¨" class="headerlink" title="generator ç”Ÿæˆå™¨"></a>generator ç”Ÿæˆå™¨</h3><p>å¦‚æœè¯´è¿­ä»£å™¨æ˜¯å®šä¹‰åœ¨ç±»å½“ä¸­çš„ï¼Œé‚£ä¹ˆç”Ÿæˆå™¨å°±æ˜¯å¯ä»¥ç›´æ¥å®šä¹‰åœ¨æ™®é€šå‡½æ•°ä¸­çš„è¿­ä»£å™¨ã€‚é€šè¿‡ <code>yield</code> å…³é”®å­—èƒ½å¤Ÿå°†æ™®é€šå‡½æ•°å˜ä¸ºç”Ÿæˆå™¨ï¼Œå®ƒå°†å®ç°ä¹‹å‰çš„  <code>__iter__()</code> å’Œ <code>__next__()</code> åŠŸèƒ½ã€‚æ¯æ¬¡é‡åˆ° yield æ—¶å‡½æ•°ä¼šæš‚åœå¹¶ä¿å­˜å½“å‰æ‰€æœ‰çš„è¿è¡Œä¿¡æ¯ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>yield</code> çš„å€¼, å¹¶åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œ next() æ–¹æ³•æ—¶ä»å½“å‰ <code>yield</code> ä½ç½®ç»§ç»­è¿è¡Œã€‚ä¸‹é¢å®ç°ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—å‡½æ•°ï¼Œæ¥è¿›ä¸€æ­¥ç†è§£å…¶å†…éƒ¨é€»è¾‘</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>    count <span class="token operator">=</span> <span class="token number">0</span>     <span class="token keyword">while</span> count <span class="token operator">&lt;</span> n<span class="token punctuation">:</span>        <span class="token keyword">yield</span> a        a_ <span class="token operator">=</span> a        a <span class="token operator">=</span> b        b <span class="token operator">=</span> a_ <span class="token operator">+</span> b        count <span class="token operator">+=</span> <span class="token number">1</span>iterator <span class="token operator">=</span> fibonacci<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> iterator<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç±»æ¯”ä¸€ä¸‹ç±»ä¸­çš„è¿­ä»£å™¨ï¼Œèƒ½å¤Ÿæ›´å¿«é€Ÿçš„ç†è§£ã€‚é€šè¿‡ <code>yield</code> å£°æ˜è¿™æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œè¿™æ ·ä¼šåœ¨é‡åˆ° for-in å¾ªç¯çš„æ—¶å€™ä¸æ–­åœ°è°ƒç”¨ next() æ–¹æ³•å¹¶è¿”å› <code>yield</code> å€¼ <code>a</code> èµ‹ç»™ <code>i</code>ã€‚åŒºåˆ«äºç±»ä¸­çš„ <code>__next__()</code>  æ–¹æ³•æ˜¯é‡å¤ <code>__next__()</code> å‡½æ•°å†…çš„ä»£ç ï¼Œç”Ÿæˆå™¨è¿è¡Œ <code>next()</code> å‡½æ•°ï¼Œåˆ™ä¼šä»å½“å‰ <code>yield</code> å¤„ç»§ç»­è¿è¡Œï¼Œç›´åˆ°ç¢°åˆ°ä¸‹ä¸€ä¸ª <code>yield</code> </p><h3 id="ç”Ÿæˆå¼"><a href="#ç”Ÿæˆå¼" class="headerlink" title="ç”Ÿæˆå¼"></a>ç”Ÿæˆå¼</h3><p>ç”Ÿæˆå¼æ˜¯ç”Ÿæˆå™¨çš„ä¸€ä¸ªç®€å•åº”ç”¨ï¼Œå¯ä»¥ç”¨äºç”Ÿæˆåˆ—è¡¨ã€å­—å…¸</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ä½¿ç”¨ç”Ÿæˆå¼åˆ›å»ºåˆ—è¡¨å’Œå­—å…¸</span>f <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>f <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token operator">+</span> y <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token string">'ABCDE'</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token string">'1234567'</span><span class="token punctuation">]</span>f <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment"># ç”Ÿæˆå¼æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨</span>f <span class="token operator">=</span> x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Python </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 1 åŸºç¡€</title>
      <link href="/archives/2bc936a0.html"/>
      <url>/archives/2bc936a0.html</url>
      
        <content type="html"><![CDATA[<h1 id="Python-Basic"><a href="#Python-Basic" class="headerlink" title="Python Basic"></a>Python Basic</h1><p>åœ¨è¿›è¡Œæ·±åº¦å­¦ä¹ çš„å®è·µä¸­ï¼Œè¶Šå‘æ„Ÿè§‰åˆ°è‡ªå·±çš„ python ç†è®ºä¸è¶³ï¼Œæƒ³è¦é‡æ–°å¿«é€Ÿæ•´ç†ä¸€ä¸‹ pythonï¼Œå»ºç«‹ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´ä½†ä¸ç»†è‡´çš„æ¡†æ¶ä¾›è‡ªå·±ä¹‹åå¤ä¹ ã€‚æ•´ç†èµ„æºæ¥è‡ªäº <a href="https://github.com/jackfrued/Python-100-Days">python 100 days</a> å’Œ <a href="https://www.runoob.com/python3/python3-tutorial.html">èœé¸Ÿæ•™ç¨‹</a> </p><h2 id="ä»€ä¹ˆæ˜¯-python"><a href="#ä»€ä¹ˆæ˜¯-python" class="headerlink" title="ä»€ä¹ˆæ˜¯ python?"></a>ä»€ä¹ˆæ˜¯ python?</h2><p>ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œä»¥ç¼©è¿›åˆ†å—ï¼Œæœ‰ç€æ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„ä¸‰æ–¹åº“ï¼Œåœ¨äººå·¥æ™ºèƒ½ã€ç½‘ç»œçˆ¬è™«ã€è‡ªåŠ¨è¿ç»´ã€Webå¼€å‘ç­‰é¢†åŸŸéƒ½æœ‰å¹¿æ³›åº”ç”¨</p><p>åœ¨æˆ‘çš„ç‹­éš˜ç†è§£å½“ä¸­ python = python.exeã€‚å½“æˆ‘åœ¨ä½¿ç”¨ anaconda æ—¶ï¼Œä¼šæœ‰ä¸åŒçš„ç¯å¢ƒï¼Œä¸€èˆ¬æ¯ä¸€ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„ python.exeï¼Œå¦‚æœæˆ‘æƒ³è¦è¿è¡Œä¸€ä¸ª python è„šæœ¬ï¼Œé‚£ä¹ˆéœ€è¦é€‰æ‹©ä¸€ä¸ª python.exe/è§£é‡Šå™¨ /interpreter æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬</p><h2 id="å®‰è£…-python"><a href="#å®‰è£…-python" class="headerlink" title="å®‰è£… python"></a>å®‰è£… python</h2><p>å¼ºçƒˆå»ºè®®ç›´æ¥å®‰è£… anacondaï¼Œç®€ç§° condaã€‚è¿™æ˜¯ä¸€ä¸ªæµè¡Œçš„åŒ…ç®¡ç†å·¥å…·ï¼Œå…¶ç®¡ç†å¥¥ä¹‰å°±æ˜¯åˆ›å»ºâ€ç¯å¢ƒâ€œã€‚ç¯å¢ƒä¸­å¯ä»¥ä¸‹è½½åŒ…ï¼Œç®¡ç†åŒ…ï¼Œä¸”æ¯ä¸ªç¯å¢ƒéƒ½å¯ä»¥å®‰è£…è‡ªå·±çš„ python è§£é‡Šå™¨ã€‚è¿™å°±æ„å‘³ç€å¦‚æœä½ æƒ³è¦ä½¿ç”¨ä¸åŒç‰ˆæœ¬ python è§£é‡Šå™¨ï¼Œconda å¯ä»¥åšåˆ°ï¼Œåªéœ€è¦åˆ›å»ºå¤šä¸ª conda ç¯å¢ƒï¼Œæƒ³ç”¨å“ªä¸ªç‰ˆæœ¬å°±åˆ‡åˆ°å“ªä¸ªç‰ˆæœ¬çš„ conda ç¯å¢ƒï¼ŒåŒæ—¶ä¸åŒçš„ç¯å¢ƒå¯ä»¥ä¸‹è½½ä¸åŒçš„åŒ…ï¼Œå®ç°ä¸ä¸€æ ·çš„åŠŸèƒ½</p><h2 id="python-å¼€å‘å·¥å…·"><a href="#python-å¼€å‘å·¥å…·" class="headerlink" title="python å¼€å‘å·¥å…·"></a>python å¼€å‘å·¥å…·</h2><ol><li>python.exeï¼Œç›´æ¥åŒå‡»æ‰“å¼€å°±å¯ä»¥å¼€å§‹å†™ python ä»£ç äº†ï¼Œæœ€åŸç”Ÿçš„äº¤äº’å¼å¼€å‘å·¥å…·ï¼Œæ‡‚æˆ‘æ„æ€ï¼Ÿ</li><li>ipythonï¼Œæ¯”åŸç”Ÿå¼€å‘å·¥å…·å¥½ä¸€ç‚¹</li><li>pycharmï¼Œä¸“ä¸šè½¯ä»¶ï¼Œéå¸¸å¥½ç”¨</li><li>vscodeï¼Œå®‡å®™ç¬¬ä¸€å¼€å‘å·¥å…·ï¼Œæ‡‚ï¼Ÿ</li></ol><h2 id="å˜é‡ä¸ç±»å‹"><a href="#å˜é‡ä¸ç±»å‹" class="headerlink" title="å˜é‡ä¸ç±»å‹"></a>å˜é‡ä¸ç±»å‹</h2><p>ç°åœ¨æ­£å¼å¼€å§‹å¯¹ python è„šæœ¬è¿›è¡Œäº†è§£</p><p>ä»‹ç»å‡ ä¸ªåŸºç¡€æ•°æ®ç±»å‹ï¼š</p><ol><li>int </li><li>float</li><li>string</li><li>bool</li><li>complexï¼Œå¾ˆå°‘ç”¨</li></ol><h3 id="å˜é‡å‘½å"><a href="#å˜é‡å‘½å" class="headerlink" title="å˜é‡å‘½å"></a>å˜é‡å‘½å</h3><p>è§„åˆ™ï¼šä»¥å­—æ¯ï¼Œä¸‹åˆ’çº¿ï¼Œæ•°å­—æ„æˆï¼Œæ•°å­—ä¸èƒ½å¼€å¤´ï¼Œå­—æ¯å¤§å°å†™æ•æ„Ÿ</p><p>PEP 8è¦æ±‚ï¼š</p><ul><li>ä¸€èˆ¬ç”¨å°å†™å­—æ¯æ‹¼å†™ï¼Œå¤šä¸ªå•è¯ç”¨ä¸‹åˆ’çº¿è¿æ¥</li><li>å—ä¿æŠ¤çš„å®ä¾‹å±æ€§ç”¨å•ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼ˆåé¢ä¼šè®²åˆ°ï¼‰</li><li>ç§æœ‰çš„å®ä¾‹å±æ€§ç”¨ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼ˆåé¢ä¼šè®²åˆ°ï¼‰</li></ul><h3 id="å˜é‡çš„ä½¿ç”¨"><a href="#å˜é‡çš„ä½¿ç”¨" class="headerlink" title="å˜é‡çš„ä½¿ç”¨"></a>å˜é‡çš„ä½¿ç”¨</h3><p>python ä¸­å˜é‡çš„åˆ›å»ºä¸éœ€è¦å£°æ˜ï¼Œç›´æ¥èµ‹å€¼å³åˆ›å»ºã€‚<strong>è¿˜å¯ä»¥ä½¿ç”¨å†…ç½®å‡½æ•°ï¼Œå¯¹å˜é‡ç±»å‹è¿›è¡Œè½¬æ¢ï¼šint(), float(), str()â€¦ä½¿ç”¨ type() æŸ¥çœ‹å˜é‡ç±»å‹</strong></p><p><strong>å†ä»‹ç»ä¸¤ä¸ªåŸºç¡€å‡½æ•°ï¼Œprint() &amp; input()ï¼Œå‰è€…ç”¨äºæ‰“å°ï¼Œåè€…ç”¨äºæ¥æ”¶é”®ç›˜è¾“å…¥å­—ç¬¦ä¸²</strong></p><h4 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h4><p>ä¸‹è¡¨å¤§è‡´æŒ‰ç…§ä¼˜å…ˆçº§ä»é«˜åˆ°ä½çš„é¡ºåºåˆ—å‡ºäº†æ‰€æœ‰çš„è¿ç®—ç¬¦</p><p><img src="/archives/2bc936a0/image-20210828224442524.png" style="zoom: 67%;"></p><p>æ¯”è¾ƒé™Œç”Ÿçš„æ˜¯ä½è¿ç®—ç¬¦ï¼Œèº«ä»½è¿ç®—ç¬¦ï¼Œæˆå‘˜è¿ç®—ç¬¦ï¼Œéœ€è¦é‡ç‚¹ç†è§£ä¸€ä¸‹ï¼Œå‚è€ƒ <a href="https://www.runoob.com/python/python-operators.html">èœé¸Ÿæ•™ç¨‹</a></p><h2 id="åˆ†æ”¯ä¸å¾ªç¯"><a href="#åˆ†æ”¯ä¸å¾ªç¯" class="headerlink" title="åˆ†æ”¯ä¸å¾ªç¯"></a>åˆ†æ”¯ä¸å¾ªç¯</h2><p>åˆ†æ”¯ä½¿ç”¨ ifâ€¦elifâ€¦else å½¢å¼å®ç°åˆ†æ”¯</p><p>å¾ªç¯æœ‰ä¸¤ç§å½¢å¼ï¼šfor-in å’Œ whileï¼Œé‡ç‚¹æä¸€ä¸‹ for-inï¼Œç”¨æ¥å¯¹ä¸€ä¸ªå®¹å™¨è¿›è¡Œè¿­ä»£éå¸¸æ–¹ä¾¿ï¼Œè¿™ä¸ªå®¹å™¨å¯ä»¥æ˜¯åˆ—è¡¨ï¼Œå­—å…¸ï¼Œå…ƒç»„ç­‰å…·æœ‰è¿­ä»£åŠŸèƒ½çš„å®¹å™¨ã€‚ä½¿ç”¨ <code>break &amp; continue</code> æ¥è·³å‡ºå¾ªç¯</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>python ä½¿ç”¨ def å…³é”®å­—å£°æ˜å‡½æ•°ï¼Œä»¥ return ç»“æŸï¼Œå¦‚æœæ²¡æœ‰ return é»˜è®¤è¿”å› Noneã€‚åœ¨ python ä¸­ï¼Œå‡½æ•°çš„å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼Œä¹Ÿæ”¯æŒä½¿ç”¨å¯å˜å‚æ•° *args, **kwargs</p><h3 id="å‡½æ•°å‚æ•°"><a href="#å‡½æ•°å‚æ•°" class="headerlink" title="å‡½æ•°å‚æ•°"></a>å‡½æ•°å‚æ•°</h3><h4 id="å¯æ›´æ”¹å¯¹è±¡ä¸ä¸å¯æ›´æ”¹å¯¹è±¡"><a href="#å¯æ›´æ”¹å¯¹è±¡ä¸ä¸å¯æ›´æ”¹å¯¹è±¡" class="headerlink" title="å¯æ›´æ”¹å¯¹è±¡ä¸ä¸å¯æ›´æ”¹å¯¹è±¡"></a>å¯æ›´æ”¹å¯¹è±¡ä¸ä¸å¯æ›´æ”¹å¯¹è±¡</h4><p>ç”±äº python ä¸­çš„å˜é‡ä¸åƒ C è¯­è¨€ä¸€æ ·éœ€è¦å£°æ˜ï¼Œæ‰€ä»¥ python å‡½æ•°å‚æ•°æ˜¯ä¼ å€¼è¿˜æ˜¯å¼•ç”¨ï¼Œä¹Ÿå’Œ C è¯­è¨€ä¸ä¸€æ ·ã€‚ç”±äº python çš„å˜é‡ä¸éœ€è¦å£°æ˜ï¼Œé‚£ä¹ˆ python çš„å˜é‡ä¸ C è¯­è¨€å˜é‡æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ï¼Œä¸¾ä¸ªä¾‹å­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token number">1</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token keyword">is</span> b<span class="token punctuation">)</span><span class="token comment"># True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ° a å’Œ b å…¶å®æ˜¯æ¥è‡ªåŒä¸€ä¸ªå¯¹è±¡ï¼Œæ›´æ”¹äº† a çš„å€¼ï¼Œb ä¹Ÿä¸€èµ·è¢«æ›´æ”¹äº†ï¼Œå°±å¥½åƒ a å’Œ b çš„â€œæŒ‡é’ˆâ€éƒ½æŒ‡å‘äº†1</p><p>å‚è€ƒè¿™ä¸ª <a href="http://winterttr.me/2015/10/24/python-passing-arguments-as-value-or-reference/">åšå®¢</a>ï¼Œ â€œç±»å‹æ˜¯å±äºå¯¹è±¡çš„ï¼Œè€Œä¸æ˜¯å˜é‡çš„â€ï¼Œpython ä¸­çš„å˜é‡æ›´åƒæ˜¯ä¸€ä¸ªâ€œæŒ‡é’ˆâ€ï¼Œæ˜¯å¯¹å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸€ä¸ªå˜é‡å¯ä»¥æŒ‡å‘ä»»æ„çš„å¯¹è±¡ã€‚1æ˜¯å±äº int å¯¹è±¡çš„ï¼Œè€Œä¸æ˜¯å±äº a, b å˜é‡çš„</p><p>ç°åœ¨å›åˆ°å‚æ•°ä¼ é€’è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘è®¤ä¸ºå¯ä»¥è®¤ä¸ºæ˜¯â€œå¼•ç”¨â€ä¼ é€’ï¼Œä½†æƒ…å†µåˆ†ä¸ºä¸¤ç§ï¼š</p><ol><li>ä¼ é€’å‚æ•°ä¸ºå¯æ›´æ”¹å¯¹è±¡ (mutable)ï¼Œä¾‹å¦‚ list, dict, np.arrayï¼Œåœ¨å‡½æ•°ä¸­<strong>ä¿®æ”¹</strong>å‚æ•°å€¼æ—¶ï¼Œä¼šæ”¹å˜åŸå˜é‡ï¼›<strong>èµ‹å€¼</strong>æ–°å€¼æ—¶ï¼Œä¸ä¼šæ”¹å˜åŸå˜é‡</li><li>ä¼ é€’å‚æ•°ä¸ºä¸å¯æ›´æ”¹å¯¹è±¡ (immutable)ï¼Œä¾‹å¦‚ strings, numbers, tuplesï¼Œåœ¨å‡½æ•°ä¸­<strong>èµ‹å€¼</strong>æ–°å€¼æ—¶ï¼Œä¸ä¼šæ”¹å˜åŸå˜é‡ï¼Œå³åŸå˜é‡æ‰€æŒ‡å¯¹è±¡ä¸å˜</li></ol><p>ä¸¾ä¸ªä¾‹å­æ¥ç†è§£ä¸€ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token number">1</span>b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'this is c'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>    c <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token comment"># -1 [-1, 2, 3] 0</span>    test<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token comment"># 1 [-1, 2, 3] ['this is c']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å‚æ•°ç±»å‹"><a href="#å‚æ•°ç±»å‹" class="headerlink" title="å‚æ•°ç±»å‹"></a>å‚æ•°ç±»å‹</h4><p>è¿™é‡Œå‚è€ƒ <a href="https://cloud.tencent.com/developer/article/1640717">python å‚æ•°ï¼Œè…¾è®¯äº‘</a> è¿›è¡Œæ•´ç†ã€‚python å‡½æ•°çš„å½¢å‚åˆ†ä¸ºå››ç§ï¼š</p><ul><li>å¿…éœ€å‚æ•°ï¼šå¹³æ—¶æœ€å¸¸ç”¨çš„ï¼Œå¿…ä¼ ç¡®å®šæ•°é‡çš„å‚æ•°</li><li>ç¼ºçœå‚æ•°ï¼šåœ¨è°ƒç”¨å‡½æ•°æ—¶å¯ä»¥ä¼ ä¹Ÿå¯ä»¥ä¸ä¼ ï¼Œå¦‚æœä¸ä¼ å°†ä½¿ç”¨é»˜è®¤å€¼</li><li>å¯å˜å‚æ•°ï¼šå¯å˜é•¿åº¦å‚æ•°ï¼Œé€šå¸¸ç”¨ <code>*args</code> è¡¨ç¤º</li><li>å…³é”®å­—å‚æ•°ï¼šé•¿åº¦å¯å˜ï¼Œä½†éœ€è¦ä»¥ key=value å¯¹å½¢å¼ä¼ é€’ï¼Œé€šå¸¸ç”¨ <code>**kwargs</code> è¡¨ç¤º</li></ul><p>å¯¹äºå®šä¹‰å‡½æ•°æ—¶ï¼Œå‚æ•°ä½ç½®çš„å¼ºåˆ¶è¦æ±‚æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li>ç¼ºçœå‚æ•°å¿…é¡»åœ¨å¿…é¡»å‚æ•°ä¹‹å</li><li>å…³é”®å­—å‚æ•°å¿…é¡»åœ¨æœ€å</li></ol><p>åœ¨ç»™å‡½æ•°ä¼ å…¥å‚æ•°æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä¸¤ç§ç±»å‹ï¼š</p><ul><li>ä½ç½®å‚æ•°ï¼šç›´æ¥ä¼ å…¥å®å‚ï¼Œä¼ å…¥ä½ç½®ä¸å‡½æ•°å®šä¹‰æ—¶çš„å‚æ•°ä½ç½®ç›¸åŒ</li><li>å…³é”®å­—å‚æ•°ï¼šä»¥ <code>param=value</code> å½¢å¼å‡ºç°ï¼Œå¯ä»¥å¿½ç•¥å‡½æ•°å®šä¹‰æ—¶å‚æ•°çš„ä½ç½®</li></ul><p>python å¼ºåˆ¶è¦æ±‚ä½ç½®å‚æ•°å¿…é¡»åœ¨å…³é”®å­—å‚æ•°ä¹‹å‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'c'</span><span class="token punctuation">,</span> d<span class="token operator">=</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å¿…é¡»å‚æ•°: %s, %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç¼ºçœå‚æ•°: %s, %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å¯å˜å‚æ•°:'</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å…³é”®å­—å‚æ•°:'</span><span class="token punctuation">,</span> kwargs<span class="token punctuation">)</span>    test<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token string">'e'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--------------------------'</span><span class="token punctuation">)</span>test<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'C'</span><span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token string">'e'</span><span class="token punctuation">)</span><span class="token comment"># ä¸Šé¢è¿‡æ—©ä¼ å…¥äº†å…³é”®å­—å‚æ•°ï¼Œå¯¼è‡´æ— æ³•ä¼ å…¥å¯å˜å‚æ•° *args</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢å†’å· <code>:</code> ä¹‹åè¡¨ç¤ºçš„æ˜¯ä½œè€…å»ºè®®çš„ä¼ å…¥å‚æ•°ç±»å‹ï¼Œç®­å¤´ <code>-&gt;</code> ä¹‹åä¸ºå»ºè®®çš„å‡½æ•°è¿”å›ç±»å‹</p><h3 id="è§£åŒ…"><a href="#è§£åŒ…" class="headerlink" title="è§£åŒ…"></a>è§£åŒ…</h3><p>å½“éœ€è¦ä¼ å…¥çš„å¤šä¸ªå‚æ•°è¢«æ‰“åŒ…åœ¨äº†ä¸€ä¸ªå…ƒç»„/å­—å…¸ä¸­ï¼Œå¯ä»¥é€šè¿‡è§£åŒ…çš„æ–¹å¼ï¼Œç›´æ¥æŠŠå…ƒç»„/å­—å…¸ä½œä¸ºå¯å˜å‚æ•°/å…³é”®å­—å‚æ•°ï¼Œä¼ å…¥åˆ°å‡½æ•°å½“ä¸­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">args <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>kwargs <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>test<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token comment"># 1 2 3</span>test<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token comment"># a b c</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè§£åŒ…å…ƒç»„ç”¨  <code>*</code>ï¼Œè§£åŒ…å­—å…¸ç”¨ <code>**</code></p><h3 id="lambda-åŒ¿åå‡½æ•°"><a href="#lambda-åŒ¿åå‡½æ•°" class="headerlink" title="lambda åŒ¿åå‡½æ•°"></a>lambda åŒ¿åå‡½æ•°</h3><p>lambda åªæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå‡½æ•°ä½“æ¯” def ç®€å•å¾ˆå¤šï¼Œæ‰€ä»¥åªèƒ½å°è£…æœ‰é™çš„é€»è¾‘ã€‚lambda å‡½æ•°çš„è¯­æ³•åªæœ‰ä¸€å¥</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">lambda</span> <span class="token punctuation">[</span>args_list<span class="token punctuation">]</span><span class="token punctuation">:</span> expression<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>expression</code> å¯ä»¥æ˜¯è¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­æ¥ä½¿ç”¨ lambda å‡½æ•°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">add <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> a <span class="token operator">+</span> b<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> a<span class="token operator">**</span>b<span class="token comment"># expression can be a function</span>exp_of_2 <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> exp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>exp_of_2<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€è°“åŒ¿åï¼Œæ„å³ä¸å†ä½¿ç”¨ def è¯­å¥è¿™æ ·æ ‡å‡†çš„å½¢å¼å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ•…æ²¡æœ‰å‡½æ•°åï¼</p><h3 id="æ¨¡å—åŒ–ç®¡ç†"><a href="#æ¨¡å—åŒ–ç®¡ç†" class="headerlink" title="æ¨¡å—åŒ–ç®¡ç†"></a>æ¨¡å—åŒ–ç®¡ç†</h3><p>é€šè¿‡æ¨¡å—ç®¡ç† python æ–‡ä»¶/å‡½æ•°å°†ä¼šå˜å¾—éå¸¸æ–¹ä¾¿ï¼Œéœ€è¦ä½¿ç”¨çš„å‡½æ•°ï¼Œä½¿ç”¨å…³é”®å­— <code>import</code> å¯¼å…¥å³å¯ï¼Œå¯¼å…¥æ–¹æ³•æœ‰å¦‚ä¸‹ï¼š</p><ol><li><code>import module</code>ï¼šå¯¼å…¥æ¨¡å—ï¼Œä»¥ <code>module.func</code> ä½¿ç”¨æ¨¡å—ä¸­çš„å‡½æ•°ç­‰å†…å®¹</li><li><code>import module ad md</code>ï¼šå¯¼å…¥æ¨¡å—ï¼Œå‘½åä¸º mdï¼Œä½¿ç”¨æ–¹æ³•ç±»ä¼¼1</li><li><code>from module import func</code>ï¼šç›´æ¥ä»æ¨¡å—ä¸­å¯¼å…¥å‡½æ•°ï¼Œå¯ç›´æ¥ä½¿ç”¨ func()</li></ol><p>å½“æˆ‘ä»¬ä½¿ç”¨ import è¯­å¥çš„æ—¶å€™ï¼ŒPythonè§£é‡Šå™¨æ˜¯æ€æ ·æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶çš„å‘¢ï¼Ÿè¿™å°±æ¶‰åŠåˆ° Python çš„æœç´¢è·¯å¾„ï¼Œæœç´¢è·¯å¾„æ˜¯ç”±ä¸€ç³»åˆ—ç›®å½•åç»„æˆçš„ï¼ŒPython è§£é‡Šå™¨å°±ä¾æ¬¡ä»è¿™äº›ç›®å½•ä¸­å»å¯»æ‰¾æ‰€å¼•å…¥çš„æ¨¡å—ã€‚æœç´¢è·¯å¾„è¢«å­˜å‚¨åœ¨ sys æ¨¡å—ä¸­çš„ path å˜é‡ï¼Œæ­¤å˜é‡ä¸ºä¸€ä¸ªåˆ—è¡¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">for</span> path <span class="token keyword">in</span> sys<span class="token punctuation">.</span>path<span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token comment"># d:\VScodeProjects\TestProj</span><span class="token comment"># D:\LenovoSoftstore\Anaconda\python38.zip</span><span class="token comment"># D:\LenovoSoftstore\Anaconda\lib\site-packages</span><span class="token comment"># ...MORE</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€èˆ¬ <code>sys.path</code> åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå³ä¸ºå½“å‰æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</p><h4 id="if-name-â€˜-main-â€˜"><a href="#if-name-â€˜-main-â€˜" class="headerlink" title="if __name__ = â€˜__main__â€˜"></a>if __name__ = â€˜__main__â€˜</h4><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœå¯¼å…¥çš„æ¨¡å—ä¸­æœ‰å¯æ‰§è¡Œçš„ä»£ç ï¼Œé‚£ä¹ˆåœ¨å¯¼å…¥æ¨¡å—æ—¶å°±ä¼šæ‰§è¡Œã€‚ä½†äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›æ‰§è¡Œè¿™äº›ä»£ç ï¼Œåªæƒ³è¦å¯¼å…¥è¿™ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚ä¸‹é¢çš„æ¨¡å—</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># module.py</span><span class="token keyword">def</span> <span class="token function">module_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is a module'</span><span class="token punctuation">)</span>module_func<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶å¦‚æœåœ¨å¦ä¸€ä¸ª python æ–‡ä»¶ä¸­ <code>import module</code> å°†ä¼šçœ‹åˆ°è¾“å‡º <code>this is a module</code>ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦åœ¨æ¨¡å—ä¸­é™å®šè¿™äº›å¯æ‰§è¡Œä»£ç ï¼Œä»…åœ¨è¯¥æ¨¡å—ç›´æ¥è¿è¡Œçš„æ—¶å€™è¿è¡Œï¼Œè€Œä¸åœ¨å¯¼å…¥çš„æ—¶å€™è¿è¡Œã€‚å¯é‡‡å–å¦‚ä¸‹å½¢å¼</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># module.py</span><span class="token keyword">def</span> <span class="token function">module_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is a module'</span><span class="token punctuation">)</span><span class="token comment"># __name__æ˜¯Pythonä¸­ä¸€ä¸ªéšå«çš„å˜é‡å®ƒä»£è¡¨äº†æ¨¡å—çš„åå­—</span><span class="token comment"># åªæœ‰è¢«Pythonè§£é‡Šå™¨ç›´æ¥æ‰§è¡Œçš„æ¨¡å—çš„åå­—æ‰æ˜¯__main__</span><span class="token keyword">if</span> __name__ <span class="token operator">=</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>module_func<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæåˆ°äº†ä¸€ä¸ªéšå«å˜é‡ <code>__name__</code>ï¼Œæ˜¯ç”± python è‡ªåŠ¨ç”Ÿæˆçš„å˜é‡ï¼Œä¸éœ€è¦äººä¸ºå®šä¹‰ã€‚åœ¨ python ä¸­æœ‰å…¶ä»–çš„éšå«å˜é‡ï¼Œä¾‹å¦‚ <code>__doc__</code> ç”¨äºä¿å­˜å¯¹è±¡çš„è¯´æ˜æ€§æ–‡æ¡£ï¼Œé€šè¿‡å…³é”®å­— <code>?</code> å°±èƒ½è°ƒå‡ºæ–‡æ¡£ï¼Œ<a href="https://blog.csdn.net/u011699626/article/details/107981264">CSDN docå‚è€ƒ</a></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows è½¯ä»¶æ¨è</title>
      <link href="/archives/c92482f1.html"/>
      <url>/archives/c92482f1.html</url>
      
        <content type="html"><![CDATA[<h2 id="Windows-çš„è½¯ä»¶"><a href="#Windows-çš„è½¯ä»¶" class="headerlink" title="Windows çš„è½¯ä»¶"></a>Windows çš„è½¯ä»¶</h2><ol><li>Listaryï¼Œæœç´¢ç¥å™¨</li><li>potplayer + ç®€æ´çš®è‚¤å®šåˆ¶ï¼Œè¯¥æ’­æ”¾å¼ºæ¯”ä½ æƒ³è±¡ä¸­æ›´å¼ºå¤§ï¼Œå¯¹å„ç§æ ¼å¼éƒ½æœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œè¿˜èƒ½å®æ—¶ç¿»è¯‘å­—å¹•ä»¥åŠå½•åˆ¶è§†é¢‘</li><li>bandzip</li><li>bilibili ç›´æ’­å§¬ï¼ŒOBSï¼Œå¯¹äº OBS çš„ç®€è¦æ•™ç¨‹æ”¾åœ¨æ–‡æœ«</li><li>clash</li><li>æ»´ç­”æ¸…å•</li><li>chromeï¼Œæ²¹çŒ´æ’ä»¶ï¼šBilibili Evolvedï¼Œzoteroï¼Œgoogle translateï¼Œyoutube åŒè¯­å­—å¹•, translatesubtitles.co/</li><li>å°è±¡ç¬”è®°</li><li>typora</li><li>latex</li><li>vscode</li><li>zoteroï¼Œæ¨è plugin: zotero citation counts manager ç”¨äºçˆ¬å–æ–‡çŒ®å¼•ç”¨ï¼Œzotfile ç”¨äºæ·»åŠ æ–‡çŒ® pdf å¹¶å¯¹å…¶é‡å‘½åã€‚æƒ³è¦å°† zotero çš„æ–‡çŒ®è¿›è¡Œè½¬ç§»æ—¶ï¼Œåªéœ€è¦è½¬ç§» storage åŠå…¶ zotero.split æ–‡ä»¶å³å¯</li><li>gitï¼Œå½“ github ä¸‹è½½æ–‡ä»¶æ…¢æ—¶è¯·æœç´¢ github é•œåƒèµ„æº</li><li>ç™¾åº¦ç½‘ç›˜ é˜¿é‡Œäº‘ç›˜</li><li>ps pr</li><li><p>youtube-dlï¼Œæ”¯æŒ pip ä¸‹è½½ï¼Œè¯¥è½¯ä»¶å¯ä»¥ä¸‹è½½ youtube è§†é¢‘ã€‚é€šè¿‡æ›´æ”¹å…¶ option æ–‡ä»¶å¯ä»¥æ”¹ä¸€äº›é»˜è®¤çš„ option</p><ol><li>æ›´æ”¹äº†ä¸‹è½½é»˜è®¤è·¯å¾„ï¼Œå‚è€ƒé  <a href="https://stackoverflow.com/questions/32482230/how-to-set-up-default-download-location-in-youtube-dl/34958672">StackOverflow</a> å°† <code>--output</code> çš„ default æ”¹ä¸º <code>r'D:\Downloads\%(title)s-%(id)s.%(ext)s'</code></li><li>æ›´æ”¹äº† <code>--proxy</code> åŠ é€Ÿä¸‹è½½</li></ol></li><li>WinSCPï¼ŒXshellï¼ŒMobaXtermï¼ˆå¼ºçƒˆæ¨èï¼Œå¯ä»¥æ›¿ä»£ WinSCP &amp; XShellï¼‰</li><li>SpaceSnifferï¼ŒæŸ¥çœ‹å­˜å‚¨ç©ºé—´</li><li>utorrent</li><li>LinuxReaderï¼Œæ–¹ä¾¿åŒç³»ç»Ÿåœ¨ Win ä¸­è·å– Linux ç³»ç»Ÿçš„æ–‡ä»¶</li><li>Snipasteï¼Œå¥½ç”¨çš„æˆªå›¾å·¥å…·ï¼Œä»¥åå†ä¹Ÿä¸ç”¨æ‰“å¼€ QQ å†æˆªå›¾äº†çš„ğŸ˜</li><li>Drawio &amp; Excalidraoï¼Œç”¨äºç”»æµç¨‹å›¾/ç½‘ç»œæ¶æ„</li></ol><h2 id="OBS-ç®€è¦æ•™ç¨‹"><a href="#OBS-ç®€è¦æ•™ç¨‹" class="headerlink" title="OBS ç®€è¦æ•™ç¨‹"></a>OBS ç®€è¦æ•™ç¨‹</h2><p>ä¸»è¦æ ¹æ® <a href="https://www.bilibili.com/video/BV1wt4y1Q7rV?p=1">bilibili</a> è¿›è¡Œå­¦ä¹ </p><h3 id="ç•Œé¢ä»‹ç»"><a href="#ç•Œé¢ä»‹ç»" class="headerlink" title="ç•Œé¢ä»‹ç»"></a>ç•Œé¢ä»‹ç»</h3><p><img src="/archives/c92482f1/image-20210916200411505.png" style="zoom:80%;"></p><ol><li><p>æ¥æº</p><p>é¦–å…ˆ OBS æœ€åŸºæœ¬çš„åŠŸèƒ½å°±æ˜¯å½•åˆ¶ç”µè„‘å±å¹•/çª—å£ã€‚æˆ‘ä»¬éœ€è¦å‘Šè¯‰ OBS éœ€è¦æ·»åŠ å“ªäº›ä¿¡æ¯æºï¼Œè¿™å°±æ˜¯<strong>æ¥æº</strong>çª—å£çš„åŠŸèƒ½ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­æ·»åŠ äº†<strong>æ˜¾ç¤ºå™¨é‡‡é›†</strong>ï¼Œè¿™ä¸ªæ¥æºå°±èƒ½å¤Ÿè®°å½•ä½ çš„å±å¹•å†…æ‰€æ˜¾ç¤ºçš„å†…å®¹</p></li><li><p>åœºæ™¯</p><p><strong>OBS åœ¨ä¸€ä¸ªåœºæ™¯ä¸­å¯ä»¥æ·»åŠ å¤šä¸ªæ¥æº</strong>ï¼Œå¹¶ä¸”è°ƒæ•´è¿™äº›æ¥æºå¦‚ä½•æ˜¾ç¤ºå„ä¸ªæ¥æºï¼Œæ¯”å¦‚æˆ‘ä»¬å¸Œæœ›æœ€ç»ˆçš„ç”»é¢å·¦è¾¹ä¸º<strong>æ˜¾ç¤ºå™¨é‡‡é›†</strong>å†…å®¹ï¼Œå³è¾¹ä¸º<strong>æ¸¸æˆæº</strong>ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºå¤šä¸ªåœºæ™¯ï¼Œåœ¨ç›´æ’­çš„æ—¶å€™å¯ä»¥ç›´æ¥é€‰æ‹©æŸä¸ªåœºæ™¯ï¼Œæˆ–è€…åœ¨åœºæ™¯ä¹‹é—´åˆ‡æ¢</p></li><li><p>æ··éŸ³å™¨</p><p>ç”¨äºé‡‡é›†ç”µè„‘å£°éŸ³å’Œéº¦å…‹é£å£°éŸ³</p></li></ol><h3 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h3><p>æŒæ¡ä»¥ä¸Šé€»è¾‘å°±èƒ½å¾ˆå¥½åœ°ä½¿ç”¨ OBS äº†ï¼Œå½“ç„¶è¿›ä¸€æ­¥ä½¿ç”¨è‚¯å®šè¦å¯¹<strong>è®¾ç½®</strong>è¿›è¡Œè°ƒæ•´ï¼Œä»¥ä¸‹ä¸ºæˆ‘çš„è®¾ç½®</p><p><img src="/archives/c92482f1/image-20210916201726253.png" style="zoom: 67%;"></p><p>æ¯”è¾ƒé‡è¦çš„å°±æ˜¯è¾“å‡ºè®¾ç½®ï¼Œä¸²æµä»£è¡¨ä½ ç›´æ’­æ—¶é‡‡é›†ç”»é¢çš„è´¨é‡ï¼Œå½•åƒå³ä»£è¡¨å½•åˆ¶ç”»é¢çš„è´¨é‡ã€‚ä¸‹é¢çœ‹çœ‹è¿™å‡ ä¸ªå‚æ•°</p><ol><li>ç ç‡ï¼Œè¶Šé«˜è§†é¢‘è´¨é‡è¶Šé«˜ï¼Œä¸€èˆ¬æ¨è 2k-8k ä¹‹é—´</li><li><p>ç¼–ç å™¨ï¼Œä¸€èˆ¬æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œx264 ä»£è¡¨ç”¨ CPU è¿›è¡Œç¼–ç ï¼Œå…¶ä»–ç¡¬ä»¶åˆ™å¤šä¸º GPU</p></li><li><p>éŸ³é¢‘æ¯”ç‰¹ç‡ï¼Œä¸€èˆ¬ä¸º160æˆ–320</p></li></ol><p>é¢æ¿ä¸­çš„å…¶ä»–è®¾ç½®ï¼Œä¾‹å¦‚ï¼šæ¨æµç”¨äºè®¾ç½®ç›´æ’­å¹³å°æœåŠ¡å™¨ï¼Œè§†é¢‘è¿˜å¯ä»¥è¿›ä¸€æ­¥è®¾ç½®è§†é¢‘çš„åˆ†è¾¨ç‡ã€å¸§æ•°</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨è </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MMDetection Quick Run</title>
      <link href="/archives/6f4f5bd8.html"/>
      <url>/archives/6f4f5bd8.html</url>
      
        <content type="html"><![CDATA[<h1 id="MMDetection-Quick-Run"><a href="#MMDetection-Quick-Run" class="headerlink" title="MMDetection Quick Run"></a>MMDetection Quick Run</h1><p>æ•´ç†è‡ª <a href="https://mmdetection.readthedocs.io/en/latest/index.html">MMDetection å®˜æ–¹æ–‡æ¡£</a></p><h2 id="Part-1-Inference-and-train-with-existing-models-and-standard-datasets"><a href="#Part-1-Inference-and-train-with-existing-models-and-standard-datasets" class="headerlink" title="Part 1, Inference and train with existing models and standard datasets"></a>Part 1, Inference and train with existing models and standard datasets</h2><blockquote><p>MMDetection provides hundreds of existing and existing detection models in <a href="https://mmdetection.readthedocs.io/en/latest/model_zoo.html">Model Zoo</a>, and supports multiple standard datasets, including Pascal VOC, COCO, CityScapes, LVIS, etc.</p></blockquote><p>è¿™ä¸€éƒ¨åˆ†å°†ç®€è¦ä»‹ç»ï¼Œå¦‚ä½•ä½¿ç”¨ MMDetection å¯¹ Model zoo ä¸­çš„æ¨¡å‹è¿›è¡Œæµ‹è¯•å’Œè®­ç»ƒ</p><h3 id="Inference-with-existing-models"><a href="#Inference-with-existing-models" class="headerlink" title="Inference with existing models"></a>Inference with existing models</h3><blockquote><p>By inference, we mean using trained models to detect objects on images. In MMDetection, a model is defined by a configuration file and existing model parameters are save in a checkpoint file.</p></blockquote><p>è¿™é‡Œä»‹ç»äº† MMDetection æ¨¡å‹è¡¨ç¤ºçš„åŸºæœ¬é€»è¾‘ï¼š<code>configuration file</code>+ <code>checkpoint file</code> </p><p>æ–‡æ¡£ä»¥ Faster R-CNN ä¸ºä¾‹å­ï¼Œå¦‚ä½•è¿›è¡Œç›®æ ‡æ£€æµ‹æ¨ç†</p><blockquote><p>To start with, we recommend <a href="https://github.com/open-mmlab/mmdetection/tree/master/configs/faster_rcnn">Faster RCNN</a> with this <a href="https://github.com/open-mmlab/mmdetection/blob/master/configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py">configuration file</a> and this <a href="https://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_1x_coco/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth">checkpoint file</a>. It is recommended to download the checkpoint file to <code>checkpoints</code> directory.</p></blockquote><p>Q: config files åå­—çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ config å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸­æœ‰ markdown æ–‡æ¡£è¿›è¡Œè¯´æ˜ï¼Œä¾‹å¦‚ <a href="https://github.com/open-mmlab/mmdetection/tree/master/configs/faster_rcnn">faster rcnn</a> </p><h4 id="High-level-APIs-for-inference"><a href="#High-level-APIs-for-inference" class="headerlink" title="High-level APIs for inference"></a>High-level APIs for inference</h4><p>åœ¨ä¹‹å‰ä¹Ÿè§åˆ°è¿‡è¿™ä¸ªä»£ç ï¼Œç°åœ¨å†æ¥çœ‹ä¸€çœ‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> init_detector<span class="token punctuation">,</span> inference_detector<span class="token keyword">import</span> mmcv<span class="token comment"># Specify the path to model config and checkpoint file</span>config_file <span class="token operator">=</span> <span class="token string">'configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py'</span>checkpoint_file <span class="token operator">=</span> <span class="token string">'checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth'</span><span class="token comment"># build the model from a config file and a checkpoint file</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file<span class="token punctuation">,</span> device<span class="token operator">=</span><span class="token string">'cuda:0'</span><span class="token punctuation">)</span><span class="token comment"># test a single image and show the results</span>img <span class="token operator">=</span> <span class="token string">'test.jpg'</span>  <span class="token comment"># or img = mmcv.imread(img), which will only load it once</span>result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token comment"># visualize the results in a new window</span>model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token comment"># or save the visualization results to image files</span>model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">,</span> out_file<span class="token operator">=</span><span class="token string">'result.jpg'</span><span class="token punctuation">)</span><span class="token comment"># test a video and show the results</span>video <span class="token operator">=</span> mmcv<span class="token punctuation">.</span>VideoReader<span class="token punctuation">(</span><span class="token string">'video.mp4'</span><span class="token punctuation">)</span><span class="token keyword">for</span> frame <span class="token keyword">in</span> video<span class="token punctuation">:</span>    result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> frame<span class="token punctuation">)</span>    model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> result<span class="token punctuation">,</span> wait_time<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢çš„ä»£ç ä¸­ç”¨åˆ°äº†æ˜¯è¿™ä¸‰ä¸ª API:</p><ol><li>å¼‚æ­¥æ¨ç† <code>async_inference_detector</code></li><li>ç»˜åˆ¶ <code>show_result</code></li><li>æ¨ç† <code>inference_detector</code></li></ol><p>è¿™é‡Œ <code>show_result</code> çš„å‚æ•°è¯·æŸ¥çœ‹ <a href="https://github.com/open-mmlab/mmdetection/blob/a1cecf63c713c53941b8dcf8a9d762baf8511f2c/mmdet/models/detectors/base.py">åŸä»£ç </a>ï¼Œå¦‚æœéœ€è¦æ˜¾ç¤ºçš„è¯è¦æ·»åŠ å‚æ•° <code>show=True</code>ã€‚ä½†åœ¨ç”¨ vscode è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œå³ä½¿è®¾ç½®äº† <code>show=True</code> ä¹Ÿä¸ä¼šå±•ç¤ºç»“æœï¼Œå¯èƒ½å› ä¸ºæœåŠ¡å™¨ä¸æ”¯æŒ GUIï¼Œæ›¿ä»£çš„æ–¹æ³•å°±æ˜¯åœ¨ Jupyter notebook æˆ–è€… interactive window ä¸­è¿è¡Œ</p><h4 id="Asynchronous-interface-supported-for-Python-3-7"><a href="#Asynchronous-interface-supported-for-Python-3-7" class="headerlink" title="Asynchronous interface - supported for Python 3.7+"></a>Asynchronous interface - supported for Python 3.7+</h4><p>è¿™ä¸€èŠ‚æ²¡æœ‰ç†è§£æ¸…æ¥šï¼Œåªç¨å¾®ç•™äº†ç‚¹å°è±¡ï¼šä½¿ç”¨å¼‚æ­¥æ¥å£ç†è®ºä¸Šèƒ½å¤ŸåŠ é€Ÿæ¨ç†/è®­ç»ƒè¿‡ç¨‹</p><h5 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h5><p>é¦–å…ˆä»€ä¹ˆæ˜¯ <a href="https://blog.csdn.net/lemon4869/article/details/107145903">å¼‚æ­¥æ€ç»´</a>ï¼Œåœ¨é“¾æ¥ä¸­çš„ç†è§£æ¥è¯´ï¼šå¼‚æ­¥å°±æ˜¯ä¸å¿…ç­‰å¾…æ¨ç†ç»“æŸæ‰å¼€å§‹ä¸‹ä¸€å¼ å›¾åƒçš„é¢„å¤„ç†ã€‚ä½†çœ‹åŸä»£ç è¯´çš„å¼‚æ­¥åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæˆ‘ä¹Ÿä¸å¤ªç†è§£ï¼Œä»¥åå†å›æ¥æ•´ç† asyncio ç›¸å…³çŸ¥è¯†å§</p><h5 id="async-amp-await"><a href="#async-amp-await" class="headerlink" title="async &amp; await"></a>async &amp; await</h5><p>ä»€ä¹ˆæ˜¯ Asynchronous interface <a href="https://zhuanlan.zhihu.com/p/353857526">çŸ¥ä¹é“¾æ¥</a></p><p>ä»€ä¹ˆæ˜¯ asyncio <a href="https://blog.csdn.net/permike/article/details/110821246">çŸ¥ä¹é“¾æ¥</a></p><p>Q: è¿™é‡Œéœ€è¦æ›´å¤šçš„ python çŸ¥è¯†ï¼Œæˆ‘å¾—å›å»è¡¥å……ï¼Œæ¯”å¦‚ with å…³é”®å­—ä»€ä¹ˆæ„æ€ï¼Ÿæ•´ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Œèƒ½å¦æŠŠæ•´ä¸ªæ—¶é—´ä¸äº‹ä»¶å¼„æ¸…æ¥šï¼Ÿ</p><h4 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h4><p>æ–‡æ¡£ç»™äº†3ä¸ªdemoï¼š</p><ol><li>Image Demo</li><li>Webcam Demo</li><li>Video Demo</li></ol><p>ç®€å•çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œçœ‹æ¥è¿˜éœ€è¦è¡¥å……æ€»ç»“ OpenCV çš„ä¸€äº›åŸºç¡€çŸ¥è¯†</p><h3 id="Test-existing-models-on-standard-datasets"><a href="#Test-existing-models-on-standard-datasets" class="headerlink" title="Test existing models on standard datasets"></a>Test existing models on standard datasets</h3><blockquote><p>MMDetection supports multiple public datasets including COCO, Pascal VOC, CityScapes, and <a href="https://github.com/open-mmlab/mmdetection/tree/master/configs/_base_/datasets">more</a>. This section will show how to test existing models on supported datasets.</p></blockquote><h4 id="Prepare-datasets"><a href="#Prepare-datasets" class="headerlink" title="Prepare datasets"></a>Prepare datasets</h4><p>æ¨èåœ¨é¡¹ç›®ä¹‹å¤–å»ºç«‹æ•°æ®é›†ï¼Œç„¶åä»¥è½¯é“¾æ¥çš„å½¢å¼æ”¾åˆ°é¡¹ç›®ä¸­ï¼Œä¸”ç›®å½•ç»“æ„è¦æ ¹æ® config files è§„æ”¾ç½®ï¼ˆæˆ–è€…ä½ è‡ªå·±ä¿®æ”¹ config filesï¼‰ï¼Œä¸¾ä¸ªå‡ ä¸ªä¾‹å­</p><pre class="line-numbers language-none"><code class="language-none">mmdetectionâ”œâ”€â”€ mmdetâ”œâ”€â”€ toolsâ”œâ”€â”€ configsâ”œâ”€â”€ dataâ”‚   â”œâ”€â”€ cocoâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”œâ”€â”€ train2017â”‚   â”‚   â”œâ”€â”€ val2017â”‚   â”‚   â”œâ”€â”€ test2017â”‚   â”œâ”€â”€ cityscapesâ”‚   â”‚   â”œâ”€â”€ annotationsâ”‚   â”‚   â”œâ”€â”€ leftImg8bitâ”‚   â”‚   â”‚   â”œâ”€â”€ trainâ”‚   â”‚   â”‚   â”œâ”€â”€ valâ”‚   â”‚   â”œâ”€â”€ gtFineâ”‚   â”‚   â”‚   â”œâ”€â”€ trainâ”‚   â”‚   â”‚   â”œâ”€â”€ valâ”‚   â”œâ”€â”€ VOCdevkitâ”‚   â”‚   â”œâ”€â”€ VOC2007â”‚   â”‚   â”œâ”€â”€ VOC2012<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Test-existing-models"><a href="#Test-existing-models" class="headerlink" title="Test existing models"></a>Test existing models</h4><blockquote><p>We provide testing scripts for evaluating an existing model on the whole dataset (COCO, PASCAL VOC, Cityscapes, etc.). </p></blockquote><p>å¯ä»¥åœ¨å•ä¸ª GPU ä¸Šæµ‹è¯•ï¼Œä¹Ÿå¯ä»¥åœ¨å¤šä¸ª GPU ä¸Šè¿›è¡Œåˆ†å¸ƒæµ‹è¯•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># single-gpu testing</span>python tools/test.py <span class="token punctuation">\</span>    <span class="token variable">${CONFIG_FILE}</span> <span class="token punctuation">\</span>    <span class="token variable">${CHECKPOINT_FILE}</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>--out <span class="token variable">${RESULT_FILE}</span><span class="token punctuation">]</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>--eval <span class="token variable">${EVAL_METRICS}</span><span class="token punctuation">]</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>--show<span class="token punctuation">]</span><span class="token comment"># multi-gpu testing</span><span class="token function">bash</span> tools/dist_test.sh <span class="token punctuation">\</span>    <span class="token variable">${CONFIG_FILE}</span> <span class="token punctuation">\</span>    <span class="token variable">${CHECKPOINT_FILE}</span> <span class="token punctuation">\</span>    <span class="token variable">${GPU_NUM}</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>--out <span class="token variable">${RESULT_FILE}</span><span class="token punctuation">]</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>--eval <span class="token variable">${EVAL_METRICS}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>mmdetection æä¾›å¯¹æ— æ ‡è®°æ•°æ®é›†è¿›è¡Œæµ‹è¯•ï¼Œä½†æ•°æ®é›†éœ€è¦ç¬¦åˆ COCO formatï¼Œå¦‚æœä¸æ˜¯ COCO format ä¾‹å¦‚ VOC æ•°æ®é›†ï¼Œéœ€è¦ä½¿ç”¨ <a href="https://github.com/open-mmlab/mmdetection/tree/master/tools/dataset_converters/pascal_voc.py">script in tools</a> è½¬åŒ–</p><p>mmdetection æä¾› batch inferenceï¼Œèƒ½å¤Ÿä¸€æ¬¡æ¨ç†å¤šä¸ªæ ·æœ¬ï¼Œåœ¨ config files ä¸­ä¿®æ”¹ <code>sample_per_gpu</code> å³å¯ï¼Œæˆ–è€…ä½¿ç”¨ <code>--cfg-options data.test.samples_per_gpu=2</code></p><p>è¿˜æœ‰å¾ˆå¤šå‚æ•°å¯ä»¥è°ƒæ•´ï¼Œå…·ä½“è¯·çœ‹æºä»£ç ï¼Œæ–‡æ¡£ä¹Ÿç»™å‡ºäº†å¾ˆå¤š <a href="https://mmdetection.readthedocs.io/en/latest/1_exist_data_model.html#examples">ä¾‹å­</a></p><h3 id="Train-predefined-models-on-standard-datasets"><a href="#Train-predefined-models-on-standard-datasets" class="headerlink" title="Train predefined models on standard datasets"></a>Train predefined models on standard datasets</h3><blockquote><p>This section will show how to train <em>predefined</em> models (under <a href="https://github.com/open-mmlab/mmdetection/tree/master/configs">configs</a>) on standard datasets i.e. COCO.</p><p><strong>Important</strong>: è®­ç»ƒçš„é»˜è®¤å­¦ä¹ ç‡çš„é…ç½®ä¸º 8ä¸ª GPU å’Œ 2 img/gpuï¼Œä¹Ÿå°±æ˜¯ batch size ä¸º16ï¼Œå¦‚æœä½¿ç”¨ä¸åŒçš„ batch size é‚£ä¹ˆå°±è¦æŒ‰ç…§çº¿æ€§ç¼©æ”¾åŸåˆ™æ›´æ”¹å­¦ä¹ ç‡ e.g., <code>lr=0.01</code> for 4 GPUs <em> 2 imgs/gpu and <code>lr=0.08</code> for 16 GPUs </em> 4 imgs/gpu.</p></blockquote><h4 id="Prepare-datasets-1"><a href="#Prepare-datasets-1" class="headerlink" title="Prepare datasets"></a>Prepare datasets</h4><p>å‡†å¤‡è¿‡ç¨‹å’Œä¸Šä¸€èŠ‚ Test éƒ¨åˆ†æ˜¯ä¸€è‡´çš„ã€‚å»ºè®®å…ˆå°†æ¨¡å‹ä¸‹è½½å¥½ï¼Œä»¥é˜²ç½‘ä¸å¥½å¯¼è‡´æŠ¥é”™</p><h4 id="Training-on-a-single-GPU"><a href="#Training-on-a-single-GPU" class="headerlink" title="Training on a single GPU"></a>Training on a single GPU</h4><p>åœ¨å•ä¸ª GPU ä¸Šè®­ç»ƒï¼ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python tools/train.py <span class="token punctuation">\</span>    <span class="token variable">${CONFIG_FILE}</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>optional arguments<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è®­ç»ƒè¿‡ç¨‹ä¸­çš„ log å’Œ checkpoints éƒ½ä¼šè¢«å­˜æ”¾åˆ° <code>work_dir</code> å½“ä¸­ï¼Œä¹Ÿå¯ä»¥ç”¨ <code>--work-dir</code> é‡æ–°æŒ‡å®š</p><p>é»˜è®¤æ¯12ä¸ª epoch ä½¿ç”¨éªŒè¯é›†å¯¹æ¨¡å‹è¿›è¡Œä¸€æ¬¡è¯„ä¼° evaluationï¼Œtrain.py è¿˜æ¥å—ä¸€äº›å¸¸ç”¨å‚æ•°ï¼š</p><ul><li><code>--no-validate</code> (<strong>not suggested</strong>): Disable evaluation during training.</li><li><code>--work-dir ${WORK_DIR}</code>: Override the working directory.</li><li><code>--resume-from ${CHECKPOINT_FILE}</code>: Resume from a previous checkpoint file.</li><li><code>--options 'Key=value'</code>: Overrides other settings in the used config.</li></ul><p>æ–‡æ¡£æåˆ°ä¸¤ä¸ªå‚æ•°çš„åŒºåˆ«ï¼š<code>--resume-from &amp; --load-from</code> å‰è€…ä¸ä»…åŠ è½½å‚æ•°æƒé‡ï¼Œä¹ŸåŠ è½½ optimizer çš„çŠ¶æ€ï¼Œä¸»è¦ç”¨äºè®­ç»ƒè¢«çªç„¶æ‰“æ–­åæ¥ç€è®­ç»ƒã€‚åè€…åªåŠ è½½å‚æ•°æƒé‡ï¼Œä¸»è¦ç”¨äº finetuning</p><h4 id="Training-on-multiple-GPUs"><a href="#Training-on-multiple-GPUs" class="headerlink" title="Training on multiple GPUs"></a>Training on multiple GPUs</h4><p>åŒæ ·ï¼ŒåŸºæœ¬ç”¨æ³•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">bash</span> ./tools/dist_train.sh <span class="token punctuation">\</span>    <span class="token variable">${CONFIG_FILE}</span> <span class="token punctuation">\</span>    <span class="token variable">${GPU_NUM}</span> <span class="token punctuation">\</span>    <span class="token punctuation">[</span>optional arguments<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯é€‰å‚æ•°å’Œä¸Šé¢è®­ç»ƒå•ä¸ª GPU æ˜¯ä¸€æ ·çš„</p><h5 id="Launch-multiple-jobs-simultaneously"><a href="#Launch-multiple-jobs-simultaneously" class="headerlink" title="Launch multiple jobs simultaneously"></a>Launch multiple jobs simultaneously</h5><p>åœ¨è®­ç»ƒå½“ä¸­ï¼Œé€šå¸¸ä¼šæœ‰å¤šä»»åŠ¡çš„å­˜åœ¨ï¼Œmmdetection ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†ç°åœ¨èƒ½åŠ›æœ‰é™ï¼Œå®åœ¨ä¸èƒ½ç†è§£å…·ä½“çš„å®ç°é€»è¾‘ï¼Œç•™ä¸ª <a href="https://mmdetection.readthedocs.io/en/latest/1_exist_data_model.html#training-on-multiple-gpus">åŸæ–‡æ¡£é“¾æ¥</a></p><p>æåˆ°äº†å¾ˆå¤šæ–°ä¸œè¥¿ï¼Œnodes, port, slurm, pytorch launch utilityâ€¦å¦‚æœèƒ½å¤Ÿåœ¨å®è·µä¸­ç†è§£è¿™äº›æ¦‚å¿µæ›´å¥½äº†</p><h2 id="Part-2-Train-with-customized-datasets"><a href="#Part-2-Train-with-customized-datasets" class="headerlink" title="Part 2, Train with customized datasets"></a>Part 2, Train with customized datasets</h2><blockquote><p> We use the <a href="https://github.com/matterport/Mask_RCNN/tree/master/samples/balloon">balloon dataset</a> as an example to describe the whole process.</p></blockquote><p>åŸºæœ¬æ­¥éª¤ä¸ºï¼š</p><ol><li>Prepare the customized dataset</li><li>Prepare a config</li><li>Train, test, inference models on the customized dataset.</li></ol><h3 id="Prepare-the-customized-dataset"><a href="#Prepare-the-customized-dataset" class="headerlink" title="Prepare the customized dataset"></a>Prepare the customized dataset</h3><p>mmdetection æ”¯æŒå¯¹ COCO format æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå°†ä¸åŒæ ¼å¼çš„æ•°æ®é›†è½¬åŒ–ä¸º COCO format å³å¯ã€‚å¯èƒ½ä¹Ÿå¯ä»¥å¯¹ config file è¿›è¡Œé…ç½®ï¼Œæ¥é€‚é…ä¸åŒæ ¼å¼çš„æ•°æ®é›†ï¼Œä½†è¿™ä¸€éƒ¨åˆ†æ–‡æ¡£æ²¡æœ‰æåŠ</p><h4 id="COCO-annotation-format"><a href="#COCO-annotation-format" class="headerlink" title="COCO annotation format"></a>COCO annotation format</h4><blockquote><p>The necessary keys of COCO format for instance segmentation is as below, for the complete details, please refer <a href="https://cocodataset.org/#format-data">here</a>.</p></blockquote><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"images"</span><span class="token operator">:</span> <span class="token punctuation">[</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"annotations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>annotation<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>category<span class="token punctuation">]</span><span class="token punctuation">}</span>image = <span class="token punctuation">{</span>    <span class="token property">"id"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"width"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"height"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"file_name"</span><span class="token operator">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span>annotation = <span class="token punctuation">{</span>    <span class="token property">"id"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"image_id"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"category_id"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"segmentation"</span><span class="token operator">:</span> RLE or <span class="token punctuation">[</span>polygon<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"area"</span><span class="token operator">:</span> float<span class="token punctuation">,</span>    <span class="token property">"bbox"</span><span class="token operator">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"iscrowd"</span><span class="token operator">:</span> <span class="token number">0</span> or <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">}</span>categories = <span class="token punctuation">[</span><span class="token punctuation">{</span>    <span class="token property">"id"</span><span class="token operator">:</span> int<span class="token punctuation">,</span>    <span class="token property">"name"</span><span class="token operator">:</span> str<span class="token punctuation">,</span>    <span class="token property">"supercategory"</span><span class="token operator">:</span> str<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>balloon dataset format å½¢å¦‚ä¸‹</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>'base64_img_data'<span class="token operator">:</span> ''<span class="token punctuation">,</span> 'file_attributes'<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 'filename'<span class="token operator">:</span> '34020010494_e5cb88e1c4_k.jpg'<span class="token punctuation">,</span> 'fileref'<span class="token operator">:</span> ''<span class="token punctuation">,</span> 'regions'<span class="token operator">:</span> <span class="token punctuation">{</span>'<span class="token number">0</span>'<span class="token operator">:</span> <span class="token punctuation">{</span>'region_attributes'<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>   'shape_attributes'<span class="token operator">:</span> <span class="token punctuation">{</span>'all_points_x'<span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    'all_points_y'<span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    'name'<span class="token operator">:</span> 'polygon'<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 'size'<span class="token operator">:</span> <span class="token number">1115004</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–‡æ¡£æä¾›äº†å‡½æ•°å°† balloon dataset JSON æ ¼å¼è½¬åŒ–ä¸º COCO formatï¼Œ<a href="https://mmdetection.readthedocs.io/en/latest/2_new_data_model.html#coco-annotation-format">åŸæ–‡æ¡£</a></p><h3 id="Prepare-a-config"><a href="#Prepare-a-config" class="headerlink" title="Prepare a config"></a>Prepare a config</h3><blockquote><p>The second step is to prepare a config thus the dataset could be successfully loaded. </p></blockquote><p>å‡è®¾ä»¥ balloon dataset è®­ç»ƒ Mask R-CNN with FPNï¼Œconfig åœ¨ <code>configs/balloon</code> å‘½åä¸º  <code>mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># The new config inherits a base config to highlight the necessary modification</span>_base_ <span class="token operator">=</span> <span class="token string">'mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'</span><span class="token comment"># We also need to change the num_classes in head to match the dataset's annotation</span>model <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    roi_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        bbox_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        mask_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>num_classes<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Modify dataset related settings</span>dataset_type <span class="token operator">=</span> <span class="token string">'COCODataset'</span>classes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'balloon'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    train<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'balloon/train/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'balloon/train/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    val<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    test<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>        img_prefix<span class="token operator">=</span><span class="token string">'balloon/val/'</span><span class="token punctuation">,</span>        classes<span class="token operator">=</span>classes<span class="token punctuation">,</span>        ann_file<span class="token operator">=</span><span class="token string">'balloon/val/annotation_coco.json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># We can use the pre-trained Mask RCNN model to obtain higher performance</span>load_from <span class="token operator">=</span> <span class="token string">'checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Train-amp-Test-Model"><a href="#Train-amp-Test-Model" class="headerlink" title="Train &amp; Test Model"></a>Train &amp; Test Model</h3><p>é…ç½®å¥½äº†æ•°æ®é›†è¿‡åï¼ŒåŸºæœ¬ä¸Šå°±å’Œ Part 1 ä¸­çš„è®­ç»ƒå’Œæµ‹è¯•æ–¹æ³•ä¸€æ ·</p><p>To train a model with the new config, you can simply run</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python tools/train.py configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>To test the trained model, you can simply run</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python tools/test.py configs/balloon/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py <span class="token punctuation">\</span>work_dirs/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_balloon.py/latest.pth <span class="token punctuation">\</span>--eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="Part-3-Train-with-customized-models-and-standard-datasets"><a href="#Part-3-Train-with-customized-models-and-standard-datasets" class="headerlink" title="Part 3, Train with customized models and standard datasets"></a>Part 3, Train with customized models and standard datasets</h2><blockquote><p>In this note, you will know how to train, test and inference your own customized models under standard datasets.</p></blockquote><p>ä½¿ç”¨ cityscapes dataset è®­ç»ƒä¸ªæ€§åŒ– Cascade Mask R-CNN R50 modelï¼Œä½¿ç”¨ <a href="https://github.com/Gus-Guo/AugFPN"><code>AugFPN</code></a> æ›¿ä»£ <code>FPN</code> ä½œä¸º neckï¼Œå¹¶ä¸”åŠ ä¸Š <code>Rotate</code> or <code>Translate</code> ä½œä¸ºæ•°æ®å¢å¼º</p><p>åŸºæœ¬æ­¥éª¤æ¯” Part 2 å¤šä¸€ä¸ªå‡†å¤‡ customized model:</p><ol><li>Prepare the standard dataset</li><li>Prepare your own customized model</li><li>Prepare a config</li><li>Train, test, and inference models on the standard dataset</li></ol><h3 id="Prepare-the-standard-dataset"><a href="#Prepare-the-standard-dataset" class="headerlink" title="Prepare the standard dataset"></a>Prepare the standard dataset</h3><p>åŸºæœ¬æµç¨‹ï¼Œä¹Ÿæ˜¯éœ€è¦å°† cityscapes dataset è½¬ä¸º COCO formatï¼Œmmdetection ä¹Ÿæä¾›è½¬åŒ–è„šæœ¬ <code>tools/dataset_converters/cityscapes.py</code></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> cityscapesscriptspython tools/dataset_converters/cityscapes.py ./data/cityscapes --nproc <span class="token number">8</span> --out-dir ./data/cityscapes/annotations<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Prepare-your-own-customized-model"><a href="#Prepare-your-own-customized-model" class="headerlink" title="Prepare your own customized model"></a>Prepare your own customized model</h3><h4 id="1-Define-a-new-neck-e-g-AugFPN"><a href="#1-Define-a-new-neck-e-g-AugFPN" class="headerlink" title="1. Define a new neck (e.g. AugFPN)"></a>1. Define a new neck (e.g. AugFPN)</h4><p>é¦–å…ˆæ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code>mmdet/models/necks/augfpn.py</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>builder <span class="token keyword">import</span> NECKS@NECKS<span class="token punctuation">.</span>register_module<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">AugFPN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>                in_channels<span class="token punctuation">,</span>                out_channels<span class="token punctuation">,</span>                num_outs<span class="token punctuation">,</span>                start_level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                end_level<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                add_extra_convs<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># implementation is ignored        pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„è¿™é‡Œç”¨äº†ä¸€ä¸ªè£…é¥°å™¨ï¼Œå¤ä¹  python çš„æ—¶å€™å¯ä»¥è”ç³»èµ·æ¥</p><h4 id="2-Import-the-module"><a href="#2-Import-the-module" class="headerlink" title="2. Import the module"></a>2. Import the module</h4><p>å¯¼å…¥æ¨¡å—æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ol><li><p>åœ¨  <code>mmdet/models/necks/__init__.py</code> å¯¼å…¥</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>augfpn <span class="token keyword">import</span> AugFPN<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åœ¨ config æ–‡ä»¶ä¸­æ›´æ”¹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">custom_imports <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>    imports<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'mmdet.models.necks.augfpn.py'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    allow_failed_imports<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±é¿å…å»æ›´æ”¹åŸæ–‡ä»¶</p></li></ol><h4 id="3-Modify-the-config-file"><a href="#3-Modify-the-config-file" class="headerlink" title="3. Modify the config file"></a>3. Modify the config file</h4><p>å°† neck åŠ å…¥åˆ° config file ä¸­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">neck<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'AugFPN'</span><span class="token punctuation">,</span>    in_channels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    out_channels<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>    num_outs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæƒ³è¦æ›´æ”¹åˆ«äººçš„æ¨¡å‹ï¼Œmmdetection éƒ½æ˜¯ä»¥ config file ä¸ºæ ¸å¿ƒï¼Œè€Œä¸å»æ›´æ”¹åŸæ–‡ä»¶</p><p>å¦‚æœè¦å®Œæˆ AugFPN, Rotate, Translate ä¸‰ä¸ªä¿®æ”¹çš„è¯ï¼Œåœ¨æ–‡æ¡£ä¸­ç»™å‡ºäº†å‚è€ƒçš„ <a href="https://mmdetection.readthedocs.io/en/latest/3_exist_data_new_model.html#prepare-a-config">config file</a></p><h3 id="Train-amp-Test-Model-1"><a href="#Train-amp-Test-Model-1" class="headerlink" title="Train &amp; Test Model"></a>Train &amp; Test Model</h3><p>è®­ç»ƒå’Œæµ‹è¯•åŸºæœ¬ä½¿ç”¨æ–¹æ³•åœ¨ä¹‹å‰å·²ç»ä»‹ç»è¿‡ï¼Œè¿™éƒ¨åˆ†ä¹Ÿä¸€æ ·</p><p>To train a model with the new config, you can simply run</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python tools/train.py configs/cityscapes/cascade_mask_rcnn_r50_augfpn_autoaug_10e_cityscapes.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>To test the trained model, you can simply run</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python tools/test.py configs/cityscapes/cascade_mask_rcnn_r50_augfpn_autoaug_10e_cityscapes.py <span class="token punctuation">\</span>work_dirs/cascade_mask_rcnn_r50_augfpn_autoaug_10e_cityscapes.py/latest.pth --eval bbox segm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><h3 id="pthæ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ"><a href="#pthæ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ" class="headerlink" title=".pthæ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ"></a>.pthæ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ</h3><p>è¦å›ç­”ä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ˜¯ <a href="https://zhuanlan.zhihu.com/p/84797438">.pth æ–‡ä»¶ çŸ¥ä¹</a>ï¼Œåœ¨ mmdetection æ¡†æ¶ä¸­å¯ä»¥çœ‹åˆ° pth æ–‡ä»¶åŒ…å«äº†ä¸¤ä¸ªéƒ¨åˆ† <code>meta &amp; state_dict</code></p><p>å…¶ä¸­ <code>meta</code> ä¿å­˜äº†æ¨¡å‹çš„é…ç½®ä¿¡æ¯ï¼Œåˆ—å‡ºå…¶ keyï¼š</p><ol><li>mmdet_version</li><li><strong>config</strong></li><li>CLASSES</li><li>epoch</li><li>iter</li><li>mmcv_version</li><li>time</li></ol><p>è€Œ <code>state_dict</code> ä¿å­˜äº†æ¨¡å‹å‚æ•°å€¼ï¼Œåˆ—å‡ºéƒ¨åˆ† keyï¼š</p><p>backbone.conv1.weight<br>backbone.bn1.weight<br>backbone.bn1.bias<br>backbone.bn1.running_mean<br>backbone.bn1.running_var<br>backbone.bn1.num_batches_tracked<br>backbone.layer1.0.conv1.weight<br>backbone.layer1.0.bn1.weight<br>backbone.layer1.0.bn1.bias<br>backbone.layer1.0.bn1.running_mean<br>backbone.layer1.0.bn1.running_var<br>backbone.layer1.0.bn1.num_batches_tracked</p><p>â€¦â€¦.</p><h3 id="å¦‚ä½•ç†è§£-Registry"><a href="#å¦‚ä½•ç†è§£-Registry" class="headerlink" title="å¦‚ä½•ç†è§£ Registry"></a>å¦‚ä½•ç†è§£ Registry</h3><p>åœ¨å­¦ä¹  mmdetection è¿‡ç¨‹ä¸­ä¸€ç›´åˆä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•ä½¿ç”¨ config + registry è¿”å›ä¸€ä¸ª nn.Module ç±»çš„æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹æ˜¯å¦‚ä½•è¢«æ³¨å†Œåˆ° Registry ç±»å½“ä¸­çš„ï¼Ÿ</p><p>é˜…è¯»èµ„æºï¼š</p><ol><li><p><a href="https://blog.csdn.net/sinat_29963957">mmdetection æºç é˜…è¯»ç¬”è®°</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/337375549">mmdetection æ•´ä½“æ„å»ºæµç¨‹</a></p></li><li><p><a href="https://blog.csdn.net/wulele2/article/details/114139512">mmdetectionä¹‹modelæ„å»º</a></p></li><li><p><a href="https://mmtracking.readthedocs.io/en/latest/">MMCV å®˜æ–¹æ–‡æ¡£</a>ï¼Œè¿™ä¸ªæ–‡æ¡£ç›¸å½“æœ‰ç”¨ï¼Œæ˜¯ mmlab çš„é€šç”¨åŸºç¡€åº“ï¼Œè¦å¥½å¥½å­¦ä¹ ä¸€ä¸‹</p></li><li><p><a href="https://www.cnblogs.com/hester/p/10546235.html#:~:text=Python%E4%B8%AD%E4%B8%80%E4%B8%AApy%E6%96%87%E4%BB%B6%E5%B0%B1%E6%98%AF%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9D%97%EF%BC%8C%E2%80%9C__all__%E2%80%9D%E5%8F%98%E9%87%8F%E6%98%AF%E4%B8%80%E4%B8%AA%E7%89%B9%E6%AE%8A%E7%9A%84%E5%8F%98%E9%87%8F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8py%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%9C%A8%E5%8C%85%E7%9A%84__init__.py%E4%B8%AD%E5%87%BA%E7%8E%B0%E3%80%82%20%E5%A6%82%EF%BC%9A%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%EF%BC%8C%E5%87%BD%E6%95%B0%EF%BC%8C%E7%B1%BB%E3%80%82%20%E5%A6%82%E4%B8%8B%EF%BC%8Ctest1.py%E5%92%8Cmain.py,%3F%20%3F%20%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E5%9C%A8%E5%90%8C%E4%B8%80%E4%B8%AA%E7%9B%AE%E5%BD%95%E4%B8%8B%E3%80%82%20%E9%82%A3%E4%B9%88%E5%9C%A8%E6%A8%A1%E5%9D%97%E4%B8%AD%E7%9A%84__all__%E5%8F%98%E9%87%8F%E5%B0%B1%E6%98%AF%E4%B8%BA%E4%BA%86%E9%99%90%E5%88%B6%E6%88%96%E8%80%85%E6%8C%87%E5%AE%9A%E8%83%BD%E8%A2%AB%E5%AF%BC%E5%85%A5%E5%88%B0%E5%88%AB%E7%9A%84%E6%A8%A1%E5%9D%97%E7%9A%84%E5%87%BD%E6%95%B0%EF%BC%8C%E7%B1%BB%EF%BC%8C%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E7%AD%89%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%8C%87%E5%AE%9A%E4%BA%86%E9%82%A3%E4%B9%88%E5%8F%AA%E8%83%BD%E6%98%AF%E6%8C%87%E5%AE%9A%E7%9A%84%E9%82%A3%E4%BA%9B%E5%8F%AF%E4%BB%A5%E8%A2%AB%E5%AF%BC%E5%85%A5%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%8C%87%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%B0%B1%E6%98%AF%E5%85%A8%E9%83%A8%E5%8F%AF%E4%BB%A5%E5%AF%BC%E5%85%A5%EF%BC%8C%E5%BD%93%E7%84%B6%E7%A7%81%E6%9C%89%E5%B1%9E%E6%80%A7%E5%BA%94%E8%AF%A5%E9%99%A4%E5%A4%96%E3%80%82">python __all__å˜é‡</a></p></li><li>åœ¨ B ç«™ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªå®˜æ–¹ <a href="https://space.bilibili.com/630319191/channel/detail?cid=179690&amp;ctype=0">å­¦ä¹ è®²åº§ç³»åˆ—</a>ï¼Œè¿™ä¸ªè®²åº§ä¸å¤ªå’Œæˆ‘èƒƒå£ï¼Œåˆåœ¨ B ç«™ä¸Šæ‰¾äº†ä¸€ä¸ªè¥¿äº¤çš„ <a href="https://www.bilibili.com/video/BV1Jb4y1r7ir?p=1">æ•™å­¦è§†é¢‘</a>ï¼Œè¿™ä¸ªè§†é¢‘å°±æ¯”è¾ƒå‹å¥½ï¼Œå¯¹æˆ‘å¸®åŠ©æ›´å¤§</li></ol><p>æˆ‘ä¸€ç›´éƒ½å¾ˆä¸ç†è§£è¿™äº›ç±»æ˜¯æ€ä¹ˆæ³¨å†Œçš„ï¼Œä¸ºä»€ä¹ˆæœ‰çš„ä»£ç ä¼¼ä¹æ²¡æœ‰â€œæ˜æ˜¾â€åœ°è¿è¡Œï¼Œä½†æ˜¯è¿™äº›æ¨¡å—å°±å·²ç»è¢«æ³¨å†Œåˆ° Registry å½“ä¸­äº†ï¼Ÿçœ‹å®Œ MMCV æ–‡æ¡£ä¹‹åæ‰å¤§æ¦‚æ˜ç™½äº†ï¼Œé‡ç‚¹å°±åœ¨äº <code>__init__.py</code> æ–‡ä»¶ä»¥åŠ <code>__all__</code> å˜é‡ã€‚å¯ä»¥çœ‹åˆ°åœ¨è®¸å¤šæ–‡ä»¶å¤¹ä¸‹éƒ½æœ‰ <code>__init__.py</code> æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>mmdet/models/__init__.py</code>, <code>mmdet/models/backbones/__init__.py</code></p><p>å¦‚æœ import æ–‡ä»¶å¤¹/æ¨¡å—ä¸‹æœ‰ init.py æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨ import è¯¥æ¨¡å—ä¹‹å‰å…ˆè¿è¡Œ init.py æ–‡ä»¶ï¼Œå°±æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶ä¹‹ä¸­å®Œæˆäº†å„ä¸ªæ¨¡å—çš„æ³¨å†Œï¼Œå…¶ä¸­ <code>__all__</code> å˜é‡åŒ…å«äº†éœ€è¦å¯¼å…¥çš„æ¨¡å—åˆ—è¡¨</p><p>å…·ä½“çœ‹ä¸€ä¸‹å…¶ä¸­çš„å†…å®¹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>backbones <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span><span class="token keyword">from</span> <span class="token punctuation">.</span>builder <span class="token keyword">import</span> <span class="token punctuation">(</span>BACKBONES<span class="token punctuation">,</span> DETECTORS<span class="token punctuation">,</span> HEADS<span class="token punctuation">,</span> LOSSES<span class="token punctuation">,</span> NECKS<span class="token punctuation">,</span>                      ROI_EXTRACTORS<span class="token punctuation">,</span> SHARED_HEADS<span class="token punctuation">,</span> build_backbone<span class="token punctuation">,</span>                      build_detector<span class="token punctuation">,</span> build_head<span class="token punctuation">,</span> build_loss<span class="token punctuation">,</span> build_neck<span class="token punctuation">,</span>                      build_roi_extractor<span class="token punctuation">,</span> build_shared_head<span class="token punctuation">)</span><span class="token keyword">from</span> <span class="token punctuation">.</span>dense_heads <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span><span class="token keyword">from</span> <span class="token punctuation">.</span>detectors <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span><span class="token keyword">from</span> <span class="token punctuation">.</span>losses <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span><span class="token keyword">from</span> <span class="token punctuation">.</span>necks <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span><span class="token keyword">from</span> <span class="token punctuation">.</span>plugins <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span><span class="token keyword">from</span> <span class="token punctuation">.</span>roi_heads <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment"># noqa: F401,F403</span>__all__ <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'BACKBONES'</span><span class="token punctuation">,</span> <span class="token string">'NECKS'</span><span class="token punctuation">,</span> <span class="token string">'ROI_EXTRACTORS'</span><span class="token punctuation">,</span> <span class="token string">'SHARED_HEADS'</span><span class="token punctuation">,</span> <span class="token string">'HEADS'</span><span class="token punctuation">,</span> <span class="token string">'LOSSES'</span><span class="token punctuation">,</span>    <span class="token string">'DETECTORS'</span><span class="token punctuation">,</span> <span class="token string">'build_backbone'</span><span class="token punctuation">,</span> <span class="token string">'build_neck'</span><span class="token punctuation">,</span> <span class="token string">'build_roi_extractor'</span><span class="token punctuation">,</span>    <span class="token string">'build_shared_head'</span><span class="token punctuation">,</span> <span class="token string">'build_head'</span><span class="token punctuation">,</span> <span class="token string">'build_loss'</span><span class="token punctuation">,</span> <span class="token string">'build_detector'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Bug-amp-vscode-debugger"><a href="#Bug-amp-vscode-debugger" class="headerlink" title="Bug  &amp; vscode debugger"></a>Bug  &amp; vscode debugger</h3><p>æ£é¼“äº†ä¸€å¤©äº†åœ¨æœåŠ¡å™¨ï¼Œæ€ä¹ˆéƒ½ä¸èƒ½å¤Ÿæå¥½ xrdpï¼Œè¿˜å·®ç‚¹æŠŠç”µè„‘å¼„å‡ºç‚¹æ¯›ç—…â€¦æœ€åç”¨ <code>sudo dpkg --purge xrdp</code> åˆ é™¤äº†æ²¡æœ‰ä¸‹è½½å®Œå…¨çš„åŒ…æ‰å¼„å¥½äº†ã€‚æˆ‘è®¤ä¸ºå®éªŒå®¤çš„æœåŠ¡å™¨éœ€è¦ä¸€ä¸ªå¤§æ›´æ–°ï¼Œä¸€ä¸ªæ˜¯ç³»ç»Ÿå‡çº§ï¼Œå¦ä¸€ä¸ªæ˜¯æ¸…ç†å†…å­˜ï¼Œç°åœ¨å¤§æ¦‚è¿˜æœ‰350Gçš„ç©ºé—´å‰©ä½™ï¼Œæœ€é‡è¦çš„æ˜¯æœåŠ¡å™¨çš„ç½‘ç»œæ˜¯ä¸ªå¤§é—®é¢˜ï¼å¾ˆå¤šèµ„æºéƒ½æ— æ³•ç›´æ¥ä¸‹è½½ï¼Œæœ‰äº›èµ„æºä¸‹è½½èµ·æ¥éå¸¸åƒåŠ›</p><p>æ”¾ä¸€ä¸ª <a href="https://www.jianshu.com/p/ceb3c020e06b">nvidia-smiè®²è§£é“¾æ¥</a>ï¼Œç†è§£ä¸€ä¸‹å„ä¸ªæŒ‡æ ‡æ˜¯åœ¨è¯´ä»€ä¹ˆ</p><h4 id="vscode-debugger"><a href="#vscode-debugger" class="headerlink" title="vscode debugger"></a>vscode debugger</h4><p>åœ¨ä½¿ç”¨ vscode debug çš„æ—¶å€™å‘ç°æœ‰çš„ä»£ç å¹¶ä¸ä¼š step inï¼Œåæ¥å‘ç°è¿™äº›ä»£ç éƒ½æ˜¯é€šè¿‡ pip/conda install ä¸‹è½½çš„åº“ä¸­çš„ä»£ç ã€‚è€Œ vscode çš„ debugger ä¼šé»˜è®¤è®¾å®šåªåœ¨ â€˜MyCodeâ€™ ä¸­è¿›è¡Œ debugï¼Œç®€å•çš„è¯´ï¼Œå¦‚æœä¸æ˜¯â€œè‡ªå·±â€å†™çš„ä»£ç ï¼Œvscode debugger æ˜¯ä¸ä¼š step in çš„</p><p>è§£å†³åŠæ³•ï¼šåœ¨ debugger çš„ json æ–‡ä»¶ä¸­è®¾ç½® <code>"justMyCode: false"</code></p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token comment">// Use IntelliSense to learn about possible attributes.</span>    <span class="token comment">// Hover to view descriptions of existing attributes.</span>    <span class="token comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>    <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Python: Current File"</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"python"</span><span class="token punctuation">,</span>            <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>            <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"${file}"</span><span class="token punctuation">,</span>            <span class="token property">"console"</span><span class="token operator">:</span> <span class="token string">"integratedTerminal"</span><span class="token punctuation">,</span>            <span class="token comment">// add the next line into your .json file</span>            <span class="token property">"justMyCode"</span><span class="token operator">:</span> <span class="token boolean">false</span>        <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ol><li><p>è¿˜éœ€è¦æ•´ç† MMCV ä»¥äº†è§£æ•´ä¸ª OpenMMLab çš„è¿è¡Œé€»è¾‘ </p></li><li><p>å¯¹äºå¦‚ä½•è®­ç»ƒè‡ªå·±çš„ç½‘ç»œè¿˜è¦ç»§ç»­çœ‹æ–‡æ¡£ä¸­çš„ Tutorial éƒ¨åˆ†</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MMDetection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£… MMDetection ç¬”è®°</title>
      <link href="/archives/54605061.html"/>
      <url>/archives/54605061.html</url>
      
        <content type="html"><![CDATA[<h1 id="å®‰è£…-MMDetection-ç¬”è®°"><a href="#å®‰è£…-MMDetection-ç¬”è®°" class="headerlink" title="å®‰è£… MMDetection ç¬”è®°"></a>å®‰è£… MMDetection ç¬”è®°</h1><p>æƒ³æ³•ï¼šé€šè¿‡è¿™ç§æ ‡å‡†åŒ–çš„ç®—æ³•æ¡†æ¶ï¼Œæ¥è¿›è¡Œç»„åˆå®éªŒ</p><p>ä½†æ˜¯ç›®å‰ SE-SSD æ²¡æœ‰æ”¯æŒï¼Œå¯ä»¥å°è¯•ç»„åˆä¸€ä¸‹</p><h2 id="OpenMMLab"><a href="#OpenMMLab" class="headerlink" title="OpenMMLab"></a>OpenMMLab</h2><p>å®˜ç½‘ï¼š<a href="https://openmmlab.com/">https://openmmlab.com/</a></p><p>github: <a href="https://github.com/open-mmlab">https://github.com/open-mmlab</a></p><p>å­é¡¹ç›®å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://mmdetection.readthedocs.io/zh_CN/latest/">MMDetection</a> <a href="https://mmdetection3d.readthedocs.io/zh_CN/latest/index.html">MMDetection3D</a></p><p>ä»€ä¹ˆæ˜¯ OpenMMLabï¼Ÿä»€ä¹ˆæ˜¯ MMDdetctionï¼Ÿ</p><blockquote><p>OpenMMLab æ˜¯ä¸€ä¸ªè®¡ç®—æœºè§†è§‰å¼€æºç®—æ³•ä½“ç³»å’Œæ¡†æ¶ï¼Œæ¶‰åŠè¶…è¿‡10ç§ç ”ç©¶æ–¹å‘ï¼Œå¼€æ”¾è¶…è¿‡100ç§ç®—æ³•ã€800ç§é¢„è®­ç»ƒæ¨¡å‹</p><p>MMDetection is an open source object detection toolbox based on PyTorch. It is a part of the OpenMMLab project.</p></blockquote><h2 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h2><p>æˆ‘æ‰“ç®—å…ˆç†Ÿæ‚‰ MMDetectionï¼Œå› ä¸ºè¿™ä¸ªé¡¹ç›®åœ¨ github ä¸Š star æ˜¯ç›¸å¯¹è¾ƒå¤šçš„ï¼Œç„¶åå†è¿›ä¸€æ­¥å­¦ä¹  mmdetection 3Dï¼Œä¸‹é¢æ¥å®‰è£… MMDetection ç¯å¢ƒ</p><p>é¦–å…ˆçœ‹çœ‹ä¾èµ–çš„è¦æ±‚</p><ul><li>Linux å’Œ macOS ï¼ˆWindows ç†è®ºä¸Šæ”¯æŒï¼‰</li><li>Python 3.6+</li><li>PyTorch 1.3+</li><li>CUDA 9.2+ ï¼ˆå¦‚æœåŸºäº PyTorch æºç å®‰è£…ï¼Œä¹Ÿèƒ½å¤Ÿæ”¯æŒ CUDA 9.0ï¼‰</li><li>GCC 5+</li><li><a href="https://mmcv.readthedocs.io/en/latest/#installation">MMCV</a></li></ul><p>ä¹‹åä¸‹è½½çš„ä¾èµ–ç‰ˆæœ¬å‚è€ƒè¦æ±‚æ¥</p><ol><li><p>åˆ›å»º conda ç¯å¢ƒ <code>conda create -n mmlab python=3.7</code></p></li><li><p>å®‰è£… pytorch</p><p>åœ¨ <a href="https://pytorch.org/get-started/previous-versions/">pytorch previous versions</a> ä¸­æŸ¥æ‰¾ä½ æƒ³è¦çš„ç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©å¦‚ä¸‹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">conda <span class="token function">install</span> <span class="token assign-left variable">pytorch</span><span class="token operator">==</span><span class="token number">1.5</span>.1 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.6</span>.1 <span class="token assign-left variable">cudatoolkit</span><span class="token operator">=</span><span class="token number">10.1</span> -c pytorch<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶æŸ¥çœ‹æˆ‘çš„ç”µè„‘ä¸Šå®‰è£…çš„ CUDA ç‰ˆæœ¬ï¼Œä½¿ç”¨å‘½ä»¤ <code>nvcc -V</code></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">nvcc: NVIDIA <span class="token punctuation">(</span>R<span class="token punctuation">)</span> Cuda compiler driverCopyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2005</span>-2018 NVIDIA CorporationBuilt on Sat_Aug_25_21:08:01_CDT_2018Cuda compilation tools, release <span class="token number">10.0</span>, V10.0.130<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥ç‰ˆæœ¬ä¸º 10.0 å’Œ cudatoolkit çš„ 10.1 ç‰ˆæœ¬å¹¶ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆ pytorch ç©¶ç«Ÿæ˜¯ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨ 10.0 çš„ç‰ˆæœ¬ï¼Œéœ€è¦æ›´æ”¹ä¸€ä¸‹ç¯å¢ƒ CUDA_HOME ç¯å¢ƒå˜é‡ã€‚æ›´å¤šçš„ä¿¡æ¯ï¼Œè¯·é˜…è¯»è¡¥å……ç¬”è®°</p></li></ol><h2 id="å®‰è£…-MMDetection"><a href="#å®‰è£…-MMDetection" class="headerlink" title="å®‰è£… MMDetection"></a>å®‰è£… MMDetection</h2><p>å®˜æ–¹æ¨èä½¿ç”¨ <a href="https://github.com/open-mmlab/mim">MIM</a> å®‰è£… MMDetection</p><blockquote><p>MIM provides a unified interface for launching and installing OpenMMLab projects and their extensions, and managing the OpenMMLab model zoo.</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> openmimmim <span class="token function">install</span> mmdet<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>MIM è‡ªåŠ¨ä¸‹è½½äº† mmdet åŠå…¶å¯¹åº”ä¾èµ–</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># mim list</span>Package    Version    Source---------  ---------  -----------------------------------------mmcv-full  <span class="token number">1.3</span>.10     https://github.com/open-mmlab/mmcvmmdet      <span class="token number">2.15</span>.0     https://github.com/open-mmlab/mmdetection<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>å°† MMDetection ä»“åº“å…‹éš†åˆ°æœ¬åœ°ï¼Œè¿è¡Œå¦‚ä¸‹ä»£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mmdet<span class="token punctuation">.</span>apis <span class="token keyword">import</span> inference_detector<span class="token punctuation">,</span> init_detectorconfig_file <span class="token operator">=</span> <span class="token string">'configs/faster_rcnn/faster_rcnn_r50_fpn_1x_coco.py'</span><span class="token comment"># ä» model zoo ä¸‹è½½ checkpoint å¹¶æ”¾åœ¨ `checkpoints/` æ–‡ä»¶ä¸‹</span><span class="token comment"># ç½‘å€ä¸º: http://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_1x_coco/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth</span>checkpoint_file <span class="token operator">=</span> <span class="token string">'checkpoints/faster_rcnn_r50_fpn_1x_coco_20200130-047c8118.pth'</span>device <span class="token operator">=</span> <span class="token string">'cuda:0'</span><span class="token comment"># åˆå§‹åŒ–æ£€æµ‹å™¨</span>model <span class="token operator">=</span> init_detector<span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> checkpoint_file<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span><span class="token comment"># æ¨ç†æ¼”ç¤ºå›¾åƒ</span>img <span class="token operator">=</span> <span class="token string">'demo/demo.jpg'</span>result <span class="token operator">=</span> inference_detector<span class="token punctuation">(</span>model<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token comment"># ç»˜åˆ¶ç»“æœå›¾</span>model<span class="token punctuation">.</span>show_result<span class="token punctuation">(</span>img<span class="token punctuation">,</span> result<span class="token punctuation">,</span> wait_time<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¡¥å……ï¼šPytorch-amp-CUDA"><a href="#è¡¥å……ï¼šPytorch-amp-CUDA" class="headerlink" title="è¡¥å……ï¼šPytorch &amp; CUDA"></a>è¡¥å……ï¼šPytorch &amp; CUDA</h2><h3 id="CUDA-amp-CUDA-toolkit-amp-pytorch-install-with-conda"><a href="#CUDA-amp-CUDA-toolkit-amp-pytorch-install-with-conda" class="headerlink" title="CUDA &amp; CUDA toolkit &amp; pytorch install with conda"></a>CUDA &amp; CUDA toolkit &amp; pytorch install with conda</h3><p>conda åœ¨å®‰è£… Pytorch ç­‰ä¼šä½¿ç”¨åˆ° CUDA çš„æ¡†æ¶æ—¶ï¼Œä¼šè‡ªåŠ¨ä¸ºç”¨æˆ·å®‰è£… cudatoolkitï¼Œå…¶ä¸»è¦åŒ…å«åº”ç”¨ç¨‹åºåœ¨ä½¿ç”¨ CUDA ç›¸å…³çš„åŠŸèƒ½æ—¶æ‰€ä¾èµ–çš„åŠ¨æ€é“¾æ¥åº“ã€‚åœ¨å®‰è£…äº† cudatoolkit åï¼Œåªè¦ç³»ç»Ÿä¸Šå­˜åœ¨ä¸å½“å‰çš„ cudatoolkit æ‰€å…¼å®¹çš„ Nvidia é©±åŠ¨ï¼Œåˆ™å·²ç»ç¼–è¯‘å¥½çš„ CUDA ç›¸å…³çš„ç¨‹åºå°±å¯ä»¥ç›´æ¥è¿è¡Œï¼Œè€Œä¸éœ€è¦å®‰è£…å®Œæ•´çš„ Nvidia å®˜æ–¹æä¾›çš„ CUDA Toolkit </p><p>ç»è¿‡è‡ªå·±çš„å®éªŒï¼Œç¯å¢ƒä¸­çš„ CUDA_HOME å˜é‡æ˜¯æ¸…ç©ºçš„ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è®¾ç½® /usr/local/cuda è½¯é“¾æ¥ï¼Œä½†æ˜¯ pytorch ä¾ç„¶èƒ½å¤Ÿè°ƒç”¨ GPUï¼Œè¯´æ˜åªéœ€è¦ä½ çš„ Nvidia Driver å’Œ conda install cudatoolkit å…¼å®¹ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦ä» Nvidia å®˜ç½‘ä¸­ä¸‹è½½å®Œæ•´çš„ CUDA Toolkit</p><p>ç»¼ä¸Š Pytorch æŸ¥æ‰¾ cuda è·¯å¾„é¡ºåºä¸ºï¼š</p><ol><li><p>å…ˆæŸ¥æ‰¾ç¯å¢ƒå˜é‡ä¸­æ˜¯å¦å­˜åœ¨ CUDA_PATH / CUDA_HOME å¦‚æœ‰åˆ™ä½¿ç”¨è¯¥è·¯å¾„æŒ‡å‘çš„ CUDA ç‰ˆæœ¬ã€‚å…¶ä¸­ CUDA_PATH ä¸º windows ç¯å¢ƒå˜é‡ï¼ŒCUDA_HOME ä¸º Linux ç¯å¢ƒå˜é‡</p></li><li><p>è‹¥æ‰¾ä¸åˆ° CUDA_HOMEï¼Œåˆ™æŸ¥çœ‹ usr/local/cuda æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™ä½¿ç”¨è¯¥è·¯å¾„æŒ‡å‘çš„ CUDA ç‰ˆæœ¬</p></li><li><p>è‹¥ä¸¤ä¸ªè·¯å¾„éƒ½ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨ conda ä¸‹è½½çš„ cudatoolkitï¼Œä¹Ÿå³ä¸‹è½½ pytorch æ—¶è‡ªåŠ¨ä¸‹è½½çš„ cudatoolkit</p></li></ol><p>æ¨è <a href="https://www.cnblogs.com/yhjoker/p/10972795.html">å‚è€ƒé“¾æ¥</a> è¿›è¡Œæ·±å…¥äº†è§£</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> OpenMMLab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MMDetection </tag>
            
            <tag> å®‰è£…æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŒ«å¤´é¹°å…ˆç”Ÿå‚¬çœ å½•éŸ³æ–‡æœ¬</title>
      <link href="/archives/11812369.html"/>
      <url>/archives/11812369.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV16f4y1S72h">bilibili link</a></p><p>my name is Mr. Owl</p><p>I will shortly lead you through a guided hypnosis</p><p>please donâ€™t listen to this while driving or operating machinery</p><p>you may also want to have a glass of water nearby</p><p>it can help ground you after a recession</p><p>I would like you to start by simply lying down in a comfortable position </p><p>perhaps on some cushions</p><p>or on a couch</p><p>and just take a few moments to relax your mind</p><p>(a moment â€¦)</p><p>in a moment</p><p>Iâ€™m going to ask you to imagine a place</p><p>a special place</p><p>you may see it</p><p>feel it</p><p>imagine it or experience it</p><p>in any way you want</p><p>and you might find your mind wondering quite a bit</p><p>but that doesnâ€™t matter to you</p><p>the sound of my voice will continue to relax you</p><p>and it doesnâ€™t matter if you donâ€™t hear a word I say</p><p>because very soon now</p><p>you are going to be relaxed</p><p>more than you have ever known</p><p>imagine now that you are in that place</p><p>that place you know well</p><p>a hotel by a lake</p><p>and you are here </p><p>at the top of a gorgeous staircase</p><p>in a large open hallway</p><p>a really beautiful old hotel</p><p>itâ€™s such a comfortable temperature here</p><p>daylight streams in through the window</p><p>slightly warm</p><p>such a peaceful place to be</p><p>and at the bottom of those stairs</p><p>an open doorway</p><p>leading to a garden</p><p>in a few moments</p><p>I will count</p><p>from 1 to 10</p><p>and count you down each step</p><p>let each number</p><p>represent a step</p><p>and each step takes you deeper and deeper</p><p>into relaxation</p><p>so that by the time I get to ten</p><p>you can allow yourself</p><p>to be as deeply relaxed</p><p>as you ever can be</p><p>and youâ€™ll still hear</p><p>the sound of my voice</p><p>and as you look down</p><p>you can glimpse</p><p>through the open door</p><p>that intriguing garden</p><p>itâ€™s so interesting to you</p><p>to explore and discover</p><p>this special place</p><p>the sunlight to the windows on your skin</p><p>thereâ€™s no one around</p><p>that needs anything from you</p><p>no one around</p><p>to bother you</p><p>1</p><p>when you are ready</p><p>take your first step now</p><p>relaxing letting go</p><p>2</p><p>take another step</p><p>feeling more at ease</p><p>and at peace with yourself</p><p>3</p><p>perhaps noticing</p><p>heavy</p><p>restful feeling</p><p>spreading down your legs</p><p>with every step</p><p>4</p><p>just drifting deeper</p><p>and deeper down</p><p>5</p><p>another step</p><p>becoming calmer</p><p>and even calmer still</p><p>continuing to relax</p><p>continuing to let go</p><p>and feeling so good</p><p>6</p><p>perhaps beginning to notice</p><p>any sounds becoming part of your experience of comfort</p><p>relaxation</p><p>and anything you notice</p><p>becoming part of your experience</p><p>7</p><p>sinking deeper and deeper</p><p>drifting</p><p>further</p><p>into this welcoming</p><p>relaxed state</p><p>8</p><p>enjoying those feelings</p><p>half awake</p><p>half asleep</p><p>9</p><p>noticing way of growing relaxation</p><p>and spreading comfort</p><p>10</p><p>an now</p><p>at the bottom of the stairs</p><p>and wandering through that open door</p><p>how into the gardon beyond</p><p>soak up those feelings of</p><p>tranquility</p><p>see</p><p>hear</p><p>feel sense or imagine this</p><p>beautiful garden</p><p>the greens</p><p>the flowers</p><p>the trees</p><p>the brown</p><p>the clear blue sky</p><p>feel the warmth of the sun</p><p>on your head and shoulders</p><p>enjoy a moment here</p><p>and peace</p><p>inhale the sense of the garden</p><p>there is no one around</p><p>wanting anything from you</p><p>needing anything from you</p><p>no one expecting anything</p><p>so enjoy this</p><p>peace</p><p>and quiet</p><p>for a few moments more</p><p>notice now</p><p>at the end of this garden</p><p>a set of steps</p><p>leading down to a sturdy pier</p><p>at the edge of lake</p><p>so now</p><p>take the steps now</p><p>sinking further and further into relaxation</p><p>as you do</p><p>more and more relaxed with each step</p><p>until you step onto the wooden pier</p><p>then stepping forward</p><p>towards that beautiful crystal blue water</p><p>the sun on your skin</p><p>and gentle breeze</p><p>and here</p><p>at the end of the pier</p><p>a fishing rod</p><p>You take it in your hand</p><p>feel a comforting weight of it</p><p>not too heavy to hold</p><p>but you know that itâ€™s strong and sturdy</p><p>it will not struggle with the weight of todayâ€™s catch</p><p>slowly and deliberately</p><p>you unravel some of the line</p><p>you pull back the rod</p><p>and cast that line into that crystal</p><p>clear</p><p>blue water</p><p>it sits in that water for a moment</p><p>and soon you feel a gentle pull on the fishing rod</p><p>youâ€™ve caught something</p><p>you gently crank back the handle</p><p>pulling your catch out of the water</p><p>what have you caught</p><p>itâ€™s a white cube</p><p>so square and perfect on every side</p><p>a little water drips from it</p><p>as you gently swing it back onto the pier beside you</p><p>you lower the fishing rod to your side</p><p>and you take</p><p>the white cube from the line</p><p>whatâ€™s inside this cube</p><p>itâ€™s a memory</p><p>a good memory</p><p>a memory from your life</p><p>a memory of a time when you were happy</p><p>and strong</p><p>and confident</p><p>you pick up the cube</p><p>you hold it close to your face</p><p>and now you can see this memory</p><p>you see it in a vivid wide screen</p><p>The colors are rich</p><p>the image is bright</p><p>the sound is clear and strong and vibrant</p><p>so strong and vibrant that you step into this memory</p><p>you are inside</p><p>let those feelings grow inside you</p><p>feeling happy and strong and confident and bright</p><p>take a moment to enjoy this</p><p>to live in it</p><p>to breathe</p><p>this beautiful positive memory from the white cube</p><p>feeling strong and confident</p><p>and bright and happy</p><p>now</p><p>slowly</p><p>and with care</p><p>you move out of the memory</p><p>and you lower the cube</p><p>from in front of your face</p><p>and se t it down gently on the pier beside you</p><p>take a moment now</p><p>look out</p><p>onto the lake</p><p>at the cool blue water</p><p>the peace</p><p>tranquility of it</p><p>you kneel down and lower the white cube</p><p>into the peaceful water</p><p>and as the ripples slow and stop</p><p>you catch sight of your own reflection</p><p>and you see how beautiful you are</p><p>how strong you are</p><p>you can see positivity in your eye</p><p>like jewels</p><p>you stand and look out at that lake</p><p>calm serene and full of power</p><p>breathe it in gently</p><p>and then breathe it out gently</p><p>all that power thatâ€™s within you</p><p>I let you enjoy those feelings for a few moments more</p><p>allow you time to bask in that life</p><p>but soon</p><p>soon Iâ€™ll start count from one up to five</p><p>when I reach five</p><p>you will be back in the room</p><p>1</p><p>starting to come back</p><p>become aware of your breathing</p><p>your body and the space around you</p><p>2</p><p>moving your legs start to wiggle your toes and feet</p><p>a lovely grounding energy, traveling up your legs</p><p>3</p><p>moving your arms starting to stretch, feel the energy moving through your body again</p><p>4 </p><p>your eyes starting to open</p><p>And on the next count your eyes fully open </p><p>5</p><p>eyes fully open, feeling refreshed and recharged and being fully aware of being in the space</p><p>welcome back</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¡çœ  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ¡å‹è®¿è°ˆ(çºªå½•ç‰‡)åŸ¹è®­</title>
      <link href="/archives/c8ed5799.html"/>
      <url>/archives/c8ed5799.html</url>
      
        <content type="html"><![CDATA[<h1 id="æ ¡å‹è®¿è°ˆ-çºªå½•ç‰‡-åŸ¹è®­"><a href="#æ ¡å‹è®¿è°ˆ-çºªå½•ç‰‡-åŸ¹è®­" class="headerlink" title="æ ¡å‹è®¿è°ˆ(çºªå½•ç‰‡)åŸ¹è®­"></a>æ ¡å‹è®¿è°ˆ(çºªå½•ç‰‡)åŸ¹è®­</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><ol><li><p>è®¤è¯†çºªå½•ç‰‡å’Œå£è¿°å²</p><p>ä»€ä¹ˆæ˜¯çœŸå®ï¼Œä»€ä¹ˆæ˜¯å¥½çš„çºªå½•ç‰‡</p></li><li><p>æ²¡æœ‰ç»å¯¹çš„çœŸå®ï¼Œè®©æ•…äº‹æœ‰é€»è¾‘ï¼Œäººç‰©æœ‰å‘å±•ï¼Œè®©è§‚ä¼—æ„Ÿåˆ°çœŸå®ï¼Œæ˜¯ä¸€ä¸ªå¥½çš„çºªå½•ç‰‡çš„æ¡ä»¶</p></li></ol><h2 id="å‰æœŸè°ƒç ”"><a href="#å‰æœŸè°ƒç ”" class="headerlink" title="å‰æœŸè°ƒç ”"></a>å‰æœŸè°ƒç ”</h2><ol><li>ä¸ªäººç»´åº¦ï¼šç”Ÿå¹³ï¼Œè¡Œä¸šä¿¡æ¯ï¼Œçªå‡ºæˆå°±ï¼Œå®¶åº­æƒ…å†µ</li><li>å†å²ç»´åº¦ï¼šç»å†è¿‡å“ªäº›é‡å¤§çš„å†å²äº‹ä»¶ï¼Œä¸å…¶ä»–äººç‰©åœ¨å†å²ä¸Šçš„äº¤é›†</li><li>äº‹ä»¶å™è¿°ï¼šèµ·å› ï¼Œè¿‡ç¨‹ï¼Œç»“æœï¼Œå†å²æ„ä¹‰</li><li>æœ€ç»ˆå½¢æˆä¸€ä¸ªäººç‰©å°ä¼ </li></ol><h3 id="æ¡ˆä¾‹åˆ†äº«ã€Šå—å¤§åˆ›ä¸šè€…çš„æ—¶ä»£è„‰æã€‹"><a href="#æ¡ˆä¾‹åˆ†äº«ã€Šå—å¤§åˆ›ä¸šè€…çš„æ—¶ä»£è„‰æã€‹" class="headerlink" title="æ¡ˆä¾‹åˆ†äº«ã€Šå—å¤§åˆ›ä¸šè€…çš„æ—¶ä»£è„‰æã€‹"></a>æ¡ˆä¾‹åˆ†äº«ã€Šå—å¤§åˆ›ä¸šè€…çš„æ—¶ä»£è„‰æã€‹</h3><h2 id="æ•…äº‹æ’°å†™"><a href="#æ•…äº‹æ’°å†™" class="headerlink" title="æ•…äº‹æ’°å†™"></a>æ•…äº‹æ’°å†™</h2><ol><li>ä¸€å¥è¯æ¦‚æ‹¬ä½ çš„æ•…äº‹ logline</li><li>æ•…äº‹çš„ä»‹ç»ä¸ç»“æ„ï¼Œå…³äºå½±ç‰‡çš„æ•…äº‹ç»“æ„ï¼Œå¼€å¤´ã€è¿‡ç¨‹ã€ç»“å°¾ã€é‡è¦èŠ‚ç‚¹</li><li>äººç‰©çš„å¡‘é€ éœ€è¦æœ‰æˆé•¿ï¼Œæœ‰å¥—è·¯ï¼Œä»å¹³å‡¡åˆ°ä¸å¹³å‡¡çš„å¾ªç¯è¿‡ç¨‹</li></ol><h2 id="æ’°å†™é‡‡è®¿é—®é¢˜"><a href="#æ’°å†™é‡‡è®¿é—®é¢˜" class="headerlink" title="æ’°å†™é‡‡è®¿é—®é¢˜"></a>æ’°å†™é‡‡è®¿é—®é¢˜</h2><ol><li>æ’°å†™é—®é¢˜æŒ‰ç…§æ—¶é—´çº¿çš„é¡ºåºï¼Œå¸®åŠ©è¢«é‡‡è®¿äººå›å¿†</li><li>æœ‰å¿…é¡»å®Œæˆçš„å›ºå®šåŠ¨ä½œï¼šé‡è¦å†ç¨‹çš„å›é¡¾ï¼Œé‡è¦æ—¶é—´ç‚¹çš„è®²è¿°ï¼Œå…³äºä¸»é¢˜çš„å¿…ç„¶è”ç³»ï¼Œæ‰€æœ‰äººéƒ½å¸Œæœ›è¢«ç†è§£ã€è¢«å°Šé‡</li><li><p>å›ºå®šåŠ¨ä½œä¹‹å¤–çš„æƒŠå–œé—®é¢˜ï¼šæœ‰ä¸€äº›å°–é”æ·±åˆ»çš„è¯é¢˜ï¼Œåœ¨å¿ƒé‡Œæ‹Ÿå®šå¥½ï¼Œåœ¨ç°åœºæ‰¾ç‚¹åˆ‡å…¥</p></li><li><p>å¤šäººç‰©é‡‡è®¿æ—¶çš„é—®é¢˜æ€è·¯ï¼šé‡‡è®¿è€…ä¹‹é—´çš„å…±æ€§ã€ç‰¹æ€§é—®é¢˜ï¼Œä»¥åŠç›¸åº”çš„æƒŠå–œé—®é¢˜</p></li></ol><h2 id="ç¡®å®šè§†è§‰ä¸æ–‡å­—å±•ç°å½¢å¼"><a href="#ç¡®å®šè§†è§‰ä¸æ–‡å­—å±•ç°å½¢å¼" class="headerlink" title="ç¡®å®šè§†è§‰ä¸æ–‡å­—å±•ç°å½¢å¼"></a>ç¡®å®šè§†è§‰ä¸æ–‡å­—å±•ç°å½¢å¼</h2><ol><li>é˜è¿°å¼ï¼šæœ‰æ—ç™½ã€æœ‰é‡‡è®¿</li><li>è§‚å¯Ÿå¼ï¼šè§‚å¯Ÿäººç‰©</li><li>å‚ä¸å¼ï¼šç±»ä¼¼äº äº’åŠ¨vlog</li><li>æ‰®æ¼”å¼ï¼šæ‰¾æ¼”å‘˜æ‰®æ¼”</li><li>èµ„æ–™å¼ï¼šç”¨èµ„æ–™å’Œäººç‰©è¿˜åŸ</li><li>åŠ¨ç”»çºªå½•ç‰‡</li></ol><p>é˜è¿° + èµ„æ–™ä¸ºå¸¸è§ç»„åˆ</p><h2 id="ç°åœºæ‹æ‘„"><a href="#ç°åœºæ‹æ‘„" class="headerlink" title="ç°åœºæ‹æ‘„"></a>ç°åœºæ‹æ‘„</h2><p>æ‘„åƒæœºã€ä¸‰è„šæ¶ã€è¯ç­’ã€ç¯</p><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>å—è®¿è€…çŸ¥æ™“æ‹æ‘„å†…å®¹ã€ç”¨é€”ã€ç­¾æ–‡ä»¶</li><li>è°ƒæ•´ç¯å¢ƒï¼Œè®©å—è®¿è€…æ„Ÿåˆ°èˆ’é€‚ï¼Œä½†åŒæ—¶å¯èƒ½éœ€è¦ç‰ºç‰²ç”»è´¨</li><li>å¼€å§‹å‰å…ˆèŠèŠå®¶å¸¸ï¼ŒåŒæ—¶è°ƒæ•´å£°éŸ³å’Œæ„å›¾ï¼Œè°ƒæ•´ç”»é¢æ°´å¹³</li><li>é‡‡è®¿æ—¶ï¼Œä¸€å®šä¸è¦æ‰“æ–­å—è®¿è€…ï¼Œå§‹ç»ˆä¿æŒçœ¼ç¥äº¤æµï¼Œä¸è¦ä½¿ç”¨è¯­æ°”è¯â€œå—¯ï¼Œå•Šâ€ä¹‹ç±»çš„</li><li>éšå³è°ƒæ•´é‡‡è®¿çš„é¡ºåº</li></ol><h2 id="è·Ÿæ‹"><a href="#è·Ÿæ‹" class="headerlink" title="è·Ÿæ‹"></a>è·Ÿæ‹</h2><ol><li>é•œå¤´ç¨³å®š</li><li>é•œå¤´è¡¨ç°</li><li>ç´ æä¿ç®¡ï¼Œä¸€å®šè¦åŒå¤‡ä»½ï¼Œç”šè‡³ä¸‰å¤‡ä»½ï¼å› ä¸ºç´ ææ˜¯å¾ˆâ€œè´µâ€çš„ï¼Œä¸è¦ç”¨å‰ªåˆ‡ï¼</li><li>ä¿æŒâ€œè®°å½•æ„Ÿâ€ï¼Œè®©é•œå¤´æŒç»­å¼€æœºï¼Œæœ‰æ¯”æ²¡æœ‰å¼º</li></ol><h2 id="Transcription-amp-paper-cut"><a href="#Transcription-amp-paper-cut" class="headerlink" title="Transcription &amp; paper cut"></a>Transcription &amp; paper cut</h2><ol><li>å°†è§†é¢‘ä¸­çš„æ–‡å­—å¯¹è¯å¯¼å‡º</li><li>å®Œæˆå½±ç‰‡è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬æ˜¯å‰ªè¾‘çš„æ ¹æ®ä¸é€»è¾‘</li></ol><h2 id="å‰ªè¾‘ä¸åæœŸ"><a href="#å‰ªè¾‘ä¸åæœŸ" class="headerlink" title="å‰ªè¾‘ä¸åæœŸ"></a>å‰ªè¾‘ä¸åæœŸ</h2><ol><li>å‰ªè¾‘ä¸»è¦æ•…äº‹çº¿</li><li>å¢åŠ èµ„æ–™ã€ç´ æã€ç‰¹æ•ˆåŒ…è£…</li><li>å£°éŸ³åˆ¶ä½œã€è°ƒè‰²</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çºªå½•ç‰‡ </tag>
            
            <tag> åŸ¹è®­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Conda ç¬”è®°</title>
      <link href="/archives/c8895fc.html"/>
      <url>/archives/c8895fc.html</url>
      
        <content type="html"><![CDATA[<h1 id="Conda-Cheat-Sheet"><a href="#Conda-Cheat-Sheet" class="headerlink" title="Conda Cheat Sheet"></a>Conda Cheat Sheet</h1><p>è®°å½•ä¸€äº›å¸¸ç”¨çš„ conda å‘½ä»¤å¸®åŠ©å¿«é€Ÿç®¡ç†ç¯å¢ƒï¼Œæ•´ç†è‡ªå®˜æ–¹ <a href="https://docs.conda.io/projects/conda/en/4.6.0/_downloads/52a95608c49671267e40c689e0bc00ca/conda-cheatsheet.pdf">CONDA CHEAT SHEET</a></p><h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><h3 id="conda-info"><a href="#conda-info" class="headerlink" title="conda info"></a>conda info</h3><p>è¿™ä¸ªå‘½ä»¤éå¸¸ç®¡ç”¨ï¼ŒåŸºæœ¬ä¸Šèƒ½å¤Ÿçœ‹åˆ°æ‰€æœ‰çš„ conda é…ç½®ä¿¡æ¯</p><h3 id="conda-install"><a href="#conda-install" class="headerlink" title="conda install"></a>conda install</h3><p><code>conda install PACKAGENAME</code> ä¸‹è½½æŒ‡å®šåŒ…</p><h3 id="conda-update"><a href="#conda-update" class="headerlink" title="conda update"></a>conda update</h3><p><code>conda update PACKAGENAME</code> æ›´æ–°æŒ‡å®šåŒ… </p><h2 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h2><h3 id="conda-create-n"><a href="#conda-create-n" class="headerlink" title="conda create -n"></a>conda create -n</h3><p><code>conda create -n py36 python=3.6</code> åˆ›é€ ä¸€ä¸ª python 3.6 çš„ç¯å¢ƒ py36</p><p>æ³¨æ„ï¼šä¸€èˆ¬éƒ½è¦åŠ ä¸Š <code>python=x.x</code> å¦åˆ™ä½¿ç”¨çš„æ˜¯ base ç¯å¢ƒçš„ python è§£é‡Šå™¨</p><h3 id="conda-env-list"><a href="#conda-env-list" class="headerlink" title="conda env list"></a>conda env list</h3><p>åˆ—å‡ºç›®å‰æœ‰çš„ç¯å¢ƒ</p><h3 id="conda-env-remove"><a href="#conda-env-remove" class="headerlink" title="conda env remove"></a>conda env remove</h3><p><code>conda env remove -n env_name</code> ç§»é™¤ç¯å¢ƒ</p><h3 id="conda-activate-deactivate"><a href="#conda-activate-deactivate" class="headerlink" title="conda activate/deactivate"></a>conda activate/deactivate</h3><p><code>conda activate/deactivate env_name</code> æ¿€æ´»/é€€å‡ºç¯å¢ƒ</p><h2 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h2><h3 id="conda-install-1"><a href="#conda-install-1" class="headerlink" title="conda install"></a>conda install</h3><p><code>conda install PACKAGENAME</code> ä¸‹è½½åŒ…</p><p><code>conda install --file requirements.txt</code> é€šè¿‡ requirements æ–‡ä»¶ä¸‹è½½åŒ…</p><h3 id="conda-remove"><a href="#conda-remove" class="headerlink" title="conda remove"></a>conda remove</h3><p><code>conda remove PACKAGENAME</code> ç§»é™¤åŒ…</p><h3 id="conda-list"><a href="#conda-list" class="headerlink" title="conda list"></a>conda list</h3><p><code>conda list PACKAGENAME</code> æŸ¥çœ‹ç¯å¢ƒçš„æŸä¸ªåŒ…ï¼Œå¦‚æœä¸åŠ  PACKAGENAME åˆ™åˆ—å‡ºæ‰€æœ‰ç¯å¢ƒ</p><h3 id="conda-clean"><a href="#conda-clean" class="headerlink" title="conda clean"></a>conda clean</h3><p>å¦‚æœä¸æ¸…ç†çš„è¯ï¼Œanaconda è¿˜æ˜¯å¾ˆåƒå­˜å‚¨çš„ï¼Œä¼šé€æ¸ç§¯ç´¯å¾ˆå¤šä¸‹è½½åŒ…</p><p><code>conda clean --all</code>  Remove index cache, lock files, unused cache packages, and tarballs.</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="ç¦ç”¨è‡ªåŠ¨å¯åŠ¨-base-ç¯å¢ƒ"><a href="#ç¦ç”¨è‡ªåŠ¨å¯åŠ¨-base-ç¯å¢ƒ" class="headerlink" title="ç¦ç”¨è‡ªåŠ¨å¯åŠ¨ base ç¯å¢ƒ"></a>ç¦ç”¨è‡ªåŠ¨å¯åŠ¨ base ç¯å¢ƒ</h3><p>æ¯æ¬¡æ‰“å¼€æ–°çš„ shell éƒ½ä¼šè‡ªåŠ¨è¿›å…¥ base ç¯å¢ƒï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤è¡Œç¦ç”¨</p><p><code>conda config --set auto_activate_base false</code></p><h3 id="é•œåƒæºè®¾ç½®"><a href="#é•œåƒæºè®¾ç½®" class="headerlink" title="é•œåƒæºè®¾ç½®"></a>é•œåƒæºè®¾ç½®</h3><p>ç¼–è¾‘ <code>~/.condarc</code> æ–‡ä»¶ï¼Œè®¾ç½®é•œåƒæºï¼Œå¦‚æ²¡æœ‰è¯¥æ–‡ä»¶å¯ä½¿ç”¨ <code>conda config</code> åˆ›å»º</p><p><a href="https://mirror.nju.edu.cn/help/anaconda">å—äº¬å¤§å­¦é•œåƒæºå®˜æ–¹å¸®åŠ©æ–‡æ¡£</a></p><pre class="line-numbers language-.condarc" data-language=".condarc"><code class="language-.condarc">channels:  - defaultsshow_channel_urls: truedefault_channels:  - https://mirror.nju.edu.cn/anaconda/pkgs/main  - https://mirror.nju.edu.cn/anaconda/pkgs/r  - https://mirror.nju.edu.cn/anaconda/pkgs/msys2custom_channels:  conda-forge: https://mirror.nju.edu.cn/anaconda/cloud  msys2: https://mirror.nju.edu.cn/anaconda/cloud  bioconda: https://mirror.nju.edu.cn/anaconda/cloud  menpo: https://mirror.nju.edu.cn/anaconda/cloud  pytorch: https://mirror.nju.edu.cn/anaconda/cloud  simpleitk: https://mirror.nju.edu.cn/anaconda/cloud<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–é•œåƒæºï¼Œä¾‹å¦‚ï¼š<a href="https://mirrors.bfsu.edu.cn/help/anaconda/">åŒ—äº¬å¤–å›½è¯­å¤§å­¦é•œåƒæº</a> é€Ÿåº¦ä¹Ÿå¾ˆå¿«</p><p>åŒæ—¶ä¹Ÿæ›´æ–°ä¸€ä¸‹ pypi æº</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># å…ˆæ›´æ–° pip</span>pip <span class="token function">install</span> pip -U<span class="token comment"># Linux</span>pip <span class="token function">install</span> pip -U --user<span class="token comment"># Windows</span><span class="token comment"># è®¾ç½®é•œåƒ</span>pip config <span class="token builtin class-name">set</span> global.index-url https://mirror.nju.edu.cn/pypi/web/simple<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Conda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Manim æ•™ç¨‹</title>
      <link href="/archives/5654e2fe.html"/>
      <url>/archives/5654e2fe.html</url>
      
        <content type="html"><![CDATA[<h1 id="Manim-note"><a href="#Manim-note" class="headerlink" title="Manim note"></a>Manim note</h1><p>å®˜æ–¹ <a href="https://github.com/3b1b/manim">github é¡¹ç›®</a></p><blockquote><p>Note, there are two versions of manim. This repository began as a personal project by the author of <a href="https://www.3blue1brown.com/">3Blue1Brown</a> for the purpose of animating those videos, with video-specific code available <a href="https://github.com/3b1b/videos">here</a>. In 2020 a group of developers forked it into what is now the <a href="https://github.com/ManimCommunity/manim/">community edition</a>, with a goal of being more stable, better tested, quicker to respond to community contributions, and all around friendlier to get started with. See <a href="https://docs.manim.community/en/stable/installation/versions.html?highlight=OpenGL#which-version-to-use">this page</a> for more details.</p></blockquote><p>è¿™é‡Œæåˆ°æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„ manimï¼Œæ¨èä½¿ç”¨ community editionï¼Œè¿™ä¸ªç‰ˆæœ¬æ›´ç¨³å®šï¼Œæ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œä¸‹é¢æ˜¯ä¸¤ä¸ªå‚è€ƒé“¾æ¥</p><ol><li><p><a href="https://github.com/ManimCommunity/manim/">ManimCE github</a></p></li><li><p><a href="https://www.manim.community/">ManimCE documentation</a></p></li></ol><p>å¼ºçƒˆæ¨èæ ¹æ®å®˜æ–¹æ–‡æ¡£è¿›è¡Œå­¦ä¹ ï¼Œå› ä¸ºç½‘ä¸Šçš„å¾ˆå¤šèµ„æºéƒ½æ˜¯è¿‡æ—¶çš„ï¼ŒåŒ…æ‹¬æˆ‘è¿™ç¯‡ç¬”è®°ä¹Ÿä¼šå¯èƒ½ä¼šå¾ˆå¿«è¿‡æ—¶ã€‚è¿™ç¯‡ç¬”è®°ä¸»è¦è®°å½•å¦‚ä½•å®‰è£… ManimCEï¼Œä»¥åŠå…¶ä»£ç é€»è¾‘ï¼Œæ›´å¤šå®ç”¨çš„åŠ¨ç”»æ–¹æ³•å¦å¤–å†åšæ•´ç†</p><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><h3 id="Install-dependencies"><a href="#Install-dependencies" class="headerlink" title="Install dependencies"></a>Install dependencies</h3><p>å®˜æ–¹ç»™å‡ºäº†ä¸€ä¸ª<a href="https://hub.gke2.mybinder.org/user/behackl-725d956-b7bf9b4aef40b78-cns6ckcq/notebooks/basic%20example%20scenes.ipynb"> jupyter notebook</a> é¢„å…ˆè£…è½½å¥½äº† manim ç¯å¢ƒï¼Œå¦‚æœä½ ç°åœ¨ä¸æƒ³å®‰è£…çš„è¯ï¼Œå¯ä»¥åœ¨è¿™ä¸ª notebook é‡Œé¢è¿›è¡Œå°å®éªŒ</p><p>ManimCE éœ€è¦é¢„å…ˆä¸‹è½½ä¸¤ä¸ªè½¯ä»¶ ffmpeg å’Œ LaTexã€‚æ–‡æ¡£ä¸­å»ºè®®ä½¿ç”¨ Scoop, Chocolatey ç­‰åŒ…ç®¡ç†è½¯ä»¶æ¥ä¸‹è½½ dependenciesï¼Œä½†æˆ‘å¤ªæ‡’äº†ï¼Œä¸æƒ³å†ä¸‹ä¸€ä¸ªåŒ…ç®¡ç†è½¯ä»¶ï¼Œè€Œä¸”æˆ‘è‡ªå·±çš„ç”µè„‘ä¸Šæœ¬æ¥å°±å®‰è£…äº† LaTex å’Œ ffmpeg æ‰€ä»¥åªè¦ç¡®ä¿ ManimCE  èƒ½å¤Ÿè°ƒç”¨è¿™äº› dependencies å³å¯ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯è®© ffmpeg å’Œ LaTex å‘½ä»¤åŠ å…¥ç¯å¢ƒå˜é‡</p><p>ç»™ä¸¤ä¸ªå‚è€ƒé“¾æ¥ï¼š<a href="https://zhuanlan.zhihu.com/p/118362010">ffmpeg çŸ¥ä¹æ•™ç¨‹</a>  <a href="https://www.bilibili.com/video/BV11h41127FD?from=search&amp;seid=5330798070960440671">LaTexç®€ä»‹ bilibili</a></p><p>æœ€ååœ¨å‘½ä»¤è¡Œçª—å£è¾“å…¥ <code>ffmpeg -version</code> å’Œ  <code>tex -version</code> æ£€æŸ¥çœ‹çœ‹èƒ½å¦æˆåŠŸè¿è¡Œ</p><h3 id="Install-ManimCE"><a href="#Install-ManimCE" class="headerlink" title="Install ManimCE"></a>Install ManimCE</h3><blockquote><p>Manim Community runs on Python 3.7+. If youâ€™d like to just use the library, you can install it from PyPI via pip:</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pip <span class="token function">install</span> manim<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºä¹ æƒ¯äº†ç”¨ condaï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©åœ¨ conda ä¸­åˆ›å»ºä¸€ä¸ª Manim ç¯å¢ƒï¼Œç„¶åå† pip install</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">conda create -n manim <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.8</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(ç„¶è€Œæœ€ç»ˆå´ç¨€é‡Œç³Šæ¶‚çš„å®‰è£…åœ¨äº† base ç¯å¢ƒ)</p><p>ä½¿ç”¨ <code>conda list manim</code> æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼Œé€šè¿‡ <a href="https://docs.manim.community/en/stable/tutorials/quickstart.html">Quickstart</a> ç®€å•è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œæ£€æŸ¥æ•´ä¸ªæµç¨‹æ˜¯å¦èƒ½å¤Ÿè¿è¡Œ</p><h2 id="Tutorials"><a href="#Tutorials" class="headerlink" title="Tutorials"></a>Tutorials</h2><h3 id="Quickstart"><a href="#Quickstart" class="headerlink" title="Quickstart"></a>Quickstart</h3><p>ä¸‹é¢æ˜¯ä¸€æ®µç®€å•çš„ä»£ç ï¼Œèƒ½å¤Ÿå®ç°ä»çŸ©å½¢åˆ°åœ†å½¢çš„å˜æ¢</p><p><img src="/archives/5654e2fe/SquareToCircle_ManimCE_v0.8.0.gif" alt="SquareToCircle_ManimCE_v0.8.0" style="zoom: 25%;"></p><p>ä»£ç å¦‚ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># scene.py</span><span class="token keyword">from</span> manim <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">SquareToCircle</span><span class="token punctuation">(</span>Scene<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        circle <span class="token operator">=</span> Circle<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># create a circle</span>        circle<span class="token punctuation">.</span>set_fill<span class="token punctuation">(</span>PINK<span class="token punctuation">,</span> opacity<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>  <span class="token comment"># set color and transparency</span>        square <span class="token operator">=</span> Square<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># create a square</span>        square<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>PI <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># rotate a certain amount</span>        self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>Create<span class="token punctuation">(</span>square<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># animate the creation of the square</span>        self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>Transform<span class="token punctuation">(</span>square<span class="token punctuation">,</span> circle<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># interpolate the square into the circle</span>        self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>FadeOut<span class="token punctuation">(</span>square<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># fade out animation</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ terminal ä¸­æ‰§è¡Œæ–‡ä»¶</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">manim -pql scene.py SquareToCircle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»ä¸Šé¢çš„ä»£ç èƒ½å¤Ÿçœ‹å‡º Manim çš„ä¸€äº›åŸºæœ¬æ¡†æ¶ï¼Œé¦–å…ˆè¦æœ‰ class ç±»åˆ«ä½œä¸ºåœºæ™¯ Sceneï¼Œåœ¨è¿™ä¸ª class ä¸­å®šä¹‰ construct() å‡½æ•°æ¥å®ç°åŠ¨ç”»æ•ˆæœï¼Œç„¶åé€šè¿‡å‘½ä»¤è¡Œæ¸²æŸ“å‡ºåŠ¨ç”»ã€‚æ–‡æ¡£ä¸­æåˆ°çš„ Tip:</p><blockquote><p>Every animation must be contained within the <a href="https://docs.manim.community/en/stable/reference/manim.scene.scene.Scene.html#manim.scene.scene.Scene.construct"><code>construct()</code></a> method of a class that derives from <a href="https://docs.manim.community/en/stable/reference/manim.scene.scene.Scene.html#manim.scene.scene.Scene"><code>Scene</code></a>. Other code, for example auxiliary or mathematical functions, may reside outside the class.</p></blockquote><h3 id="A-deeper-look"><a href="#A-deeper-look" class="headerlink" title="A deeper look"></a>A deeper look</h3><p>ä¸»è¦æ¥åˆ†æä¸€ä¸‹ä¸Šé¢çš„å‘½ä»¤</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">manim -pql scene.py SquareToCircle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ–‡æ¡£ä¸­è§£é‡Š</p><blockquote><p>First, this command executes manim on the file <code>scene.py</code>, which contains our animation code. Further, this command tells manim exactly which <code>Scene</code> is to be rendered, in this case, it is <code>SquareToCircle</code>. This is necessary because a single scene file may contain more than one scene. Next, the flag -p tells manim to play the scene once itâ€™s rendered, and the -ql flag tells manim to render the scene in low quality.</p></blockquote><p>ä¸‹é¢æ˜¯å‡ ä¸ªå¸¸è§çš„å‚æ•°ï¼š</p><ol><li><code>-ql, -qm, -qh, -qk</code> åˆ†åˆ«ä»£è¡¨ä¸åŒåˆ†è¾¨ç‡ï¼Œä»ä½åˆ°é«˜ï¼Œå†åˆ°4k</li><li><code>-a</code> æ¸²æŸ“æ‰€æœ‰çš„ Scene</li><li><code>-i</code> è¾“å‡ºä¸º gif æ ¼å¼</li><li><code>-f</code> æ¸²æŸ“å®Œæˆåæ‰“å¼€æ‰€åœ¨æ–‡ä»¶å¤¹</li></ol><h3 id="Manimâ€™s-building-blocks"><a href="#Manimâ€™s-building-blocks" class="headerlink" title="Manimâ€™s building blocks"></a>Manimâ€™s building blocks</h3><p>Manim ä¸­æœ‰3ä¸ªé‡è¦æ¦‚å¿µ</p><ol><li><strong>mathematical object</strong> (or <strong>mobject</strong> for short)</li><li><strong>animation</strong></li><li><strong>scene</strong>.</li></ol><blockquote><p>As we will see in the following sections, each of these three concepts is implemented in manim as a separate class: the <a href="https://docs.manim.community/en/stable/reference/manim.mobject.mobject.Mobject.html#manim.mobject.mobject.Mobject"><code>Mobject</code></a>, <a href="https://docs.manim.community/en/stable/reference/manim.animation.animation.Animation.html#manim.animation.animation.Animation"><code>Animation</code></a>, and <a href="https://docs.manim.community/en/stable/reference/manim.scene.scene.Scene.html#manim.scene.scene.Scene"><code>Scene</code></a> classes.</p></blockquote><h4 id="Mobject"><a href="#Mobject" class="headerlink" title="Mobject"></a>Mobject</h4><blockquote><p>Any object that can be displayed on the screen is a <code>mobject</code>, even if it is not necessarily <em>mathematical</em> in nature.</p></blockquote><p>é€šè¿‡ scene ç±»ä¸­çš„æ–¹æ³• add(), remove() æ¥åœ¨åœºæ™¯ä¸­åŠ å…¥ mobject</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> manim <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">CreatingMobjects</span><span class="token punctuation">(</span>Scene<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        circle <span class="token operator">=</span> Circle<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>circle<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>circle<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äº mobject å±æ€§çš„è°ƒæ•´ï¼Œæ˜¯é€šè¿‡è°ƒ mobject ç±»çš„æ–¹æ³•æ¥å®Œæˆ</p><ol><li><p>Placing mobject location. é€‰æ‹©åœ¨å“ªé‡ŒåŠ å…¥ç‰©ä½“</p><p>.shift()  .move_to()  .next_to()  .align_to()</p></li><li><p>Styling mobjects. å¯¹ç‰©ä½“è¿›è¡Œé£æ ¼æ¸²æŸ“</p><p>.set_stroke()  .set_fill()</p></li><li><p>Mobject on-screen order. æ·»åŠ å…¥åœºæ™¯çš„ mobject æ˜¯æœ‰é¡ºåºçš„ï¼Œåæ·»åŠ çš„ç‰©ä½“ä¼šè¦†ç›–åˆ°å›¾å±‚çš„ä¸Šæ–¹</p></li></ol><h4 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h4><blockquote><p>At the heart of manim is animation. Generally, you can add an animation to your scene by calling the <code>play()</code> method.</p></blockquote><p>ä¸€èˆ¬æ¥è®²é€šè¿‡ play() æ–¹æ³•æ¥åŠ å…¥åŠ¨ç”»</p><blockquote><p>Animations are procedures that interpolate between two mobjects.</p></blockquote><p>åŠ¨ç”»çš„åŸºæœ¬åŸç†å¯ä»¥ç†è§£ä¸ºï¼Œä½¿ç”¨ä¸åŒçš„å‡½æ•°åœ¨ä¸¤ä¸ªå…³é”®å¸§ä¹‹é—´è¿›è¡Œæ’å€¼ï¼Œç„¶åä½¿ç”¨ play() æ–¹æ³•è¿›è¡Œæ’­æ”¾ï¼Œæ¯”å¦‚åœ¨ Quickstart ä¸­çš„åŠ¨ç”»</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>Create<span class="token punctuation">(</span>square<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># animate the creation of the square</span>self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>Transform<span class="token punctuation">(</span>square<span class="token punctuation">,</span> circle<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># interpolate the square into the circle</span>self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>FadeOut<span class="token punctuation">(</span>square<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># fade out animation</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åªè¦å¯å˜çš„å±æ€§ï¼Œéƒ½å¯ä»¥ä½¿ç”¨åŠ¨ç”»ï¼Œé€šè¿‡ <code>Mobject.aminate</code> å®ç°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> manim <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">ApplyMethodExample</span><span class="token punctuation">(</span>Scene<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        square <span class="token operator">=</span> Square<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_fill<span class="token punctuation">(</span>RED<span class="token punctuation">,</span> opacity<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>square<span class="token punctuation">)</span>        <span class="token comment"># animate the change of color</span>        self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>square<span class="token punctuation">.</span>animate<span class="token punctuation">.</span>set_fill<span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment"># animate the change of position</span>        self<span class="token punctuation">.</span>play<span class="token punctuation">(</span>square<span class="token punctuation">.</span>animate<span class="token punctuation">.</span>shift<span class="token punctuation">(</span>UP<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/archives/5654e2fe/ApplyMethodExample_ManimCE_v0.8.0.gif" alt="ApplyMethodExample_ManimCE_v0.8.0" style="zoom: 25%;"></p><h4 id="Scene"><a href="#Scene" class="headerlink" title="Scene"></a>Scene</h4><blockquote><p>The <a href="https://docs.manim.community/en/stable/reference/manim.scene.scene.Scene.html#manim.scene.scene.Scene"><code>Scene</code></a> class is the connective tissue of manim. </p></blockquote><p>æ‰€æœ‰çš„ mobject å’Œ animation éƒ½å¿…é¡»åŠ å…¥åˆ° scene ä¸­æ‰èƒ½è¢«å±•ç°å‡ºæ¥ï¼Œå¹¶ä¸” scene ä¸­å¿…é¡»åŒ…å« construct() æ–¹æ³•</p><h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><blockquote><p>Manim provides an extensive configuration system that allows it to adapt to many different use cases. There are many configuration options that can be configured at different times during the scene rendering process. </p></blockquote><p>åœ¨æ¸²æŸ“åŠ¨ç”»çš„è¿‡ç¨‹ä¸­è¿˜å¯ä»¥è®¾ç½®æ›´å¤šçš„å‚æ•°ï¼Œæ¯”å¦‚è§†é¢‘æ¸²æŸ“è´¨é‡çš„é«˜ä½ <code>-ql, -qh</code></p><p>èƒ½å¤Ÿè®¾ç½® Configuration çš„æ–¹æ³•æœ‰å‡ ç§</p><ol><li><p>The ManimConfig class</p><blockquote><p>The most direct way of configuring manim is via the global <code>config</code> object, which is an instance of <a href="https://docs.manim.community/en/stable/reference/manim._config.utils.ManimConfig.html#manim._config.utils.ManimConfig"><code>ManimConfig</code></a>.</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> manim <span class="token keyword">import</span> <span class="token operator">*</span>config<span class="token punctuation">.</span>background_color <span class="token operator">=</span> WHITEconfig<span class="token punctuation">[</span><span class="token string">"background_color"</span><span class="token punctuation">]</span> <span class="token operator">=</span> WHITE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>Command-line arguments</p><blockquote><p>The following example specifies the output file name (with the <code>-o</code> flag), renders only the first ten animations (<code>-n</code> flag) with a white background (<code>-c</code> flag), and saves the animation as a .gif instead of as a .mp4 file (<code>-i</code> flag). It uses the default quality and does not try to open the file after it is rendered.</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">manim -o myscene -i -n <span class="token number">0,10</span> -c WHITE <span class="token operator">&lt;</span>file.py<span class="token operator">&gt;</span> SceneName<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>The config files</p><blockquote><p>Manim can also be configured using a configuration file. A configuration file is a file ending with the suffix <code>.cfg</code>. To use a configuration file when rendering your scene, you must create a file with name <code>manim.cfg</code> in the same directory as your scene code.</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>CLI<span class="token punctuation">]</span><span class="token comment"># my config file</span>output_file <span class="token operator">=</span> myscenesave_as_gif <span class="token operator">=</span> <span class="token boolean">True</span>background_color <span class="token operator">=</span> WHITE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h4 id="A-list-of-all-config-options"><a href="#A-list-of-all-config-options" class="headerlink" title="A list of all config options"></a>A list of all config options</h4><pre class="line-numbers language-config" data-language="config"><code class="language-config">     aspect_ratio              assets_dir        background_color       background_opacity           bottom          custom_folders         disable_caching                 dry_run  ffmpeg_loglevel             flush_cache            frame_height              frame_rate       frame_size             frame_width          frame_x_radius          frame_y_radiusfrom_animation_number          fullscreen              images_dir              input_file        left_side                 log_dir             log_to_file        max_files_cached        media_dir             media_width       movie_file_extension    notify_outdated_version      output_file       partial_movie_dir            pixel_height             pixel_width          plugins                 preview            progress_bar                 quality       right_side             save_as_gif         save_last_frame               save_pngs      scene_names       show_in_file_browser                sound                 tex_dir     tex_template       tex_template_file                text_dir                     top      transparent       upto_animation_number   use_opengl_renderer     use_webgl_renderer        verbosity               video_dir       webgl_renderer_path       window_position   window_monitor             window_size               write_all          write_to_movie<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Using-Text"><a href="#Using-Text" class="headerlink" title="Using Text"></a>Using Text</h3><p>There are two different ways by which you can render <strong>Text</strong> in videos:</p><ol><li>Using Pango (<a href="https://docs.manim.community/en/stable/reference/manim.mobject.svg.text_mobject.html#module-manim.mobject.svg.text_mobject"><code>text_mobject</code></a>)</li><li>Using LaTeX (<a href="https://docs.manim.community/en/stable/reference/manim.mobject.svg.tex_mobject.html#module-manim.mobject.svg.tex_mobject"><code>tex_mobject</code></a>)</li></ol><p>ä¸€èˆ¬å¦‚æœä¸ç”¨å…¬å¼çš„è¯ï¼Œç›´æ¥ä½¿ç”¨ text_mobject å°±å¯ä»¥äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> manim <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">HelloWorld</span><span class="token punctuation">(</span>Scene<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        text <span class="token operator">=</span> Text<span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>scale<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/archives/5654e2fe/image-20210729160507790.png" style="zoom:25%;"></p><p>ä½¿ç”¨ tex_mobject çš„è¯ï¼Œå¦‚ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> manim <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">HelloLaTeX</span><span class="token punctuation">(</span>Scene<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        tex <span class="token operator">=</span> Tex<span class="token punctuation">(</span><span class="token string">r"\LaTeX"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>scale<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>tex<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/archives/5654e2fe/image-20210729160532548.png" style="zoom: 33%;"></p><p>æ³¨æ„éœ€è¦ä½¿ç”¨ raw string <code>r('...')</code> å› ä¸º Latex ä¸­å¾ˆå¤šç‰¹æ®Šå­—ç¬¦éœ€è¦è¿›è¡Œè½¬ä¹‰</p><p>è¿˜æœ‰ä¸åŒçš„æ–¹æ³•éƒ½èƒ½è¿”å› text_mobject &amp; tex_mobjectï¼Œæ¯”å¦‚ MarkupText, MathTex </p><p>è¿™ç¯‡ç¬”è®°å°±åˆ°è¿™é‡Œäº†ï¼Œè¿˜æœ‰å¥½å¤šå¥½ç©çš„åŠŸèƒ½å°±è¯·è‡ªè¡Œæ¢ç´¢å§ ğŸ˜</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Python </category>
          
          <category> Manim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Manim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Faster RCNN</title>
      <link href="/archives/2ad8fafc.html"/>
      <url>/archives/2ad8fafc.html</url>
      
        <content type="html"><![CDATA[<h1 id="Faster-RCNN-note"><a href="#Faster-RCNN-note" class="headerlink" title="Faster RCNN note"></a>Faster RCNN note</h1><p>æœ¬æ–‡æ€»ç»“è‡ªçŸ¥ä¹é“¾æ¥<a href="https://zhuanlan.zhihu.com/p/31426458">https://zhuanlan.zhihu.com/p/31426458</a></p><h2 id="æ•´ä½“æ€è·¯"><a href="#æ•´ä½“æ€è·¯" class="headerlink" title="æ•´ä½“æ€è·¯"></a>æ•´ä½“æ€è·¯</h2><p>Faster RCNNå…¶å®å¯ä»¥åˆ†ä¸º4ä¸ªä¸»è¦å†…å®¹ï¼š</p><ol><li><p>Conv layers </p><p>Faster RCNNé¦–å…ˆä½¿ç”¨ä¸€ç»„åŸºç¡€çš„conv+relu+poolingå±‚æå–imageçš„feature mapsã€‚è¯¥feature mapsè¢«å…±äº«ç”¨äºåç»­RPNå±‚å’Œå…¨è¿æ¥å±‚ã€‚</p></li><li><p>Region Proposal Networks</p><p>è¯¥å±‚é€šè¿‡softmaxåˆ¤æ–­anchorså±äºpositiveæˆ–è€…negativeï¼Œå†åˆ©ç”¨bounding box regressionä¿®æ­£anchorsè·å¾—ç²¾ç¡®çš„proposalsã€‚</p></li><li><p>Roi Pooling</p><p>è¯¥å±‚æ”¶é›†è¾“å…¥çš„feature mapså’Œproposalsï¼Œç»¼åˆè¿™äº›ä¿¡æ¯åæå–proposal feature mapsï¼Œé€å…¥åç»­å…¨è¿æ¥å±‚åˆ¤å®šç›®æ ‡ç±»åˆ«ã€‚</p></li><li><p>Classification</p><p>åˆ©ç”¨proposal feature mapsè®¡ç®—proposalçš„ç±»åˆ«ï¼ŒåŒæ—¶å†æ¬¡bounding box regressionè·å¾—æ£€æµ‹æ¡†æœ€ç»ˆçš„ç²¾ç¡®ä½ç½®ã€‚</p></li></ol><p><img src="/archives/2ad8fafc/image-20210614151135341.png" style="zoom: 67%;"></p><h2 id="Conv-Layers"><a href="#Conv-Layers" class="headerlink" title="Conv Layers"></a>Conv Layers</h2><p>Conv layerséƒ¨åˆ†å…±æœ‰13ä¸ªconvå±‚ï¼Œ13ä¸ªreluå±‚ï¼Œ4ä¸ªpoolingå±‚ </p><ol><li>æ‰€æœ‰çš„convå±‚éƒ½æ˜¯ï¼škernel_size=3ï¼Œpad=1ï¼Œstride=1</li><li>æ‰€æœ‰çš„poolingå±‚éƒ½æ˜¯ï¼škernel_size=2ï¼Œpad=0ï¼Œstride=2</li></ol><p>é‚£ä¹ˆï¼Œä¸€ä¸ªMxNå¤§å°çš„çŸ©é˜µç»è¿‡Conv layerså›ºå®šå˜ä¸º(M/16)x(N/16)</p><h2 id="Region-Proposal-Networks"><a href="#Region-Proposal-Networks" class="headerlink" title="Region Proposal Networks"></a>Region Proposal Networks</h2><h3 id="Anchors"><a href="#Anchors" class="headerlink" title="Anchors"></a>Anchors</h3><p>æåˆ°RPNç½‘ç»œï¼Œå°±ä¸èƒ½ä¸è¯´anchorsã€‚æ‰€è°“anchorsï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ç»„ç”±ç¨‹åºç”Ÿæˆçš„çŸ©å½¢ã€‚ç›´æ¥è¿è¡Œä½œè€…demoä¸­çš„generate_anchors.pyå¯ä»¥å¾—åˆ°ä»¥ä¸‹è¾“å‡º (ä¸è¦è¢«è¿™äº›æ•°å­—å“åˆ°äº†ï¼Œæ²¡æœ‰å…·ä½“æ„ä¹‰)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">-</span><span class="token number">84</span><span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">.</span>   <span class="token number">99</span><span class="token punctuation">.</span>   <span class="token number">55</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">176</span><span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token number">88</span><span class="token punctuation">.</span>  <span class="token number">191</span><span class="token punctuation">.</span>  <span class="token number">103</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">184</span><span class="token punctuation">.</span>  <span class="token number">375</span><span class="token punctuation">.</span>  <span class="token number">199</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span><span class="token number">56</span><span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token number">56</span><span class="token punctuation">.</span>   <span class="token number">71</span><span class="token punctuation">.</span>   <span class="token number">71</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">120</span><span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">120</span><span class="token punctuation">.</span>  <span class="token number">135</span><span class="token punctuation">.</span>  <span class="token number">135</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">248</span><span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">248</span><span class="token punctuation">.</span>  <span class="token number">263</span><span class="token punctuation">.</span>  <span class="token number">263</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span><span class="token number">36</span><span class="token punctuation">.</span>  <span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">.</span>   <span class="token number">51</span><span class="token punctuation">.</span>   <span class="token number">95</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span><span class="token number">80</span><span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">168</span><span class="token punctuation">.</span>   <span class="token number">95</span><span class="token punctuation">.</span>  <span class="token number">183</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">168</span><span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">344</span><span class="token punctuation">.</span>  <span class="token number">183</span><span class="token punctuation">.</span>  <span class="token number">359</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¯è¡Œæœ‰4ä¸ªå€¼ï¼Œä»£è¡¨äº†çŸ©å½¢å·¦ä¸Šè§’å’Œå³ä¸‹è§’ä¸¤ä¸ªç‚¹$(x_1, y_1, x_2, y_2)$ </p><p>ä¸€å…±9ä¸ªçŸ©å½¢ï¼Œæ¥ç»„äºä¸åŒé•¿å®½æ¯”å’Œä¸åŒå¤§å°çš„ç»„åˆï¼šé•¿å®½æ¯”æœ‰3ç§ï¼Œ1:1, 1:2, 2:1</p><p><img src="/archives/2ad8fafc/image-20210614152512944.png" style="zoom:50%;"></p><p>é‚£ä¹ˆè¿™9ä¸ªanchorsæ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿå€Ÿç”¨Faster RCNNè®ºæ–‡ä¸­çš„åŸå›¾ï¼Œå¦‚å›¾7ï¼Œéå†Conv layersè®¡ç®—è·å¾—çš„feature mapsï¼Œä¸ºæ¯ä¸€ä¸ªç‚¹éƒ½é…å¤‡è¿™9ç§anchorsä½œä¸ºåˆå§‹çš„æ£€æµ‹æ¡†</p><p><img src="/archives/2ad8fafc/v2-c93db71cc8f4f4fd8cfb4ef2e2cef4f4_720w.jpg" style="zoom:80%;"></p><p>ç®€å•è§£é‡Šä¸€ä¸‹ä¸Šå›¾ï¼š</p><ol><li><p>conv feature mapä¸­ï¼Œæ¯ä¸€ä¸ªç‚¹éƒ½æ˜¯256-dimensions</p></li><li><p>intermidiate layerä¸º 3x3 å·ç§¯ï¼Œout put dimensionä¸º256ï¼Œå¾—åˆ°æ–°çš„conv feature map</p></li><li><p>åœ¨æ–°çš„conv feature mapä¸Šï¼Œæˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªç‚¹é¢„å…ˆè®¾å®šçš„kä¸ªanchoråšbounding box regressionå’Œsoftmaxåˆ†ç±»(positive, nagetiveä¸¤ç±»)ï¼Œåˆ†åˆ«å¯¹åº”4k coordinatesï¼Œ2k scores</p><p>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æŠŠæŸä¸€anchoråŒºåŸŸä¸­çš„ç‰¹å¾å‘é‡æ‹¿å»åšpredictionï¼Œé¢„æµ‹å†…å®¹ä¸ºè¯¥ç‚¹çš„åˆ†ç±»å’Œè¯¥ç‚¹/anchorå¯¹åº”çš„bounding boxå‚æ•°</p></li><li><p>ç”±äºanchoræ•°é‡æ˜¯å·¨å¤§çš„ï¼Œè®­ç»ƒç¨‹åºä¼šåœ¨åˆé€‚çš„anchorsä¸­<strong>éšæœº</strong>é€‰å–128ä¸ªpostive anchors+128ä¸ªnegative anchorsè¿›è¡Œè®­ç»ƒ</p></li></ol><h3 id="Bounding-box-regressionåŸç†"><a href="#Bounding-box-regressionåŸç†" class="headerlink" title="Bounding box regressionåŸç†"></a>Bounding box regressionåŸç†</h3><p>æ€æ ·åœ¨anchorçš„åŸºç¡€ä¸Šå›å½’å¾—åˆ°ground truthæ ‡ç­¾å‘¢ï¼Ÿ</p><p>ç»™å®šanchor $(A_x, A_y, A_w, A_h)$ ï¼Œç»™å®šground truth $(G_x, G_y, G_w, G_h)$</p><p>æˆ‘ä»¬åªè¦å»é¢„æµ‹ä¸­å¿ƒç‚¹çš„ä½ç½®åç§»ï¼Œä»¥åŠçŸ©å½¢é•¿å®½çš„ç¼©æ”¾å³å¯</p><p>ä¸ªäººè§‰å¾—è¿™æ ·çš„å›å½’æ–¹æ³•æœ‰ç‚¹éº»çƒ¦ï¼Œè¿™æ ·æ¥çœ‹CenterNetä¸­çš„bounding boxå›å½’æ˜¯ç›¸å½“ç›´æ¥çš„</p><h3 id="Proposal"><a href="#Proposal" class="headerlink" title="Proposal"></a>Proposal</h3><ol><li>ç”Ÿæˆanchorsï¼Œå¾—åˆ°å¯¹åº”çš„confidence score &amp; bounding box regressionï¼Œå½¢æˆæœ€åˆçš„proposal</li><li>å¯¹æ‰€æœ‰anchorsï¼Œæ ¹æ®positive scoreè¿›è¡Œæ’åºï¼Œå–å‰6000ä¸ªanchor proposals</li><li>å»é™¤è¾ƒå°å’Œè¶…å‡ºè¾¹ç•Œçš„proposal</li><li>NMS</li></ol><h2 id="ROI-Pooling"><a href="#ROI-Pooling" class="headerlink" title="ROI Pooling"></a>ROI Pooling</h2><p>Rol poolingå±‚æœ‰2ä¸ªè¾“å…¥ï¼š</p><ol><li>åŸå§‹feature maps</li><li>RPNè¾“å‡ºçš„proposals</li></ol><p>è¿™ä¸€ä¸ªPoolingæ“ä½œè¿˜è¦æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯éœ€è¦å¤„ç†ä¸åŒå¤§å°çš„proposal (kernel)ã€‚ç»å…¸çš„pooingæ“ä½œæ˜¯ä½¿ç”¨ç›¸åŒå¤§å°çš„kernelï¼Œè¿™é‡Œæˆ‘ä»¬è¦é¢„å…ˆå¯¹ proposal (region of interest) è¿›è¡Œç»Ÿä¸€çš„åˆ†å‰²ï¼Œä½¿å¾—poolingç»“æœæ˜¯ç›¸åŒçš„è¡¨ç¤º(å¦‚ä¸‹å›¾)</p><p><img src="/archives/2ad8fafc/image-20210614164103022.png" style="zoom: 67%;"></p><h2 id="Classification"><a href="#Classification" class="headerlink" title="Classification"></a>Classification</h2><p>Classificationéƒ¨åˆ†åˆ©ç”¨å·²ç»è·å¾—çš„proposal feature mapsï¼Œé€šè¿‡full connectå±‚ä¸softmaxè®¡ç®—æ¯ä¸ªproposalå…·ä½“å±äºé‚£ä¸ªç±»åˆ«ï¼ˆå¦‚äººï¼Œè½¦ï¼Œç”µè§†ç­‰ï¼‰ï¼Œè¾“å‡ºcls_probæ¦‚ç‡å‘é‡ï¼›åŒæ—¶å†æ¬¡åˆ©ç”¨bounding box regressionè·å¾—æ¯ä¸ªproposalçš„ä½ç½®åç§»é‡bbox_predï¼Œç”¨äºå›å½’æ›´åŠ ç²¾ç¡®çš„ç›®æ ‡æ£€æµ‹æ¡†</p><p><img src="/archives/2ad8fafc/image-20210614164211554.png" style="zoom:80%;"></p><h2 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h2><p>Faster R-CNNçš„è®­ç»ƒï¼Œæ˜¯åœ¨å·²ç»è®­ç»ƒå¥½çš„modelï¼ˆå¦‚VGGï¼ŒZFï¼‰çš„åŸºç¡€ä¸Šç»§ç»­è¿›è¡Œè®­ç»ƒï¼Œå®é™…è®­ç»ƒè¿‡ç¨‹ä¸ºä»¥ä¸‹ï¼š</p><ol><li>åœ¨å·²ç»è®­ç»ƒå¥½çš„model(e.g. VGG)ï¼Œè®­ç»ƒRPN</li><li>ç”¨æ­¥éª¤1ä¸­å¾—åˆ°çš„RPNæå‡ºproposal</li><li>ç”¨æå‡ºçš„Proposalè®­ç»ƒFast RCNN</li><li>ç”¨æ­¥éª¤4ä¸­è®­ç»ƒå¥½çš„Fast RCNNç»§ç»­è®­ç»ƒRPN</li><li>é‡å¤2</li><li>é‡å¤3</li></ol><p>å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ç§ç±»ä¼¼è¿­ä»£çš„è¿‡ç¨‹ï¼Œä½†åªå¾ªç¯äº†2æ¬¡ï¼Œæ–‡ç« æå‡ºæ›´å¤šçš„å¾ªç¯å¹¶ä¸ä¼šå¸¦æ¥ç›¸åº”çš„æå‡</p>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Faster RCNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VSCode æ•™ç¨‹</title>
      <link href="/archives/ca50f614.html"/>
      <url>/archives/ca50f614.html</url>
      
        <content type="html"><![CDATA[<h1 id="VSCode-note"><a href="#VSCode-note" class="headerlink" title="VSCode note"></a>VSCode note</h1><p>å­¦ä¹ è§†é¢‘ <a href="https://www.bilibili.com/video/BV1ty4y1S7mC?p=1">bilibili</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ç›´æ¥åœ¨å®˜ç½‘ä¸€é”®ä¸‹è½½ï¼Œå®‡å®™ç¬¬ä¸€å¼€å‘å·¥å…·ï¼Œè€Œä¸”è¿˜æ˜¯å…è´¹çš„<span class="github-emoji"><span>ğŸ˜†</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ vscodeï¼Œæœ‰æ—¶å‡ºç°ä¸€äº›è«åå…¶å¦™çš„ bug<span class="github-emoji"><span>ğŸ˜¢</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f622.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>ï¼Œå¯ä»¥ä½¿ç”¨å‰å‡ ä¸ªç‰ˆæœ¬çš„ï¼Œå¦‚æœç”¨ç†Ÿäº†æŸä¸€ä¸ªç‰ˆæœ¬é‚£æš‚æ—¶ä¸è¦æ›´æ–°äº†å§ã€‚å¦‚æœæƒ³è¦å®Œæ•´å¸è½½çš„è¯éœ€è¦åˆ é™¤ <code>usr/.vscode</code> å’Œ <code>AppData/Code</code> æ–‡ä»¶ï¼Œæ„Ÿè§‰æ•´ä½“æ¥çœ‹ vscode ä¾ç„¶æ˜¯åœ¨å‘å±•å½“ä¸­çš„å¼€å‘å·¥å…·</p><h3 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h3><ol><li><p>vscode æ”¯æŒæ›´æ¢ä¸»é¢˜çš®è‚¤</p></li><li><p>vscode æ”¯æŒæ’ä»¶æ‰©å±•ï¼Œèƒ½å¤Ÿå®ç°å¤šç§åŠŸèƒ½æ¥æé«˜ç¼–ç¨‹æ•ˆç‡ï¼Œå¦‚ä¸‹è½½ä¸åŒè¯­è¨€ï¼Œé«˜äº®ä»£ç ç­‰ç­‰ï¼Œæ¨èçš„æ’ä»¶ï¼šPython, Gitlens, Remote SSH</p></li><li><p>é€šè¿‡å¿«æ·é”® palette æŸ¥æ‰¾æ–‡ä»¶ Ctrl + Pï¼ŒæŸ¥æ‰¾å‘½ä»¤ Ctrl + Shift + Pï¼ŒæŠ˜å å·¦ä¾§å·¥å…·æ  Ctrl + B</p><p>å¯ä»¥ä¿®æ”¹ä¸€äº›ä½ å¸¸ç”¨å‘½ä»¤çš„å¿«æ·é”®ï¼Œæˆ‘ä¿®æ”¹äº†å¦‚ä¸‹å‘½ä»¤ï¼š</p><ol><li>Run in python file: Ctrl + enter</li><li>Start debugging: Shift +enter</li><li>Close panels: Ctrl + Alt + P</li><li>Insert Line Above/Below: Ctrl + Shifg + \ or Enter</li><li>Collapse folders: Ctrl + Shift + F</li></ol></li><li><p>è®¾ç½®é¢æ¿å¿«æ·é”® Ctrl + ,</p></li><li><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶ Ctrl + N</p></li></ol><h2 id="äº¤äº’å¼æ¼”ç»ƒåœº-Interactive-Playground"><a href="#äº¤äº’å¼æ¼”ç»ƒåœº-Interactive-Playground" class="headerlink" title="äº¤äº’å¼æ¼”ç»ƒåœº Interactive Playground"></a>äº¤äº’å¼æ¼”ç»ƒåœº Interactive Playground</h2><p>ä¸€äº›ç¼–è¾‘çš„å°æŠ€å·§</p><ol><li><p>åŒæ—¶é€‰ä¸­åŒåå­—æ®µ Ctrl + Shift + Lï¼Œä½†è¿™ä¸ªåŠŸèƒ½æ²¡æœ‰ Refactoring æ™ºèƒ½</p></li><li><p>IntelliSense è‡ªåŠ¨è¡¥å…¨ api åŠŸèƒ½ Ctrl + space</p></li><li><p>è¡Œæ“ä½œ</p><ol><li>å¤åˆ¶è¡Œï¼Œåœ¨æ²¡æœ‰ä»»ä½•ä¸œè¥¿é€‰ä¸­çš„æ—¶å€™ç›´æ¥ Ctrl + C</li><li>ä¸Šä¸‹ç§»åŠ¨è¡Œï¼ŒAlt + ä¸Šä¸‹é”®</li><li>åˆ é™¤è¡Œ Ctrl + Shift + K</li></ol></li><li><p>Formatting è§„èŒƒä»£ç ï¼Œéœ€è¦è‡ªå·±å®šä¹‰ format</p></li></ol><h2 id="ä¸€äº›æ¨èçš„è®¾ç½®"><a href="#ä¸€äº›æ¨èçš„è®¾ç½®" class="headerlink" title="ä¸€äº›æ¨èçš„è®¾ç½®"></a>ä¸€äº›æ¨èçš„è®¾ç½®</h2><p>æ‰“å¼€ settings</p><ol><li>åœ¨ç†Ÿæ‚‰ä¹‹åå…³é—­ welcome/startup ç•Œé¢</li><li>å»ºè®®ä½¿ç”¨è‹±æ–‡ç•Œé¢</li><li>è®¾ç½®å­—ä½“ JetBrains Monoï¼Œè¿˜å¯ä»¥é¡ºä¾¿è®¾ç½®ä¸€ä¸‹å­—å·ã€‚å®‰è£…å­—ä½“<a href="https://blog.csdn.net/HUSTHY/article/details/104023077">æ•™ç¨‹</a></li><li>è®¾ç½®æ˜¯å¦æ˜¾ç¤ºç¼©ç•¥å›¾ minimap</li><li><p>è®¾ç½® restore windows æ˜¯å¦ç›´æ¥æ¢å¤ä¸Šä¸€æ¬¡çš„é¡¹ç›®</p></li><li><p>è®¾ç½®å¼€å¯ Trims final newlines è‡ªåŠ¨æ¶ˆé™¤æ–‡ä»¶æœ«å°¾å¤šä½™çš„ç©ºè¡Œ</p></li></ol><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><p>ä¸‹è½½ Python æ’ä»¶</p><h3 id="Get-Started"><a href="#Get-Started" class="headerlink" title="Get Started"></a>Get Started</h3><ol><li><p>åœ¨åº•éƒ¨çš„ status bar æ·»åŠ  python è§£é‡Šå™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ palette æ¥æ·»åŠ  interpreterã€‚ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°ç”µè„‘ä¸Šçš„ python interpreter (åŒ…æ‹¬ anaconda ä¸­åˆ›å»ºçš„ç¯å¢ƒ)</p></li><li><p>å»ºç«‹ debug ç¯å¢ƒ craete a launch.json fileï¼Œç›´æ¥ä½¿ç”¨é»˜è®¤å€¼å°±å¥½ï¼Œè¯¦ç»†è¯´æ˜åœ¨ <a href="https://zhuanlan.zhihu.com/p/142642410">çŸ¥ä¹</a></p><p>è¡¥å……ï¼šé»˜è®¤é…ç½®åª debug å½“å‰ folder ä¸‹çš„ä»£ç ï¼ˆâ€œè‡ªå·±â€çš„ä»£ç ï¼‰ï¼Œå¦‚æœæ˜¯ pip/conda install å®‰è£…çš„ä»£ç ï¼ˆâ€œåˆ«äººâ€çš„ä»£ç ï¼‰ï¼Œæ˜¯ä¸ä¼šè¿›è¡Œ debug çš„ã€‚å¦‚æœæƒ³è¦ debug æ‰€æœ‰ä»£ç åˆ™é…ç½®æ–‡ä»¶éœ€è¦åŠ ä¸Š <code>"justMyCode": false</code> <a href="https://blog.csdn.net/g534441921/article/details/102743393">CSDN</a></p><p>è¡¥å……ï¼šå¯¹äºéœ€è¦ä¼ å‚æ•°çš„ python è„šæœ¬è°ƒè¯•å¯ä»¥å‚è€ƒ <a href="https://www.zhihu.com/question/50700473">çŸ¥ä¹</a></p></li><li><p>Jupyter notebook æ˜¯æ’ä»¶é‡Œè‡ªå¸¦çš„åŠŸèƒ½ï¼Œç›´æ¥æ‰“å¼€ ipynb æ–‡ä»¶å°±å¯ä»¥è¿è¡Œä»£ç å—ï¼é€šè¿‡é€‰æ‹© notebook ä¸­çš„ kernel (å…·ä½“ä¸€ç‚¹è¯´å°±æ˜¯é€‰æ‹© conda ä¸­çš„ç¯å¢ƒ) å°±èƒ½åœ¨ä½ æƒ³è¦çš„ç¯å¢ƒä¸­è¿è¡Œäº†ï¼Œéå¸¸æ–¹ä¾¿</p></li></ol><h3 id="è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨"><a href="#è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨"></a>è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨</h3><p>ç”±äºè¦è·‘ä¸€äº›æ¨¡å‹ï¼Œè‡ªå·±çš„ç”µè„‘æ˜¾å¡æ ¹æœ¬è·‘ä¸åŠ¨ï¼Œé‚£å°±<del>ç™½å«–</del>è¿æ¥åˆ°å®éªŒå®¤çš„æœåŠ¡å™¨â€‹</p><p>é€šè¿‡ vscode Extensions: <code>Remote-SSH</code> å®Œæˆï¼Œ<a href="https://zhuanlan.zhihu.com/p/141205262">çŸ¥ä¹</a></p><p>åœ¨ Remote Expolorer -&gt; SSH TARGETS -&gt; config ä¸­æ·»åŠ é…ç½®</p><pre class="line-numbers language-config" data-language="config"><code class="language-config"># Read more about SSH config files: https://linux.die.net/man/5/ssh_configHost random_name    HostName host_ip    User user_name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>é‡åˆ°äº†æŠ¥é”™ <code>Resolver error: Error: Running the contributed command: '_workbench.downloadResource' failed.</code> æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ã€‚åŸå› å¯èƒ½åœ¨äºæœåŠ¡å™¨æ˜¯åœ¨å†…ç½‘ï¼Œæ²¡æœ‰åŠæ³•åœ¨æœåŠ¡å™¨ä¸Šè‡ªåŠ¨ä¸‹è½½å¥½ vscode-serverï¼Œäºæ˜¯åªèƒ½æœ¬åœ°ä¸‹è½½ï¼Œç„¶åä¸Šä¼ </p><p>å‚è€ƒ <a href="https://blog.csdn.net/ibless/article/details/118610776">CSDN</a> è§£å†³é—®é¢˜</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> VSCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CenterPoint å¤ç°ç¬”è®°</title>
      <link href="/archives/ba7995ee.html"/>
      <url>/archives/ba7995ee.html</url>
      
        <content type="html"><![CDATA[<h1 id="CenterPoint-å¤ç°ç¬”è®°"><a href="#CenterPoint-å¤ç°ç¬”è®°" class="headerlink" title="CenterPoint å¤ç°ç¬”è®°"></a>CenterPoint å¤ç°ç¬”è®°</h1><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><ol><li><p>pytorchä¸‹è½½å¦‚æœå¾ˆæ…¢ï¼Œè¯·é‡‡ç”¨é•œåƒï¼</p></li><li><p>ä¸‹è½½cmakeä½¿ç”¨aptï¼Œä½†è¦æ›´æ–°ä¸‹è½½æºä¸ºé˜¿é‡Œäº‘ï¼Œè¿™æ ·ç‰ˆæœ¬æ‰å¤Ÿæ–°</p></li><li><p>å®‰è£…spconvæ—¶æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">The following packages have unmet dependencies: gsettings-desktop-schemas <span class="token builtin class-name">:</span> Breaks: mutter <span class="token punctuation">(</span><span class="token operator">&lt;</span> <span class="token number">3.31</span>.4<span class="token punctuation">)</span> but <span class="token number">3.28</span>.4+git20200505-0ubuntu18.04.2 is to be installedE: Error, pkgProblemResolver::Resolve generated breaks, this may be caused by held packages.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç½‘ç»œä¸Šä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨aptitude</p><pre class="line-numbers language-SHell" data-language="SHell"><code class="language-SHell"># download aptitudesudo apt install aptitudesudo aptitude install &lt;packagename&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¡€æ³ªæ•™è®­ï¼Œä¸è¦è½»æ˜“ä½¿ç”¨aptitudeï¼Œç³»ç»Ÿå¾ˆå¤šä¸œè¥¿éƒ½è¢«æ”¹å†™äº†ï¼Œç»è¿‡ä¸€ç•ªæŠ˜è…¾å‡çº§åˆ°äº†ubuntu 20.04ï¼Œä¹Ÿä¸çŸ¥é“ä¹‹å‰å®‰è£…çš„ä¸œè¥¿æœ‰æ²¡æœ‰è¢«åŠ¨</p><p>å°è±¡ä¸­æåˆ°â€held packagesâ€ï¼Œåº”è¯¥æŒ‰ç…§é‚£ç§æ–¹å¼è§£å†³</p></li><li><p>åœ¨ä¸‹è½½ spconv æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">CMake Error at CMakeLists.txt:2 <span class="token punctuation">(</span>project<span class="token punctuation">)</span>:  No CMAKE_CUDA_COMPILER could be found.  raise CalledProcessError<span class="token punctuation">(</span>retcode, cmd<span class="token punctuation">)</span>subprocess.CalledProcessError: Command <span class="token string">'['</span>cmake<span class="token string">', '</span>/home/declan/CenterPoint/spconv<span class="token string">', '</span>-DCMAKE_PREFIX_PATH<span class="token operator">=</span>/home/declan/anaconda3/envs/centerpoint/lib/python3.6/site-packages/torch<span class="token string">', '</span>-DPYBIND11_PYTHON_VERSION<span class="token operator">=</span><span class="token number">3.6</span><span class="token string">', '</span>-DSPCONV_BuildTests<span class="token operator">=</span>OFF<span class="token string">', '</span>-DCMAKE_CUDA_FLAGS<span class="token operator">=</span><span class="token string">"--expt-relaxed-constexpr"</span><span class="token string">', '</span>-DCMAKE_LIBRARY_OUTPUT_DIRECTORY<span class="token operator">=</span>/home/declan/CenterPoint/spconv/build/lib.linux-x86_64-3.6/spconv<span class="token string">', '</span>-DCMAKE_BUILD_TYPE<span class="token operator">=</span>Release<span class="token string">']'</span> returned non-zero <span class="token builtin class-name">exit</span> status <span class="token number">1</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°è¯•è®¾ç½® CUDA è·¯å¾„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">PYTHONPATH</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${PYTHONPATH}</span>:/home/declan/CenterPoint"</span><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/cuda-10.0/bin:<span class="token environment constant">$PATH</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDA_PATH</span><span class="token operator">=</span>/usr/local/cuda-10.0<span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDA_HOME</span><span class="token operator">=</span>/usr/local/cuda-10.0<span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>/usr/local/cuda-10.0/lib64:<span class="token variable">$LD_LIBRARY_PATH</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ²¡æœ‰æ•ˆæœã€‚#241 issueså’Œæˆ‘é—®é¢˜ä¸€æ¨¡ä¸€æ · <a href="https://github.com/traveller59/spconv/issues/241">https://github.com/traveller59/spconv/issues/241</a></p><p>å°è¯•å¢åŠ è·¯å¾„ </p><p>try adding â€˜-DCMAKE_CUDA_COMPILER=/usr/local/cuda-10.1/bin/nvccâ€™ in cmake_args</p><p>ä¾æ—§å¤±è´¥</p><p>å°è¯•ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„g++ sudo apt install g++-7ï¼Œæ˜¾ç¤ºå·²ç»ä¸‹è½½ï¼Œæˆ‘ä»¬éœ€è¦åˆ‡æ¢ç‰ˆæœ¬</p><p>ls name* å¯ä»¥åˆ—å‡ºæ‰€æœ‰nameå¼€å¤´çš„åŒ…</p><p><a href="https://blog.csdn.net/FontThrone/article/details/104279224">https://blog.csdn.net/FontThrone/article/details/104279224</a></p><p>â€”slave ä½¿å¾—g++ gccç‰ˆæœ¬ä¿æŒä¸€è‡´ 70 90ä¸ºé‡è¦æƒé‡priority</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-7 <span class="token number">70</span> --slave /usr/bin/g++ g++ /usr/bin/g++-7<span class="token function">sudo</span> update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-9 <span class="token number">90</span> --slave /usr/bin/g++ g++ /usr/bin/g++-9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯¹g++å’Œgccè¿›è¡Œç®¡ç†</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">  Selection    Path            Priority   Status------------------------------------------------------------* <span class="token number">0</span>            /usr/bin/gcc-9   <span class="token number">90</span>        auto mode  <span class="token number">1</span>            /usr/bin/gcc-7   <span class="token number">70</span>        manual mode  <span class="token number">2</span>            /usr/bin/gcc-9   <span class="token number">90</span>        manual mode<span class="token function">sudo</span> update-alternatives --config gcc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸ</p></li><li><p>é€‰æ‹©äº† nuScenes mini æ•°æ®é›†</p></li><li><p>è¿è¡Œæµ‹è¯•</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python ./tools/dist_test.py infos_val_10sweeps_withvelo_filter_True.json  --work_dir work_dirs/CONFIG_NAME --checkpoint work_dirs/CONFIG_NAME/latest.pth --speed_test <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ModuleNotFoundError: No module named <span class="token string">'torchie'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°è¯•å°†torchieæ–‡æ¡£ç›´æ¥åŠ å…¥åˆ°PYTHONPATHå½“ä¸­</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">PYTHONPATH</span><span class="token operator">=</span><span class="token variable">$PYTHONPATH</span>:/home/delcan/CenterPoint/det3d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ–°æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:  File <span class="token string">"./tools/dist_test.py"</span>, line <span class="token number">211</span>, <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span>  File <span class="token string">"./tools/dist_test.py"</span>, line <span class="token number">102</span>, <span class="token keyword">in</span> main    logger <span class="token operator">=</span> get_root_logger<span class="token punctuation">(</span>cfg.log_level<span class="token punctuation">)</span>  File <span class="token string">"/home/declan/CenterPoint/det3d/torchie/utils/config.py"</span>, line <span class="token number">146</span>, <span class="token keyword">in</span> __getattr__    <span class="token builtin class-name">return</span> getattr<span class="token punctuation">(</span>self._cfg_dict, name<span class="token punctuation">)</span>  File <span class="token string">"/home/declan/CenterPoint/det3d/torchie/utils/config.py"</span>, line <span class="token number">29</span>, <span class="token keyword">in</span> __getattr__    raise exAttributeError: <span class="token string">'ConfigDict'</span> object has no attribute <span class="token string">'log_level'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯èƒ½æ˜¯å› ä¸º nuscenes_mini æµ‹è¯•é›†åŸå› </p><p><a href="https://github.com/tianweiy/CenterPoint/issues/106">https://github.com/tianweiy/CenterPoint/issues/106</a></p><p>æˆ‘æ ¹æ®ä¸Šé¢çš„å†…å®¹å¯¹æºç è¿›è¡Œäº†ä¿®æ”¹ï¼Œå…ˆå°è¯• train ä¸€ä¸‹</p><p>ä¾æ—§æŠ¥é”™ï¼Œå†æ£€æŸ¥å¯èƒ½æ˜¯å› ä¸ºé…ç½®æ–‡ä»¶æ²¡æœ‰å¯¹çš„åŸå› </p><p><a href="https://github.com/open-mmlab/mmdetection/issues/3093">https://github.com/open-mmlab/mmdetection/issues/3093</a></p><p>é€šè¿‡æ­£ç¡®é…ç½® <code>nusc_centerpoint_voxelnet_0075voxel_fix_bn_z.py</code> æ–‡ä»¶è§£å†³ä¸Šé¢æŠ¥é”™</p><p><code>./configs/nusc/voxelnet/nusc_centerpoint_voxelnet_0075voxel_fix_bn_z.py</code></p><p>ç”±äºæ²¡æœ‰å®Œæ•´çš„ nuScenes æ•°æ®é›†ï¼Œåˆæœ‰æ–°çš„é”™è¯¯æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">FileNotFoundError: <span class="token punctuation">[</span>Errno <span class="token number">2</span><span class="token punctuation">]</span> No such <span class="token function">file</span> or directory: <span class="token string">'nuScenes/samples/LIDAR_TOP/n008-2018-08-27-11-48-51-0400__LIDAR_TOP__1535385105950634.pcd.bin'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è·³è¿‡è¿™é‡Œï¼Œå°è¯•è·‘ä¸€ä¸ª demo</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python ./tools/dist_test.py ./configs/nusc/voxelnet/nusc_centerpoint_voxelnet_0075voxel_fix_bn_z.py --work_dir work_dirs/nusc_centerpoint_voxelnet_0075voxel_fix_bn_z --checkpoint work_dirs/nusc_centerpoint_voxelnet_0075voxel_fix_bn_z/latest.pth --speed_test <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šé¢çš„æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">FileNotFoundError: <span class="token punctuation">[</span>Errno <span class="token number">2</span><span class="token punctuation">]</span> No such <span class="token function">file</span> or directory: <span class="token string">'nuScenes/samples/LIDAR_TOP/n015-2018-10-02-10-50-40+0800__LIDAR_TOP__1538448754047572.pcd.bin'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥æ‰¾ç›®å½•å‘ç°è¿™ä¸ªæ–‡ä»¶å…¶å®æ˜¯å­˜åœ¨çš„ï¼Œè¯´æ˜è·¯å¾„æ²¡æœ‰å¯¹ï¼Œåœ¨ CentePoint ç›®å½•ä¸‹æ·»åŠ  nuScenes çš„è½¯é“¾æ¥å°±å¯ä»¥è§£å†³äº†</p></li><li><p>æœ€ç»ˆ RuntimeError: CUDA out of memory å³ä½¿ batch_size = 1 ä¹Ÿç›´æ¥ç‚¸äº†ï¼Œæ”¾å¼ƒï¼</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> papers </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CenterPoint </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½² Hexo åšå®¢æ•™ç¨‹</title>
      <link href="/archives/d547a647.html"/>
      <url>/archives/d547a647.html</url>
      
        <content type="html"><![CDATA[<h1 id="é˜¿é‡Œäº‘æœåŠ¡å™¨ECS"><a href="#é˜¿é‡Œäº‘æœåŠ¡å™¨ECS" class="headerlink" title="é˜¿é‡Œäº‘æœåŠ¡å™¨ECS"></a>é˜¿é‡Œäº‘æœåŠ¡å™¨ECS</h1><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://www.bilibili.com/video/BV177411K7bH">ç‹‚ç¥è¯´_bilibili</a></p><p>å®˜æ–¹é“¾æ¥ï¼š</p><p><a href="https://developer.aliyun.com/plan/grow-up">é˜¿é‡Œäº‘å¼€å‘è€…æˆé•¿è®¡åˆ’</a></p><p><a href="https://developer.aliyun.com/adc/student?spm=a2c6h.19776329.J_4403085560.4.658b3d804yW1UU#J_3120529270">ECSè®­ç»ƒè¥</a></p><p><a href="https://www.aliyun.com/product/ecs?spm=5176.224200.J_8058803260.52.1401586cYUB7hI">äº‘æœåŠ¡å™¨ECS</a></p><h2 id="å­¦ç”Ÿæœº"><a href="#å­¦ç”Ÿæœº" class="headerlink" title="å­¦ç”Ÿæœº"></a>å­¦ç”Ÿæœº</h2><p>å¦‚æœæ˜¯å­¦ç”Ÿ/æ–°ç”¨æˆ·ï¼Œä¸€å®šè¦å»çœ‹çœ‹æœ‰å“ªäº›ä¼˜æƒ ï¼Œæ¯”å¦‚<a href="https://developer.aliyun.com/plan/grow-up">é˜¿é‡Œäº‘å¼€å‘è€…æˆé•¿è®¡åˆ’</a>ã€‚æ­¤åˆ»é˜¿é‡Œäº‘æä¾›çš„å­¦ç”Ÿä¼˜æƒ æ˜¯å…è´¹ä½¿ç”¨2ä¸ªæœˆçš„æœåŠ¡å™¨èµ„æºã€‚å¦‚æœè´­ä¹°çš„è¯ï¼Œä¸€ä¸ª1æ ¸2Gçš„æœåŠ¡å™¨å°±è¶³å¤Ÿäº†</p><p><img src="/archives/d547a647/image-20210717163630430-1627213118656.png" style="zoom: 25%;"></p><h2 id="è®¾ç½®å®‰å…¨ç»„"><a href="#è®¾ç½®å®‰å…¨ç»„" class="headerlink" title="è®¾ç½®å®‰å…¨ç»„"></a>è®¾ç½®å®‰å…¨ç»„</h2><p>è¿›å…¥æ§åˆ¶å°å¼€å¯ç«¯å£ï¼Œå¦åˆ™å¤–éƒ¨æ— æ³•è®¿é—®ã€‚é™¤äº†é»˜è®¤çš„ä¸‰ä¸ªç«¯å£ï¼Œé€šè¿‡â€œå¿«é€Ÿæ·»åŠ â€ï¼Œæˆ‘å†æ·»åŠ äº† http(80) &amp; https(443) ä¸¤ä¸ªç«¯å£ã€‚ç”±äºç°åœ¨æˆ‘å¯¹è®¡ç®—æœºç½‘ç»œä¸€çªä¸é€šï¼Œæ‰€ä»¥å…ˆå°±è¿™æ ·å§</p><p><img src="/archives/d547a647/image-20210717155930905-1627213118658.png" style="zoom: 33%;"></p><h2 id="é‡ç½®å®ä¾‹å¯†ç "><a href="#é‡ç½®å®ä¾‹å¯†ç " class="headerlink" title="é‡ç½®å®ä¾‹å¯†ç "></a>é‡ç½®å®ä¾‹å¯†ç </h2><p>ä¿®æ”¹å¯†ç ä¹‹åå®ä¾‹å°±ä¼šè‡ªåŠ¨é‡å¯</p><p>ç„¶åå°±å¯ä»¥é€šè¿‡ <code>ssh root@ip</code> è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œå…¶ä¸­ ip æ˜¯ä½ æœåŠ¡å™¨çš„å…¬ç½‘ ip</p><p><img src="/archives/d547a647/image-20210717162311907-1627213118658.png" style="zoom: 33%;"></p><h2 id="Enjoy"><a href="#Enjoy" class="headerlink" title="Enjoy"></a>Enjoy</h2><p>ä¹‹åå°±å¯ä»¥åƒæ“ä½œ Linux ä¸€æ ·ï¼Œæ“ä½œè‡ªå·±çš„æœåŠ¡å™¨å•¦ï¼</p><h2 id="å°†åšå®¢éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š"><a href="#å°†åšå®¢éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š" class="headerlink" title="å°†åšå®¢éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š"></a>å°†åšå®¢éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š</h2><p>å‡ ä¸ªå‚è€ƒæ•™ç¨‹ï¼š<a href="https://developer.aliyun.com/article/775005">é˜¿é‡Œäº‘æ•™ç¨‹</a> <a href="https://blog.csdn.net/weixin_41154636/article/details/99685965">csdn æ•™ç¨‹</a> <a href="https://cloud.tencent.com/developer/article/1632020">è…¾è®¯äº‘æ•™ç¨‹</a> <a href="https://zhuanlan.zhihu.com/p/120743882">çŸ¥ä¹æ•™ç¨‹</a></p><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ ¹æ®ä¹‹å‰çš„ Linux å®‰è£…æ•™ç¨‹ç®€å•è®¾ç½®ä¸€ä¸‹è‡ªå·±çš„æœåŠ¡å™¨ï¼šæ·»åŠ æ–°ç”¨æˆ·ï¼Œæ›´æ”¹ä¸»æœºå</p><p>ç°åœ¨æœ¬åœ°é…ç½®å¥½ hexo ç¯å¢ƒï¼Œå…·ä½“é…ç½®è¿‡ç¨‹åœ¨ä¹‹å‰çš„åšå®¢æœ‰è¯¦ç»†è®°å½•</p><h3 id="åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…-git"><a href="#åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…-git" class="headerlink" title="åœ¨æœåŠ¡å™¨ä¸Šå®‰è£… git"></a>åœ¨æœåŠ¡å™¨ä¸Šå®‰è£… git</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> yum <span class="token function">install</span> -y <span class="token function">git</span><span class="token comment"># å®‰è£…æˆåŠŸåæŸ¥çœ‹ git version</span><span class="token function">git</span> --version <span class="token function">git</span> version <span class="token number">2.27</span>.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºä¹‹å‰åœ¨ Ubuntu ä¸Šä½¿ç”¨çš„æ˜¯ apt åŒ…ç®¡ç†ï¼Œåœ¨ CentOS ä¸Šåˆ™æ¢ä¸º yum åŒ…ç®¡ç†ã€‚æˆ‘è¯•éªŒäº†ä¸€ä¸‹ï¼Œå¦‚æœä¸åŠ  sudo æ˜¯ä¸èƒ½ä¸‹è½½æˆåŠŸçš„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Error: This <span class="token builtin class-name">command</span> has to be run under the root user.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥æˆ‘è®¤ä¸º yum å’Œ apt ä¸€æ ·éœ€è¦ sudo æƒé™</p><h3 id="å®‰è£…-nginx"><a href="#å®‰è£…-nginx" class="headerlink" title="å®‰è£… nginx"></a>å®‰è£… nginx</h3><p>ä»€ä¹ˆæ˜¯ nginxï¼Ÿä¸‹é¢æ˜¯å®˜ç½‘æè¿°</p><blockquote><p>NGINX is a highâ€‘performance, highly scalable, highly available web server, reverse proxy server, and web accelerator (combining the features of an HTTP load balancer, content cache, and more).</p></blockquote><p>åœ¨æˆ‘ç†è§£çœ‹æ¥ï¼Œéƒ¨ç½²ç½‘ç«™çš„è¿‡ç¨‹ä¸­ nginx å°±æ˜¯ç”¨æ¥æä¾›ç½‘é¡µæœåŠ¡çš„æœåŠ¡å™¨ã€‚è¿™é‡Œå°±è¦æ›´è¿›ä¸€æ­¥ç†è§£ä»€ä¹ˆæ˜¯å¹¿ä¹‰ä¸Šçš„æœåŠ¡å™¨</p><blockquote><p>ä»å¹¿ä¹‰ä¸Šè®²ï¼ŒæœåŠ¡å™¨æ˜¯æŒ‡ç½‘ç»œä¸­èƒ½å¯¹å…¶å®ƒæœºå™¨æä¾›æŸäº›æœåŠ¡çš„è®¡ç®—æœºç³»ç»Ÿã€‚ä»ç‹­ä¹‰ä¸Šè®²ï¼ŒæœåŠ¡å™¨æ˜¯ä¸“æŒ‡æŸäº›é«˜æ€§èƒ½è®¡ç®—æœºï¼Œèƒ½é€šè¿‡ç½‘ç»œï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚</p></blockquote><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> yum <span class="token function">install</span> -y nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å»ºç«‹-git-ä»“åº“"><a href="#å»ºç«‹-git-ä»“åº“" class="headerlink" title="å»ºç«‹ git ä»“åº“"></a>å»ºç«‹ git ä»“åº“</h3><p>Hexo å¯ä»¥ä½¿ç”¨ git æ¥éƒ¨ç½²ï¼Œè¿™æ ·æ¯æ¬¡å†™å®Œä¹‹åå°±éƒ½å¯ä»¥ä½¿ç”¨gitæ¥ä¸€é”®éƒ¨ç½²äº†ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚æˆ‘ä»¬å…ˆä¸ºç³»ç»Ÿæ·»åŠ ä¸€ä¸ª git ç”¨æˆ·</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">useradd</span> -m <span class="token function">git</span> <span class="token comment"># æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·</span><span class="token function">passwd</span> <span class="token function">git</span> <span class="token comment"># è®¾ç½®gitç”¨æˆ·å¯†ç </span><span class="token function">su</span> <span class="token function">git</span> <span class="token comment"># åˆ‡æ¢ç”¨æˆ·è¿›è¡Œåç»­æ“ä½œ</span><span class="token builtin class-name">cd</span> /home/git/<span class="token function">mkdir</span> -p projects/blog <span class="token comment"># æŠŠé¡¹ç›®ç›®å½•å»ºç«‹èµ·æ¥</span><span class="token function">mkdir</span> repos <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> repos<span class="token function">git</span> init --bare blog.git <span class="token comment"># åˆ›å»ºä»“åº“</span><span class="token builtin class-name">cd</span> blog.git/hooks<span class="token function">vim</span> post-receive <span class="token comment"># åˆ›å»ºä¸€ä¸ªé’©å­</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>post-receiveæ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token shebang important">#!/bin/sh</span><span class="token function">git</span> --work-tree<span class="token operator">=</span>/home/git/projects/blog --git-dir<span class="token operator">=</span>/home/git/repos/blog.git checkout -f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç»™ post-receive æ·»åŠ æ‰§è¡Œæƒé™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">chmod</span> +x post-receive<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>git init â€”bare å’Œ git init æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ <a href="https://blog.csdn.net/sinat_34349564/article/details/52487860">csdn é“¾æ¥</a></p><p>hooksæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ <a href="https://blog.csdn.net/weixin_41154636/article/details/99685965">csdn é“¾æ¥</a></p><p>è¯¥é’©å­çš„æ„æ€æ˜¯å½“æœ¬åœ°æœ‰æäº¤åˆ°æœåŠ¡å™¨æ—¶ï¼Œä¼šå°†æ–‡ä»¶æ”¾åœ¨/home/hexoä¸‹</p><p><code>-f</code>è¿™ä¸ªå‚æ•°å¦‚æœåœ¨å¤šäººåä½œçš„åšå®¢ä¸­å¯èƒ½ä¼šå¼•å‘ä¸å¥½çš„ç»“æœï¼Œå› ä¸ºä»–æ˜¯å¼ºåˆ¶æ›´æ–°çš„æ„æ€ï¼Œä¼šå°†æœ¬åœ°ç‰ˆæœ¬è¦†ç›–æ‰è¿œç¨‹æœåŠ¡å™¨çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯æ˜¯ä¸ªäººçš„åšå®¢ç³»ç»Ÿå°±æ— æ‰€è°“äº†</p><h3 id="å°†å…¬é’¥é…ç½®åˆ°æœåŠ¡å™¨ä¸Š"><a href="#å°†å…¬é’¥é…ç½®åˆ°æœåŠ¡å™¨ä¸Š" class="headerlink" title="å°†å…¬é’¥é…ç½®åˆ°æœåŠ¡å™¨ä¸Š"></a>å°†å…¬é’¥é…ç½®åˆ°æœåŠ¡å™¨ä¸Š</h3><p>å¯ä»¥é€šè¿‡å»ºç«‹SSHä¿¡ä»»å…³ç³»ï¼Œæ¥å…å»ç™»é™†æœåŠ¡å™¨æ—¶è¾“å…¥å¯†ç çš„æ­¥éª¤</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ssh-copy-id -i ~/.ssh/id_rsa.pub git@server_ip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘å°è¯•äº†ä¸€ä¸‹è‡ªå·±æ‰‹åŠ¨å¤åˆ¶ id_rsa.pub åˆ° authorized_keys æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯ä¸èƒ½å®ç°å…å¯†ç™»é™†ï¼Œå¯èƒ½æ—¶å¤åˆ¶æ—¶çš„å­—ç¬¦ä¸²å‡ºç°äº†é—®é¢˜ï¼Œä¹‹å‰åœ¨ github æ—¶ä¹Ÿé‡åˆ°äº†ç±»ä¼¼é—®é¢˜ï¼Œç›´æ¥å¤åˆ¶å…¬é’¥æ— æ³•è¯†åˆ«çš„æƒ…å†µ</p><h3 id="æ›´æ”¹-git-ç”¨æˆ·é»˜è®¤-shell"><a href="#æ›´æ”¹-git-ç”¨æˆ·é»˜è®¤-shell" class="headerlink" title="æ›´æ”¹ git ç”¨æˆ·é»˜è®¤ shell"></a>æ›´æ”¹ git ç”¨æˆ·é»˜è®¤ shell</h3><p>ä¸ºäº†å®‰å…¨ï¼Œæˆ‘ä»¬æœ€å¥½ç¦ç”¨ git ç”¨æˆ·çš„ shell ç™»å½•æƒé™ã€‚ä»è€Œåªèƒ½ç”¨ git cloneï¼Œgit push ç­‰ git æ“ä½œè®¿é—®æœåŠ¡å™¨</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">cat</span> /etc/shells <span class="token comment"># æŸ¥çœ‹ git-shell æ˜¯å¦åœ¨ç™»å½•æ–¹å¼é‡Œé¢</span><span class="token function">which</span> git-shell <span class="token comment"># æ‰¾åˆ°git-shellçš„è·¯å¾„ï¼Œè®°ä¸‹æ¥</span><span class="token function">sudo</span> <span class="token function">vim</span> /etc/shells <span class="token comment"># æŠŠ git-shell è·¯å¾„æ·»åŠ åˆ°æ–‡ä»¶æœ«å°¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ›´æ”¹ git ç”¨æˆ· shell</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/passwd<span class="token comment"># å°†åŸæ¥çš„ /bin/bash æ”¹ä¸º /usr/bin/git-shell</span><span class="token comment"># git:x:1001:1001::/home/git:/usr/bin/git-shell</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p> è¿™æ ·å½“ä½ å†æ¬¡ç”¨ ssh è¿æ¥ git ç”¨æˆ·æ—¶å°±ä¼šå‡ºç°ä»¥ä¸‹ä¿¡æ¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">fatal: Interactive <span class="token function">git</span> shell is not enabled.hint: ~/git-shell-commands should exist and have <span class="token builtin class-name">read</span> and execute access.Connection to your_ip closed.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="éƒ¨ç½²ä¸Šçº¿"><a href="#éƒ¨ç½²ä¸Šçº¿" class="headerlink" title="éƒ¨ç½²ä¸Šçº¿"></a>éƒ¨ç½²ä¸Šçº¿</h3><p>æˆ‘ä»¬ä¿®æ”¹<strong>æœ¬åœ°</strong> hexo é…ç½®æ–‡ä»¶ _config.yml</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> git  <span class="token key atrule">repo</span><span class="token punctuation">:</span> git@your_ip<span class="token punctuation">:</span>/home/git/repos/blog.git<span class="token comment"># repo: git@github.com:name/name.github.io.git</span>  <span class="token key atrule">branch</span><span class="token punctuation">:</span> master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½®å¥½åå°±æ˜¯ hexo ä¸‰è¿ä¸€é”®éƒ¨ç½²ï¼š<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></p><h3 id="é…ç½®-nginx"><a href="#é…ç½®-nginx" class="headerlink" title="é…ç½® nginx"></a>é…ç½® nginx</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">cd</span> /etc/nginx<span class="token function">cp</span> nginx.conf nginx_backup.conf <span class="token comment"># å¤‡ä»½é…ç½®æ–‡ä»¶</span><span class="token function">vim</span> nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æœ‰ä¸¤ä¸ªéœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼š</p><ol><li><p>å¼€å¤´çš„ <code>user nginx</code> è¦æ”¹ä¸º <code>user root</code> </p></li><li><p>server éƒ¨åˆ†</p><pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token directive"><span class="token keyword">server</span></span><span class="token punctuation">{</span>        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span> <span class="token comment">#ç›‘å¬80ç«¯å£</span>        <span class="token directive"><span class="token keyword">server_name</span> 139.159.245.212</span><span class="token punctuation">;</span> <span class="token comment">#ä½ çš„æœåŠ¡å™¨åï¼Œé€šå¸¸æ˜¯åŸŸåï¼Œå¦‚æœæ˜¯åŸŸåï¼Œä½ å°±éœ€è¦ç›‘å¬80ç«¯å£</span>        <span class="token directive"><span class="token keyword">root</span>       /home/git/projects/blog</span><span class="token punctuation">;</span> <span class="token comment">#ç½‘ç«™çš„æ ¹ç›®å½•</span>        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p>é…ç½®å¥½å <code>nginx -s reload</code> é‡æ–°åŠ è½½é…ç½®ä¿¡æ¯ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿›è¡ŒåŠ è½½ï¼Œåˆ™è¿˜éœ€è¦å…ˆè¿è¡Œå‘½ä»¤ <code>nginx -c /etc/nginx/nginx.conf</code></p><p>ç°åœ¨ä½ å°±å¯ä»¥é€šè¿‡ ip åœ°å€è®¿é—®ä½ çš„ç½‘é¡µå•¦ï¼</p><p>æˆ‘å‘ç°ç”±äºæˆ‘çš„ç½‘ç«™å°é¢å¤ªå¤§(æœ‰6M)ï¼Œæ‰“å¼€æ—¶åŠ è½½æ¯”è¾ƒæ…¢ã€‚æ‰€ä»¥æˆ‘éœ€è¦å‹ç¼©ä¸€ä¸‹å°é¢å›¾ç‰‡çš„å¤§å°ï¼Œæ¨èä¸¤ä¸ªå‹ç¼©å›¾ç‰‡ç½‘ç«™</p><p><a href="https://compressjpeg.com/">https://compressjpeg.com/</a></p><p><a href="https://tinypng.com/">https://tinypng.com/</a></p><h2 id="åŸŸå"><a href="#åŸŸå" class="headerlink" title="åŸŸå"></a>åŸŸå</h2><p>ä»€ä¹ˆæ˜¯åŸŸåï¼Ÿå‚è€ƒé“¾æ¥ï¼š<a href="https://www.bilibili.com/video/BV1kE411i7Jo?from=search&amp;seid=2556702162224412196">CodeSheep bilibili</a></p><p>å»ºè®®é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://help.aliyun.com/product/35473.html?spm=a2c4g.11186623.6.540.5b09689epNroGg">é˜¿é‡Œäº‘åŸŸåæœåŠ¡</a> <a href="https://help.aliyun.com/document_detail/61257.html?spm=a2c4g.11174283.2.6.36904c070bCdBM">ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘åŸŸåæœåŠ¡</a></p><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ <a href="https://help.aliyun.com/document_detail/54068.htm?spm=a2c4g.11186623.2.13.5ff0689efHL52u#task-1830383">æ³¨å†Œé€šç”¨åŸŸå</a>ï¼ŒèŠ±è´¹79å…ƒå·¨èµ„æ³¨å†Œäº†3å¹´åŸŸå hongkun.space</p><p><img src="/archives/d547a647/image-20210717235130445-1627213118658.png" style="zoom:50%;"></p><p>å®Œæˆè´­ä¹°è¿‡åè¿˜éœ€è¦è¿›è¡Œï¼š</p><ol><li><a href="https://help.aliyun.com/document_detail/35881.htm?spm=a2c4g.11186623.2.14.275a689e1pnnCW#concept-uhk-w5v-12b">å®åè®¤è¯</a>ï¼šä¸€èˆ¬3å¤©å·¦å³å®¡æ ¸é€šè¿‡</li><li><a href="https://beian.aliyun.com/pcContainer/formpage?page=selfBa&amp;pageAction=init&amp;orderType=100">åŸŸåå¤‡æ¡ˆ</a>ï¼šåˆå®¡1-2å¤©ï¼Œå®Œæ•´å¤‡æ¡ˆå®¡æ ¸è¿‡ç¨‹å¤§æ¦‚åå¤šå¤©</li></ol><p>æ³¨æ„éœ€è¦å…ˆè¿›è¡Œå®åè®¤è¯ï¼Œç„¶åæ‰èƒ½å®Œæˆå¤‡æ¡ˆ</p><p>è¿™é‡Œæˆ‘è¿˜é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘é€šè¿‡å­¦ç”Ÿä¼˜æƒ å…è´¹é¢†å–çš„æœåŠ¡å™¨ä¸èƒ½è¿›è¡ŒåŸŸåå¤‡æ¡ˆï¼Œå› ä¸ºè‡³å°‘éœ€è¦æœ‰3ä¸ªæœˆçš„æœåŠ¡å™¨ä½¿ç”¨æƒæ‰èƒ½å¤‡æ¡ˆã€‚çœ‹æ¥è¿˜æ˜¯å¾—è‡ªå·±è´­ä¹°ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæˆ‘å†æ¬¡èŠ±è´¹å·¨èµ„96å…ƒï¼ˆæ–°ç”¨æˆ·ä¼˜æƒ ï¼‰è´­ä¹°äº†ä¸€å¹´çš„è½»é‡åº”ç”¨æœåŠ¡å™¨</p><h3 id="è½»é‡åº”ç”¨æœåŠ¡å™¨"><a href="#è½»é‡åº”ç”¨æœåŠ¡å™¨" class="headerlink" title="è½»é‡åº”ç”¨æœåŠ¡å™¨"></a>è½»é‡åº”ç”¨æœåŠ¡å™¨</h3><p><a href="https://www.aliyun.com/product/swas?spm=5176.8789780.J_8058803260.52.578945b5xsNx3V">è½»é‡åº”ç”¨æœåŠ¡å™¨</a>æœ‰å•ç‹¬çš„<a href="https://account.aliyun.com/login/login.htm?spm=5176.161059.J_5253785160.3.2c9ea505nvWZQs&amp;oauth_callback=https%3A%2F%2Fswas.console.aliyun.com%2F%3Fspm%3D5176.161059.J_835498.2.3e9f7fdaKmYuj7&amp;lang=zh#/servers">æ§åˆ¶å°</a>ï¼Œç”¨æ¥éƒ¨ç½²ç½‘ç«™æ€§ä»·æ¯”éå¸¸ä¸é”™ï¼Œé…ç½®è¿‡ç¨‹å’Œä¸Šé¢çš„äº‘æœåŠ¡å™¨ä¸€æ ·</p><p>åœ¨è½»é‡åº”ç”¨æœåŠ¡å™¨çš„æ§åˆ¶å°ä¸­ï¼ŒåŸŸåè§£æå’Œå¤‡æ¡ˆå°±åœ¨æ¦‚è§ˆé¡µé¢å½“ä¸­ï¼Œæ ¹æ®æµç¨‹è¿›è¡Œå³å¯</p><p><img src="/archives/d547a647/image-20210725173426850.png" style="zoom: 33%;"></p><h2 id="éƒ¨ç½²-SSL-è¯ä¹¦-https"><a href="#éƒ¨ç½²-SSL-è¯ä¹¦-https" class="headerlink" title="éƒ¨ç½² SSL è¯ä¹¦ (https)"></a>éƒ¨ç½² SSL è¯ä¹¦ (https)</h2><p>ç½‘ç«™ç°åœ¨å¯ä»¥è®¿é—®äº†ï¼Œä½†æ˜¯å¦‚ä¸‹å›¾å¯è§ï¼Œç™»é™†ç½‘ç«™ä¼šæç¤º <strong>Not Secure!!!</strong></p><p><img src="/archives/d547a647/image-20210802105224250.png" style="zoom: 50%;"></p><p>è¿™å¯ä¸èƒ½å¿ï¼Œäºæ˜¯æˆ‘æ ¹æ® <a href="https://blog.csdn.net/qq_33505555/article/details/106046616">CSDN æ•™ç¨‹</a> ç»™é˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½® SSL è¯ä¹¦ï¼Œä½¿ç”¨çš„æ˜¯ FreeSSL ä¸€ä¸ªæä¾›å…è´¹ https è¯ä¹¦ç”³è¯·çš„ç½‘ç«™</p><h3 id="ä½¿ç”¨-FreeSSL-ç”³è¯·è¯ä¹¦"><a href="#ä½¿ç”¨-FreeSSL-ç”³è¯·è¯ä¹¦" class="headerlink" title="ä½¿ç”¨ FreeSSL ç”³è¯·è¯ä¹¦"></a>ä½¿ç”¨ FreeSSL ç”³è¯·è¯ä¹¦</h3><p>è€è§„çŸ©ï¼Œå…ˆçœ‹çœ‹ <a href="https://blog.freessl.cn/tag/ssl-apply/">å®˜ç½‘æ•™ç¨‹</a></p><ol><li><p>ç”Ÿæˆ CSR <a href="https://cloud.tencent.com/document/product/400/5367">ä»€ä¹ˆæ˜¯ CSR ? è…¾è®¯äº‘æ–‡æ¡£</a></p><p>æ•™ç¨‹ä¸­æ¨èä½¿ç”¨ Keymanager ç”Ÿæˆ</p></li><li><p>åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸­é…ç½® DNS è§£æï¼Œå¹¶å¯¹é…ç½®è¿›è¡Œæ£€æµ‹å’ŒéªŒè¯</p><p>éªŒè¯æˆåŠŸåå¯ä»¥åœ¨ FreeSSL æ§åˆ¶å°ä¸­æŸ¥çœ‹è¯ä¹¦</p><p><img src="/archives/d547a647/image-20210802141326078.png" style="zoom:33%;"></p><p>åœ¨â€œæ›´å¤šæ“ä½œâ€ä¸­å¯ä»¥ä¸‹è½½è¯ä¹¦ï¼Œä¸€ä¸ª pem æ–‡ä»¶ï¼Œä¸€ä¸ª private.key</p><p><img src="/archives/d547a647/image-20210802141919162.png" style="zoom:33%;"></p></li><li><p>ç„¶åå°†è¯ä¹¦ .pem æ–‡ä»¶å¯¼å…¥åˆ° keymanager ä¸­</p><p><img src="/archives/d547a647/image-20210802170924734.png" style="zoom: 25%;"></p></li><li><p>è¿›è¡Œä¸€é”®éƒ¨ç½²ã€‚åŸºäºä½ è‡ªå·±çš„æ¡†æ¶ï¼Œé€‰æ‹©ä¸åŒçš„éƒ¨ç½²æ–¹æ³•ï¼Œæˆ‘é€‰æ‹©éƒ¨ç½²åˆ° Nginx ä¸Šã€‚è¿™é‡Œçš„â€œä¸€é”®éƒ¨ç½²â€å®è´¨ä¸Šå°±æ˜¯ä¸Šä¼ ä½ çš„è¯ä¹¦åˆ°æœåŠ¡å™¨ä¸Š</p><p><img src="/archives/d547a647/image-20210802171457165.png" style="zoom: 33%;"></p><p>éƒ¨ç½²æˆåŠŸè¿‡åï¼Œä½¿ç”¨ <a href="https://myssl.com/">myssl.com </a> æ£€æŸ¥ç½‘ç«™çš„å®‰å…¨æ€§ã€‚ä½†æ˜¯å¦‚æœä½ çš„ Nginx é…ç½®ä¸å¯¹çš„è¯ï¼Œ</p></li><li><p>é…ç½® Nginx</p><p>ç°åœ¨æˆ‘ä»¬å¸Œæœ›é€šè¿‡ https 443 ç«¯å£æ¥æ‰“å¼€ç½‘ç«™ï¼Œä¸ä¹‹å‰ç›‘å¬ http 80 ç«¯å£ï¼Œæˆ‘ä»¬ç›‘å¬ 443 ç«¯å£ï¼Œç„¶åå°† 80 ç«¯å£é‡å®šå‘</p><pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>      <span class="token comment">#listen 80;</span>      <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span></span><span class="token punctuation">;</span>      <span class="token directive"><span class="token keyword">ssl</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>      <span class="token directive"><span class="token keyword">ssl_certificate</span> /etc/ssl/cert.pem</span><span class="token punctuation">;</span>      <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /etc/ssl/key.pem</span><span class="token punctuation">;</span>      <span class="token directive"><span class="token keyword">server_name</span>  hongkun.space</span><span class="token punctuation">;</span>      <span class="token directive"><span class="token keyword">root</span>         /home/git/blog</span><span class="token punctuation">;</span>  ...  <span class="token punctuation">}</span>  <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>      <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>      <span class="token directive"><span class="token keyword">server_name</span> hongkun.space      <span class="token comment"># permenant redirect to https</span>      return <span class="token number">301</span> https://hongkun.space<span class="token variable">$request_uri</span></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½®å¥½è¿‡åé‡å¯ <code>nginx -s reload</code></p></li><li><p>ç°åœ¨è®¿é—®ç½‘ç«™ï¼Œæ—è¾¹å°±æœ‰é«˜è´µçš„<span class="github-emoji"><span>ğŸ”’</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f512.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><p><img src="/archives/d547a647/image-20210802173016910.png" style="zoom:50%;"></p><p>éƒ¨ç½²æˆåŠŸè¿‡åï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <a href="https://myssl.com/">myssl.com </a> æ£€æŸ¥ç½‘ç«™çš„å®‰å…¨æ€§</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> é˜¿é‡Œäº‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CS231N Assignment2 ç¬”è®°</title>
      <link href="/archives/407bb789.html"/>
      <url>/archives/407bb789.html</url>
      
        <content type="html"><![CDATA[<h1 id="cs231n-2021-Assignment-2-note"><a href="#cs231n-2021-Assignment-2-note" class="headerlink" title="cs231n 2021 Assignment 2 note"></a>cs231n 2021 Assignment 2 note</h1><h2 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h2><p>assignment æ¨¡æ¿: <a href="https://github.com/cs231n/cs231n.github.io">github</a> </p><p>å®˜æ–¹: <a href="https://cs231n.github.io/assignments2021/assignment2/">è¯¾ç¨‹é“¾æ¥</a></p><p>assignment å‚è€ƒé“¾æ¥: <a href="https://github.com/amanchadha/stanford-cs231n-assignments-2020">2020</a></p><p>å‘ç°äº†ä¸€ç§æ–°çš„æ¨¡å¼: pycharm + git + anaconda &amp; jupyter</p><p>ä¸Šé¢çš„ç»„åˆèƒ½å¤Ÿå¸®åŠ©å†™ä»£ç çš„æ•ˆç‡æå‡ï¼Œpycharm èƒ½å¤Ÿå¸®åŠ©è°ƒè¯•ï¼Œgit ç”¨äºç‰ˆæœ¬ç®¡ç†ï¼Œconda ç”¨äºç¯å¢ƒç®¡ç†ã€‚jupyter åœ¨æµ‹è¯•ä»£ç å—ä¸Šæœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ï¼Œå¹¶ä¸”å¾ˆå¤š cs231n çš„ä½œä¸šå½¢å¼éƒ½æ˜¯ä»¥ ipynb çš„æ–‡ä»¶ç±»å‹å‘å¸ƒï¼Œæ›´é€‚åˆåœ¨ jupyter ä¸Šæ‰“å¼€ï¼Œè€Œä¸” jupyter èƒ½å¤Ÿç›´æ¥ä½¿ç”¨åˆ›å»ºå¥½çš„ conda ç¯å¢ƒï¼Œç‰¹åˆ«æ–¹ä¾¿</p><p>ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œæœ€ç»ˆå†³å®šä½¿ç”¨ vs code æ›¿æ¢ pycharmï¼ŒåŸå› æ˜¯ vs code æœ‰ jupyter notebook æ’ä»¶ï¼Œå¯ä»¥ç›´æ¥æ˜¾ç¤ºåœ¨ editor å†…ï¼Œæ¯” Pycharm æ›´æ–¹ä¾¿è€Œä¸”ä»¥åæƒ³è¦å­¦ä¹ å…¶ä»–è¯­è¨€ vs code ä¼˜åŠ¿æ›´å¤§</p><h2 id="è¿‡ç¨‹ä¸­çš„ç¼–ç¨‹å¤ä¹ "><a href="#è¿‡ç¨‹ä¸­çš„ç¼–ç¨‹å¤ä¹ " class="headerlink" title="è¿‡ç¨‹ä¸­çš„ç¼–ç¨‹å¤ä¹ "></a>è¿‡ç¨‹ä¸­çš„ç¼–ç¨‹å¤ä¹ </h2><ol><li><p>é‡æ–°å¤ä¹ äº† numpy çš„ä¸€äº›ç”¨æ³•ï¼Œä¸€ä¸ªé‡è¦æ€æƒ³å°±æ˜¯å°½é‡å°‘è€ƒè™‘ä½¿ç”¨å¾ªç¯è§£å†³ï¼Œè¦ä»¥ index ç´¢å¼•æ€æƒ³æ¥è§£å†³æ•°æ®çš„æ“ä½œé—®é¢˜ã€‚</p><p>reshapeå·²ç»å­˜åœ¨çš„shape</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>b<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“æ¥å—å‚æ•°æ˜¯å…ƒç»„è€Œæ˜¯å¯å˜å‚æ•° <em>args çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ </em>tuple æ¥å°†å‚æ•°å˜ä¸º *args</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¦å­¦ä¼šå–„ç”¨çŸ©é˜µç‚¹ä¹˜ A * Bï¼Œæ˜¯å°†å¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œåœ¨è®¡ç®—æ¨¡çš„æ—¶å€™ï¼Œæˆ–è€…å½“å…¶ä¸­ä¸€ä¸ªæ˜¯ indication function æ—¶å¾ˆæœ‰ç”¨</p></li><li><p>é‡æ–°å¤ä¹ äº†å­—å…¸çš„ç”¨æ³•ï¼Œæ ¸å¿ƒæ˜¯åˆ›é€ å­—å…¸ï¼Œdict(), dict.fromkeys()</p><p>å­—å…¸çš„ key, val è¿­ä»£å™¨ï¼Œå¦‚æœä¸ç”¨ itemsï¼Œåˆ™åªæœ‰ key</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> key<span class="token punctuation">,</span> val <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>pas<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>å¯¹äºæ ¼å¼åŒ–å­—ç¬¦ä¸²æœ‰æ–°çš„è®¤çŸ¥ï¼Œä¸‹é¢ä¾‹å­</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">self<span class="token punctuation">.</span>params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>self<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'b%d'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> weight_scale <span class="token operator">*</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>hd<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯ä»¥ç”¨è¿™æ ·çš„å½¢å¼æ¥è°ƒç”¨ key</p></li></ol><h2 id="Fully-Connected-Networks"><a href="#Fully-Connected-Networks" class="headerlink" title="Fully Connected Networks"></a>Fully Connected Networks</h2><ol><li>å¯¹äºç½‘ç»œçš„è®¤çŸ¥æœ‰äº†æ›´æ–°ã€‚è¦æŠŠå±‚(layer, w)å’Œç‚¹(node, x)åˆ†å¼€æ¥çœ‹ï¼Œè¿™æ ·ç½‘ç»œç»“æ„æ‰æ›´æ¸…æ™°ã€‚ä¸€èˆ¬éšè—å±‚ä¸åŒ…å«è¾“å‡ºå±‚</li><li><strong>åå‘ä¼ æ’­ç†Ÿæ‚‰ back propagationï¼Œå°¤å…¶æ˜¯çŸ©é˜µç›¸ä¹˜çš„åå‘ä¼ æ’­ï¼Œåªéœ€è¦è®°ä½ç»“è®ºå°±è¡Œäº†ã€‚å¯¹äºå¹¿æ’­è¿‡åçš„ç»“æœï¼Œéœ€è¦å°†å¹¿æ’­çš„çŸ©é˜µä½œ sum å¤„ç†ï¼Œå¾—åˆ°å¹¿æ’­å‰çš„å¯¹åº”å…ƒç´ æ¢¯åº¦</strong></li><li>5 layers å’Œ 3 layers ç½‘ç»œä¼˜åŒ–æ—¶æ¯”è¾ƒï¼Œå·®å¼‚åœ¨å“ªé‡Œï¼Ÿ5 layer æ›´éš¾ä¼˜åŒ–ï¼Œå¯¹äºåˆå§‹å€¼æ•æ„Ÿ</li><li><strong>å¯¹äºä¼˜åŒ–ç®—æ³•è¿›è¡Œäº†è¿›ä¸€æ­¥äº†è§£ï¼Œç”±ä¸‰ä¸ªæ ¸å¿ƒç‚¹ï¼šAdaGrad, Momentum, EWA æœ€åè‡ªç„¶æ¨å‡º Adam ä¼˜åŒ–ç®—æ³•</strong></li><li><strong>åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™é‡è¦çš„ç‰ˆæœ¬éœ€è¦ä¿å­˜ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨ git</strong></li></ol><h2 id="Batch-normalization"><a href="#Batch-normalization" class="headerlink" title="Batch normalization"></a>Batch normalization</h2><p>è¿›ä¸€æ­¥æ¸…æ™°äº† bn çš„è¿‡ç¨‹ä¸ä½œç”¨ï¼Œå¯ä»¥å›çœ‹è‡ªå·±çš„ç¬”è®°äº†è§£è¯¦æƒ…</p><h3 id="Inline-Question-1"><a href="#Inline-Question-1" class="headerlink" title="Inline Question 1"></a>Inline Question 1</h3><p><strong>How does the scale of weight initialization affect models with/without batch normalization differently, and why?</strong></p><p>You should find that using batch normalization helps the network to converge much faster. </p><p>ä½¿ç”¨ batch normalization ä¼šè®©ç½‘ç»œåœ¨è®­ç»ƒé›†ä¸Šæ”¶æ•›æ›´å¿«ã€‚è¿™å’Œæ™®é€šçš„ normalization æ˜¯ä¸€ä¸ªé“ç†ï¼Œå‡å°‘ zigzag æ‹å¼¯</p><p>è¿˜æœ‰å‡ ä¸ªéœ€è¦çŸ¥é“å’Œç†è§£çš„ç‚¹æ˜¯ï¼š</p><ol><li>batch normalization å¸®åŠ©ç¼“è§£æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸çš„é—®é¢˜ï¼Œè¿™å°†å‡ç¼“å› ä¸º weight initialization è¿‡å¤§æˆ–è¿‡å°è€Œäº§ç”Ÿæ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸çš„é—®é¢˜</li><li>batch normalization æœ‰ä¸€å®šçš„æ­£åˆ™åŒ–æ•ˆæœï¼Œé¿å…è¿‡æ‹Ÿåˆ</li></ol><p><img src="/archives/407bb789/image-20210707160726541.png" style="zoom: 67%;"></p><h3 id="Inline-Question-2"><a href="#Inline-Question-2" class="headerlink" title="Inline Question 2"></a>Inline Question 2</h3><p><strong>hat does this imply about the relationship between batch normalization and batch size? Why is this relationship observed?</strong></p><p>ä¸€èˆ¬è§„å¾‹æ˜¯ï¼šbatch size è¶Šå¤§è®­ç»ƒé›†ä¸Šæ”¶æ•›è¶Šå¿«ã€‚å½“ batch size æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œæ¯” baseline é€Ÿåº¦æ›´æ…¢ï¼ŒåŸå› åœ¨äºè¿‡å°‘çš„æ ·æœ¬å¸¦æ¥çš„åå·®å¤ªå¤§ï¼Œè¿™æ ·çš„å™ªéŸ³ä¼šå½±å“è®­ç»ƒå’Œæµ‹è¯•è¡¨ç°</p><p><img src="/archives/407bb789/image-20210707164225500.png" style="zoom: 67%;"></p><p>åœ¨è®­ç»ƒå’Œæµ‹è¯•æ—¶å‡ä¼šç”¨åˆ° bn layerï¼Œæµ‹è¯•æ—¶ç”¨çš„ $\mu,\sigma$  å‚æ•°æ˜¯è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ•°åŠ æƒå¹³å‡ EWA</p><h3 id="Layer-Normalization"><a href="#Layer-Normalization" class="headerlink" title="Layer Normalization"></a>Layer Normalization</h3><p>ç”¨åœ¨ RNN ä¸­æ›´å¤šï¼Œå¦‚æœä»¥åæ¥è§¦ NLP é¢†åŸŸçš„è¯å†æ·±å…¥æ•´ç†ã€‚ç®€å•çš„è§£é‡Š <a href="https://zhuanlan.zhihu.com/p/74516930">çŸ¥ä¹é“¾æ¥</a> </p><p>å‡è®¾æˆ‘ä»¬æœ‰ 10è¡Œ 3åˆ— çš„æ•°æ®ï¼Œå³æˆ‘ä»¬çš„batchsize = 10ï¼Œæ¯ä¸€è¡Œæ•°æ®æœ‰ä¸‰ä¸ªç‰¹å¾ï¼Œè¿™æ˜¯ä¸€ç§â€œåˆ—ç¼©æ”¾â€ã€‚</p><p>è€Œlayeræ–¹å‘ç›¸åï¼Œå®ƒé’ˆå¯¹çš„æ˜¯æ¯ä¸€è¡Œè¿›è¡Œç¼©æ”¾ã€‚å³åªçœ‹ä¸€ç¬”æ•°æ®ï¼Œç®—å‡ºè¿™ç¬”æ‰€æœ‰ç‰¹å¾çš„å‡å€¼ä¸æ–¹å·®å†ç¼©æ”¾ã€‚è¿™æ˜¯ä¸€ç§â€œè¡Œç¼©æ”¾â€ã€‚</p><p>Q: ä¸ºä»€ä¹ˆ gamma å’Œ beta è¿˜æ˜¯åŸæ¥çš„ (D, ) å½¢çŠ¶ï¼ŸLayer normalization åœ¨ RNN ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><p><img src="/archives/407bb789/image-20210707200112133.png" style="zoom: 67%;"></p><p>çœ‹å¾—å‡º layer normalization åœ¨è®­ç»ƒä¸Šä¹Ÿæ˜¯æœ‰ä¸€å®šä½œç”¨çš„ï¼Œä½†åœ¨å›¾åƒæ–¹é¢ç›¸æ¯”äº batch normalization æ•ˆæœå·®ä¸€ç‚¹ï¼Œå¦ä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„ç»“æœæ˜¯ï¼Œå¯¹äº layer normalization æ¥è¯´ hidden dimension å–è¾ƒå¤§å€¼è¾ƒå¥½</p><h2 id="Drop-out"><a href="#Drop-out" class="headerlink" title="Drop out"></a>Drop out</h2><p>ä¸¤è¡Œä»£ç è§£å†³ (inverted) dropout layer æ ¸å¿ƒ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">mask <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">input</span><span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token operator">&lt;</span> poutput <span class="token operator">=</span> <span class="token builtin">input</span> <span class="token operator">*</span> mask <span class="token operator">/</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>vallina dropout æ˜¯åœ¨ test æ—¶å°†è¾“å‡ºä¹˜ä»¥ p ä½¿å¾—è¾“å‡ºæ˜¯ä¸€ä¸ªåˆç†æœŸæœ›å€¼ã€‚ä½†å¦‚æœæˆ‘ä»¬åœ¨è®­ç»ƒçš„æ—¶å€™å·²ç»é™¤ä»¥ p äº†ï¼Œåœ¨æµ‹è¯•æ—¶å°±ä¸éœ€è¦ä½œä»»ä½•æ“ä½œã€‚ä¸‹å›¾ä¸ºæ­£åˆ™åŒ–æ•ˆæœ regularization</p><p><img src="/archives/407bb789/image-20210708160433242.png" style="zoom:67%;"></p><h2 id="Convolutional-Neural-Networks"><a href="#Convolutional-Neural-Networks" class="headerlink" title="Convolutional Neural Networks"></a>Convolutional Neural Networks</h2><ol><li><p>ç”¨åµŒå¥—å¾ªç¯å®ç°äº†æœ€åŸå§‹çš„å·ç§¯æ“ä½œï¼Œä½¿ç”¨ np.pad å‡½æ•°èƒ½å®ç° padding æ“ä½œï¼Œæ„Ÿè§‰è¿™ä¸ªå‡½æ•°çš„å‚æ•°ä¸æ˜¯é‚£ä¹ˆçµæ´»</p></li><li><p>è¿”å›æœ€å¤§å€¼åæ ‡ np.argmaxï¼Œå¦‚æœæƒ³è¦è¿”å›å¤šå…ƒåæ ‡è¿˜éœ€è¦ä½¿ç”¨ np.unravel_index è½¬åŒ–</p><p><code>np.unravel(indices, shape)</code></p></li><li><p>assignment æä¾›äº† fast_layers.py æ¥å®ç°å¿«é€Ÿå·ç§¯æ“ä½œï¼Œæ¯”æˆ‘è‡ªå·±å†™çš„å¾ªç¯ä»£ç è¦å¿« 1000 å¤šå€ï¼Œä½¿ç”¨äº† im2col æŠ€å·§ä»¥åŠ Cpython extension</p></li><li><p>ä¸ºä»€ä¹ˆåœ¨æ­£åˆ™åŒ–çš„æ—¶å€™æ­£åˆ™é¡¹ä¸­ä¸åŒ…æ‹¬åå·® b? ä¸ªäººç†è§£è®¤ä¸º b å¯¹äºæ­£åˆ™åŒ–çš„è´¡çŒ®å¹¶ä¸å¤§ï¼Œè€Œ w å‚æ•°åˆ™å æ®äº†ç»å¤§éƒ¨åˆ†çš„å‚æ•°ã€‚</p></li></ol><h3 id="Spatial-Batch-Normalization"><a href="#Spatial-Batch-Normalization" class="headerlink" title="Spatial Batch Normalization"></a>Spatial Batch Normalization</h3><p>è¿™æ˜¯å·ç§¯ç¥ç»ç½‘ç»œç‰¹æœ‰çš„ batch normalizationã€‚ä¹‹å‰ä½¿ç”¨çš„ batch normalization é¢å¯¹çš„æ˜¯ (N, D) å½¢çŠ¶çš„æ•°æ®ï¼Œä½†å·ç§¯è¿‡åå¾—åˆ°çš„è¾“å‡ºæ˜¯ç±»ä¼¼ (N, C, H, W) è¿™æ ·çš„å¤šç»´æ•°æ®ã€‚é‚£æˆ‘ä»¬åº”è¯¥æ€æ ·å»è®¡ç®—è¿™ä¸€æ‰¹æ•°æ®çš„ç»Ÿè®¡é‡ $\mu, \sigma$ å‘¢ï¼Ÿ</p><p>å¦‚æœæ²¿ç€ä¹‹å‰çš„æ€ç»´ï¼Œæˆ‘ä»¬åªæ²¿ç€æ ·æœ¬æ•°æ®è½´ N å»è®¡ç®— $\mu, \sigma$ </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># data.shape = (N, C, H, W)</span>mean <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>data<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>var  <span class="token operator">=</span> np<span class="token punctuation">.</span>var<span class="token punctuation">(</span>data<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™å°†ä¼šå¾—åˆ° (C, H, W) å½¢çŠ¶çš„ç»Ÿè®¡é‡ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå€¼ (c, h, w)ï¼Œå…¶æ ·æœ¬æ¥è‡ªäº N ä¸ªåƒç´ ç‚¹ï¼ˆåŒä¸€ channelï¼ŒåŒä¸€ä½ç½®ï¼‰ã€‚ä½†æˆ‘ä»¬å¸Œæœ›æ ·æœ¬çš„æ•°é‡æ›´å¹¿æ³›ä¸€äº›ï¼Œå…·ä½“ä¸€ç‚¹æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›æ ·æœ¬æ¥è‡ªäº N ä¸ª feature map (H, W)ï¼Œç”¨ numpy è¡¨ç¤ºä¸º</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># data.shape = (N, C, H, W)</span>mean <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>data<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>var <span class="token operator">=</span> np<span class="token punctuation">.</span>var<span class="token punctuation">(</span>data<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™å°†ä¼šå¾—åˆ° (C,) å½¢çŠ¶çš„ç»Ÿè®¡é‡ï¼Œå³ï¼šå¾—åˆ°äº†å¯¹äºæŸä¸€ä¸ª channel çš„ç»Ÿè®¡é‡ï¼Œè¿™æ˜¯åˆç†çš„ï¼Œå› ä¸ºåŒä¸€ä¸ª channel æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ª kernelã€‚è¿™æ ·æˆ‘ä»¬ä¸ä»…å¾—åˆ°äº†æ›´å¹¿æ³›æ ·æœ¬çš„ç»Ÿè®¡é‡ï¼Œè¿˜å‡å°‘äº†å‚æ•°æ•°é‡</p><p>å¦‚æœè¦ä½¿ç”¨ä¹‹å‰å†™çš„ batch_norm å‡½æ•°çš„è¯å¯ä»¥å°†æ•°æ®è½¬åŒ–ä¸º (N <em> H </em> W, C) ï¼Œåœ¨ numpy ä¸­ä½¿ç”¨ transpose + reshape å°±å¯ä»¥å®Œæˆ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> C<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Spatial-Group-Normalization"><a href="#Spatial-Group-Normalization" class="headerlink" title="Spatial Group Normalization"></a>Spatial Group Normalization</h3><p>ä¸€å¼ å›¾å±•ç¤ºBatch Normï¼Œ Layer Norm ï¼ŒGroup Normçš„åŒºåˆ«</p><p><img src="/archives/407bb789/image-20210710193505933.png" alt="image-20210710193505933"></p><p>Group Normå¯ä»¥ç†è§£ä¸ºåœ¨layer Normçš„åŸºç¡€ä¸Šï¼Œè¾“å…¥ç»´åº¦ä¸º (N, C, H, W)ï¼Œå¯¹Cè¿›è¡Œåˆ†ç»„ï¼Œå³ (N, G, C//G, H, W)ã€‚ä¸ºäº†å®Œæˆè¿™ä¸€éƒ¨åˆ†ï¼Œé‡æ–°æ€è€ƒäº†å¦‚ä½•åŸºäºç³»ç»Ÿè®¡ç®— back propagation</p><p><strong>å¯ä»¥ä»¥é‡è¦çš„ä¸­é—´å˜é‡ä¸ºèŠ‚ç‚¹ï¼Œæ ¹æ®è®¡ç®—å›¾é€æ­¥æ¨å¯¼æ¢¯åº¦ã€‚éš¾ç‚¹åœ¨äºæœ‰çŸ©é˜µå‚ä¸çš„è®¡ç®—ï¼Œç»å¸¸ä¼´éšç€çŸ©é˜µå½¢çŠ¶çš„æ”¹å˜ï¼Œåœ¨è¿›è¡Œ back propagation ä¸­ä¸€å®šè¦è®©æ¢¯åº¦è·Ÿç€è¿™äº›è®¡ç®—è¿›è¡Œå‡ç»´å’Œé™ç»´ï¼Œå¯ä»¥æƒ³è±¡ä¸ºæ¢¯åº¦ä¼šéšç€è¿™äº›èŠ‚ç‚¹å½¢çŠ¶çš„å˜åŒ–è¿›è¡Œå¤æ‚çš„æµåŠ¨ï¼Œæœ‰åˆ†æµ(ä¾‹å¦‚é™ç»´åº¦)ï¼Œä¹Ÿæœ‰æ±‡åˆ(ä¾‹å¦‚ broadcast)</strong></p><p>ä¾‹å¦‚ï¼Œåœ¨ forward pass ä¸­ broadcast ä¼šå°†çŸ©é˜µå‡ç»´ï¼Œsum ä¼šå°†çŸ©é˜µé™ç»´ï¼Œå¦‚æœåœ¨ backward pass ä¸­é‡åˆ° broadcast æ“ä½œæ—¶ï¼Œåˆ™éœ€è¦å°† upper_grad æ ¹æ®å¯¹åº”ç»´åº¦æ±‚å’Œï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦æ±‚ä¸‹é¢ X çš„æ¢¯åº¦çš„è¯ï¼Œä»£ç åº”è¯¥æ—¶è¿™æ ·çš„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># input: X, X.shape = (N, D)</span><span class="token comment"># f(X) = X - np.mean(X)</span><span class="token comment"># upper_grad = dout, dout.shape = (N, D)</span>dmean <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dout<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># sum broadcast dimension</span>dmean <span class="token operator">=</span> dmean <span class="token operator">/</span> N<span class="token comment"># mean operation back prop</span>dX <span class="token operator">=</span> dout <span class="token operator">-</span> dmean<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæƒ³ä¸ä½¿ç”¨è®¡ç®—å›¾ç›´æ¥æŒ‰ç…§ä¸€èˆ¬çš„çŸ©é˜µæ¢¯åº¦è®¡ç®—ï¼Œé‡åˆ°å¯¹çŸ©é˜µ/å‘é‡æ±‚å¯¼æ—¶ï¼Œå°±ä¼šå‡ºç°å¼ é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ç»´åº¦ä¼šå¢åŠ ï¼Œéœ€è¦ç†Ÿæ‚‰å¼ é‡çš„è¿ç®—åŠå…¶æ€ç»´ã€‚è¿˜æ˜¯å€Ÿç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œä½†æˆ‘ä»¬æŠŠå¹³å‡å€¼ä½œä¸º (N, D) å½¢çŠ¶æ¥çœ‹å¾…</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># input: X, X.shape = (N, D)</span><span class="token comment"># f(X) = X - np.mean(X) * np.ones(X.shape)</span><span class="token comment"># upper_grad = dout, dout.shape = (N, D)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><script type="math/tex; mode=display">\frac{\partial{loss}}{\partial{f(x)}} = doutï¼Œ\ f(x)=x-\mu\\\frac{\partial{f(x)}}{\partial{\mu}} = a\ ((N\times D) \times (N\times D))\ shape\ tensor\\\frac{\partial{loss}}{\partial{\mu}}=\frac{\partial{loss}}{\partial{f(x)}} Â·\frac{\partial{f(x)}}{\partial{\mu}}=dout\\\frac{\partial{\mu}}{\partial{x}} = a\ ((N\times D) \times (N\times D))\ shape\ tensor\\\frac{\partial{loss}}{\partial{x}}=\frac{\partial{loss}}{\partial{f(x)}}Â·\frac{\partial{f(x)}}{\partial{x}} - \frac{\partial{loss}}{\partial{f(x)}}Â·\frac{\partial{f(x)}}{\partial{\mu}}Â·\frac{\partial{\mu}}{\partial{x}}=dout -doutÂ·\frac{\partial{\mu}}{\partial{x}}</script><p>è¿™å°†æ˜¯ä¸€ç§æ™®é€‚çš„æ–¹æ³•ï¼Œæ›´åŠ æŠ½è±¡åŒ–ï¼Œèƒ½å¤Ÿå¤„ç†ä»»ä½•çš„çŸ©é˜µæ±‚å¯¼ï¼Œä½†ä¸æ¨èå®é™…ä¸­ä½¿ç”¨ã€‚</p><p>ä¸è®ºä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œæœ€æ ¸å¿ƒçš„è¿˜æ˜¯è¦ç†è§£æ¢¯åº¦æµåŠ¨çš„æœ¬è´¨â€”â€”æŸä¸€ä¸ªå˜é‡çš„å˜åŠ¨èƒ½å¤Ÿå¼•èµ·è¾“å‡ºå¤šå°‘å˜åŠ¨</p><h2 id="BUG"><a href="#BUG" class="headerlink" title="BUG"></a>BUG</h2><h3 id="Fully-Connected-Layer"><a href="#Fully-Connected-Layer" class="headerlink" title="Fully Connected Layer"></a>Fully Connected Layer</h3><p>ç°åœ¨å¡åœ¨äº† solver ä¸Š</p><p>ä¸èƒ½å¾—åˆ° overfitting çš„ç»“æœ</p><ol><li><p>å°è¯•æ›´æ¢ solver çœ‹èƒ½å¦å¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœ</p><p>å¤±è´¥äº†</p></li><li><p>å°è¯•ä½¿ç”¨2016çš„æ‰€æœ‰ç­”æ¡ˆï¼Œçœ‹æ˜¯å¦æ˜¯è‡ªå·±çš„ä»£ç å‡ºé—®é¢˜äº†</p><p>å¤±è´¥äº†</p><p>å°æŠ€å·§ Ctrl+r èƒ½å¤Ÿæ›´æ¢ pycharm ç›¸åŒå­—æ®µ</p></li><li><p>å°è¯•æ›´æ”¹ colab æœ¬èº«çš„æ–‡ä»¶ï¼Œä½¿ç”¨2016å¹´çš„colabæ–‡ä»¶</p><p>æˆåŠŸï¼ŒåŸå› åœ¨äº learning rate å¤ªå°äº†ï¼Œä¸èƒ½æ‰¾åˆ°å…¨å±€æœ€ä¼˜</p></li></ol><h3 id="Batch-normalization-1"><a href="#Batch-normalization-1" class="headerlink" title="Batch normalization"></a>Batch normalization</h3><ol><li><p>å¡åœ¨äº†è®¡ç®— back prop ä¸Š</p><p>æœ€åå‡ºç°çš„å¤±è¯¯è¿˜æ˜¯åœ¨äºæ¯ä¸€ä¸ªå…¬å¼å¿…é¡»è¦ç²¾ç¡®æ‰è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">norm_x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> sample_mean<span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>sample_var <span class="token operator">+</span> eps<span class="token punctuation">)</span>norm_x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> sample_mean<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>sample_var<span class="token punctuation">)</span> <span class="token operator">+</span> eps<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸Šé¢ä¸¤ä¸ªå¼å­è™½ç„¶åœ¨è®¡ç®—ç»“æœä¸Šç›¸å·®ä¸å¤šï¼Œä½†æ˜¯åœ¨ç½‘ç»œçš„è®¡ç®—ä¸­ï¼Œä¸€ç‚¹ç‚¹çš„è¯¯å·®ä¼ æ’­è¿‡åä¼šå˜å¾—è¶Šæ¥è¶Šå¤§</p></li><li><p>å°è¯•ä½¿ç”¨ jupyter è¿›è¡Œç¼–ç¨‹ï¼Œé‡åˆ°é—®é¢˜ï¼šThe kernel appears to have died. It will restart automatically</p><p>ä»¥ä¸ºæ˜¯ jupyter çš„é—®é¢˜ï¼Œä½†æµ‹è¯•äº†ä¸åŒçš„è½¯ä»¶éƒ½å‡ºé”™äº†ï¼Œæœ€ç»ˆå‘ç°æ˜¯è‡ªå·±ä»£ç çš„é—®é¢˜ï¼å½“æ‰¾äº†ä¸€åœˆæ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆæ—¶ï¼Œå¯èƒ½å°±è¦æ€€ç–‘è‡ªå·±äº†ï¼Œè€Œä¸æ˜¯æ€€ç–‘è½¯ä»¶å‡ºäº†é—®é¢˜ï¼ä¸è¿‡è¿™ä¹Ÿæœ‰å¥½å¤„ï¼Œè®©æˆ‘å†³å®šæ”¾å¼ƒä½¿ç”¨ pycharm è½¬æˆ˜ vs code</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ </category>
          
          <category> CS231N </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CS231N </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux/Windows å®‰è£…ç¬”è®°</title>
      <link href="/archives/53e3a160.html"/>
      <url>/archives/53e3a160.html</url>
      
        <content type="html"><![CDATA[<h1 id="å®‰è£…Linuxç¬”è®°"><a href="#å®‰è£…Linuxç¬”è®°" class="headerlink" title="å®‰è£…Linuxç¬”è®°"></a>å®‰è£…Linuxç¬”è®°</h1><h2 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><ol><li><p>å¦‚ä½•å®‰è£…åŒç³»ç»Ÿï¼šç§»æ­¥ <a href="https://www.bilibili.com/video/BV18W41137XB">bilibili</a>ï¼ˆå»ºè®®å®‰è£…æœ€æ–°ç‰ˆï¼Œç¾è§‚ä¸”ä½“éªŒæ›´å‹å¥½ï¼‰æˆ–è€…é˜…è¯» <a href="https://ubuntu.com/tutorials/install-ubuntu-desktop#1-overview">ubuntu å®˜æ–¹æ•™ç¨‹</a></p></li><li><p>è®¾ç½® root å¯†ç ã€‚ç„¶ååˆ›å»ºæ–°ç”¨æˆ·ï¼Œå¹¶è®¾ç½®æ–°ç”¨æˆ·å¯†ç ä»¥åŠ sudo æƒé™</p></li><li><p>ä¿®æ”¹ /etc/hostnameï¼Œreboot åæ°¸ä¹…æ›´æ”¹ä¸»æœºå</p></li><li><p>å¯èƒ½å‡ºç°å¯åŠ¨ windows çš„æ—¶å€™æœ‰ bitlockerï¼Œç¦ç”¨ bitlocker å®‰å…¨åè®®</p></li><li><p>é…ç½®ä»£ç† clashï¼Œä» youtube ä¸Šå­¦çš„ï¼ˆè¿·é€”å°ä¹¦ç«¥ï¼‰ï¼Œè¦ç‚¹å°±æ˜¯å°†é…ç½®æ–‡ä»¶ config.yaml å’Œ Country.mmdb ç§»åŠ¨åˆ° ~/.config/clash æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œé…ç½®æ–‡ä»¶é€šè¿‡ clash for windows ç”Ÿæˆï¼Œæ–‡ä»¶ç›®å½•ä¸º User/.config/clash(/profiles) ã€‚é€šè¿‡ clash dashboard åˆ‡æ¢èŠ‚ç‚¹ <a href="http://clash.razord.top/">http://clash.razord.top/</a></p><p>è®©Terminalèµ°ä»£ç†çš„æ–¹æ³•(desktopä¸Šçš„settingsä¸­è®¾å®šä¼šæ”¹å†™terminalç«¯ï¼Œä½¿ç”¨exportæ”¹å†™åˆ™ä¸ä¼šå½±å“desktop)ï¼Œå‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/46973701">çŸ¥ä¹é“¾æ¥</a></p></li><li><p>å®˜ç½‘ä¸‹è½½git anaconda chrome typora chrome baiduyun vscodeè½¯ä»¶å¹¶å®‰è£…</p><p>conda install, pip install ä¸‹è½½é€Ÿåº¦æ…¢æ—¶ï¼Œè¯·ä½¿ç”¨å›½å†…é•œåƒæºï¼Œä¾‹å¦‚ï¼š</p><ol><li><a href="https://mirrors.bfsu.edu.cn/help/anaconda/">åŒ—äº¬å¤–å›½è¯­å¤§å­¦é•œåƒæº</a>ï¼ˆæˆªè‡³2021/6/15ä¸‹è½½é€Ÿåº¦å¾ˆå¿«ï¼‰</li><li><a href="https://mirror.tuna.tsinghua.edu.cn/help/anaconda/">æ¸…åå¤§å­¦é•œåƒæº</a></li><li><a href="https://mirror.nju.edu.cn/help/anaconda">å—äº¬å¤§å­¦é•œåƒæº</a>ï¼ˆè‡ªå®¶çš„é•œåƒæºï¼Œå½“ç„¶è¦æ¨èä¸€ä¸‹ğŸ˜ï¼‰</li></ol></li><li><p>é…ç½®nvidia driver: æ ¹æ® <a href="https://zhuanlan.zhihu.com/p/59618999">çŸ¥ä¹é“¾æ¥</a> ï¼Œåœ¨å‘½ä»¤è¡Œé‡Œä¸‹è½½æ¨èçš„driverã€‚å¦‚æœåœ¨é…ç½®nvidia driverçš„è¿‡ç¨‹ä¸­å‡ºç°è¿æ¥ä¸ä¸Šæ˜¾å¡ï¼Œå¯èƒ½éœ€è¦å…³é—­ security bootã€‚å‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/336429888">ç¨šæ™–å›</a> çš„æ•™ç¨‹ï¼Œä¸‹è½½å®‰è£…CUDAï¼Œé€‰æ‹©runfileã€‚</p><p>å¦‚æœæƒ³ç§»é™¤æ‰€æœ‰cuda, cudnn, nvidia driver</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> remove --purge nvidia*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½® cuda path</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDA_HOME</span><span class="token operator">=</span>/usr/local/cuda<span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">${CUDA_HOME}</span>/lib64<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">${CUDA_HOME}</span>/bin:<span class="token variable">${<span class="token environment constant">PATH</span>}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ•™ç¨‹é‡Œè¿˜æ•™äº†å¦‚ä½•æ›´æ–°apt sourceä¸ºé˜¿é‡Œäº‘é•œåƒæºï¼Œé•œåƒä¸­çš„è½¯ä»¶ä¼šæŒç»­è€Œä¸”ä¸‹è½½é€Ÿåº¦å¾ˆå¿«ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©æ›´æ¢ä¸º <a href="https://mirror.nju.edu.cn/help/ubuntu">å—äº¬å¤§å­¦é•œåƒæº</a> å¦‚ä¸‹æ‰€ç¤ºã€‚åŒæ—¶æ•™ç¨‹é‡Œä¹Ÿè®¾ç½®äº† sudoï¼Œè®©æ¯ä¸€æ¬¡ sudo éƒ½ä¸éœ€è¦è¾“å…¥å¯†ç </p>  <pre class="line-numbers language-source.list" data-language="source.list"><code class="language-source.list"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Šdeb https://mirror.nju.edu.cn/ubuntu/ {{release_name}} main restricted universe multiverse# deb-src https://mirror.nju.edu.cn/ubuntu/ {{release_name}} main restricted universe multiversedeb https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-updates main restricted universe multiverse# deb-src https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-updates main restricted universe multiversedeb https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-backports main restricted universe multiverse# deb-src https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-backports main restricted universe multiversedeb https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-security main restricted universe multiverse# deb-src https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-security main restricted universe multiverse# é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨# deb https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-proposed main restricted universe multiverse# deb-src https://mirror.nju.edu.cn/ubuntu/ {{release_name}}-proposed main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯·æ ¹æ® Ubuntu ç‰ˆæœ¬è‡ªè¡Œæ›¿æ¢ </p></li></ol><div class="table-container"><table><thead><tr><th>ç‰ˆæœ¬</th><th><code>{{release_name}}</code></th></tr></thead><tbody><tr><td>Ubuntu 14.04 LTS</td><td>trusty</td></tr><tr><td>Ubuntu 16.04 LTS</td><td>xenial</td></tr><tr><td>Ubuntu 18.04 LTS</td><td>bionic</td></tr><tr><td>Ubuntu 20.04 LTS</td><td>focal</td></tr><tr><td>Ubuntu 20.10</td><td>groovy</td></tr><tr><td>Ubuntu 21.04</td><td>hirsute</td></tr></tbody></table></div><ol><li><p>pip install é‡åˆ°é—®é¢˜ enter your password to unlock your login keyring</p><p>è§£å†³æ–¹æ³•ï¼Œç›´æ¥cancelï¼Œæˆ–è€…åœ¨passwd and keyä¸­æ›´æ”¹å¯†ç </p></li></ol><h1 id="å®‰è£…-Windows-ç¬”è®°"><a href="#å®‰è£…-Windows-ç¬”è®°" class="headerlink" title="å®‰è£… Windows ç¬”è®°"></a>å®‰è£… Windows ç¬”è®°</h1><p>å®éªŒå®¤æœ‰ä¸€ä¸ªç©ºçš„ä¸»æœºï¼Œæ¯”è¾ƒè€ï¼Œæƒ³è¦é‡æ–°æ¸…ç†ä¸€ä¸‹è‡ªå·±ç”¨ã€‚æˆ‘å¹¶æ²¡æœ‰é€‰æ‹©é‡è£…æ•´ä¸ªç³»ç»Ÿï¼Œè€Œæ˜¯é€‰æ‹©é‡ç½®ï¼Œå³æ¢å¤å‡ºå‚è®¾ç½®</p><p>èµ„æºä¸‹è½½ï¼š<a href="https://msdn.itellyou.cn/">MSDN</a> <a href="https://rufus.ie/zh/">rufus</a> MSDN æä¾›äº†éœ€è¦çš„å„ä¸ª Windows ç‰ˆæœ¬çš„ isoï¼Œä½¿ç”¨ rufus å°† iso çƒ§å…¥åˆ°Uç›˜é‡Œ</p><p>æ•™ç¨‹ï¼š<a href="https://www.bilibili.com/video/BV1DJ411D79y/?spm_id_from=333.788.recommend_more_video.-1">bilibili</a></p><p>Windows æ¿€æ´»ï¼š<a href="https://github.com/TGSAN/CMWTAT_Digital_Edition/releases">github</a></p><p>github å¦‚æœä¸‹è½½ä¸å¤Ÿå¿«ï¼Œè‡ªè¡Œæœç´¢ github é•œåƒï¼Œè¿™é‡Œç•™ä¸€ä¸ªå‚è€ƒ <a href="https://ghproxy.com/">link</a></p><p>ç£ç›˜ç®¡ç†ï¼š<a href="https://www.bilibili.com/video/BV1Uj411f7wj">bilibili</a></p><p>Office ä¸‹è½½ï¼š<a href="https://otp.landian.vip/zh-cn/">Office Tool plus</a></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ•™ç¨‹ </tag>
            
            <tag> Linux </tag>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git æ•™ç¨‹</title>
      <link href="/archives/2121b11b.html"/>
      <url>/archives/2121b11b.html</url>
      
        <content type="html"><![CDATA[<h1 id="Git-reorganiszed-note"><a href="#Git-reorganiszed-note" class="headerlink" title="Git reorganiszed note"></a>Git reorganiszed note</h1><p>é‡æ–°æ•´ç†äº† git çš„å¸¸ç”¨æ“ä½œå‘½ä»¤ï¼Œèƒ½å¤Ÿè¦†ç›–å¤§éƒ¨åˆ†ç‰ˆæœ¬ç®¡ç†åœºæ™¯ï¼Œé€‚åˆä½œä¸ºæçº²è¿›è¡Œå¤ä¹ </p><p>æ•´ç†æ¥è‡ªï¼š<a href="https://www.bilibili.com/video/BV1FE411P7B3?from=search&amp;seid=1905221215711628694">bilibili</a> <a href="https://www.liaoxuefeng.com/wiki/896043488029600">å»–é›ªå³°æ•™ç¨‹</a></p><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>å½“é‡åˆ°å›½å¤–èµ„æºä¸‹è½½å¾ˆæ…¢çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨é•œåƒèµ„æº</p><p>è§†é¢‘é‡Œä½¿ç”¨äº†æ·˜å®é•œåƒå®‰è£… windows ç‰ˆæœ¬ <a href="https://npm.taobao.org/mirrors/">https://npm.taobao.org/mirrors/</a></p><p>ubuntu ç›´æ¥ä½¿ç”¨ <code>apt install git</code> ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒ</p><h2 id="Git-é…ç½®"><a href="#Git-é…ç½®" class="headerlink" title="Git é…ç½®"></a>Git é…ç½®</h2><p>é¦–å…ˆè¦ç†è§£çš„æ˜¯ï¼Œåœ¨windows ä¸­ git bash çš„åŸºæœ¬æ“ä½œå‘½ä»¤å’Œ Linux  terminal æ˜¯ä¸€æ ·çš„ã€‚åœ¨ Linux ä¸­ git æ˜¯é›†æˆåˆ° terminal å½“ä¸­çš„</p><h3 id="git-config"><a href="#git-config" class="headerlink" title="git  config"></a>git  config</h3><p>é…ç½®ç”¨æˆ·åå’Œé‚®ç®±</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">git</span> config --global user.name <span class="token string">'your_name'</span><span class="token function">git</span> config --global user.email <span class="token string">'***@qq.com'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¹‹åçš„æ‰€æœ‰æäº¤éƒ½ä¼šä½¿ç”¨ä½ çš„ç”¨æˆ·å’Œé‚®ç®±</p><p>è¿˜å¯ä»¥æ ¹æ®éœ€æ±‚é…ç½®ä»£ç†</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># è®¾ç½®ä»£ç†</span><span class="token function">git</span> config --global http.proxy http://127.0.0.1:1080<span class="token comment"># æŸ¥çœ‹ä»£ç†</span><span class="token function">git</span> config --global --get http.proxy<span class="token comment"># å–æ¶ˆä»£ç†</span><span class="token function">git</span> config --global --unset http.proxy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Git-åŸºæœ¬ç†è®º"><a href="#Git-åŸºæœ¬ç†è®º" class="headerlink" title="Git åŸºæœ¬ç†è®º"></a>Git åŸºæœ¬ç†è®º</h2><p>ç›´æ¥ä¸Šå›¾ï¼Œé‡ç‚¹å…³æ³¨å·¦ä¾§å‘½ä»¤</p><p><img src="/archives/2121b11b/image-20210628141830141.png" style="zoom:80%;"></p><p>ä»å·¥ä½œåŒº -&gt; æš‚å­˜åŒºï¼š<code>git add</code></p><p>ä»æš‚å­˜åŒº -&gt; æœ¬åœ°ä»“åº“ï¼š<code>git commit</code></p><p>ä»æœ¬åœ°ä»“åº“ -&gt; è¿œç¨‹ä»“åº“ï¼š<code>git push</code></p><p>è¿™ä¸‰ä¸ªå‘½ä»¤å°±èƒ½å¤Ÿè®©ä½ æ„Ÿå—åˆ° git ç‰ˆæœ¬æ§åˆ¶çš„åŸºæœ¬æµç¨‹</p><h2 id="Git-ä»“åº“æ­å»º"><a href="#Git-ä»“åº“æ­å»º" class="headerlink" title="Git ä»“åº“æ­å»º"></a>Git ä»“åº“æ­å»º</h2><h3 id="git-init-amp-git-clone"><a href="#git-init-amp-git-clone" class="headerlink" title="git init &amp; git clone"></a>git init &amp; git clone</h3><p>ç”Ÿæˆä»“åº“(master åˆ†æ”¯)çš„ä¸¤ç§æ–¹æ³•</p><ol><li><code>git init</code> åˆå§‹åŒ–ï¼Œç”Ÿæˆ .git æ–‡ä»¶</li><li><code>git clone url</code> å…‹éš†è¿œç¨‹ä»“åº“</li><li><code>git clone -b branch_name url</code> å…‹éš†æŒ‡å®šåˆ†æ”¯</li></ol><p>åˆ é™¤ä»“åº“åˆ™åªéœ€è¦åˆ é™¤ .git æ–‡ä»¶å¤¹å³å¯ã€‚å¦‚æœåœ¨ clone é¡¹ç›®çš„æ—¶å€™å‘ç°é€Ÿåº¦å¾ˆæ…¢ï¼Œæ¨èä½¿ç”¨å›½å†…çš„é•œåƒæºï¼Œå¦‚ï¼š<a href="https://gitclone.com/">gitclone</a> <a href="https://doc.fastgit.org/zh-cn/">fastgit</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">git</span> config --global url.<span class="token string">"https://hub.fastgit.org/"</span>.insteadOf <span class="token string">"https://github.com/"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Git-æ–‡ä»¶åŸºæœ¬æ“ä½œ"><a href="#Git-æ–‡ä»¶åŸºæœ¬æ“ä½œ" class="headerlink" title="Git æ–‡ä»¶åŸºæœ¬æ“ä½œ"></a>Git æ–‡ä»¶åŸºæœ¬æ“ä½œ</h2><h3 id="git-status"><a href="#git-status" class="headerlink" title="git status"></a>git status</h3><p><code>git status</code> æŸ¥çœ‹ git æ–‡ä»¶çŠ¶æ€ï¼Œ<code>git status file_name</code> å¯æŒ‡å®šæ–‡ä»¶</p><p>æ–‡ä»¶çš„å‡ ç§çŠ¶æ€ï¼š</p><ol><li>untracked æ–‡ä»¶åœ¨æ–‡ä»¶å¤¹ä¸­ï¼Œä»æ²¡æœ‰ add è¿‡</li><li>unmodify æ–‡ä»¶å·²ç» commit ä¸”åº“ä¸­æœ€æ–°ç‰ˆæœ¬å’Œå½“å‰æ–‡ä»¶æ˜¯ä¸€è‡´çš„ï¼Œå¯ä»¥é€šè¿‡ <code>git rm</code> å°†å…¶ç§»å‡ºç‰ˆæœ¬åº“ç®¡ç†</li><li>modified æ–‡ä»¶åœ¨ commit æˆ–è€… add è¿‡åæœ‰è¿‡ä¿®æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ <code>git checkout</code> ä¸¢å¼ƒä¿®æ”¹</li><li>staged (æ–‡ä»¶åœ¨ä¹‹å‰ commit è¿‡åæœ‰è¿‡ä¿®æ”¹) ç»è¿‡ addï¼Œæ²¡æœ‰ commit</li></ol><p>å½“å­˜åœ¨æ–‡ä»¶ä¸ºä¸­æ–‡å‘½åæ—¶ git status ä¼šæ˜¾ç¤ºä¸ºè½¬ä¹‰æ•°å­—ä¸²å½¢å¦‚ \351\237â€¦ è¿™æ ·çš„ä¹±ç è§£å†³æ–¹æ³•å¦‚ä¸‹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">git</span> config --global core.quotepath <span class="token boolean">false</span><span class="token comment"># core.quotepathçš„ä½œç”¨æ˜¯æ§åˆ¶è·¯å¾„æ˜¯å¦ç¼–ç æ˜¾ç¤ºçš„é€‰é¡¹, å½“å­—ç¬¦ä¸ºä¸­æ–‡æ—¶ä¼šè½¬ä¹‰è¾“å‡º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="gitignore"><a href="#gitignore" class="headerlink" title=".gitignore"></a>.gitignore</h3><p>æœ‰äº›æ—¶å€™æˆ‘ä»¬ä¸æƒ³æŠŠæŸäº›æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œå¯åœ¨ä¸»ç›®å½•ä¸‹å»ºç«‹ .gitignore æ–‡ä»¶ï¼Œä¾‹å¦‚ä½ ä¸è¯¦æŠŠ txt ç±»å‹æ–‡ä»¶è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ™åœ¨ .gitignore æ–‡ä»¶ä¸­å†™å…¥ *.txt å³å¯ï¼Œå…¶ä»–å…·ä½“è§„åˆ™ä¸ä½œä»‹ç»ï¼Œä¹Ÿæ¯”è¾ƒç®€å•ã€‚</p><h3 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h3><p><code>git add file_name</code> å°†æ–‡ä»¶åŠ å…¥æš‚å­˜åŒºï¼Œæ–‡ä»¶æˆä¸º staged çŠ¶æ€</p><p><code>git add .</code> å°†å½“å‰æ–‡ä»¶å¤¹ addï¼Œæ¯”è¾ƒæ–¹ä¾¿å¿«æ·</p><h3 id="git-commit"><a href="#git-commit" class="headerlink" title="git commit"></a>git commit</h3><p><code>git commit -m 'message content'</code> å°†æš‚å­˜åŒºæ‰€æœ‰æ–‡ä»¶åŠ å…¥åˆ°ç‰ˆæœ¬åº“ä¸­ï¼Œå¹¶ç•™ä¸‹æ­¤æ¬¡æäº¤çš„ message</p><p><code>git commit -am 'message content'</code> å°†åŒæ—¶å®Œæˆ <code>git add all</code>ï¼ˆå³å°†æ‰€æœ‰æ”¹åŠ¨æ–‡ä»¶åŠ å…¥æš‚å­˜åŒºï¼‰å’Œ <code>git commit</code> æ“ä½œ</p><p><code>git commit -amend</code> å¯ä»¥ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤çš„ commit message</p><h3 id="git-rm"><a href="#git-rm" class="headerlink" title="git rm"></a>git rm</h3><p><code>git rm --cached file_name</code> å°†å·²ç» commit çš„æ–‡ä»¶ä»ç‰ˆæœ¬åº“ä¸­ç§»é™¤å˜ä¸º untracked æ–‡ä»¶</p><p><code>git rm file_name</code> ä¸ä½¿ç”¨å‚æ•°åˆ™ä»£è¡¨å½»åº•åˆ é™¤è¯¥æ–‡ä»¶</p><h2 id="Git-ç‰ˆæœ¬å›é€€"><a href="#Git-ç‰ˆæœ¬å›é€€" class="headerlink" title="Git ç‰ˆæœ¬å›é€€"></a>Git ç‰ˆæœ¬å›é€€</h2><h3 id="git-log-amp-git-reflog"><a href="#git-log-amp-git-reflog" class="headerlink" title="git log &amp; git reflog"></a>git log &amp; git reflog</h3><p><code>git log</code> æŸ¥çœ‹ commit å†å²è®°å½•ï¼Œidï¼Œä½œè€…ç­‰ä¿¡æ¯</p><p><code>git reflog</code> æŸ¥çœ‹æ‰€æœ‰çš„æ“ä½œ</p><h3 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h3><p><code>git reset --hard commit_id</code> å°†å›é€€åˆ°æŸä¸€ä¸ª commit ç‰ˆæœ¬ï¼Œid åªç”¨å†™å‰å‡ ä½ï¼Œgit è‡ªåŠ¨è¯†åˆ«</p><p><code>git reset --hard HEAD^</code> å°†å›é€€åˆ°ä¸Šä¸€ä¸ª commit ç‰ˆæœ¬ï¼Œå¦‚æœå›é€€ä¸¤ä¸ªåˆ™æ˜¯ HEAD^^</p><p><code>--hard</code> å‚æ•°å…¶å®ä»£è¡¨å›é€€åˆ°æŸä¸ª commit åï¼Œè¯¥ commit ä¹‹åçš„è®°å½•éƒ½ä¼šè¢«ä¸¢å¼ƒã€‚ä½† git æ°¸è¿œéƒ½æœ‰åæ‚”è¯åƒï¼Œå¦‚æœå›é€€åˆ°ä»¥å‰çš„ç‰ˆæœ¬æƒ³è¦å†å›æ¥ï¼Œä½¿ç”¨ git reflog æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤</p><h3 id="git-checkout"><a href="#git-checkout" class="headerlink" title="git checkout"></a>git checkout</h3><p><code>git checkout filename</code> èƒ½å¤Ÿè®©æ–‡ä»¶å›åˆ°æœ€è¿‘ä¸€æ¬¡ add æˆ–è€… commit æ—¶çš„çŠ¶æ€</p><h2 id="åˆ†æ”¯ä¸å†²çª"><a href="#åˆ†æ”¯ä¸å†²çª" class="headerlink" title="åˆ†æ”¯ä¸å†²çª"></a>åˆ†æ”¯ä¸å†²çª</h2><h3 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a>git branch</h3><p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ›´åŠ æ·±å…¥ç†è§£ git çš„å·¥ä½œå½¢è±¡ï¼Œworking tree</p><p>é™¤äº† master åˆ†æ”¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºå…¶ä»–åˆ†æ”¯ï¼ŒHEAD æ‰€æŒ‡çš„å°±æ˜¯ working tree â€œç”Ÿé•¿â€çš„åœ°æ–¹ï¼Œç„¶åæˆ‘ä»¬å°†åˆ†æ”¯åˆå¹¶ï¼Œä¹Ÿå³è®© master â€œèµ¶ä¸Šæ¥â€ï¼Œå†åˆ é™¤ dev åˆ†æ”¯ã€‚git åˆ†æ”¯è¿˜æœ‰ä¸€ä¸ªä¸€èˆ¬è§„åˆ™æ˜¯ï¼Œmaster åˆ†æ”¯æ°¸è¿œæ˜¯æœ€ç¨³å®šçš„åˆ†æ”¯ï¼Œå¼€å‘éƒ½åœ¨ dev æˆ–å…¶ä»–åˆ†æ”¯ä¸Šè¿›è¡Œ</p><p><img src="/archives/2121b11b/branch_1.png" style="zoom: 50%;"></p><p><img src="/archives/2121b11b/branch_2.png" style="zoom: 50%;"></p><p><img src="/archives/2121b11b/branch_3.png" style="zoom:50%;"></p><p><code>git branch</code> å¯ä»¥æŸ¥çœ‹åˆ†æ”¯æƒ…å†µ</p><p><code>git branch -d branch_name</code> ç”¨äºåˆ é™¤åˆ†æ”¯</p><h3 id="git-switch"><a href="#git-switch" class="headerlink" title="git switch"></a>git switch</h3><p><code>git switch -c branch_name</code> ä½¿ç”¨ git swich æ¥åˆ›å»ºåˆ†æ”¯</p><p><code>git switch branch_name</code> ä½¿ç”¨ git swich æ¥åˆ‡æ¢åˆ†æ”¯</p><p><code>git switch -c branch_name origin/branch_name</code> åˆ›å»ºåˆ†æ”¯å¹¶å¤åˆ¶è¿œç¨‹çš„åˆ†æ”¯åˆ°æœ¬åœ°</p><h3 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a>git merge</h3><p><code>git merge branch_name</code> å°†æŸä¸ªåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯</p><p>å¦‚æœå‘ç”Ÿäº†å†²çªï¼šä¸¤ä¸ª branch ä¸­åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­æœ‰ä¸åŒçš„ä¿®æ”¹è€Œæ— æ³•åˆå¹¶ï¼Œé‚£ä¹ˆéœ€è¦è§£å†³å†²çªã€‚ï¼ˆåˆ¤æ–­æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹ï¼Œæ˜¯æ ¹æ® commit id ä¹‹ç±»çš„æ ‡è®°èŠ‚ç‚¹æ¥åˆ¤æ–­çš„ï¼Œä½†æ˜¯å¦å­˜åœ¨å†²çªåˆ™æ˜¯æ ¹æ®æ–‡ä»¶çš„å†…å®¹ï¼‰</p><p><img src="/archives/2121b11b/branch_4.png" style="zoom:50%;"></p><p>å…ˆä½¿ç”¨ <code>git status</code> æŸ¥çœ‹å“ªä¸ªæ–‡ä»¶å‘ç”Ÿå†²çªï¼Œç„¶åä½¿ç”¨ vim ç¼–è¾‘ï¼Œgit ä¼šè‡ªåŠ¨åœ¨æ–‡æ¡£ä¸­æ ‡æ˜å†²çªçš„åœ°æ–¹ã€‚æ€æ ·ä¿®æ”¹æ— æ‰€è°“ï¼Œåªè¦ä½  add &amp; commit è¿‡åï¼Œgit å°±ä¼šé»˜è®¤å†²çªè§£å†³ï¼Œå¹¶å°†ä½ çš„æ–‡ä»¶ä½œä¸ºæœ€æ–°çš„ç‰ˆæœ¬åŠ å…¥ç‰ˆæœ¬åº“ä¸­ï¼Œæ›´æ–° working tree</p><p>å¦‚æœå¯¹äº git ä¸­ recursive 3-way merge ç®—æ³•æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚çœ‹ <a href="https://en.wikipedia.org/wiki/Merge_(version_control">ç»´åŸºç™¾ç§‘</a>)</p><h2 id="è¿œç¨‹ä»“åº“"><a href="#è¿œç¨‹ä»“åº“" class="headerlink" title="è¿œç¨‹ä»“åº“"></a>è¿œç¨‹ä»“åº“</h2><h3 id="æ·»åŠ è¿œç¨‹ä»“åº“-github-or-gitee"><a href="#æ·»åŠ è¿œç¨‹ä»“åº“-github-or-gitee" class="headerlink" title="æ·»åŠ è¿œç¨‹ä»“åº“ github or gitee"></a>æ·»åŠ è¿œç¨‹ä»“åº“ github or gitee</h3><p>gitee ä¸ºå›½å†…ç½‘ç«™ï¼Œä¼ è¾“é€Ÿåº¦æ›´å¿«ã€‚é€šè¿‡ä»¥ä¸‹æ­¥éª¤å°†æœ¬æœºä¸è¿œç¨‹è¿æ¥ï¼ˆä»¥ github ä¸ºä¾‹ï¼‰ï¼š</p><ol><li><p>æ³¨å†Œ github è´¦å·</p></li><li><p>ç”Ÿæˆ ssh å…¬é’¥</p><ol><li><p>åœ¨æœ¬æœº user ç›®å½•ä¸‹æ‰¾åˆ° ssh æ–‡ä»¶å¤¹ï¼ˆå®‰è£… git è¿‡åè¿™ä¸ªæ–‡ä»¶å¤¹ä¼šè‡ªåŠ¨ç”Ÿæˆï¼‰</p></li><li><p>åœ¨ shell ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ ssh å¯†é’¥ï¼Œå…¶ä¸­ rsa æ˜¯ä¸€ç§åŠ å¯†ç®—æ³• </p><p><code>ssh-keygen -t rsa</code></p><p>ä¹‹åä½ å°±èƒ½åœ¨ .ssh æ–‡ä»¶ä¸­æ‰¾åˆ° id_rsa å’Œ id_rsa.pub æ–‡ä»¶</p></li></ol></li><li><p>æ·»åŠ  id_rsa.pub åˆ° github è´¦æˆ·è®¾ç½®ä¸­</p></li></ol><p>è¿™æ ·å°±æŠŠæœ¬æœºå’Œè¿œç¨‹ä»“åº“è¿æ¥èµ·æ¥äº†ï¼Œå…·ä½“çš„è¯´æ˜¯å°†æœ¬æœºä¸ä½ çš„ github è´¦å·é€šè¿‡ ssh è¿æ¥èµ·æ¥äº†</p><h3 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h3><p>ä½ çš„è´¦å·é‡Œå¯ä»¥æœ‰å¾ˆå¤šçš„ä»“åº“ï¼Œæˆ‘ä»¬æƒ³è¦å°†æœ¬åœ°ä»“åº“ä¸æŸä¸€ä¸ªæŒ‡å®šä»“åº“é“¾æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯</p><p><code>git remote add origin [url]</code></p><p>è¿œç¨‹ä»“åº“çš„åå­—å« originï¼Œè¿™æ˜¯ git çš„é»˜è®¤å«æ³•ï¼Œurl æ˜¯ä»“åº“çš„ https æˆ–è€… ssh</p><p><code>git remote -v</code> æŸ¥çœ‹æ·»åŠ çš„è¿œç¨‹ä»“åº“ï¼Œ<code>-v</code> ä»£è¡¨ verbose æ¨¡å¼ï¼Œè¯¥ä¸å¸¦å‚æ•°ä»…è¿”å›è¿œç¨‹ä»“åº“çš„åå­— <code>origin</code> </p><p><code>git remote remove origin</code> ç§»é™¤ä¸è¿œç¨‹ä»“åº“çš„é“¾æ¥</p><h3 id="git-push"><a href="#git-push" class="headerlink" title="git push"></a>git push</h3><p>æŠŠæœ¬åœ°åº“çš„å†…å®¹æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤</p><p><code>git push -u orgin master</code></p><p>è¿™æ ·å°±æŠŠæœ¬åœ° master åˆ†æ”¯å†…å®¹æ¨é€åˆ°äº†è¿œç¨‹çš„ master åˆ†æ”¯ã€‚-u å‚æ•°ä¸º set upstream çš„æ„æ€ï¼Œåœ¨æ¨é€çš„åŒæ—¶å°†æˆ‘ä»¬çš„æœ¬åœ° master åˆ†æ”¯å’Œè¿œç¨‹ master åˆ†æ”¯è”ç³»èµ·æ¥ï¼ˆç›¸å½“äºä½œäº† <code>git branch -u origin/master</code> ï¼‰ï¼Œä»Šååˆ™å¯ä»¥ç›´æ¥è¾“å…¥ git push æ¥ç®€åŒ–æ¨é€å‘½ä»¤ï¼Œå¼ºçƒˆå»ºè®®åœ¨ç¬¬ä¸€æ¬¡ push çš„æ—¶å€™å¸¦ä¸Š -u å‚æ•°</p><p>å…¶ä»–æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„ push å’Œè¿æ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼ŒæŠŠä¸Šé¢å‘½ä»¤çš„ master æ”¹ä¸ºå¯¹åº”åˆ†æ”¯çš„åå­—ï¼ˆä¾‹å¦‚ï¼šdev åˆ†æ”¯ï¼‰å³å¯ï¼Œå‰ææ˜¯æœ¬åœ°è¦åˆ‡æ¢åˆ°é‚£ä¸ªåˆ†æ”¯ï¼Œä¸”è¿œç¨‹å­˜åœ¨åŒåçš„åˆ†æ”¯</p><p>ä¸ªäººè®¤ä¸º <code>git push</code> ä¸€èˆ¬æ˜¯åœ¨åŒåçš„æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯ä¹‹é—´è¿›è¡Œ</p><h3 id="git-pull"><a href="#git-pull" class="headerlink" title="git pull"></a>git pull</h3><p>æ–‡ä»¶å†²çªä¸ä»…å‡ºç°åœ¨æœ¬åœ°çš„ merge å½“ä¸­ï¼Œä¹Ÿå­˜åœ¨åœ¨ push æ“ä½œå½“ä¸­ã€‚push çš„æœ¬è´¨ä¹Ÿæ˜¯å°†æœ¬åœ°å’Œè¿œç¨‹è¿™ä¸¤ä¸ª branch è¿›è¡Œèåˆã€‚å½“è¿™ä¸ªè¿œç¨‹ä»“åº“åªæœ‰ä½ ä¸€ä¸ªäººåœ¨ push æ—¶ï¼Œæ˜¯ä¸ä¼šæœ‰å†²çªçš„ï¼Œå› ä¸ºè¿œç¨‹çš„ working tree åªä¼šä¸€ç›´å¾€å‰å»¶ä¼¸ï¼›å½“æœ‰å¤šä¸ªäººéƒ½åœ¨å¯¹æŸä¸€ä¸ªæ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œworking tree å°±ç›¸å½“äºæœ‰äº†å¤šä¸ªåˆ†æ”¯ï¼Œåœ¨ push çš„æ—¶å€™å°±ä¼šå½¢æˆå†²çªã€‚å¦‚æœæœ‰è¿œç«¯çš„å†²çªå½¢æˆï¼Œå°±éœ€è¦ä½¿ç”¨ <code>git pull</code></p><p><code>git pull</code> æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€ä¸ªæ˜¯æ‹‰å–ä»£ç åˆ°æœ¬åœ°ï¼Œå¦ä¸€ä¸ªæ˜¯å°è¯•ä¸æœ¬åœ°ä»£ç åˆå¹¶ï¼Œå¦‚æœä¸èƒ½ä½¿ç”¨ fast forward åˆå¹¶ï¼Œåˆ™éœ€è¦è‡ªå·±æ¥ä¿®æ”¹å†²çªéƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†å’Œ <code>git merge</code> æ˜¯ä¸€æ ·çš„</p><h3 id="æ­å»ºè‡ªå·±çš„è¿œç¨‹ä»“åº“"><a href="#æ­å»ºè‡ªå·±çš„è¿œç¨‹ä»“åº“" class="headerlink" title="æ­å»ºè‡ªå·±çš„è¿œç¨‹ä»“åº“"></a>æ­å»ºè‡ªå·±çš„è¿œç¨‹ä»“åº“</h3><blockquote><p>è¿œç¨‹ä»“åº“å®é™…ä¸Šå’Œæœ¬åœ°ä»“åº“æ²¡å•¥ä¸åŒï¼Œçº¯ç²¹ä¸ºäº†7x24å°æ—¶å¼€æœºå¹¶äº¤æ¢å¤§å®¶çš„ä¿®æ”¹ã€‚GitHubå°±æ˜¯ä¸€ä¸ªå…è´¹æ‰˜ç®¡å¼€æºä»£ç çš„è¿œç¨‹ä»“åº“ã€‚ä½†æ˜¯å¯¹äºæŸäº›è§†æºä»£ç å¦‚ç”Ÿå‘½çš„å•†ä¸šå…¬å¸æ¥è¯´ï¼Œæ—¢ä¸æƒ³å…¬å¼€æºä»£ç ï¼Œåˆèˆä¸å¾—ç»™GitHubäº¤ä¿æŠ¤è´¹ï¼Œé‚£å°±åªèƒ½è‡ªå·±æ­å»ºä¸€å°GitæœåŠ¡å™¨ä½œä¸ºç§æœ‰ä»“åº“ä½¿ç”¨ã€‚</p></blockquote><p>ä¾æ—§æ˜¯å‚è€ƒ <a href="https://www.liaoxuefeng.com/wiki/896043488029600/899998870925664">å»–é›ªå³°æ•™ç¨‹</a>ï¼Œä¸è¿‡è‡ªå·±åœ¨å®ç°æ—¶æœ‰ä¸€äº›åŒºåˆ«ã€‚åœ¨è¿›è¡Œ git clone æ“ä½œæ—¶ï¼Œå…‹éš†çš„é“¾æ¥ä¸åº”è¯¥ä½¿ç”¨ç»å¯¹è·¯å¾„ <code>git clone git@server:/srv/sample.git</code> åº”è¯¥å»æ‰ç¬¬ä¸€ä¸ªæ–œæ  <code>git clone git@server:srv/sample.git</code></p><h2 id="Git-IDE"><a href="#Git-IDE" class="headerlink" title="Git + IDE"></a>Git + IDE</h2><p>ç°åœ¨ git å’Œå¾ˆå¤š IDE éƒ½æœ‰è”åŠ¨ï¼Œå¯ä»¥ç›´æ¥åœ¨ IDE ä¸­æ–¹ä¾¿çš„æ“ä½œ gitï¼Œç”šè‡³å°† git å¯è§†åŒ–ï¼Œå¯ä»¥ç›´è§‚çœ‹åˆ°ä½ å¯¹æ–‡ä»¶çš„ä¿®æ”¹</p><p>ä»¥ pycharm å’Œ vscode ä¸ºä¾‹ï¼Œåªè¦åœ¨ä½ çš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æœ‰ .git æ–‡ä»¶å³å¯ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ git init æ–°å»º </p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-theme-matery æ•™ç¨‹</title>
      <link href="/archives/b129f5ae.html"/>
      <url>/archives/b129f5ae.html</url>
      
        <content type="html"><![CDATA[<h1 id="hexo-theme-matery-note"><a href="#hexo-theme-matery-note" class="headerlink" title="hexo-theme-matery note"></a>hexo-theme-matery note</h1><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>å‚è€ƒåŸ github é¡¹ç›®è¿›è¡Œæ•´ç†ï¼š<a href="https://github.com/blinkfox/hexo-theme-matery">https://github.com/blinkfox/hexo-theme-matery</a></p><h3 id="config-yml-çš„ä¿®æ”¹å»ºè®®"><a href="#config-yml-çš„ä¿®æ”¹å»ºè®®" class="headerlink" title="_config.yml çš„ä¿®æ”¹å»ºè®®"></a>_config.yml çš„ä¿®æ”¹å»ºè®®</h3><p>åœ¨ hexo æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ä¸­ï¼š</p><ol><li><p>åˆ‡æ¢ theme ä¸º hexo-theme-matery</p></li><li><p>url æ”¹ä¸ºç½‘ç«™ url (å¦‚ï¼š<a href="http://xxx.github.io">http://xxx.github.io</a>)</p></li><li><p>per_page æ•°å€¼æ”¹ä¸º6åŠ6çš„å€æ•°ï¼Œè¿™æ ·æ–‡ç« åˆ—è¡¨åœ¨å„ä¸ªå±å¹•ä¸‹éƒ½èƒ½è¾ƒå¥½æ˜¾ç¤º</p></li><li><p>æ’å…¥å›¾ç‰‡ï¼ˆæœ‰ç‚¹å¤æ‚ï¼Œå¯ä»¥å…ˆè·³è¿‡ï¼‰ã€‚æ ¹æ® <a href="https://zhuanlan.zhihu.com/p/265077468">çŸ¥ä¹é“¾æ¥</a> é…ç½®å¥½ post_asset_folderï¼Œé‡Œé¢æåˆ°çš„ typora æŠ€å·§ä¹Ÿå¾ˆå®ç”¨ï¼Œå»ºè®®é‡‡ç”¨ã€‚ä¸”ä¸€èˆ¬æ¥è®²é“¾æ¥ä¸­æåˆ°çš„ hexo-renderer-marked æ’ä»¶éƒ½æ˜¯å·²ç»å†…ç½®å¥½çš„ï¼Œä¸ç„¶ä½ çš„åšå®¢ä¸ä¼šæ¸²æŸ“æˆåŠŸã€‚</p><p>ä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸èƒ½æ§åˆ¶å›¾ç‰‡å¤§å°ï¼Œè€Œä¸”é…ç½®è¿‡ typora åè¿˜è¦å†æ”¹å›¾ç‰‡çš„è·¯å¾„ã€‚æˆ‘å†ä¸‹è½½äº† hexo-asset-image æ’ä»¶è¿‡åï¼Œç›´æ¥ç”¨ typora ä¸­çš„ html æ–¹æ³• <code>&lt;img src='post_name/img.jpg'&gt;</code>å¼•ç”¨å›¾ç‰‡ï¼Œä¸éœ€è¦äºŒæ¬¡æ›´æ”¹è·¯å¾„</p></li></ol><h3 id="æ–°å»ºåˆ†ç±»-categories-é¡µ"><a href="#æ–°å»ºåˆ†ç±»-categories-é¡µ" class="headerlink" title="æ–°å»ºåˆ†ç±» categories é¡µ"></a>æ–°å»ºåˆ†ç±» categories é¡µ</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hexo new page <span class="token string">'categories'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>categories é¡µæ˜¯ç”¨æ¥å±•ç¤ºæ‰€æœ‰åˆ†ç±»çš„é¡µé¢</p><p>ä¿®æ”¹ <code>/source/categories/index.md</code> æ–‡ä»¶çš„ front-matter (Front-matter æ˜¯æ–‡ä»¶æœ€ä¸Šæ–¹ä»¥ â€”- åˆ†éš”çš„åŒºåŸŸï¼Œç”¨äºæŒ‡å®šä¸ªåˆ«æ–‡ä»¶çš„å˜é‡)</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">---title: categoriesdate: <span class="token number">2018</span>-09-30 <span class="token number">17</span>:25:30type: <span class="token string">"categories"</span>layout: <span class="token string">"categories"</span>---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…³äº page å’Œ post çš„åŒºåˆ«ï¼šä¸¤è€…å…¶å®å¾ˆç›¸ä¼¼ï¼Œä½ å¯ä»¥æŠŠ page çœ‹ä½œæ˜¯ç‰¹æ®Šçš„ postï¼Œç”¨æ¥æ”¾ç½®ä¸€äº›ç‰¹æ®Šå†…å®¹ï¼šå¦‚åˆ†ç±»ã€æ ‡ç­¾ç­‰ç­‰ã€‚</p><p>hexo çš„åˆ†ç±»æ˜¯æœ‰ç­‰çº§å…³ç³»çš„ï¼Œæˆ‘ä»¬ä»¥ä¸‹é¢çš„ post front-matter ä¸ºä¾‹</p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">title: æˆ‘çš„åšå®¢æ­å»ºç¬”è®°date: 2021-06-29 15:26:41tags:<span class="token list punctuation">-</span> hexo<span class="token list punctuation">-</span> åšå®¢æ­å»ºcategories:<span class="token list punctuation">-</span> è½¯ä»¶åŸºç¡€<span class="token list punctuation">-</span> hexo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ–‡ä»¶åœ¨åˆ†ç±»æ—¶ä¼šè¢«åˆ†é…åˆ°æ‰€æœ‰æåˆ°çš„ categories ä¸­ï¼Œè¿™äº› categories çš„è·¯å¾„æ˜¯é€æ¸å¾€ä¸‹çš„ <code>/categories/è½¯ä»¶åŸºç¡€/hexo/</code>ï¼Œå®ƒä»¬éƒ½æœ‰è‡ªå·±çš„ page æ¥æ”¶çº³å±äºè‡ªå·±ç±»åˆ«çš„æ–‡ç« ã€‚</p><h3 id="æ–°å»ºæ ‡ç­¾-tags-é¡µ"><a href="#æ–°å»ºæ ‡ç­¾-tags-é¡µ" class="headerlink" title="æ–°å»ºæ ‡ç­¾ tags é¡µ"></a>æ–°å»ºæ ‡ç­¾ tags é¡µ</h3><p>æ–°å»º page</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">hexo new page <span class="token string">"tags"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹å¯¹åº” index.md</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">---title: tagsdate: <span class="token number">2018</span>-09-30 <span class="token number">18</span>:23:38type: <span class="token string">"tags"</span>layout: <span class="token string">"tags"</span>---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»™ post æŒ‡å®š tags åªéœ€è¦åœ¨ front-matter ä¸­å†™å¥½å°±è¡Œäº†ï¼Œå¦‚ä¸Šé¢ categories çš„ä¾‹å­ã€‚</p><h3 id="æ–°å»ºå…³äºæˆ‘-about-é¡µ"><a href="#æ–°å»ºå…³äºæˆ‘-about-é¡µ" class="headerlink" title="æ–°å»ºå…³äºæˆ‘ about é¡µ"></a>æ–°å»ºå…³äºæˆ‘ about é¡µ</h3><h3 id="æ–°å»ºç•™è¨€æ¿-contact-é¡µ"><a href="#æ–°å»ºç•™è¨€æ¿-contact-é¡µ" class="headerlink" title="æ–°å»ºç•™è¨€æ¿ contact é¡µ"></a>æ–°å»ºç•™è¨€æ¿ contact é¡µ</h3><h3 id="æ–°å»ºå‹æƒ…é“¾æ¥-friends-é¡µ"><a href="#æ–°å»ºå‹æƒ…é“¾æ¥-friends-é¡µ" class="headerlink" title="æ–°å»ºå‹æƒ…é“¾æ¥ friends é¡µ"></a>æ–°å»ºå‹æƒ…é“¾æ¥ friends é¡µ</h3><p>æ–°å»ºæ–¹æ³•éƒ½æ˜¯å’Œä¸Šé¢çš„æ–¹æ³•ä¸€æ ·çš„</p><h2 id="èœå•å¯¼èˆªé…ç½®ä¸æ¸²æŸ“"><a href="#èœå•å¯¼èˆªé…ç½®ä¸æ¸²æŸ“" class="headerlink" title="èœå•å¯¼èˆªé…ç½®ä¸æ¸²æŸ“"></a>èœå•å¯¼èˆªé…ç½®ä¸æ¸²æŸ“</h2><h3 id="åç§°ã€è·¯å¾„ã€å›¾æ ‡"><a href="#åç§°ã€è·¯å¾„ã€å›¾æ ‡" class="headerlink" title="åç§°ã€è·¯å¾„ã€å›¾æ ‡"></a>åç§°ã€è·¯å¾„ã€å›¾æ ‡</h3><p>é…ç½®èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlã€å’Œå›¾æ ‡iconï¼Œé…ç½®æ–‡ä»¶åœ¨ <code>themes/hexo-theme-matery/._config.yml</code></p><p>æ›´æ”¹ menu éƒ¨åˆ†å³å¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">menu:  <span class="token comment"># æŠŠ Index æ”¹ä¸º Home</span>  Home:    url: /    icon: fas fa-home  Tags:    url: /tags    icon: fas fa-tags<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯è¯¥çš„éƒ¨åˆ†ï¼š</p><ol><li>åç§°å¯ä»¥æ˜¯ä¸­æ–‡</li><li>å›¾æ ‡å¯ä»¥åœ¨ <a href="https://fontawesome.com/icons">Font Awesome</a> ä¸­æŸ¥æ‰¾</li><li>è¿˜å¯ä»¥ä½¿ç”¨äºŒçº§èœå•ã€‚äºŒçº§èœå•åœ¨å®ç°ä¸Šå¯ä»¥ç†è§£ä¸ºåˆ›å»ºäº†ä¸€ä¸ªè½¯é“¾æ¥ï¼Œåˆ°ä½ æŒ‡å®šçš„ page ä¸Šã€‚</li></ol><p>ç”±äºæˆ‘å¯¹äºè¿™ä¸ªå¯¼èˆªè¿˜æ˜¯æ¯”è¾ƒæ»¡æ„ï¼Œå°±ä¸ä½œè¿‡å¤šä¿®æ”¹</p><h3 id="ä¿®æ”¹é¡µè„š"><a href="#ä¿®æ”¹é¡µè„š" class="headerlink" title="ä¿®æ”¹é¡µè„š"></a>ä¿®æ”¹é¡µè„š</h3><p>é¡µè„šä¿¡æ¯å¯èƒ½éœ€è¦åšå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œä¿®æ”¹çš„åœ°æ–¹åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/layout/_partial/footer.ejs</code> æ–‡ä»¶ä¸­ï¼ŒåŒ…æ‹¬ç«™ç‚¹ã€ä½¿ç”¨çš„ä¸»é¢˜ã€è®¿é—®é‡ç­‰ã€‚</p><p>ç”±äºä»£ç çœ‹ä¸æ˜ç™½ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„ <a href="https://sunhwee.com/posts/6e8839eb.html">æ•™ç¨‹</a>ã€‚æ ¹æ®æ•™ç¨‹ä¿®æ”¹äº†ç‰ˆæƒä¿¡æ¯ï¼Œå¢åŠ äº†ç½‘ç«™è¿è¡Œæ—¶é—´ï¼Œè®¿é—®äººæ•°çš„ä»£ç ç›®å‰ä¸éœ€è¦ä¿®æ”¹</p><h3 id="ä»£ç é«˜äº®"><a href="#ä»£ç é«˜äº®" class="headerlink" title="ä»£ç é«˜äº®"></a>ä»£ç é«˜äº®</h3><p>ä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹ <code>_config.yml</code> æ–‡ä»¶ä¸­ <code>highlight.enable</code> çš„å€¼ä¸º <code>false</code>ï¼Œå¹¶å°† <code>prismjs.enable</code> çš„å€¼è®¾ç½®ä¸º <code>true</code></p><p>ä»¥ä¸Šçš„è®¾ç½®å¹¶ä¸ç®¡ç”¨ï¼Œæ²¡æœ‰é«˜äº®ä¹Ÿæ²¡æœ‰è¡Œå·</p><p>ä½†æ˜¯æˆ‘ä¸‹è½½äº† hexo-prism-plugin åˆå¸è½½æ‰è¿™ä¸ªæ’ä»¶ï¼Œå°±æœ‰é«˜äº®äº†ï¼Œä½†ä¾æ—§æ²¡æœ‰è¡Œå·</p><p>è€ƒè™‘æ˜¯ matery.css æ–‡ä»¶ä¸­ pre ä¸‹ paddidng ä¸å¤Ÿå¤§çš„é—®é¢˜ï¼Œå¢åŠ  padding ä½†ä¾ç„¶æ²¡èƒ½è§£å†³</p><p>è€ƒè™‘æ˜¯ä¸æ˜¯æœ¬èº« prism æ–‡ä»¶å‡ºäº†é—®é¢˜ï¼Œé‡æ–°åˆ°å®˜ç½‘ä¸Šä¸‹è½½äº† prism.js å’Œ prism.css æ›¿æ¢åŸæ¥ç³»ç»Ÿä¸­å¯¹åº”çš„æ–‡ä»¶ï¼ŒåŒæ—¶è°ƒæ•´ä¸Šé¢æåˆ°çš„ padding å‚æ•°ï¼Œæœ€åæˆåŠŸï¼</p><p>prism.js æ–‡ä»¶ä½ç½®åœ¨ <code>node_modules/prismjs</code></p><p>prism.css æ–‡ä»¶ä½ç½®åœ¨ <code>themes/hexo-theme-matery/source/libs/prism</code></p><p>ç°åœ¨æƒ³è¦å»é™¤éš”ç¦»çš„é‚£æ¡ç«–çº¿ï¼Œå°è¯•é‡å¤ <a href="https://github.com/blinkfox/hexo-theme-matery/issues/103">github issue</a> çš„æ“ä½œï¼Œæ“ä½œè¿‡åç«–çº¿æ²¡æœ‰å»é™¤ï¼Œä¸è¿‡ç¨å¾®è°ƒæ•´äº†ä¸€ä¸‹ä»£ç ä½ç½®ï¼Œä¹ŸæŒºå¥½çœ‹</p><p>æœ€ç»ˆï¼Œæˆ‘é€šè¿‡ä¿®æ”¹ prism.css ä¸­ border-right ä¸º 0pxï¼Œå»é™¤äº†è¡Œå·å’Œä»£ç ä¹‹é—´çš„åˆ†éš”çº¿ï¼</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.line-numbers .line-numbers-rows</span> <span class="token punctuation">{</span><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span> -0.2em<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span> -3.8em<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span> 3em<span class="token punctuation">;</span> <span class="token comment">/* works for line-numbers below 1000 lines */</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span> -1px<span class="token punctuation">;</span><span class="token property">border-right</span><span class="token punctuation">:</span> 0px solid #999<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç°åœ¨è§£å†³æ ‡å·å’Œ code æ²¡å¯¹é½çš„é—®é¢˜ï¼Œä¿®æ”¹ prism.css æ–‡ä»¶ä¸­ <code>.line-numbers .line-numbers-rows</code> ä¸‹ top å‚æ•°ä¸º -0.2emï¼Œå¾®è°ƒæˆåŠŸï¼æ²»å¥½äº†å¼ºè¿«ç—‡ï¼</p><h3 id="æ¸²æŸ“è¡¨æ ¼"><a href="#æ¸²æŸ“è¡¨æ ¼" class="headerlink" title="æ¸²æŸ“è¡¨æ ¼"></a>æ¸²æŸ“è¡¨æ ¼</h3><p>hexo å¯¹è¡¨æ ¼çš„æ¸²æŸ“ä¸ typora æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ­£æ–‡å’Œè¡¨æ ¼éœ€è¦é—´éš”ä¸¤è¡Œã€‚è€Œä¸” hexo å¹¶ä¸ä¼šæ˜¾ç¤ºåŒæ‹¬å·ï¼Œå»ºè®®ä½¿ç”¨ä»£ç æ ¼å¼å¼•ç”¨åŒæ‹¬å· <code>{{}}</code></p><h2 id="é…ç½®-theme-ä¸­çš„-config-yml"><a href="#é…ç½®-theme-ä¸­çš„-config-yml" class="headerlink" title="é…ç½® theme ä¸­çš„ _config.yml"></a>é…ç½® theme ä¸­çš„ _config.yml</h2><ol><li><p>æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„æ³¨é‡Šï¼Œç®€å•ä¿®æ”¹äº†ä¸‹é¢çš„è®¾ç½®</p><p>dream, music, video, recommend, github &amp; social link, reward, clicklove, myProjects, mySkills, subtitle, banner</p></li><li><p>å–æ¶ˆ rainbow ç‰¹æ•ˆ</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.bg-cover:after</span> <span class="token punctuation">{</span>    <span class="token property">-webkit-animation</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>    <span class="token property">animation</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åœ¨ hexo d æ—¶é‡åˆ°é—®é¢˜</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">err: Error: Spawn failed<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒå¤©è‡ªåŠ¨å¥½äº†ï¼Œæ ¹æœ¬åŸå› æ˜¯ç½‘ç»œæ²¡æœ‰èµ°é€šçš„é—®é¢˜ï¼Œä¹‹åå¯èƒ½å†æ¬¡é‡åˆ°ï¼Œåˆ°æ—¶å€™å†è§£å†³ï¼Œå»ºè®®åœ¨ github ä¸Šæœç´¢</p><p>ç°åœ¨å‘ç°äº†ï¼Œç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯ root ç”¨æˆ·ä¸‹çš„ git é…ç½®ï¼Œè€Œæˆ‘ root ç”¨æˆ·ä¸‹ git config æ²¡æœ‰è®¾ç½®å¥½å‚æ•°æ‰€ä»¥éƒ¨ç½²å¤±è´¥ã€‚æˆ‘åœ¨ root ç›®å½•çš„ .gitconfig å’Œ .ssh ä¸‹é…ç½®å¥½äº† user.name ssh ç­‰å¿…è¦ git é…ç½®å°±æˆåŠŸäº†ã€‚è¿™è¯´æ˜äº†åœ¨ linux ä¸‹ä¸åŒçš„ç”¨æˆ·éƒ½éœ€è¦è‡ªå·±å»é…ç½® git</p></li><li><p>ä¿®æ”¹åšå®¢ feature image åªé€‰ç”¨1å¼ ç®€å•å›¾æ¥ä»£è¡¨ã€‚åŸæ¥æœ‰ 24 å¼ å›¾ï¼Œæˆ‘æŠŠ24ä¸ªè·¯å¾„å…¨éƒ¨æ”¹ä¸ºåŒ1å¼ å›¾ã€‚</p></li><li><p>å› ä¸ºä¹‹åéœ€è¦å†™å…¥æ•°å­¦å…¬å¼ï¼Œå°† mathjax æ”¹ä¸º trueã€‚ä½†å‘ç°æ˜¾ç¤ºå…¬å¼æ¸²æŸ“ä¸æ­£å¸¸ï¼Œè€Œä¸”å°æ‹¬å·æ˜¾ç¤ºä¸å‡ºæ¥ã€‚æ ¹æ® <a href="https://github.com/blinkfox/hexo-theme-matery/issues/119">github issue</a> è§£å†³æ— æ³•æ¢è¡Œé—®é¢˜ï¼Œå°†æ¸²æŸ“å™¨æ¢ä¸º hexo-renderer-kramed è€Œä¸”ä»£ç é«˜äº®æ’ä»¶ä¼¼ä¹å¹¶æ²¡å—åˆ°å½±å“ã€‚æ ¹æ® <a href="https://adaning.github.io/posts/33457.html">MathJaxå¸¸è§é—®é¢˜</a> è§£å†³å°æ‹¬å·æ— æ³•æ˜¾ç¤ºé—®é¢˜ã€‚æ ¹æ® <a href="https://www.jianshu.com/p/7ab21c7f0674">åšå®¢</a> å†è¿›ä¸€æ­¥é…ç½® kramed æ¸²æŸ“ï¼Œè§£å†³å¤§æ‹¬å·çš„å†²çªé—®é¢˜</p></li></ol><h2 id="é…ç½®-matery-css"><a href="#é…ç½®-matery-css" class="headerlink" title="é…ç½® matery.css"></a>é…ç½® matery.css</h2><p>ä¸ºäº†è¿›ä¸€æ­¥è®¾ç½®æˆ‘ä»¬çš„ç½‘é¡µï¼Œè®©å…¶æ›´å…·æœ‰ä¸ªæ€§åŒ–ï¼Œå°±éœ€è¦è¿›ä¸€æ­¥è°ƒæ•´ matery.css æ–‡ä»¶ã€‚</p><ol><li><p>è®¾ç½® å¯¼èˆªé¢œè‰²</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.bg-color</span> <span class="token punctuation">{</span>    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span> #BEBEBE 0%<span class="token punctuation">,</span> #708090 100%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æŸ¥è¯¢é¢œè‰²ä»£ç ç½‘å€ï¼š<a href="https://tool.oschina.net/commons?type=3">https://tool.oschina.net/commons?type=3</a></p></li><li><p>ç”±äºåˆšå¼€å§‹åŠ è½½æ—¶ banner å›¾ç‰‡æ²¡æœ‰è¿…é€ŸåŠ è½½ï¼Œä¼šé»˜è®¤å…ˆåŠ è½½æ©™è‰²ï¼Œæˆ‘æ”¹æˆç°è‰²</p><p>ä¿®æ”¹â€œ\Hexo\themes\hexo-theme-matery\layout\ _partial\index-cover.ejsâ€æ–‡ä»¶ä¸­çš„ç¬¬63è¡Œå³å¯ã€‚</p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>carousel-item red white-text bg-cover about-cover<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠŠâ€œredâ€ä¿®æ”¹ä¸ºå…¶ä»–é¢œè‰²å³å¯ã€‚æˆ‘æ”¹ä¸º slate gray</p></li><li><p>æ”¹å˜ progress-bar é¢œè‰²</p></li><li><p>æ”¹å˜å›åˆ°é¡¶éƒ¨æŒ‰é’®é¢œè‰² top-scroll</p></li><li><p>æ”¹å˜å°é¢æ‰“å­—æ•ˆæœçš„æ–‡å­—å¤§å°ã€é¢œè‰² .bg-cover .description</p></li><li><p>ä¿®æ”¹äº†æ‰“å­—æ•ˆæœçš„é¢œè‰²è¿‡åï¼Œæˆ‘å‘ç°æ–‡ç« æ ‡é¢˜çš„é¢œè‰²ä¹Ÿè·Ÿç€æ”¹äº†ã€‚è§£å†³æ–¹æ³•æ˜¯åœ¨ä¸‹é¢çš„ .bg-cover .description å¢åŠ å±æ€§ color: #color_codeï¼Œè¿™æ ·å°±èƒ½åˆ†åˆ«è°ƒæ•´å®ƒä»¬çš„é¢œè‰²ã€‚</p></li><li><p>ä¿®æ”¹ about é¡µé¢é“¾æ¥é¢œè‰² aboutme</p></li><li><p>ä¿®æ”¹ archive é¡µé¢æ—¶é—´çº¿é¢œè‰² cd-timeline</p></li></ol><h2 id="æ’ä»¶ä¼˜åŒ–"><a href="#æ’ä»¶ä¼˜åŒ–" class="headerlink" title="æ’ä»¶ä¼˜åŒ–"></a>æ’ä»¶ä¼˜åŒ–</h2><h3 id="æ–‡ç« -url-ä¼˜åŒ–"><a href="#æ–‡ç« -url-ä¼˜åŒ–" class="headerlink" title="æ–‡ç«  url ä¼˜åŒ–"></a>æ–‡ç«  url ä¼˜åŒ–</h3><p>æˆ‘æ²¡æœ‰ä½¿ç”¨é¡¹ç›®ä¸­ä¸»è¦ä»‹ç»çš„è½¬æ‹¼éŸ³æ–¹æ³•ï¼Œé‚£æ ·ç”Ÿæˆçš„é“¾æ¥å¤ªé•¿äº†ï¼Œè€Œæ˜¯ä½¿ç”¨ hexo-abbrlink æ’ä»¶</p><pre class="line-numbers language-sehll" data-language="sehll"><code class="language-sehll">npm install hexo-abbrlink --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ ¹ç›®å½• _config.yml æ–‡ä»¶ä¸­ä¿®æ”¹</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">permalink</span><span class="token punctuation">:</span> archives/<span class="token punctuation">:</span>abbrlink.html<span class="token key atrule">abbrlink</span><span class="token punctuation">:</span>    <span class="token key atrule">alg</span><span class="token punctuation">:</span> crc32   <span class="token comment">#ç®—æ³•ï¼š crc16(default) and crc32</span>    <span class="token key atrule">rep</span><span class="token punctuation">:</span> hex     <span class="token comment">#è¿›åˆ¶ï¼š dec(default) and hex</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ hexo ä¸‰è¿æ—¶é‡åˆ°æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">FATAL YAMLException: duplicated mapping key <span class="token punctuation">(</span><span class="token number">111</span>:1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯´æ˜æœ‰åŸé…ç½®æ–‡ä»¶ä¸­å·²ç»æœ‰ permalink çš„å®šä¹‰ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé‡Œæœ¬èº«çš„ permalink ä»£ç æ³¨é‡Šæ‰ï¼Œå®Œç¾è¿è¡Œï¼ç°åœ¨æˆ‘ä»¬çš„æ–‡ç«  url æœ€åæ˜¯ç‰¹æ®Šçš„æ•°å­—id <code>/archives/48732.html</code></p><h3 id="æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶"><a href="#æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶" class="headerlink" title="æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶"></a>æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶</h3><h3 id="æ·»åŠ -emoji-è¡¨æƒ…æ”¯æŒ"><a href="#æ·»åŠ -emoji-è¡¨æƒ…æ”¯æŒ" class="headerlink" title="æ·»åŠ  emoji è¡¨æƒ…æ”¯æŒ"></a>æ·»åŠ  emoji è¡¨æƒ…æ”¯æŒ</h3><h3 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h3><p>ä¸Šé¢ä¸‰ä¸ªéƒ¨åˆ†éƒ½æ˜¯æŒ‰ç…§ hexo-thme-matery github é¡¹ç›®é…ç½®çš„</p><h3 id="è¯„è®ºæ’ä»¶utterance"><a href="#è¯„è®ºæ’ä»¶utterance" class="headerlink" title="è¯„è®ºæ’ä»¶utterance"></a>è¯„è®ºæ’ä»¶utterance</h3><p>matery åœ¨é…ç½®æ–‡ä»¶ä¸­å‘Šè¯‰æˆ‘ä»¬ï¼Œæœ‰çš„è¯„è®ºè½¯ä»¶æœ‰å®‰å…¨éšæ‚£ï¼Œæ¨èä½¿ç”¨ utterance</p><p>å°è¯• utteranceï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›å¸è½½ valineï¼Œæ³¨é”€ lean cloud</p><p>ä¹Ÿå°è¯•äº† livere å®‰è£…ä¹Ÿå¾ˆä¸å‹å¥½</p><p>æˆåŠŸåœ¨ contact é¡µé¢ä¸‹å±•ç¤ºäº† utteranceï¼Œæ–¹æ³•æ˜¯åœ¨ contact.ejs æ–‡æ¡£ä¸‹æ‰¾äº†ä¸€ä¸ªåœ°æ–¹æ’å…¥ä¸‹é¢çš„ä»£ç ï¼ˆè®°å¾—æ”¹ä¸º rè‡ªå·±çš„ github repoï¼Œå½¢å¼ä¸º <owner>/<name> ï¼‰ï¼Œ</name></owner></p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://utteranc.es/client.js<span class="token punctuation">"</span></span><span class="token attr-name">repo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[ENTER REPO HERE]<span class="token punctuation">"</span></span><span class="token attr-name">issue-term</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pathname<span class="token punctuation">"</span></span><span class="token attr-name">theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>github-light<span class="token punctuation">"</span></span><span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span><span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘æ’å…¥åœ¨ <code>&lt;div class="card"&gt;</code> åé¢ï¼Œæ˜¯ç®¡ç”¨çš„ã€‚å› ä¸ºåŸé¡¹ç›®è¯´ï¼Œæ’å…¥åˆ°ä½ çš„ layout éœ€è¦å‡ºç°çš„åœ°æ–¹ï¼Œæˆ‘ä¸æ‡‚å‰ç«¯çš„ä»£ç ï¼Œåªèƒ½èƒ¡ä¹±æ’å…¥äº†ï¼Œç®¡ç”¨å°±è¡Œï¼æˆ‘çŒœæµ‹è¿™æ˜¯ä¸€ä¸ªâ€œå¡ç‰‡ç±»â€èƒ½å¤Ÿå­˜æ”¾ä½ çš„å†…å®¹ï¼Œä»¥ç™½è‰²å¡ç‰‡åœ¨é¡µé¢ä¸­å±•ç¤ºå‡ºæ¥ã€‚</p><p>ç”¨åŒæ ·çš„æ–¹æ³•åœ¨ post ä¸‹æ·»åŠ è¯„è®ºã€‚æ‰¾åˆ° <code>/hexo-theme-matery/layout/_partial/post-detail.ejs</code> æ–‡ä»¶ï¼Œæ‰¾åˆ°è¯„è®ºçš„å¸ƒå±€ä¹‹å¤„ï¼ˆæœç´¢ä¸»é¢˜è‡ªå¸¦çš„è¯„è®ºæ’ä»¶å¦‚ gittalkï¼Œå°±èƒ½æ‰¾åˆ°ï¼‰æ’å…¥ä¸Šé¢çš„ä»£ç å³å¯ã€‚ä½†æ˜¯æ¸²æŸ“è¿‡åèƒŒæ™¯æ˜¯é€æ˜çš„ï¼Œä¸å¤ªå¥½çœ‹ï¼Œæˆ‘å¸Œæœ›æƒ³ contact ä¸€æ ·æœ‰ç™½è‰²èƒŒæ™¯ï¼Œé‚£å°±å¤åˆ¶ä¸€ä¸‹ contact.ejs ä¸­çš„â€œå¡ç‰‡ç±»â€è¯„è®ºåŒºå°±è¡Œäº†ã€‚</p><h3 id="åˆ†ç±»ä¼˜åŒ–"><a href="#åˆ†ç±»ä¼˜åŒ–" class="headerlink" title="åˆ†ç±»ä¼˜åŒ–"></a>åˆ†ç±»ä¼˜åŒ–</h3><p>matery ä¸»é¢˜çš„åˆ†ç±»æ²¡æœ‰å¤šå±‚åˆ†ç±»ï¼Œåœ¨ categories é¡µé¢åªæœ‰åƒ tag ä¸€æ ·æ ‡ç­¾ï¼Œè¿™æ ·çš„åˆ†ç±»åˆæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæ ¹æ® <a href="https://notes.zhangxiaocai.cn/posts/5a99eb4d.html#toc-heading-8">Hexo Matery ä¸»é¢˜æ·»åŠ å¤šçº§åˆ†ç±»</a> è¿›è¡Œè®¾ç½®ï¼Œå¯ä»¥å¾—åˆ°æ›´å¥½çš„åˆ†ç±»é¡µï¼Œç±»åˆ«ä¹‹é—´å°†æœ‰å±‚æ¬¡å…³ç³»</p><p>å…·ä½“æ¥è®²ï¼Œé‡‡ç”¨äº†åšå®¢é‡Œæœ€æ–°æ›´æ–°çš„ä»£ç ï¼Œåˆä½œäº†ä»¥ä¸‹æ”¹åŠ¨ï¼š</p><ol><li><p>ç»™ category-item, category-count ç­‰å¢åŠ  color å±æ€§ï¼Œæ”¹ä¸ºè‡ªå·±å–œæ¬¢çš„é¢œè‰²</p></li><li><p>ç»™ category-title å¢åŠ  font-size å±æ€§ï¼Œä¿®æ”¹æ ‡é¢˜å¤§å°</p></li><li><p>ç”±äºæ¯æ¬¡è¿›å…¥ç›®å½•é»˜è®¤è¦å±•å¼€ä¸€ä¸ªç±»åˆ«ï¼Œæ”¹åŠ¨ä¸‹æ–¹ä»£ç ï¼Œè®©æ‰€æœ‰ç±»åˆ«åˆå§‹çŠ¶æ€é»˜è®¤æŠ˜å </p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* origin code: &lt;li  class="&lt;%= subCats.length &gt; 0 ? 'active' : '' %&gt;" &gt; */</span><span class="token operator">&lt;</span>li  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"&lt;%= subCats.length &gt; 10000 ? 'active' : '' %&gt;"</span> <span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>åˆ é™¤ç®­å¤´å˜åŒ– <code>category-item-action col s11 m11</code></p></li></ol><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><h3 id="ç½‘ç«™SEOä¼˜åŒ–"><a href="#ç½‘ç«™SEOä¼˜åŒ–" class="headerlink" title="ç½‘ç«™SEOä¼˜åŒ–"></a>ç½‘ç«™SEOä¼˜åŒ–</h3><p>Search Engine Optimization</p><p>å°†è‡ªå·±çš„ç½‘ç«™æäº¤ç»™æœç´¢å¼•æ“</p><h3 id="ä¸æ–­æ›´æ–°"><a href="#ä¸æ–­æ›´æ–°" class="headerlink" title="ä¸æ–­æ›´æ–°"></a>ä¸æ–­æ›´æ–°</h3><p>æŒç»­æ›´æ–°åšå®¢å†…å®¹ï¼Œå®Œå–„åˆ†ç±»</p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> åšå®¢æ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„åšå®¢æ­å»ºç¬”è®°</title>
      <link href="/archives/4984.html"/>
      <url>/archives/4984.html</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ªäººåšå®¢æ­å»º-hexo"><a href="#ä¸ªäººåšå®¢æ­å»º-hexo" class="headerlink" title="ä¸ªäººåšå®¢æ­å»º hexo"></a>ä¸ªäººåšå®¢æ­å»º hexo</h1><p>æ•´ä½“å‚è€ƒè¿‡ç¨‹ä¸º CodeSheep è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1Yb411a7ty">https://www.bilibili.com/video/BV1Yb411a7ty</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="Node-js-amp-npm"><a href="#Node-js-amp-npm" class="headerlink" title="Node.js &amp; npm"></a>Node.js &amp; npm</h3><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://developer.aliyun.com/article/760687">https://developer.aliyun.com/article/760687</a></p><p>æˆ‘é€‰æ‹©äº† apt å®‰è£…</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nodejs <span class="token function">npm</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç‰ˆæœ¬ä¿¡æ¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">nodejs --versionv10.19.0<span class="token function">npm</span> --version<span class="token number">6.14</span>.4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç‰ˆæœ¬è¿˜æ˜¯æœ‰ç‚¹è€æ—§</p><h3 id="æ·˜å®é•œåƒ-cnpm"><a href="#æ·˜å®é•œåƒ-cnpm" class="headerlink" title="æ·˜å®é•œåƒ cnpm"></a>æ·˜å®é•œåƒ cnpm</h3><p>cnpm çš„å®˜æ–¹ä»‹ç»æ˜¯ï¼šcnpmæ˜¯ä¸€ä¸ªå®Œæ•´ npmjs.or é•œåƒï¼Œä½ å¯ä»¥ç”¨æ­¤ä»£æ›¿å®˜æ–¹ç‰ˆæœ¬(åªè¯»)ï¼ŒåŒæ­¥é¢‘ç‡ç›®å‰ä¸º <strong>10åˆ†é’Ÿ</strong> ä¸€æ¬¡ä»¥ä¿è¯å°½é‡ä¸å®˜æ–¹æœåŠ¡åŒæ­¥ã€‚</p><p>å®‰è£…äº† cnpm å°±å¯ä»¥ä½¿ç”¨é•œåƒèµ„æºä¸‹è½½åŒ…ï¼Œå¦‚æœä¸å¸Œæœ›ä½¿ç”¨é•œåƒèµ„æºåˆ™æ¢å› npm å‘½ä»¤å³å¯ã€‚ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> -g cnpm --registry<span class="token operator">=</span>https://registry.npm.taobao.org<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> cnpm <span class="token function">install</span> -g hexo-cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç‰ˆæœ¬ä¿¡æ¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">hexo -vhexo-cli: <span class="token number">4.3</span>.0os: linux <span class="token number">5.4</span>.0-77-generic Ubuntu <span class="token number">20.04</span>.2 LTS <span class="token punctuation">(</span>Focal Fossa<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="æ­å»ºåšå®¢"><a href="#æ­å»ºåšå®¢" class="headerlink" title="æ­å»ºåšå®¢"></a>æ­å»ºåšå®¢</h2><h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">mkdir</span> blog <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> blog<span class="token function">sudo</span> hexo init<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœå“ªé‡Œå‡ºé”™äº†ï¼Œæƒ³é‡æ¥ï¼Œç›´æ¥åˆ é™¤ blog æ–‡ä»¶å¤¹å³å¯</p><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡åˆ°æŠ¥é”™</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">INFO  Validating configINFO  Start processingFATAL <span class="token punctuation">{</span> err:   TypeError: line.matchAll is not a <span class="token keyword">function</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åŸå› åœ¨äº nodejs ç‰ˆæœ¬å¤ªä½ï¼Œå°è¯•ä½¿ç”¨ n å‡çº§ nodejs</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> -g n<span class="token function">sudo</span> n latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æŸ¥çœ‹ç‰ˆæœ¬</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">node -vv16.4.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆåŠŸå¯åŠ¨ hexo serverï¼Œä½ å¯ä»¥é€šè¿‡ <a href="http://localhost:4000">http://localhost:4000</a> è®¿é—®ä½ çš„æœ¬åœ°åšå®¢å•¦ï¼</p><h3 id="å†™ç¬¬ä¸€ç¯‡æ–‡ç« "><a href="#å†™ç¬¬ä¸€ç¯‡æ–‡ç« " class="headerlink" title="å†™ç¬¬ä¸€ç¯‡æ–‡ç« "></a>å†™ç¬¬ä¸€ç¯‡æ–‡ç« </h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hexo new <span class="token string">'Fisrt Blog'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿¡æ¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">INFO  Validating configINFO  Created: /home/declan/Documents/blog/source/_posts/First-Blog.md<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½ çš„æ–‡ç« ä½ç½®åœ¨ä¸Šé¢çš„è·¯å¾„ä¸­å¯ä»¥æ‰¾åˆ°ï¼Œå¯ä»¥é€šè¿‡ markdown è¯­æ³•è¿›è¡Œä¹¦å†™</p><h3 id="ç”Ÿæˆ"><a href="#ç”Ÿæˆ" class="headerlink" title="ç”Ÿæˆ"></a>ç”Ÿæˆ</h3><p>æ¸…ç†ä¸€äº›ç¼“å­˜ï¼Œç„¶åç”Ÿæˆæˆ‘ä»¬çš„é¡µé¢ï¼ŒåŒæ ·ä½¿ç”¨ hexo server ä»æœ¬åœ°æŸ¥çœ‹æ•ˆæœ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">hexo cleanhexo generatehexo server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="å¸ƒå±åˆ°è¿œç«¯"><a href="#å¸ƒå±åˆ°è¿œç«¯" class="headerlink" title="å¸ƒå±åˆ°è¿œç«¯"></a>å¸ƒå±åˆ°è¿œç«¯</h2><h3 id="github"><a href="#github" class="headerlink" title="github"></a>github</h3><p>åœ¨ github æ–°å»ºä»“åº“ name.github.io nameä¸€å®šè¦æ˜¯ä½ çš„ github ç”¨æˆ·å</p><p>åœ¨ blog ç›®å½•ä¸‹ï¼Œä¸‹è½½ git deployer</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> cnpm <span class="token function">install</span> --save hexo-deployer-git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="è®¾ç½®-config-yml"><a href="#è®¾ç½®-config-yml" class="headerlink" title="è®¾ç½® _config.yml"></a>è®¾ç½® _config.yml</h3><p>åœ¨ blog ç›®å½•ä¸‹æ‰“å¼€ _config.yml æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åçš„ # Deployments ä¸Šä¿®æ”¹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># Deployment</span><span class="token comment">## Docs: https://hexo.io/docs/one-command-deployment</span>deploy:  type: <span class="token string">'git'</span>  repo: https://github.com/DeclK/declk.github.io.git  branch: master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç°åœ¨ä½ çš„ä»“åº“é‡Œå¤šäº†ä¸€äº›æ–‡ä»¶</p><p>ä»¥åä½ å°±å¯ä»¥é€šè¿‡ä½ çš„ä»“åº“å <em>*</em>.github.io æ¥è®¿é—®ä½ çš„åšå®¢å•¦ï¼</p><h2 id="æ›´æ¢ä¸»é¢˜"><a href="#æ›´æ¢ä¸»é¢˜" class="headerlink" title="æ›´æ¢ä¸»é¢˜"></a>æ›´æ¢ä¸»é¢˜</h2><p>åœ¨å¯»æ‰¾äº†è®¸ä¹…è¿‡åå†³å®šä½¿ç”¨ <a href="https://github.com/blinkfox/hexo-theme-matery">hexo-theme-matery</a></p><h2 id="å¯ç§»æ¤æ€§"><a href="#å¯ç§»æ¤æ€§" class="headerlink" title="å¯ç§»æ¤æ€§"></a>å¯ç§»æ¤æ€§</h2><p>å¦‚æœæŠŠ hexo æ•´ä¸ªåšå®¢é¡¹ç›®ç§»åˆ°å¦ä¸€å°ç”µè„‘ä¸Šï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›å°å›°éš¾ï¼Œä½†æ˜¯æ ¹æ® hexo çš„æç¤ºå‘½ä»¤ï¼Œå¾ˆå¿«å°±èƒ½è§£å†³</p>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶ </category>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> åšå®¢æ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
